window.__require=function t(e,i,a){function n(s,r){if(!i[s]){if(!e[s]){var c=s.split("/");if(c=c[c.length-1],!e[c]){var d="function"==typeof __require&&__require;if(!r&&d)return d(c,!0);if(o)return o(c,!0);throw new Error("Cannot find module '"+s+"'")}s=c}var l=i[s]={exports:{}};e[s][0].call(l.exports,function(t){return n(e[s][1][t]||t)},l,l.exports,t,e,i,a)}return i[s].exports}for(var o="function"==typeof __require&&__require,s=0;s<a.length;s++)n(a[s]);return n}({ActiveExchangeAwardItem:[function(t,e,i){"use strict";cc._RF.push(e,"595c2xZYClMS5EAfZ0gwyDw","ActiveExchangeAwardItem");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/MstData"),r=t("../../scripts/utils/GlobalFun"),c=t("./BuildItem"),d=cc._decorator,l=d.ccclass,p=d.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.awardnum=null,e.awardIcon=null,e.skinRoot=null,e}return n(e,t),e.prototype.initAwardInfo=function(t,e,i){var a=this;void 0===i&&(i=1);for(var n=0;n<this.skinRoot.children.length;n++)this.skinRoot.children[n].destroy();if(3==t){this.awardIcon.node.active=!1,this.skinRoot.active=!0,this.awardnum.node.active=!1;var o=s.default.getInstance().mstBuildingSkin[e].nodeName;o&&cc.resources.load("building/"+o,cc.Prefab,function(t,e){if(!t){var i=cc.instantiate(e);i.setPosition(cc.v2(0,0)),i.getComponent(c.default).initUnlockShow(160,160),a.skinRoot.addChild(i)}})}else{this.awardIcon.node.active=!0,this.skinRoot.active=!1,this.awardnum.node.active=!0,this.awardnum.string="x"+i;var d=r.default.getItemIconPathById(e);r.default.loadSpriteFrame(this.awardIcon,d)}},o([p(cc.Label)],e.prototype,"awardnum",void 0),o([p(cc.Sprite)],e.prototype,"awardIcon",void 0),o([p(cc.Node)],e.prototype,"skinRoot",void 0),o([l],e)}(cc.Component);i.default=u,cc._RF.pop()},{"../../scripts/data/MstData":void 0,"../../scripts/utils/GlobalFun":void 0,"./BuildItem":"BuildItem"}],ActivityBtn:[function(t,e,i){"use strict";cc._RF.push(e,"47c65M+r8pFuYWfAn/srVwm","ActivityBtn");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/UserData"),r=t("../../scripts/manager/UIManager"),c=t("../../scripts/utils/ActionFunc"),d=t("../../scripts/utils/EventName"),l=t("../../scripts/utils/GlobalFun"),p=t("../prefabs/ChristmasPopup"),u=cc._decorator,f=u.ccclass,h=u.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnBg=[],e.itemBg=[],e.itemNode=[],e.completeNode=null,e.bgSprite=null,e.endTimeLab=null,e.isStartAni=!1,e}return n(e,t),e.prototype.initNeedItems=function(){var t=s.default.getInstance().activityData.christmas.taskData[0];if(t){var e=t.requireItems,i=t.isReceived;if(e.length>0){var a=s.default.getInstance().getNormalItemIndexByIds(e);this.itemNode[0].active=!1,this.itemNode[1].active=!1;for(var n=0;n<e.length;n++){var o=i||a[n]>0,r=this.itemNode[n];r.active=!0;var d=l.default.getItemIconPathById(e[n]+"");if(d){var p=r.getChildByName("itemicon").getComponent(cc.Sprite);l.default.loadSpriteFrame(p,d)}o?(r.getChildByName("gou").active=!0,r.getComponent(cc.Sprite).spriteFrame=this.itemBg[1]):(r.getChildByName("gou").active=!1,r.getComponent(cc.Sprite).spriteFrame=this.itemBg[0])}}t.isComplete?(this.completeNode.active=!0,this.bgSprite.spriteFrame=this.btnBg[1],this.isStartAni||(this.isStartAni=!0,c.default.zoomAnim2(this.node))):(this.isStartAni&&(this.isStartAni=!1,cc.Tween.stopAllByTarget(this.node),this.node.scale=1),this.completeNode.active=!1,this.bgSprite.spriteFrame=this.btnBg[0])}},e.prototype.onClickActivity=function(){r.default.getInstance().openUI(p.default)},e.prototype.updateTime=function(){var t=s.default.getInstance().activityData.getActivityEndTime("christmas");if(t.length>0){var e=t[1]-window.serverTime;e>0?this.endTimeLab.string=l.default.formatDateTimeDaysPre(e):cc.director.getScene().emit(d.default.RESET_ACTIVITY)}else cc.director.getScene().emit(d.default.RESET_ACTIVITY)},e.prototype.onLoad=function(){cc.director.getScene().on(d.default.UPDATE_MERGEAREA,this.initNeedItems,this),cc.director.getScene().on(d.default.UPDATE_BY_SECOND,this.updateTime,this),this.updateTime(),this.initNeedItems(),s.default.getInstance().activityData.isFirstLoadActivitu("christmas")?(s.default.getInstance().activityData.setShowOneActivity("christmas"),s.default.getInstance().updateTaskAndItem(),cc.director.getScene().emit(d.default.UPDATE_MERGEAREA)):s.default.getInstance().activityData.setShowOneActivity("christmas")},o([h([cc.SpriteFrame])],e.prototype,"btnBg",void 0),o([h([cc.SpriteFrame])],e.prototype,"itemBg",void 0),o([h([cc.Node])],e.prototype,"itemNode",void 0),o([h(cc.Node)],e.prototype,"completeNode",void 0),o([h(cc.Sprite)],e.prototype,"bgSprite",void 0),o([h(cc.Label)],e.prototype,"endTimeLab",void 0),o([f],e)}(cc.Component);i.default=g,cc._RF.pop()},{"../../scripts/data/UserData":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/utils/ActionFunc":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../prefabs/ChristmasPopup":"ChristmasPopup"}],AdapterTop:[function(t,e,i){"use strict";cc._RF.push(e,"f5d4aHv+EpJ4p4qczhEv7Hq","AdapterTop");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=cc._decorator,r=s.ccclass,c=s.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.widget=null,e}return n(e,t),e.prototype.onLoad=function(){var t=this.widget.top,e=cc.view.getVisibleSize().width,i=cc.view.getVisibleSize().height;i/e>1.8&&(this.widget.top=t+550*(i/e-1.8))},o([c(cc.Widget)],e.prototype,"widget",void 0),o([r],e)}(cc.Component);i.default=d,cc._RF.pop()},{}],AltasTypeItem:[function(t,e,i){"use strict";cc._RF.push(e,"156f6pKT/BDT4fZdTvF0ATy","AltasTypeItem");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../extension/ListItem"),r=t("./AtlasElementItem"),c=cc._decorator,d=c.ccclass,l=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.titleNode=null,e.itemNode=null,e.lineNode=null,e.lbItemName=null,e.itemPrefab=null,e._parent=null,e}return n(e,t),e.prototype.initItemInfo=function(t,e){t.typeName?(this.lbItemName.string=t.typeName,this.titleNode.active=!0):this.titleNode.active=!1,t.line?this.lineNode.active=!0:this.lineNode.active=!1;var i=this.itemNode.getComponent(cc.Layout);i.spacingX=12,i.paddingLeft=12,this._parent=e,this.initItemList(t.ids)},e.prototype.initItemList=function(t){var e,i=this.itemNode.children;e=i.length>t.length?i.length:t.length;for(var a=0;a<e;a++)if(i[a]&&t[a])i[a].getComponent(r.default).initItemData(t[a],this._parent),i[a].active=!0;else if(i[a]&&!t[a])i[a].active=!1;else if(!i[a]&&t[a]){var n=cc.instantiate(this.itemPrefab);n.getComponent(r.default).initItemData(t[a],this._parent),this.itemNode.addChild(n)}},e.prototype.getGuideItemNode=function(t){return this.itemNode.children[t].getComponent(r.default).getGuideItemNode()},e.prototype.initBuildingInfo=function(t,e){t.typeName?(this.lbItemName.string=t.typeName,this.titleNode.active=!0):this.titleNode.active=!1,t.line?this.lineNode.active=!0:this.lineNode.active=!1;var i=this.itemNode.getComponent(cc.Layout);i.spacingX=12,i.paddingLeft=12,this._parent=e,this.initBuildingList(t.ids)},e.prototype.initBuildingList=function(t){var e,i=this.itemNode.children;e=i.length>t.length?i.length:t.length;for(var a=0;a<e;a++)if(i[a]&&t[a])i[a].getComponent(r.default).initBuildingData(t[a],this._parent),i[a].active=!0;else if(i[a]&&!t[a])i[a].active=!1;else if(!i[a]&&t[a]){var n=cc.instantiate(this.itemPrefab);n.getComponent(r.default).initBuildingData(t[a],this._parent),this.itemNode.addChild(n)}},e.prototype.initCustomerInfo=function(t,e){var i=this.itemNode.getComponent(cc.Layout);i.spacingX=37.5,i.paddingLeft=37.5,this._parent=e,this.titleNode.active=!1,this.lineNode.active=!1,this.initCustomerList(t.ids)},e.prototype.initCustomerList=function(t){var e,i=this.itemNode.children;e=i.length>t.length?i.length:t.length;for(var a=0;a<e;a++)if(i[a]&&t[a])i[a].getComponent(r.default).initCustomerData(t[a],this._parent),i[a].active=!0;else if(i[a]&&!t[a])i[a].active=!1;else if(!i[a]&&t[a]){var n=cc.instantiate(this.itemPrefab);n.getComponent(r.default).initCustomerData(t[a],this._parent),this.itemNode.addChild(n)}},o([l(cc.Node)],e.prototype,"titleNode",void 0),o([l(cc.Node)],e.prototype,"itemNode",void 0),o([l(cc.Node)],e.prototype,"lineNode",void 0),o([l(cc.Label)],e.prototype,"lbItemName",void 0),o([l(cc.Prefab)],e.prototype,"itemPrefab",void 0),o([d],e)}(s.default);i.default=p,cc._RF.pop()},{"../extension/ListItem":"ListItem","./AtlasElementItem":"AtlasElementItem"}],AssistShopAwardItem:[function(t,e,i){"use strict";cc._RF.push(e,"0b755DxNC9L1qMq9M+dD0OQ","AssistShopAwardItem");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/manager/UIManager"),r=t("../../scripts/utils/GlobalFun"),c=t("../prefabs/ItemChain"),d=cc._decorator,l=d.ccclass,p=d.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.awardnum=null,e.awardIcon=null,e.btnChain=null,e._itemID=null,e}return n(e,t),e.prototype.initAwardInfo=function(t,e,i){void 0===e&&(e=1),void 0===i&&(i=!0),this._itemID=t,this.btnChain.active=i,this.awardnum.node.active=!0,this.awardnum.string="x"+e;var a=r.default.getItemIconPathById(t);r.default.loadSpriteFrame(this.awardIcon,a)},e.prototype.onItemClicked=function(){s.default.getInstance().openUI(c.default,{data:this._itemID})},o([p(cc.Label)],e.prototype,"awardnum",void 0),o([p(cc.Sprite)],e.prototype,"awardIcon",void 0),o([p(cc.Node)],e.prototype,"btnChain",void 0),o([l],e)}(cc.Component);i.default=u,cc._RF.pop()},{"../../scripts/manager/UIManager":void 0,"../../scripts/utils/GlobalFun":void 0,"../prefabs/ItemChain":"ItemChain"}],AssistShopItem:[function(t,e,i){"use strict";cc._RF.push(e,"aa65bhayNlP8aaGKn5KZ7BS","AssistShopItem");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/UserData"),r=t("../../scripts/manager/AdManager"),c=t("../../scripts/manager/UIManager"),d=t("../../scripts/prefabs/Toast"),l=t("../../scripts/utils/EventName"),p=t("../../scripts/utils/GlobalFun"),u=t("../../scripts/utils/StatisticsManager"),f=t("../extension/ListItem"),h=t("../prefabs/AwardPopup"),g=t("./AssistShopAwardItem"),m=t("../../scripts/extension/LanguageData"),v=cc._decorator,_=v.ccclass,y=v.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnFinish=null,e.awardRoot=null,e.rescived=null,e.giftName=null,e.surplusCount=null,e.awardPrefab=null,e.itemBgIcon=null,e.itemBg=[],e.shopInfo=null,e.awardList=[],e._parent=null,e}return n(e,t),e.prototype.init=function(t,e){this.shopInfo=t,this._parent=e,this.awardList=[],this.itemBgIcon.spriteFrame=this.itemBg[this.listId%3],this.giftName.string=this.shopInfo.giftName,this.updateAward(),this.updateState()},e.prototype.updateAward=function(){for(var t=0;t<this.awardRoot.children.length;t++)this.awardRoot.children[t].destroy();var e=this.shopInfo.reward;for(t=0;t<e.length;t++)(n=cc.instantiate(this.awardPrefab)).getComponent(g.default).initAwardInfo(e[t]),this.awardRoot.addChild(n),this.awardList.push({id:e[t],num:1});var i=p.default.rewardResToObj(this.shopInfo.rewardRes);for(var a in i){var n;Object.prototype.hasOwnProperty.call(i,a)&&((n=cc.instantiate(this.awardPrefab)).getComponent(g.default).initAwardInfo(Number(a),i[a],!1),this.awardRoot.addChild(n),this.awardList.push({id:Number(a),num:i[a]}))}},e.prototype.updateState=function(){var t=s.default.getInstance().activityData.newYear.payShop[this.shopInfo.shopId]?s.default.getInstance().activityData.newYear.payShop[this.shopInfo.shopId]:0;if(t>=this.shopInfo.limitNum)this.btnFinish.active=!1,this.rescived.active=!0,this.surplusCount.node.active=!1;else{this.btnFinish.active=!0,this.rescived.active=!1;var e=this.shopInfo.limitNum-t;e>0&&e<=10?(this.surplusCount.node.active=!0,this.surplusCount.string=m.default.t("shopItem_1",{times:e})):this.surplusCount.node.active=!1}},e.prototype.onClickGetAward=function(){var t=this;"video"==this.shopInfo.costType&&r.default.getInstance().showRewardAd(function(){var e;e=s.default.getInstance().activityData.newYear.firecrackers,u.default.trackEvent("activity_newYear_payShop",{shopId:t.shopInfo.shopId+""}),s.default.getInstance().activityData.newYear.buyItem(t.shopInfo.shopId)?(s.default.getInstance().activityData.newYear.firecrackers!=e&&t._parent.addFirecrackersAni(e),t.updateState(),t.awardList.length>0&&c.default.getInstance().openUI(h.default,{data:p.default.clone(t.awardList)}),cc.director.getScene().emit(l.default.UPDATE_FIRECRACKERS)):c.default.getInstance().openUI(d.default,{data:{str:m.default.t("buildInfoPopup_7")}})},function(){},function(){})},e.prototype.start=function(){},o([y(cc.Node)],e.prototype,"btnFinish",void 0),o([y(cc.Node)],e.prototype,"awardRoot",void 0),o([y(cc.Node)],e.prototype,"rescived",void 0),o([y(cc.Label)],e.prototype,"giftName",void 0),o([y(cc.Label)],e.prototype,"surplusCount",void 0),o([y(cc.Prefab)],e.prototype,"awardPrefab",void 0),o([y(cc.Sprite)],e.prototype,"itemBgIcon",void 0),o([y([cc.SpriteFrame])],e.prototype,"itemBg",void 0),o([_],e)}(f.default);i.default=I,cc._RF.pop()},{"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/Toast":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../../scripts/utils/StatisticsManager":void 0,"../extension/ListItem":"ListItem","../prefabs/AwardPopup":"AwardPopup","./AssistShopAwardItem":"AssistShopAwardItem"}],AssistShopPopup:[function(t,e,i){"use strict";cc._RF.push(e,"f2a5fjBnk1JoqAUm/+kbsek","AssistShopPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MstData"),c=t("../../scripts/data/UserData"),d=t("../../scripts/manager/AdManager"),l=t("../../scripts/utils/ActionFunc"),p=t("../../scripts/utils/GlobalFun"),u=t("../entitys/AssistShopItem"),f=t("../extension/List"),h=cc._decorator,g=h.ccclass,m=h.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.listElement=null,e.firecrackersLab=null,e.btnBianpao=null,e.payList=[],e}return n(e,t),e.prototype.init=function(){this.updateTaskData(),this.updateFirecrackers(),p.default.isCanShowBanner()&&d.default.getInstance().showBanner()},e.prototype.updateTaskData=function(){this.payList=[];var t=r.default.getInstance().mstActivity.newYear.config.payShop;for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)){var i=t[e];i.shopId=Number(e),this.payList.push(i)}this.payList.sort(function(t,e){return t.index-e.index})},e.prototype.updateFirecrackers=function(){this.firecrackersLab.string=c.default.getInstance().activityData.newYear.firecrackers+""},e.prototype.addFirecrackersAni=function(t){var e=this,i=c.default.getInstance().activityData.newYear.firecrackers;l.default.updateNumberAnimation(this.btnBianpao,this.firecrackersLab,i,t,function(){cc.isValid(e)&&e.updateFirecrackers()})},e.prototype.itemElementRender=function(t,e){t.getComponent(u.default).init(this.payList[e],this)},e.prototype.onLoad=function(){this.listElement.numItems=this.payList.length},e.prototype.onDestroy=function(){p.default.isCanShowBanner()&&d.default.getInstance().hideBanner()},e.uiName="AssistShopPopup",o([m(f.default)],e.prototype,"listElement",void 0),o([m(cc.Label)],e.prototype,"firecrackersLab",void 0),o([m(cc.Node)],e.prototype,"btnBianpao",void 0),o([g],e)}(s.default);i.default=v,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/utils/ActionFunc":void 0,"../../scripts/utils/GlobalFun":void 0,"../entitys/AssistShopItem":"AssistShopItem","../extension/List":"List"}],AtlasElementItem:[function(t,e,i){"use strict";cc._RF.push(e,"68091kWke1LgbNg7Ewuu28l","AtlasElementItem");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/MstData"),r=t("../../scripts/data/UserData"),c=t("../../scripts/manager/UIManager"),d=t("../../scripts/utils/EventName"),l=t("../../scripts/utils/GlobalFun"),p=t("../extension/ListItem"),u=t("../prefabs/BuildInfoPopup"),f=t("../prefabs/CustomerInfoPopup"),h=t("../prefabs/ItemInfoPopup"),g=t("./BuildItem"),m=cc._decorator,v=m.ccclass,_=m.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.level=null,e.itemName=null,e.itemIcon=null,e.itemBg=null,e.unlock=null,e.btnGetAward=null,e.levelbg=null,e.attsnode=null,e.skintip=null,e.roleSkintip=null,e.skinRed=null,e.itemId=null,e._parent=null,e._itemFlag=0,e}return n(e,t),e.prototype.initItemData=function(t,e){this.itemId&&this.itemId==t||(this.itemId=t,this._parent=e,this._itemFlag=0,this.node.setContentSize(cc.size(210,240)),this.itemBg.setContentSize(cc.size(210,240)),this.btnGetAward.setPosition(cc.v3(0,-80,0)),this.itemName.node.setPosition(cc.v3(0,-93,0)),this.refreshItem())},e.prototype.refreshItem=function(){var t=this;if(this.levelbg.active=!0,this.level.node.active=!0,this.itemIcon.node.active=!0,this.attsnode.active=!1,this.skintip.active=!1,this.roleSkintip.active=!1,this.skinRed.active=!1,r.default.getInstance().isItemUnlock(this.itemId))if(this.itemId,r.default.getInstance().itemUnlockItemRewardData[this.itemId]){var e=l.default.getItemIconPathById(this.itemId);l.default.loadSpriteFrame(this.itemIcon,e,function(){t.itemIcon.node.scale=1}),this.itemIcon.node.y=0,this.itemName.node.active=!0,this.itemName.string=s.default.getInstance().mstItem[this.itemId].name,this.btnGetAward.active=!1}else e=l.default.getItemIconPathById(30094),l.default.loadSpriteFrame(this.itemIcon,e,function(){t.itemIcon.node.scale=1}),this.itemIcon.node.y=18,this.itemName.node.active=!1,this.btnGetAward.active=!0;else this.itemIcon.node.scale=1,this.itemIcon.node.y=0,this.itemIcon.spriteFrame=this.unlock,this.itemName.string="???",this.btnGetAward.active=!1,this.itemName.node.active=!0;var i=s.default.getInstance().mstItem[this.itemId].level;this.level.string=""+i},e.prototype.initBuildingData=function(t,e){this.itemId&&this.itemId==t||(this.itemId=t,this._parent=e,this._itemFlag=1,this.node.setContentSize(cc.size(210,240)),this.itemBg.setContentSize(cc.size(210,240)),this.btnGetAward.setPosition(cc.v3(0,-80,0)),this.itemName.node.setPosition(cc.v3(0,-93,0)),this.refreshBuildingItem())},e.prototype.refreshBuildingItem=function(){var t=this;this.levelbg.active=!1,this.level.node.active=!1,this.skintip.active=!1,this.roleSkintip.active=!1,this.skinRed.active=!1,this.itemName.node.setPosition(cc.v3(0,-93,0));var e=r.default.getInstance().buildingData[this.itemId].mstSkinData,i=e.nodeName;if(this.attsnode.removeAllChildren(),r.default.getInstance().buildingData[this.itemId].isUnlock){var a=this.itemId;if(r.default.getInstance().buildingData[this.itemId].isReceived)r.default.getInstance().buildingData[this.itemId].mstData.skinIds.length>1&&(this.skintip.active=!0),r.default.getInstance().buildingData[this.itemId].isHaveTips&&(this.skinRed.active=!0,this.skinRed.x=88,this.skinRed.y=104),this.itemIcon.node.active=!1,this.attsnode.active=!0,i&&cc.resources.load("building/"+i,cc.Prefab,function(e,i){if(!e&&a==t.itemId){var n=cc.instantiate(i);n.setPosition(cc.v2(0,0)),n.getComponent(g.default).initUnlockShow(160,160),t.attsnode.addChild(n)}}),this.itemName.node.active=!0,this.itemName.string=e.name,this.btnGetAward.active=!1;else{this.itemIcon.node.active=!0,this.attsnode.active=!1;var n=l.default.getItemIconPathById(30094);l.default.loadSpriteFrame(this.itemIcon,n,function(){t.itemIcon.node.scale=1}),this.itemName.node.active=!1,this.btnGetAward.active=!0}}else this.itemIcon.node.active=!0,this.attsnode.active=!1,this.itemIcon.node.scale=1,this.itemIcon.spriteFrame=this.unlock,this.itemName.string="???",this.btnGetAward.active=!1,this.itemName.node.active=!0},e.prototype.initCustomerData=function(t,e){this.itemId&&this.itemId.id==t.id||(this.itemId=t,this._parent=e,this._itemFlag=2,this.node.setContentSize(cc.size(250,270)),this.itemBg.setContentSize(cc.size(250,270)),this.btnGetAward.setPosition(cc.v3(0,-98,0)),this.itemName.node.setPosition(cc.v3(0,-98,0)),this.refreshCustomerItem())},e.prototype.refreshCustomerItem=function(){var t=this;this.levelbg.active=!1,this.level.node.active=!1,this.itemIcon.node.active=!0,this.attsnode.active=!1,this.skintip.active=!1,this.roleSkintip.active=!1,this.skinRed.active=!1,this.itemName.node.setPosition(cc.v3(0,-110,0));var e=this.itemId;if(e.isUnlock)if(e.id,e.isReceived)e.mstData.skinIds.length>1&&(this.roleSkintip.active=!0),e.isHaveTips&&(this.skinRed.active=!0,this.skinRed.x=110,this.skinRed.y=126),l.default.loadSpriteFrame(this.itemIcon,"textures/role/icon/icon_"+e.mstSkinData.icon,function(){t.itemIcon.node.y=0;var e=180/t.itemIcon.node.width,i=180/t.itemIcon.node.height;t.itemIcon.node.scale=e<i?e:i}),this.itemName.node.active=!0,this.itemName.string=e.mstSkinData.name,this.btnGetAward.active=!1;else{var i=l.default.getItemIconPathById(30094);l.default.loadSpriteFrame(this.itemIcon,i,function(){t.itemIcon.node.scale=1}),this.itemName.node.active=!1,this.btnGetAward.active=!0}else this.itemIcon.node.scale=1,this.itemIcon.spriteFrame=this.unlock,this.itemName.string="???",this.btnGetAward.active=!1,this.itemName.node.active=!0},e.prototype.onGetUnlockAward=function(){var t={id:30094,num:s.default.getInstance().mstMisc.unlockReward.config};0==this._itemFlag?r.default.getInstance().receiveUnlockItemReward(this.itemId)&&(this.refreshItem(),this._parent.refreshItemRed()):1==this._itemFlag?r.default.getInstance().receiveUnlockBuildingReward(this.itemId)&&(this.refreshBuildingItem(),this._parent.refreshBuildingRed()):2==this._itemFlag&&r.default.getInstance().receiveUnlockCustomerReward(this.itemId.id)&&(this.refreshCustomerItem(),this._parent.refreshCustomerRed()),this.flyCoin(t)},e.prototype.flyCoin=function(t){var e={};e.id=t.id,e.startNode=this.node,e.num=t.num,e.callback=function(){cc.director.getScene().emit(d.default.UPDATE_REWARD)},cc.director.getScene().emit(d.default.ITEM_FLY,e)},e.prototype.refushBuild=function(){this.refreshBuildingItem()},e.prototype.refushRole=function(){this.refreshCustomerItem()},e.prototype.onClickItem=function(){this.btnGetAward.active?this.onGetUnlockAward():0==this._itemFlag?r.default.getInstance().isItemUnlock(this.itemId)&&c.default.getInstance().openUI(h.default,{data:this.itemId}):1==this._itemFlag?r.default.getInstance().buildingData[this.itemId].isUnlock&&(this.skinRed.active=!1,c.default.getInstance().openUI(u.default,{data:{buildId:this.itemId,parent:this}})):2==this._itemFlag&&r.default.getInstance().roleData[this.itemId.id].isUnlock&&(this.skinRed.active=!1,c.default.getInstance().openUI(f.default,{data:{roleId:this.itemId.id,parent:this}}))},e.prototype.getGuideItemNode=function(){var t={};return this.btnGetAward.active?t.isGetAward=!1:t.isGetAward=!0,t.node=this.node,t},o([_(cc.Label)],e.prototype,"level",void 0),o([_(cc.Label)],e.prototype,"itemName",void 0),o([_(cc.Sprite)],e.prototype,"itemIcon",void 0),o([_(cc.Node)],e.prototype,"itemBg",void 0),o([_(cc.SpriteFrame)],e.prototype,"unlock",void 0),o([_(cc.Node)],e.prototype,"btnGetAward",void 0),o([_(cc.Node)],e.prototype,"levelbg",void 0),o([_(cc.Node)],e.prototype,"attsnode",void 0),o([_(cc.Node)],e.prototype,"skintip",void 0),o([_(cc.Node)],e.prototype,"roleSkintip",void 0),o([_(cc.Node)],e.prototype,"skinRed",void 0),o([v],e)}(p.default);i.default=y,cc._RF.pop()},{"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../extension/ListItem":"ListItem","../prefabs/BuildInfoPopup":"BuildInfoPopup","../prefabs/CustomerInfoPopup":"CustomerInfoPopup","../prefabs/ItemInfoPopup":"ItemInfoPopup","./BuildItem":"BuildItem"}],AtlasPopup:[function(t,e,i){"use strict";cc._RF.push(e,"0dd5ccOVqVPWoJ7p6DIWwY5","AtlasPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MstData"),c=t("../../scripts/data/UserData"),d=t("../../scripts/manager/AdManager"),l=t("../../scripts/manager/UIManager"),p=t("../../scripts/prefabs/Toast"),u=t("../../scripts/utils/EventName"),f=t("../../scripts/utils/GlobalFun"),h=t("../../scripts/utils/StatisticsManager"),g=t("../entitys/AltasTypeItem"),m=t("../extension/List"),v=t("./ShopPopup"),_=t("../../scripts/extension/LanguageData"),y=cc._decorator,I=y.ccclass,b=y.property,N=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.listElement=null,e.itemRed=null,e.buildingRed=null,e.customerRed=null,e.dressNum=null,e.tiketNum=null,e.toggleList=[],e._atlasList=null,e._areaList=null,e._customerList=null,e._atlasFlag=0,e._itemAwardIdx=0,e._buildingIdx=0,e._customerIdx=0,e._chooseIndex=0,e._srollToID=0,e._buildingLoadLock=0,e._buildingLoadLockIdx=0,e._callback=null,e._srollToRoleID=0,e._roleLoadLock=0,e._roleLoadLockIdx=0,e}return n(e,t),e.prototype.init=function(t){t&&t.choose&&(this._chooseIndex=Number(t.choose)),t&&t.buildId&&(this._srollToID=Number(t.buildId)),t&&t.callback&&(this._callback=t.callback),t&&t.roleId&&(this._srollToRoleID=Number(t.roleId)),this.initAtalsData(),this.initBuildData(),this.initCustomerData(),this.refreshItemRed(),this.refreshBuildingRed(),this.refreshCustomerRed(),this.updateResCount(),f.default.isCanShowBanner()&&d.default.getInstance().showBanner()},e.prototype.updateResCount=function(){this.dressNum.string=c.default.getInstance().skinScore+"",this.tiketNum.string=c.default.getInstance().skinTicket+""},e.prototype.itemElementRender=function(t,e){0==this._atlasFlag?t.getComponent(g.default).initItemInfo(this._atlasList[e],this):1==this._atlasFlag?t.getComponent(g.default).initBuildingInfo(this._areaList[e],this):2==this._atlasFlag&&t.getComponent(g.default).initCustomerInfo(this._customerList[e],this)},e.prototype.onItemChecked=function(t){t.isChecked&&(this._atlasFlag=0,this.listElement.numItems=this._atlasList.length,this.listElement.node.getComponent(cc.ScrollView).stopAutoScroll(),this.listElement.scrollTo(this._itemAwardIdx))},e.prototype.onBuildingChecked=function(t){t.isChecked&&(this._atlasFlag=1,this.listElement.numItems=this._areaList.length,this.listElement.node.getComponent(cc.ScrollView).stopAutoScroll(),this.listElement.scrollTo(this._buildingIdx))},e.prototype.onCustomerChecked=function(t){t.isChecked&&(this._atlasFlag=2,this.listElement.numItems=this._customerList.length,this.listElement.node.getComponent(cc.ScrollView).stopAutoScroll(),this.listElement.scrollTo(this._customerIdx))},e.prototype.refreshItemRed=function(){for(var t=!1,e=0;e<this._atlasList.length;e++){for(var i=this._atlasList[e].ids,a=0;a<i.length;a++)if(c.default.getInstance().isItemUnlock(i[a])&&!c.default.getInstance().itemUnlockItemRewardData[i[a]]){this._itemAwardIdx=e,t=!0;break}if(t)break}t?this.itemRed.active=!0:(this._itemAwardIdx=0,this.itemRed.active=!1)},e.prototype.refreshBuildingRed=function(){for(var t=!1,e=0;e<this._areaList.length;e++){for(var i=this._areaList[e].ids,a=0;a<i.length;a++)if("area"!=r.default.getInstance().mstBuilding[i[a]].type&&c.default.getInstance().buildingData[i[a]].isUnlock&&!c.default.getInstance().buildingData[i[a]].isReceived){this._buildingIdx=e,t=!0;break}if(t)break}t?this.buildingRed.active=!0:(this._buildingIdx=0,this.buildingRed.active=!1)},e.prototype.refreshCustomerRed=function(){for(var t=!1,e=0;e<this._customerList.length;e++){for(var i=this._customerList[e].ids,a=0;a<i.length;a++)if(i[a].isUnlock&&!i[a].isReceived){this._customerIdx=e,t=!0;break}if(t)break}t?this.customerRed.active=!0:(this._customerIdx=0,this.customerRed.active=!1)},e.prototype.initAtalsData=function(){this._atlasList=[];for(var t=r.default.getInstance().getAtlasData(),e=0;e<t.length;e++){var i=t[e],a=r.default.getInstance().mstItem[i[0]].typeName,n=Math.floor(i.length/4);i.length%4&&(n+=1);for(var o=0;o<n;o++){var s={};0==o&&(s.typeName=a),o==n-1&&e!=t.length-1&&(s.line=!0),s.ids=[];for(var c=0;c<4;c++)i[4*o+c]&&s.ids.push(i[4*o+c]);this._atlasList.push(s)}}},e.prototype.initBuildData=function(){this._areaList=[];var t=r.default.getInstance().mstSceneArea;for(var e in t){for(var i=[],a=[],n=0;n<t[e].buildingIds.length;n++){var o=t[e].buildingIds[n];"area"!==r.default.getInstance().mstBuilding[o].type&&(c.default.getInstance().buildingData[o].isUnlock?i.push(o):a.push(o))}i.sort(function(t,e){return r.default.getInstance().mstBuilding[t].atlasIndex-r.default.getInstance().mstBuilding[e].atlasIndex}),a.sort(function(t,e){return r.default.getInstance().mstBuilding[t].atlasIndex-r.default.getInstance().mstBuilding[e].atlasIndex});var s=[];for(n=0;n<i.length;n++)s.push(i[n]);for(n=0;n<a.length;n++)s.push(a[n]);var d=t[e].name,l=Math.floor(s.length/4);s.length%4&&(l+=1);for(var p=0;p<l;p++){var u={};0==p&&(u.typeName=d),p==l-1&&"8"!=e&&(u.line=!0),u.ids=[];for(var f=0;f<4;f++)s[4*p+f]&&(s[4*p+f]==this._srollToID&&(this._buildingLoadLock=this._areaList.length,this._buildingLoadLockIdx=f),u.ids.push(s[4*p+f]));this._areaList.push(u)}}},e.prototype.initCustomerData=function(){this._customerList=[];var t=c.default.getInstance().roleData,e=[];for(var i in t)e.push(t[i]);for(var a=[],n=[],o=0;o<e.length;o++)e[o].isUnlock?a.push(e[o]):n.push(e[o]);a.sort(function(t,e){return t.mstData.index-e.mstData.index}),n.sort(function(t,e){return t.mstData.index-e.mstData.index});var s=[];for(o=0;o<a.length;o++)s.push(a[o]);for(o=0;o<n.length;o++)s.push(n[o]);var r=Math.floor(s.length/3);s.length%3&&(r+=1);for(var d=0;d<r;d++){for(var l={ids:[]},p=0;p<3;p++)s[3*d+p]&&(l.ids.push(s[3*d+p]),+s[3*d+p].id==this._srollToRoleID&&(this._roleLoadLock=d,this._roleLoadLockIdx=p));this._customerList.push(l)}},e.prototype.getGuideItemNode=function(){return this.listElement.getItemByListId(this._buildingLoadLock).getComponent(g.default).getGuideItemNode(this._buildingLoadLockIdx)},e.prototype.getGuideItemRoleNode=function(){return this.listElement.getItemByListId(this._roleLoadLock).getComponent(g.default).getGuideItemNode(this._roleLoadLockIdx)},e.prototype.getGuieUseId=function(){return this._srollToID},e.prototype.getGuieUseRoleId=function(){return this._srollToRoleID},e.prototype.onTiketChecked=function(){var t=r.default.getInstance().mstStore.dailyGift.openLevel;c.default.getInstance().level<t?l.default.getInstance().openUI(p.default,{data:{str:_.default.t("mainScene_1",{shopOpenLevel:t})}}):l.default.getInstance().openUI(v.default,{data:{key:"resource",type:1}})},e.prototype.onLoad=function(){var t=this;h.default.trackEvent("atlas_open"),0==this._chooseIndex?(this._atlasFlag=0,this.listElement.numItems=this._atlasList.length,this.listElement.scrollTo(this._itemAwardIdx,.5)):1==this._chooseIndex?(this._atlasFlag=1,this.listElement.numItems=this._areaList.length,this.listElement.scrollTo(this._buildingLoadLock,.5),this.scheduleOnce(function(){t._callback&&t._callback()},.5)):2==this._chooseIndex&&(this._atlasFlag=2,this.listElement.numItems=this._customerList.length,this.listElement.scrollTo(this._roleLoadLock,.5),this.scheduleOnce(function(){t._callback&&t._callback()},.5)),this._chooseIndex>0&&this.toggleList[this._chooseIndex].check(),cc.director.getScene().on(u.default.UPDATE_TOPINFO,this.updateResCount,this)},e.prototype.onDisable=function(){cc.director.getScene().emit(u.default.OPEN_SCENE)},e.prototype.onDestroy=function(){f.default.isCanShowBanner()&&d.default.getInstance().hideBanner()},e.uiName="AtlasPopup",o([b(m.default)],e.prototype,"listElement",void 0),o([b(cc.Node)],e.prototype,"itemRed",void 0),o([b(cc.Node)],e.prototype,"buildingRed",void 0),o([b(cc.Node)],e.prototype,"customerRed",void 0),o([b(cc.Label)],e.prototype,"dressNum",void 0),o([b(cc.Label)],e.prototype,"tiketNum",void 0),o([b([cc.Toggle])],e.prototype,"toggleList",void 0),o([I],e)}(s.default);i.default=N,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/Toast":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../../scripts/utils/StatisticsManager":void 0,"../entitys/AltasTypeItem":"AltasTypeItem","../extension/List":"List","./ShopPopup":"ShopPopup"}],AwardPopup:[function(t,e,i){"use strict";cc._RF.push(e,"5c6f34Ml6dFIZoY5qn7IJhc","AwardPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MstData"),c=t("../../scripts/manager/AdManager"),d=t("../../scripts/manager/AudioManager"),l=t("../../scripts/manager/UIManager"),p=t("../../scripts/utils/EventName"),u=t("../../scripts/utils/GlobalFun"),f=t("../entitys/BuildItem"),h=t("./UnlockShowPopup"),g=t("../../scripts/extension/LanguageData"),m=cc._decorator,v=m.ccclass,_=m.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.fram=null,e.awardItemNode=null,e.otherItemNode=null,e.otherItemName=null,e.icon=null,e.num=null,e.okNode=null,e._awardData=[],e._skinData=[],e}return n(e,t),e.prototype.init=function(t){for(var e=[],i=0;i<t.length;i++)"30098"!=t[i].id&&"40000"!=t[i].id||(e.push.apply(e,t.splice(i,1)),i--);this._awardData=t,this._skinData=e,this.updateUI(),c.default.getInstance().showBanner()},e.prototype.updateUI=function(){this._awardData.length>0?this.showAward():this.showSkin()},e.prototype.showAward=function(){var t=this,e=this._awardData[0].id,i=this._awardData[0].num,a=r.default.getInstance().mstItem[e];if(a)if("buildingSkinShow"==a.type){this.otherItemNode.children[0].destroyAllChildren(),this.otherItemNode.active=!0,this.awardItemNode.active=!1;var n=r.default.getInstance().mstBuildingSkin[i];n?(this.otherItemName.string=n.name,n.nodeName&&cc.resources.load("building/"+n.nodeName,cc.Prefab,function(e,i){if(e)t.showAnim();else if(cc.isValid(t.node)){var a=cc.instantiate(i);a.setPosition(cc.v2(0,0)),a.getComponent(f.default).initUnlockShow(),t.otherItemNode.children[0].addChild(a),t.showAnim()}})):this.onClickClose()}else if("activityShow"==a.type){this.otherItemNode.active=!1,this.awardItemNode.active=!0;var o="textures/itemIcon/"+a.icon+"_"+i;u.default.loadSpriteFrame(this.icon,o),this.num.string=g.default.t("passPopup_2"),this.showAnim()}else this.otherItemNode.active=!1,this.awardItemNode.active=!0,o="textures/itemIcon/"+a.icon,u.default.loadSpriteFrame(this.icon,o),this.num.string="x"+this._awardData[0].num,this.showAnim()},e.prototype.showSkin=function(){var t=this;this.node.opacity=0,this.fram.active=!1;var e=this._skinData.shift();if(e){var i=4e4==e.id?"customer":"building";l.default.getInstance().openNotice(h.default,{data:{ntype:i,skinId:e.num}},null,function(){t.showSkin()})}else this.onClose()},e.prototype.showAnim=function(){var t=this;d.default.getInstance().playEffect("awardShow"),this.okNode.active=!1,this.icon.parent.opacity=0,this.icon.parent.scale=0,cc.tween(this.icon.parent).to(.2,{opacity:255,scale:1}).call(function(){t.okNode.active=!0}).start()},e.prototype.onClickClose=function(){var t=this._awardData.shift();this.itemFly(t),this._awardData.length>0?this.updateUI():this._skinData.length>0?this.showSkin():this.onClose()},e.prototype.itemFly=function(t){if(30098!=t.id&&30099!=t.id&&40001!=t.id&&40002!=t.id){var e={};e.id=t.id,e.startNode=this.icon,e.num=t.num,e.callback=function(){cc.director.getScene().emit(p.default.UPDATE_REWARD)},cc.director.getScene().emit(p.default.ITEM_FLY,e)}else cc.director.getScene().emit(p.default.UPDATE_TOPINFO)},e.prototype.onDestroy=function(){c.default.getInstance().hideBanner()},e.uiName="AwardPopup",o([_(cc.Node)],e.prototype,"fram",void 0),o([_(cc.Node)],e.prototype,"awardItemNode",void 0),o([_(cc.Node)],e.prototype,"otherItemNode",void 0),o([_(cc.Label)],e.prototype,"otherItemName",void 0),o([_(cc.Node)],e.prototype,"icon",void 0),o([_(cc.Label)],e.prototype,"num",void 0),o([_(cc.Node)],e.prototype,"okNode",void 0),o([v],e)}(s.default);i.default=y,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MstData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/AudioManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../entitys/BuildItem":"BuildItem","./UnlockShowPopup":"UnlockShowPopup"}],BagItem:[function(t,e,i){"use strict";cc._RF.push(e,"a1f813Bp1tLC4sxP1awarVo","BagItem");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/UserData"),r=t("../../scripts/manager/UIManager"),c=t("../../scripts/prefabs/Toast"),d=t("../../scripts/utils/EventName"),l=t("../../scripts/utils/GlobalFun"),p=t("../../scripts/extension/LanguageData"),u=cc._decorator,f=u.ccclass,h=u.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spIcon=null,e.maxLevelNode=null,e.spBg=null,e._bagModel=null,e._index=-1,e.parent=null,e}return n(e,t),e.prototype.initItem=function(t,e){this._index=t,this.parent=e,this.updateUI()},e.prototype.updateUI=function(){if(-1==this._index)this.node.getComponent(cc.Button).interactable=!1,this.node.children[1].active=!0;else if(this.node.getComponent(cc.Button).interactable=!0,this.node.children[1].active=!1,this._bagModel=s.default.getInstance().bagData.itemData[this._index],-1!==this._bagModel.id){var t="textures/itemIcon/"+this._bagModel.mstData.icon;l.default.loadSpriteFrame(this.spIcon,t),this.maxLevelNode.active=this._bagModel.isMaxLevel&&this._bagModel.mstData.level>1}else this.spIcon.spriteFrame=null,this.maxLevelNode.active=!1},e.prototype.onClickItem=function(){if(-1!==this._bagModel.id){var t=s.default.getInstance().takeOutBag(this._index,s.default.getInstance().mergeArea+1);-1!==t?(s.default.getInstance().updateTaskAndItem(),cc.director.getScene().emit(d.default.UPDATE_MERGEAREA,[t]),this._bagModel=s.default.getInstance().bagData.itemData[this._index],this.parent.refreshBagItem()):r.default.getInstance().openUI(c.default,{data:{str:p.default.t("bagItem_1")}})}},o([h(cc.Sprite)],e.prototype,"spIcon",void 0),o([h(cc.Node)],e.prototype,"maxLevelNode",void 0),o([h(cc.Sprite)],e.prototype,"spBg",void 0),o([f],e)}(cc.Component);i.default=g,cc._RF.pop()},{"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/Toast":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0}],BagPopup:[function(t,e,i){"use strict";cc._RF.push(e,"99b0aV/PtNJMYoztaTJ5uAE","BagPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/UserData"),c=t("../../scripts/manager/AdManager"),d=t("../../scripts/manager/UIManager"),l=t("../../scripts/prefabs/Toast"),p=t("../../scripts/utils/EventName"),u=t("../../scripts/utils/GlobalFun"),f=t("../entitys/BagItem"),h=t("./HelpPopup"),g=t("../../scripts/extension/LanguageData"),m=cc._decorator,v=m.ccclass,_=m.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pfbBagItem=null,e.content=null,e.buyButtonNode=null,e.lbCoinsNum=null,e.videoButtonNode=null,e.lbVideo=null,e.lbVideoNum=null,e.lbVideoLeft=null,e._bagItemJs=[],e._bagData=null,e}return n(e,t),e.prototype.init=function(){this._bagData=r.default.getInstance().bagData,u.default.isCanShowBanner()&&c.default.getInstance().showBanner()},e.prototype.onLoad=function(){for(var t=this._bagData.itemData.length,e=0;e<t;e++){var i=cc.instantiate(this.pfbBagItem),a=i.getComponent(f.default);a.initItem(e,this),this.content.addChild(i),this._bagItemJs.push(a)}this.updateUI(),this.updateRewardCD(),cc.director.getScene().on(p.default.UPDATE_BY_SECOND,this.updateRewardCD,this)},e.prototype.updateRewardCD=function(){if(this.videoButtonNode.node.active){var t=c.default.getInstance().rewardAdCd;t>0?(this.videoButtonNode.interactable=!1,u.default.setBtnIsGrey(this.videoButtonNode),this.lbVideo.string=u.default.formatDateTimeHourEx(t)):(this.videoButtonNode.interactable=!0,u.default.setBtnIsGrey(this.videoButtonNode,new cc.Color(62,96,32)),this.lbVideo.string=g.default.t("buildInfoPopup_3"))}},e.prototype.updateUI=function(){var t=this._bagData.config.unlockDiamonds.length,e=this._bagData.config.unlockVideo.length,i=this._bagItemJs.length;if(this._bagItemJs[i-1].initItem(i-1,this),this._bagData.buyCount<t||this._bagData.videoCount<e){var a=cc.instantiate(this.pfbBagItem),n=a.getComponent(f.default);n.initItem(-1,this),this.content.addChild(a),this._bagItemJs.push(n)}if(this._bagData.buyCount>=t)this.buyButtonNode.active=!1;else{this.buyButtonNode.active=!0;var o=this._bagData.config.unlockDiamonds[this._bagData.buyCount];this.lbCoinsNum.string=o}this._bagData.videoCount>=e?this.videoButtonNode.node.active=!1:(this.videoButtonNode.node.active=!0,o=this._bagData.config.unlockVideo[this._bagData.videoCount],this.lbVideoNum.string=this._bagData.videoTimes+"/"+o,this.lbVideoLeft.string=e>0?g.default.t("shop_1",{num:e-this._bagData.videoCount}):"")},e.prototype.refreshBagItem=function(){for(var t=0;t<this._bagItemJs.length;t++)this._bagItemJs[t].updateUI()},e.prototype.onClickHelp=function(){d.default.getInstance().openUI(h.default)},e.prototype.onClickBuyCell=function(){var t=this._bagData.buyBagCell();1===t?(this.updateUI(),d.default.getInstance().openUI(l.default,{data:{str:g.default.t("bagPopup_1")}}),cc.director.getScene().emit(p.default.UPDATE_TOPINFO)):-2===t?u.default.noDiamondsCommonPopup():d.default.getInstance().openUI(l.default,{data:{str:g.default.t("bagPopup_2")}})},e.prototype.onClickVideoBuy=function(){var t=this;c.default.getInstance().showRewardAd(function(){var e=t._bagData.buyCellByVideo();if(1==e)t.updateUI(),d.default.getInstance().openUI(l.default,{data:{str:g.default.t("bagPopup_1")}}),cc.director.getScene().emit(p.default.UPDATE_TOPINFO);else if(-1==e)d.default.getInstance().openUI(l.default,{data:{str:g.default.t("bagPopup_2")}});else{var i=t._bagData.config.unlockVideo[t._bagData.videoCount];t.lbVideoNum.string=t._bagData.videoTimes+"/"+i}},function(){},function(){})},e.prototype.onDestroy=function(){u.default.isCanShowBanner()&&c.default.getInstance().hideBanner()},e.uiName="BagPopup",o([_(cc.Prefab)],e.prototype,"pfbBagItem",void 0),o([_(cc.Node)],e.prototype,"content",void 0),o([_(cc.Node)],e.prototype,"buyButtonNode",void 0),o([_(cc.Label)],e.prototype,"lbCoinsNum",void 0),o([_(cc.Button)],e.prototype,"videoButtonNode",void 0),o([_(cc.Label)],e.prototype,"lbVideo",void 0),o([_(cc.Label)],e.prototype,"lbVideoNum",void 0),o([_(cc.Label)],e.prototype,"lbVideoLeft",void 0),o([v],e)}(s.default);i.default=y,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/Toast":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../entitys/BagItem":"BagItem","./HelpPopup":"HelpPopup"}],BlindBoxAwardItem:[function(t,e,i){"use strict";cc._RF.push(e,"22b9eAwi0lCOoIaGhCB776U","BlindBoxAwardItem");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/MstData"),r=t("./ItemEntity"),c=cc._decorator,d=c.ccclass,l=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bg=null,e.itemNode=null,e.itemName=null,e._itemID=0,e._itemNum=0,e}return n(e,t),e.prototype.initItem=function(t,e){var i=s.default.getInstance().mstItem[t];this.itemName.string=i.name;var a={};a.itemId=t,a.itemNum=e>1?e:0,a.itemBg=this.bg,a.isShowInfo=!0,a.isClickAble=!0,a.numOffset=cc.v2(5,60),this.itemNode.getComponent(r.default).init(a)},o([l(cc.SpriteFrame)],e.prototype,"bg",void 0),o([l(cc.Node)],e.prototype,"itemNode",void 0),o([l(cc.Label)],e.prototype,"itemName",void 0),o([d],e)}(cc.Component);i.default=p,cc._RF.pop()},{"../../scripts/data/MstData":void 0,"./ItemEntity":"ItemEntity"}],BlindBoxAwardPopup:[function(t,e,i){"use strict";cc._RF.push(e,"288c1OjohtO25gvFL43/Yzl","BlindBoxAwardPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/manager/AdManager"),c=t("../entitys/BlindBoxAwardItem"),d=cc._decorator,l=d.ccclass,p=d.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.boxPre=null,e.boxNode=null,e}return n(e,t),e.prototype.init=function(t){var e=t.slice(0);e.sort(function(t,e){return e.itemId-t.itemId});for(var i=0;i<e.length;i++){var a=cc.instantiate(this.boxPre);a.getComponent(c.default).initItem(e[i].itemId,e[i].itemNum),this.boxNode.addChild(a)}r.default.getInstance().showBanner()},e.prototype.onDestroy=function(){r.default.getInstance().hideBanner()},e.uiName="BlindBoxAwardPopup",o([p(cc.Prefab)],e.prototype,"boxPre",void 0),o([p(cc.Node)],e.prototype,"boxNode",void 0),o([l],e)}(s.default);i.default=u,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/manager/AdManager":void 0,"../entitys/BlindBoxAwardItem":"BlindBoxAwardItem"}],BlindBoxItem:[function(t,e,i){"use strict";cc._RF.push(e,"d11d5OZw0REqpJFRHDrIGrY","BlindBoxItem");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/MstData"),r=t("../../scripts/utils/GlobalFun"),c=cc._decorator,d=c.ccclass,l=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemName=null,e.itemNum=null,e.itemIcon=null,e.select=null,e.noOpen=null,e.open=null,e.nameNode=null,e._itemID=null,e._itemIdx=0,e._openList=null,e._parent=null,e._isOpen=!1,e._itemNum=0,e}return n(e,t),e.prototype.initItemData=function(t,e,i,a){this._itemID=t.itemId,this._openList=i,this._itemIdx=e,this._parent=a,this._isOpen=!1,this._itemNum=t.itemNum,this.select.active=!1,i.indexOf(this._itemIdx+1)>=0?(this._isOpen=!0,this.open.active=!0,this.nameNode.active=!0,this.noOpen.active=!1,this.showOpenUI(this._itemIdx)):(this.open.active=!1,this.nameNode.active=!1,this.noOpen.active=!0)},e.prototype.setOpenList=function(t){t.indexOf(this._itemIdx+1)>=0&&(this._isOpen=!0,this.showOpenUI(this._itemIdx))},e.prototype.showOpenUI=function(t){if(t==this._itemIdx){var e=r.default.getItemIconPathById(this._itemID);r.default.loadSpriteFrame(this.itemIcon,e);var i=s.default.getInstance().mstItem[this._itemID];"energyShow"==i.type?(this.itemNum.node.active=!0,this.itemNum.string="x"+this._itemNum):"diamondShow"==i.type?(this.itemNum.node.active=!0,this.itemNum.string="x"+this._itemNum):(this.itemNum.node.active=!1,this.itemNum.string=""),this.itemName.node.active=!0,this.itemName.string=i.name,this.open.active=!0,this.nameNode.active=!0,this.noOpen.active=!1}},e.prototype.selectItem=function(t){this._itemIdx==t?this.select.active=!0:this.select.active=!1},e.prototype.onSelectClicked=function(){this._parent.selectBox(this._itemID,this._itemNum,this._itemIdx,this._isOpen)},o([l(cc.Label)],e.prototype,"itemName",void 0),o([l(cc.Label)],e.prototype,"itemNum",void 0),o([l(cc.Sprite)],e.prototype,"itemIcon",void 0),o([l(cc.Node)],e.prototype,"select",void 0),o([l(cc.Node)],e.prototype,"noOpen",void 0),o([l(cc.Node)],e.prototype,"open",void 0),o([l(cc.Node)],e.prototype,"nameNode",void 0),o([d],e)}(cc.Component);i.default=p,cc._RF.pop()},{"../../scripts/data/MstData":void 0,"../../scripts/utils/GlobalFun":void 0}],BottomInfoPrefab:[function(t,e,i){"use strict";cc._RF.push(e,"9590e4xS5hC4aTGFqKgQh/8","BottomInfoPrefab");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../prefabs/TaskPopup"),r=t("../prefabs/ShopPopup"),c=t("../prefabs/BagPopup"),d=t("../../scripts/utils/EventName"),l=t("../../scripts/data/UserData"),p=t("../../scripts/data/MstData"),u=t("../../scripts/utils/GlobalFun"),f=t("../../scripts/utils/StatisticsManager"),h=t("../../scripts/manager/UIManager"),g=t("../../scripts/prefabs/Toast"),m=t("../../scripts/manager/AudioManager"),v=t("../../scripts/extension/LanguageData"),_=cc._decorator,y=_.ccclass,I=_.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.shopLockNode=null,e.spBag=null,e.spfBagOpen=null,e.spfBagClose=null,e.bagLockNode=null,e.btnTask=null,e.nodeHintTask=null,e.btnAward=null,e.icon=null,e.awardCount=null,e.btnShop=null,e.nodeHintShop=null,e._rewardId=null,e}return n(e,t),e.prototype.onLoad=function(){cc.director.getScene().on(d.default.UPDATE_REWARD,this.updateReward,this),cc.director.getScene().on(d.default.LEVELUP,this.updateUI,this),cc.director.getScene().on(d.default.PERFORMTASK,this.onClickBack,this),cc.director.getScene().on(d.default.UPDATE_BY_SECOND,this.updateBySecond,this),this.updateReward(),this.updateUI()},e.prototype.putBag=function(t){this.spBag.spriteFrame=t?this.spfBagOpen:this.spfBagClose},e.prototype.updateUI=function(){var t=l.default.getInstance().level,e=p.default.getInstance().mstStore.dailyGift.openLevel;this.shopLockNode.active=e>t,this.nodeHintShop.active=l.default.getInstance().storeData.isShowRedPoint();var i=p.default.getInstance().mstMisc.bagConfig.config.openLevel;this.bagLockNode.active=i>t},e.prototype.updateBySecond=function(){this.updateReward()},e.prototype.updateReward=function(){var t=l.default.getInstance().rewards;if(t.length>0){if(t[0].updateInfo(),this.awardCount.string=t.length+"",this._rewardId>=0&&this._rewardId!=t[0].id){this._rewardId=t[0].id,this.btnAward.active=!0;var e=u.default.getItemIconPathById(t[0].id+"");u.default.loadSpriteFrame(this.icon,e)}}else this.btnAward.active&&(this._rewardId=null,this.btnAward.active=!1)},e.prototype.onClickShop=function(){f.default.trackEvent("bottomInfo_shop_click");var t=p.default.getInstance().mstStore.dailyGift.openLevel;l.default.getInstance().level>=t?h.default.getInstance().openUI(r.default,{data:{key:"",type:1}}):h.default.getInstance().openUI(g.default,{data:{str:v.default.t("bottomInfoPrefab_1",{lv:t})}})},e.prototype.onClickBag=function(){f.default.trackEvent("bottomInfo_bag_click");var t=p.default.getInstance().mstMisc.bagConfig.config.openLevel;l.default.getInstance().level>=t?h.default.getInstance().openUI(c.default):h.default.getInstance().openUI(g.default,{data:{str:v.default.t("bottomInfoPrefab_1",{lv:t})}})},e.prototype.onClickReward=function(){if(f.default.trackEvent("bottomInfo_reward_click"),l.default.getInstance().rewards.length>0){f.default.trackEvent("merge_reward_click");var t=l.default.getInstance().receiveReward(l.default.getInstance().mergeArea+1);if(t>=0)m.default.getInstance().playEffect("clickBtn"),this.updateReward(),cc.director.getScene().emit(d.default.RECEIVE_AWARD,{cells:[t],originNode:this.btnAward,isAct:0}),cc.director.getScene().emit(d.default.UPDATE_ITEM_INFO,-1);else{var e={str:v.default.t("bagItem_1")};h.default.getInstance().openUI(g.default,{data:e})}}},e.prototype.onClickTask=function(){f.default.trackEvent("bottomInfo_order_click"),h.default.getInstance().openUI(s.default)},e.prototype.onClickBack=function(){f.default.trackEvent("bottomInfo_back_click"),cc.director.getScene().emit(d.default.OPEN_SCENE)},o([I(cc.Node)],e.prototype,"shopLockNode",void 0),o([I(cc.Sprite)],e.prototype,"spBag",void 0),o([I(cc.SpriteFrame)],e.prototype,"spfBagOpen",void 0),o([I(cc.SpriteFrame)],e.prototype,"spfBagClose",void 0),o([I(cc.Node)],e.prototype,"bagLockNode",void 0),o([I(cc.Node)],e.prototype,"btnTask",void 0),o([I(cc.Node)],e.prototype,"nodeHintTask",void 0),o([I(cc.Node)],e.prototype,"btnAward",void 0),o([I(cc.Sprite)],e.prototype,"icon",void 0),o([I(cc.Label)],e.prototype,"awardCount",void 0),o([I(cc.Node)],e.prototype,"btnShop",void 0),o([I(cc.Node)],e.prototype,"nodeHintShop",void 0),o([y],e)}(cc.Component);i.default=b,cc._RF.pop()},{"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AudioManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/Toast":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../../scripts/utils/StatisticsManager":void 0,"../prefabs/BagPopup":"BagPopup","../prefabs/ShopPopup":"ShopPopup","../prefabs/TaskPopup":"TaskPopup"}],BuildCompleteItem:[function(t,e,i){"use strict";cc._RF.push(e,"effa1VcuepIt7Hse00/ctdw","BuildCompleteItem");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/utils/GlobalFun"),r=cc._decorator,c=r.ccclass,d=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.awardnum=null,e.awardCurIcon=null,e.awardIcon=[],e}return n(e,t),e.prototype.initAwardInfo=function(t,e){if(t<4)this.awardCurIcon.spriteFrame=this.awardIcon[t],this.awardnum.string="x"+e;else{var i=s.default.getItemIconPathById(e);s.default.loadSpriteFrame(this.awardCurIcon,i),this.awardnum.string="x1"}},o([d(cc.Label)],e.prototype,"awardnum",void 0),o([d(cc.Sprite)],e.prototype,"awardCurIcon",void 0),o([d([cc.SpriteFrame])],e.prototype,"awardIcon",void 0),o([c],e)}(cc.Component);i.default=l,cc._RF.pop()},{"../../scripts/utils/GlobalFun":void 0}],BuildCompletePopup:[function(t,e,i){"use strict";cc._RF.push(e,"215caujGChMxbm2zMaXeaQx","BuildCompletePopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MstData"),c=t("../../scripts/data/UserData"),d=t("../../scripts/manager/AdManager"),l=t("../../scripts/manager/UIManager"),p=t("../../scripts/prefabs/Toast"),u=t("../../scripts/utils/EventName"),f=t("../../scripts/utils/StatisticsManager"),h=t("../entitys/BuildCompleteItem"),g=t("../entitys/BuildItem"),m=t("../../scripts/extension/LanguageData"),v=cc._decorator,_=v.ccclass,y=v.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.buildName=null,e.costNum=null,e.awardItem=null,e.buildIcon=null,e.awardContent=null,e.completeNode=null,e.mergeNode=null,e.spineNode=null,e._taskData=null,e._configData=null,e}return n(e,t),e.prototype.init=function(t){var e=this;this._taskData=t.task;var i=this._taskData.mstData;this._configData=r.default.getInstance().mstBuilding[i.buildingId];var a=c.default.getInstance().buildingData[i.buildingId].mstSkinData;this.buildName.string=a.name,this.costNum.string="x"+i.costCoins,i.exp>0?this.createAwardItem(0,i.exp):i.energy>0?this.createAwardItem(1,i.energy):i.diamonds>0&&this.createAwardItem(2,i.diamonds);for(var n=i.reward,o=0;o<n.length;o++)this.createAwardItem(4,n[o]);this.createAwardItem(3,c.default.getInstance().buildingData[i.buildingId].oneSkineValue(0)),"area"==this._configData.type?(this.buildIcon.node.active=!0,this.spineNode.active=!1):(this.buildIcon.node.active=!1,this.spineNode.active=!0,a.nodeName&&cc.resources.load("building/"+a.nodeName,cc.Prefab,function(t,i){if(!t&&cc.isValid(e.spineNode)){var a=cc.instantiate(i);a.setPosition(cc.v2(0,0)),a.getComponent(g.default).initUnlockShow(200,200),e.spineNode.addChild(a)}})),i.costCoins>c.default.getInstance().coins?(this.completeNode.active=!1,this.mergeNode.active=!0):(this.completeNode.active=!0,this.mergeNode.active=!1),d.default.getInstance().showBanner()},e.prototype.createAwardItem=function(t,e){var i=cc.instantiate(this.awardItem);this.awardContent.addChild(i),i.getComponent(h.default).initAwardInfo(t,e)},e.prototype.onMergeClicked=function(){cc.director.getScene().emit(u.default.CLOSE_SCENE),l.default.getInstance().closeUI(this.tag)},e.prototype.onBuyComleteTask=function(){f.default.trackEvent("buildingTask_completeTask",{taskId:""+this._taskData.id}),this.onBuildingClicked()},e.prototype.onBuildingClicked=function(t){if(void 0===t&&(t=null),this._taskData){var e=this._taskData.mstData,i=c.default.getInstance().level,a=this._taskData.completeTask();if(a){var n=a.newTaskData;cc.director.getScene().emit(u.default.UNLOCKBUILD,{last:this._taskData,next:n,customer:a.customer,oldLev:i,callback:t}),cc.director.getScene().emit(u.default.UPDATE_TOPINFO,"coin");var o={id:30091};o.startNode=this.awardContent,o.num=e.exp,cc.director.getScene().emit(u.default.ITEM_FLY,o),l.default.getInstance().closeUI(this.tag)}else l.default.getInstance().openUI(p.default,{data:{str:m.default.t("noCoins")}})}},e.prototype.onDestroy=function(){d.default.getInstance().hideBanner()},e.uiName="BuildCompletePopup",o([y(cc.Label)],e.prototype,"buildName",void 0),o([y(cc.Label)],e.prototype,"costNum",void 0),o([y(cc.Prefab)],e.prototype,"awardItem",void 0),o([y(cc.Sprite)],e.prototype,"buildIcon",void 0),o([y(cc.Node)],e.prototype,"awardContent",void 0),o([y(cc.Node)],e.prototype,"completeNode",void 0),o([y(cc.Node)],e.prototype,"mergeNode",void 0),o([y(cc.Node)],e.prototype,"spineNode",void 0),o([_],e)}(s.default);i.default=I,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/Toast":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/StatisticsManager":void 0,"../entitys/BuildCompleteItem":"BuildCompleteItem","../entitys/BuildItem":"BuildItem"}],BuildInfoPopup:[function(t,e,i){"use strict";cc._RF.push(e,"8434bLni95FZYpHXpBsyj9a","BuildInfoPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MstData"),c=t("../../scripts/data/UserData"),d=t("../../scripts/manager/AdManager"),l=t("../../scripts/manager/SDKManager"),p=t("../../scripts/manager/UIManager"),u=t("../../scripts/prefabs/Toast"),f=t("../../scripts/utils/AppConfig"),h=t("../../scripts/utils/ChannelHelper"),g=t("../../scripts/utils/EventName"),m=t("../../scripts/utils/GlobalFun"),v=t("../entitys/BuildingSkinItem"),_=t("../entitys/BuildItem"),y=t("../extension/List"),I=t("./AtlasPopup"),b=t("./ChristmasPopup"),N=t("./NewYearPopup"),C=t("./UnlockShowPopup"),k=t("../../scripts/extension/LanguageData"),S=cc._decorator,w=S.ccclass,T=S.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.buildName=null,e.areaName=null,e.btnSkinLab=null,e.buildIcon=null,e.btnShare=null,e.videoIcon=null,e.spineNode=null,e.topResNode=null,e.iconCion=null,e.iconDiamond=null,e.iconSkinTicket=null,e.resNum=null,e.dressNum=null,e.btnUse=null,e.listElement=null,e.btnCostIcon=[],e._buildID=null,e._skinList=null,e._curSelect=0,e.parent=null,e._userBuildingData=null,e}return n(e,t),e.prototype.init=function(t){this._buildID=t.buildId,this.parent=t.parent,this._userBuildingData=c.default.getInstance().buildingData[this._buildID];var e=this._userBuildingData.mstData,i=this._userBuildingData.mstSkinData;this._skinList=e.skinIds;var a=i.nodeName,n=null,o=r.default.getInstance().mstSceneArea;for(var s in o){for(var l=0;l<o[s].buildingIds.length;l++)if(o[s].buildingIds[l]==this._buildID){n=o[s].name;break}if(n)break}this.areaName.string=n,"area"==e.type?(this.buildIcon.node.active=!0,this.spineNode.active=!1):(this.buildIcon.node.active=!1,this.spineNode.active=!0,a&&this.initBuilding(this._curSelect)),h.default.getChannel()==h.HMCHANNEL.WY?this.btnShare.active=!1:this.btnShare.active=!0,this._userBuildingData.tipsSkinIndex=[],cc.director.getScene().emit(g.default.UPDATE_ACTIVITY),d.default.getInstance().showBanner()},e.prototype.initBuilding=function(t){var e=this,i=r.default.getInstance().mstBuildingSkin[this._skinList[t]],a=i.nodeName;this.buildName.string=i.name,this.dressNum.string=i.skinValue+"",this.spineNode.removeAllChildren(),cc.resources.load("building/"+a,cc.Prefab,function(t,i){if(!t){var a=cc.instantiate(i);a.setPosition(cc.v2(0,0)),a.getComponent(_.default).initUnlockShow(200,200),e.spineNode.addChild(a)}})},e.prototype.itemElementRender=function(t,e){t.getComponent(v.default).initItemInfo(this._skinList[e],this._buildID)},e.prototype.itemSelectRender=function(t,e){this.updateSkinInfo(e),this.initBuilding(e)},e.prototype.updateRewardCD=function(){var t=this._skinList[this._curSelect],e=r.default.getInstance().mstBuildingSkin[t];if(!this._userBuildingData.isSkinUnlock(this._curSelect)&&"video"==e.costType){var i=d.default.getInstance().rewardAdCd;i>0?(this.btnUse.interactable=!1,m.default.setBtnIsGrey(this.btnUse),this.btnSkinLab.string=m.default.formatDateTimeHourEx(i)):(this.btnUse.interactable=!0,m.default.setBtnIsGrey(this.btnUse,new cc.Color(62,96,32)),this.btnSkinLab.string=this._userBuildingData.skinVideoCountById(t)+"/"+e.costNum)}},e.prototype.updateSkinInfo=function(t){this._curSelect=t;var e=this._skinList[t];this.btnUse.interactable=!0;var i=r.default.getInstance().mstBuildingSkin[e];t==this._userBuildingData.skinIdIndex?(this.btnUse.getComponent(cc.Button).interactable=!1,this.btnSkinLab.string=k.default.t("buildInfoPopup_1"),this.videoIcon.node.active=!1,this.topResNode.active=!1):(this.btnUse.node.active=!0,this._userBuildingData.isSkinUnlock(t)?(this.videoIcon.node.active=!1,this.btnSkinLab.string=k.default.t("buildInfoPopup_2")):"coins"==i.costType?(this.videoIcon.node.active=!0,this.videoIcon.spriteFrame=this.btnCostIcon[0],this.btnSkinLab.string="x"+i.costNum):"diamonds"==i.costType?(this.videoIcon.node.active=!0,this.videoIcon.spriteFrame=this.btnCostIcon[1],this.btnSkinLab.string="x"+i.costNum):"skinTicket"==i.costType?(this.videoIcon.node.active=!0,this.videoIcon.spriteFrame=this.btnCostIcon[2],this.btnSkinLab.string="x"+i.costNum):"activity"==i.costType?(c.default.getInstance().activityData.isActivityOpen(i.activityKey)?this.btnUse.interactable=!0:this.btnUse.interactable=!1,this.btnSkinLab.string=k.default.t("buildInfoPopup_4"),this.videoIcon.node.active=!1):"video"==i.costType?(this.btnSkinLab.string=this._userBuildingData.skinVideoCountById(e)+"/"+i.costNum,this.videoIcon.node.active=!0,this.videoIcon.spriteFrame=this.btnCostIcon[3]):"item"==i.costType&&(this.btnSkinLab.string=k.default.t("buildInfoPopup_4"),this.videoIcon.node.active=!1)),"coins"==i.costType?(this.topResNode.active=!0,this.iconCion.active=!0,this.iconDiamond.active=!1,this.iconSkinTicket.active=!1,this.resNum.string=c.default.getInstance().coins+""):"diamonds"==i.costType?(this.topResNode.active=!0,this.iconCion.active=!1,this.iconDiamond.active=!0,this.iconSkinTicket.active=!1,this.resNum.string=c.default.getInstance().diamonds+""):"skinTicket"==i.costType?(this.topResNode.active=!0,this.iconCion.active=!1,this.iconDiamond.active=!1,this.iconSkinTicket.active=!0,this.resNum.string=c.default.getInstance().skinTicket+""):"activity"==i.costType?this.topResNode.active=!1:"video"==i.costType?this.topResNode.active=!1:(i.costType,this.topResNode.active=!1)},e.prototype.onClickShare=function(){var t=k.default.t("share_6"),e=f.default.WX_SHARE_PATH+"share6.jpg";l.default.getInstance().shareAppMessage(t,e,null,function(){},null)},e.prototype.onClickUse=function(){var t=this,e=this._skinList[this._curSelect],i=r.default.getInstance().mstBuildingSkin[e];if(this._userBuildingData.isSkinUnlock(this._curSelect))this._userBuildingData.selectSkin(this._curSelect)?(this.updateSkinInfo(this._curSelect),this.listElement.numItems=this._skinList.length,this.listElement.selectedId=this._userBuildingData.skinIdIndex,this.parent&&this.parent.refushBuild(),cc.director.getScene().emit(g.default.CHANGBUILDINGSKIN,this._buildID),p.default.getInstance().openUI(u.default,{data:{str:k.default.t("buildInfoPopup_5")}})):p.default.getInstance().openUI(u.default,{data:{str:k.default.t("buildInfoPopup_6")}});else if("coins"==i.costType)i.costNum<=c.default.getInstance().coins?this._userBuildingData.unLockSkin(this._curSelect)?(this.updateSkinInfo(this._curSelect),this.initBuilding(this._curSelect),this.listElement.numItems=this._skinList.length,cc.director.getScene().emit(g.default.UPDATE_TOPINFO),cc.director.getScene().emit(g.default.UPDATE_ACTIVITY),p.default.getInstance().openNotice(C.default,{data:{ntype:"building",skinId:e}})):p.default.getInstance().openUI(u.default,{data:{str:k.default.t("buildInfoPopup_7")}}):p.default.getInstance().openUI(u.default,{data:{str:k.default.t("noCoins")}});else if("diamonds"==i.costType)i.costNum<=c.default.getInstance().diamonds?this._userBuildingData.unLockSkin(this._curSelect)?(this.updateSkinInfo(this._curSelect),this.initBuilding(this._curSelect),this.listElement.numItems=this._skinList.length,cc.director.getScene().emit(g.default.UPDATE_TOPINFO),cc.director.getScene().emit(g.default.UPDATE_ACTIVITY),p.default.getInstance().openNotice(C.default,{data:{ntype:"building",skinId:e}})):p.default.getInstance().openUI(u.default,{data:{str:k.default.t("buildInfoPopup_7")}}):m.default.noDiamondsCommonPopup();else if("skinTicket"==i.costType)i.costNum<=c.default.getInstance().skinTicket?this._userBuildingData.unLockSkin(this._curSelect)?(this.updateSkinInfo(this._curSelect),this.initBuilding(this._curSelect),this.listElement.numItems=this._skinList.length,cc.director.getScene().emit(g.default.UPDATE_TOPINFO),cc.director.getScene().emit(g.default.UPDATE_ACTIVITY),p.default.getInstance().openNotice(C.default,{data:{ntype:"building",skinId:e}})):p.default.getInstance().openUI(u.default,{data:{str:k.default.t("buildInfoPopup_7")}}):(p.default.getInstance().openUI(u.default,{data:{str:k.default.t("noSkinTicket")}}),m.default.noSkinTicketPopup());else if("activity"==i.costType){this.onClose(),p.default.getInstance().closeUI(I.default),cc.director.getScene().emit(g.default.CLOSE_SCENE);for(var a=!0,n=0;n<c.default.getInstance().activityData.fields.length;n++){var o=c.default.getInstance().activityData.fields[n],s=cc.sys.localStorage.getItem(o),l=c.default.getInstance().activityData.getActivityEndTime(o);(!s||""==s||l.length>0&&s!==m.default.getDateByYMD(l[0]))&&c.default.getInstance().activityData.isActivityOpen(o)&&(a=!1)}a&&("christmas"==i.activityKey?p.default.getInstance().openUI(b.default):"newYear"==i.activityKey&&p.default.getInstance().openUI(N.default))}else"video"==i.costType?d.default.getInstance().showRewardAd(function(){t._userBuildingData.addSkinVideoCount(e,t._curSelect)&&(t.initBuilding(t._curSelect),t.updateRewardCD(),p.default.getInstance().openNotice(C.default,{data:{ntype:"building",skinId:e}}),cc.director.getScene().emit(g.default.UPDATE_ACTIVITY),cc.director.getScene().emit(g.default.UPDATE_TOPINFO)),t.updateSkinInfo(t._curSelect),t.listElement.numItems=t._skinList.length},function(){},function(){}):"item"==i.costType&&(this.onClose(),p.default.getInstance().closeUI(I.default),"foodFestival"==i.activityKey&&m.default.openLimitActivityByName("foodFestival"))},e.prototype.getGuideUseNode=function(){return this.node.getChildByName("bg").getChildByName("skinbg")},e.prototype.onLoad=function(){cc.director.getScene().on(g.default.UPDATE_TOPINFO,this.updateTopInfo,this),this.listElement.numItems=this._skinList.length,this.listElement.selectedId=this._userBuildingData.skinIdIndex,this.updateRewardCD(),cc.director.getScene().on(g.default.UPDATE_BY_SECOND,this.updateRewardCD,this)},e.prototype.updateTopInfo=function(){this.updateSkinInfo(this._curSelect)},e.prototype.onDestroy=function(){d.default.getInstance().hideBanner()},e.uiName="BuildInfoPopup",o([T(cc.Label)],e.prototype,"buildName",void 0),o([T(cc.Label)],e.prototype,"areaName",void 0),o([T(cc.Label)],e.prototype,"btnSkinLab",void 0),o([T(cc.Sprite)],e.prototype,"buildIcon",void 0),o([T(cc.Node)],e.prototype,"btnShare",void 0),o([T(cc.Sprite)],e.prototype,"videoIcon",void 0),o([T(cc.Node)],e.prototype,"spineNode",void 0),o([T(cc.Node)],e.prototype,"topResNode",void 0),o([T(cc.Node)],e.prototype,"iconCion",void 0),o([T(cc.Node)],e.prototype,"iconDiamond",void 0),o([T(cc.Node)],e.prototype,"iconSkinTicket",void 0),o([T(cc.Label)],e.prototype,"resNum",void 0),o([T(cc.Label)],e.prototype,"dressNum",void 0),o([T(cc.Button)],e.prototype,"btnUse",void 0),o([T(y.default)],e.prototype,"listElement",void 0),o([T([cc.SpriteFrame])],e.prototype,"btnCostIcon",void 0),o([w],e)}(s.default);i.default=P,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/SDKManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/Toast":void 0,"../../scripts/utils/AppConfig":void 0,"../../scripts/utils/ChannelHelper":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../entitys/BuildItem":"BuildItem","../entitys/BuildingSkinItem":"BuildingSkinItem","../extension/List":"List","./AtlasPopup":"AtlasPopup","./ChristmasPopup":"ChristmasPopup","./NewYearPopup":"NewYearPopup","./UnlockShowPopup":"UnlockShowPopup"}],BuildItem:[function(t,e,i){"use strict";cc._RF.push(e,"b421dziykVIW69ejvZPohc1","BuildItem");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/MstData"),r=t("../../scripts/data/UserData"),c=t("../../scripts/manager/UIManager"),d=t("../prefabs/UnlockShowPopup"),l=t("./UnlockBuildingAni"),p=t("../../scripts/extension/LanguageData"),u=cc._decorator,f=u.ccclass,h=u.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.employee=null,e.aniNode=null,e.comState=null,e.unLock=null,e._buildID=null,e._buildConfig=null,e._pos1=null,e._pos2=null,e._men=null,e._joke=0,e}return n(e,t),e.prototype.initBuildData=function(t){this._buildID=t,this._buildConfig=s.default.getInstance().mstBuilding[this._buildID];var e=r.default.getInstance().buildingData[t].skinIdIndex,i=this._buildConfig.skinIds[e],a=s.default.getInstance().mstBuildingSkin[i],n=a.buildingPos;this.comState=this.node.getChildByName("buildnode"),this.unLock=this.node.getChildByName("box"),this.refreshState(),this.node.setPosition(cc.v3(n[0],n[1],0)),this._pos1=this.node.getChildByName("pos1"),this._pos2=this.node.getChildByName("pos2"),this.node.zIndex=a.zIndex,this._pos1&&"5"==this._buildConfig.id&&(this._men=this.comState.getChildByName("men")),this.initEmployee()},e.prototype.initUnlockShow=function(t,e){if(void 0===t&&(t=0),void 0===e&&(e=0),this.comState=this.node.getChildByName("buildnode"),this.unLock=this.node.getChildByName("box"),this.comState&&(this.comState.active=!0),this.unLock&&(this.unLock.active=!1),t>0&&e>0){var i=this.comState.getComponent(cc.Button);i&&(i.interactable=!1);var a=this.comState.getChildByName("yuangong");a&&(a.active=!1);var n=t/this.comState.width,o=e/this.comState.height;this.node.scale=n<o?n:o}},e.prototype.initEmployee=function(){var t=this;if(this.employee){var e=r.default.getInstance().roleData[999].mstSkinData.icon;cc.resources.load("textures/role/spine/"+e,sp.SkeletonData,function(i,a){if(!i){var n=t.employee.getComponent(sp.Skeleton),o=n.animation;n.skeletonData=a,n.setAnimation(0,o,!0),"dianyuan"==e&&n.setSkin("dianyuan")}})}},e.prototype.refreshState=function(){var t=r.default.getInstance().buildingData[this._buildID];if("area"!=this._buildConfig.type&&this.comState)if(t.isUnlock){this.comState.active=!0,this.unLock&&(this.unLock.active=!1);var e=this.comState.getChildByName("yuangong");e&&"dianyuan"==e.getComponent(sp.Skeleton).skeletonData.name&&(r.default.getInstance().activityData.isActivityOpen("christmas")?e.getComponent(sp.Skeleton).setSkin("dianyuan_shengdan"):e.getComponent(sp.Skeleton).setSkin("dianyuan"))}else this.comState.active=!1,this.unLock&&(this.unLock.active=!0)},e.prototype.setCustomer=function(t){if(!this.comState)return!1;var e=this.comState.getChildByName("cusnode");return!(!e||0!=e.children.length||(t.parent=e,t.setPosition(cc.v3(0,0,0)),0))},e.prototype.showUnlockAni=function(t){this.refreshState(),this.comState.opacity=0;var e=cc.instantiate(this.aniNode);e.getComponent(l.default).init(t),this.node.addChild(e)},e.prototype.sumPosZorder=function(t,e){var i={out:0,dir:0,wid:this.comState.height};if(this.comState.getBoundingBoxToWorld().contains(t)&&this._pos1&&this._pos2){var a=this.node.position.add(this._pos1.position),n=this.node.position.add(this._pos2.position),o=(n.y-a.y)*e.x+(a.x-n.x)*e.y+(n.x*a.y-a.x*n.y);o>0?(i.out=this.node.zIndex+1,i.dir=0):o<0&&(i.out=this.node.zIndex-1,i.dir=1)}return i},e.prototype.zIndexByCustomerPos=function(t,e,i){var a=this;if(!this.comState||!this._pos1||0==this.node.opacity)return{out:0,dir:0,wid:0};var n=this.sumPosZorder(e[0],i[0]),o=this.sumPosZorder(e[1],i[1]),s=function(){if(a._men&&a.comState.active){var e=a.node.convertToWorldSpaceAR(cc.v2(-145,60)),i=a.node.convertToWorldSpaceAR(cc.v2(111,-90));cc.Intersection.pointLineDistance(t,e,i,!1)<50?a._men.active&&(a._men.active=!1):a._men.active||(a._men.active=!0)}};return n.out>0&&o.out>0?(s(),n.out<o.out?n:o):o.out>0?(s(),o):n.out>0?(s(),n):{out:0,dir:0,wid:0}},e.prototype.onClickBuilding=function(){if(28==this._buildID&&!r.default.getInstance().roleData[15].isUnlock){var t=["",p.default.t("buildItem_1"),p.default.t("buildItem_2")];if(this._joke++,this._joke>=3)r.default.getInstance().roleData[15].unLock(),c.default.getInstance().openNotice(d.default,{data:{ntype:"customer",id:15}});else{var e=this.node.getChildByName("talkbg"),i=e.getChildByName("talk").getChildByName("talklab").getComponent(cc.Label);this.scheduleOnce(function(){e.active=!1},3),e.active=!0,i.string=t[this._joke]}}},o([h(cc.Node)],e.prototype,"employee",void 0),o([h(cc.Prefab)],e.prototype,"aniNode",void 0),o([f],e)}(cc.Component);i.default=g,cc._RF.pop()},{"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/UIManager":void 0,"../prefabs/UnlockShowPopup":"UnlockShowPopup","./UnlockBuildingAni":"UnlockBuildingAni"}],BuildTaskBubble:[function(t,e,i){"use strict";cc._RF.push(e,"5f9efR3Wr5K87D7A1O062eT","BuildTaskBubble");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/manager/UIManager"),r=t("../prefabs/BuildCompletePopup"),c=cc._decorator,d=c.ccclass,l=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.costnum=null,e._taskInfo=null,e._buildInfo=null,e}return n(e,t),e.prototype.initTaskInfo=function(t){this._taskInfo=t,this.costnum.string="x"+this._taskInfo.mstData.costCoins},e.prototype.onShowBuild=function(){s.default.getInstance().openUI(r.default,{data:{task:this._taskInfo}})},o([l(cc.Label)],e.prototype,"costnum",void 0),o([d],e)}(cc.Component);i.default=p,cc._RF.pop()},{"../../scripts/manager/UIManager":void 0,"../prefabs/BuildCompletePopup":"BuildCompletePopup"}],BuildTaskItem:[function(t,e,i){"use strict";cc._RF.push(e,"dad935YQV5J7KQ7mhnJ57J/","BuildTaskItem");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/MstData"),r=t("../../scripts/data/UserData"),c=t("../../scripts/manager/UIManager"),d=t("../../scripts/utils/ActionFunc"),l=t("../../scripts/utils/EventName"),p=t("../extension/ListItem"),u=t("../prefabs/BuildTaskPopup"),f=t("./BuildItem"),h=t("../../scripts/extension/LanguageData"),g=cc._decorator,m=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.taskName=null,e.awardLab=null,e.costnum=null,e.buildIcon=null,e.awardIconDec=null,e.bgSprite=null,e.btnFinish=null,e.finishRed=null,e.taskNode=null,e.spineNode=null,e.lockNode=null,e.unLockNode=null,e.nextNode=null,e.awardIcon=[],e.bgIcon=[],e.taskInfo=null,e.buildInfo=null,e}return n(e,t),e.prototype.init=function(t){var e=this;if(-1==t.id)return this.taskNode.active=!1,this.nextNode.node.active=!0,this.nextNode.string=h.default.t("buildTaskItem_1",{lv:t.lev,buildName:t.data}),void(this.bgSprite.spriteFrame=this.bgIcon[1]);this.bgSprite.spriteFrame=this.bgIcon[0],this.taskNode.active=!0,this.nextNode.node.active=!1,this.taskInfo=s.default.getInstance().mstBuildingTask[t.id],this.buildInfo=s.default.getInstance().mstBuilding[this.taskInfo.buildingId];var i=r.default.getInstance().buildingData[this.taskInfo.buildingId].mstSkinData;if(this.taskInfo.costCoins<=0)return this.taskName.string=this.taskInfo.desc,this.lockNode.active=!1,void(this.unLockNode.active=!0);this.lockNode.active=!0,this.unLockNode.active=!1,this.taskName.string=this.taskInfo.desc,this.costnum.string=this.taskInfo.costCoins,this.taskInfo.exp?(this.awardLab.string=this.taskInfo.exp,this.awardIconDec.spriteFrame=this.awardIcon[0]):this.taskInfo.energy?(this.awardLab.string=this.taskInfo.energy,this.awardIconDec.spriteFrame=this.awardIcon[1]):this.taskInfo.diamonds&&(this.awardLab.string=this.taskInfo.diamonds,this.awardIconDec.spriteFrame=this.awardIcon[2]),t.data.isComplete?(this.finishRed.active=!0,d.default.zoomAnim2(this.btnFinish)):(this.finishRed.active=!1,cc.Tween.stopAllByTarget(this.btnFinish),this.btnFinish.scale=1),"area"==this.buildInfo.type?(this.buildIcon.node.active=!0,this.spineNode.active=!1):(this.buildIcon.node.active=!1,this.spineNode.active=!0,i.nodeName&&cc.resources.load("building/"+i.nodeName,cc.Prefab,function(t,i){if(!t){var a=cc.instantiate(i);a.setPosition(cc.v2(0,0)),a.getComponent(f.default).initUnlockShow(200,200),e.spineNode.addChild(a)}}))},e.prototype.onGoTask=function(){cc.director.getScene().emit(l.default.PERFORMTASK,this.buildInfo.id),c.default.getInstance().closeUI(u.default)},e.prototype.getTaskBuildID=function(){return this.buildInfo.id},e.prototype.start=function(){},o([v(cc.Label)],e.prototype,"taskName",void 0),o([v(cc.Label)],e.prototype,"awardLab",void 0),o([v(cc.Label)],e.prototype,"costnum",void 0),o([v(cc.Sprite)],e.prototype,"buildIcon",void 0),o([v(cc.Sprite)],e.prototype,"awardIconDec",void 0),o([v(cc.Sprite)],e.prototype,"bgSprite",void 0),o([v(cc.Node)],e.prototype,"btnFinish",void 0),o([v(cc.Node)],e.prototype,"finishRed",void 0),o([v(cc.Node)],e.prototype,"taskNode",void 0),o([v(cc.Node)],e.prototype,"spineNode",void 0),o([v(cc.Node)],e.prototype,"lockNode",void 0),o([v(cc.Node)],e.prototype,"unLockNode",void 0),o([v(cc.Label)],e.prototype,"nextNode",void 0),o([v([cc.SpriteFrame])],e.prototype,"awardIcon",void 0),o([v([cc.SpriteFrame])],e.prototype,"bgIcon",void 0),o([m],e)}(p.default);i.default=_,cc._RF.pop()},{"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/utils/ActionFunc":void 0,"../../scripts/utils/EventName":void 0,"../extension/ListItem":"ListItem","../prefabs/BuildTaskPopup":"BuildTaskPopup","./BuildItem":"BuildItem"}],BuildTaskPopup:[function(t,e,i){"use strict";cc._RF.push(e,"2cc3fcQ00NPzaOBRViJ8Gjv","BuildTaskPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MstData"),c=t("../../scripts/data/UserData"),d=t("../../scripts/manager/AdManager"),l=t("../../scripts/utils/GlobalFun"),p=t("../../scripts/utils/StatisticsManager"),u=t("../entitys/BuildTaskItem"),f=t("../extension/List"),h=cc._decorator,g=h.ccclass,m=h.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.listElement=null,e.taskListID=[],e._callback=null,e}return n(e,t),e.prototype.init=function(t){this._callback=t,this.updateTaskData(),l.default.isCanShowBanner()&&d.default.getInstance().showBanner()},e.prototype.updateTaskData=function(){var t=this,e=c.default.getInstance().buildingTaskData,i=0;e.forEach(function(e){t.taskListID[i++]={id:e.id,data:e}}),this.taskListID.sort(function(t,e){return t.id-e.id}),this.taskListID.sort(function(t,e){var i=0;t.data.isComplete&&(i=1);var a=0;return e.data.isComplete&&(a=1),a-i});var a=r.default.getInstance().mstSceneArea,n=c.default.getInstance().level;for(var o in a)if(a[o].unlockLevel>n){this.taskListID[i++]={id:-1,lev:a[o].unlockLevel,data:a[o].name};break}},e.prototype.getBtnGoComplete=function(){return this.listElement.content.children[0].getComponent(u.default).btnFinish},e.prototype.getGuideCompleteBuildID=function(){return this.listElement.content.children[0].getComponent(u.default).getTaskBuildID()},e.prototype.itemElementRender=function(t,e){t.getComponent(u.default).init(this.taskListID[e])},e.prototype.onLoad=function(){p.default.trackEvent("buildingTask_open"),this.taskListID.length>0&&(this.listElement.numItems=this.taskListID.length,this._callback&&this._callback())},e.prototype.onDestroy=function(){l.default.isCanShowBanner()&&d.default.getInstance().hideBanner()},e.uiName="BuildTaskPopup",o([m(f.default)],e.prototype,"listElement",void 0),o([g],e)}(s.default);i.default=v,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/utils/GlobalFun":void 0,"../../scripts/utils/StatisticsManager":void 0,"../entitys/BuildTaskItem":"BuildTaskItem","../extension/List":"List"}],BuildingSkinItem:[function(t,e,i){"use strict";cc._RF.push(e,"29414Ew511HCJw4vSYWmJR8","BuildingSkinItem");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/MstData"),r=t("../../scripts/data/UserData"),c=t("../extension/ListItem"),d=t("./BuildItem"),l=t("../../scripts/extension/LanguageData"),p=cc._decorator,u=p.ccclass,f=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.buildNode=null,e.descLab=null,e.usedNode=null,e.hasedNode=null,e.xianding=null,e.itemBg=[],e.itemBgNode=null,e}return n(e,t),e.prototype.initItemInfo=function(t,e){var i=this,a=s.default.getInstance().mstBuildingSkin[t],n=r.default.getInstance().buildingData[e],o=a.nodeName;n.isSkinUnlock(this.listId)?n.skinIdIndex==this.listId?(this.usedNode.active=!0,this.hasedNode.active=!1,this.descLab.node.active=!1,this.itemBgNode.spriteFrame=this.itemBg[2]):(this.usedNode.active=!1,this.hasedNode.active=!0,this.descLab.node.active=!1,this.itemBgNode.spriteFrame=this.itemBg[1]):(this.itemBgNode.spriteFrame=this.itemBg[0],this.usedNode.active=!1,this.hasedNode.active=!1,this.descLab.node.active=!0,"activity"==a.costType?this.descLab.string=a.skinDesc:"item"==a.costType?this.descLab.string=a.skinDesc:this.descLab.string=l.default.t("buildingSkinItem_1")),"activity"==a.costType?this.xianding.active=!0:this.xianding.active=!1,o&&(this.buildNode.removeAllChildren(),cc.resources.load("building/"+o,cc.Prefab,function(t,e){if(!t){var a=cc.instantiate(e);a.setPosition(cc.v2(0,0)),a.getComponent(d.default).initUnlockShow(170,170),i.buildNode.addChild(a)}}))},o([f(cc.Node)],e.prototype,"buildNode",void 0),o([f(cc.Label)],e.prototype,"descLab",void 0),o([f(cc.Node)],e.prototype,"usedNode",void 0),o([f(cc.Node)],e.prototype,"hasedNode",void 0),o([f(cc.Node)],e.prototype,"xianding",void 0),o([f([cc.SpriteFrame])],e.prototype,"itemBg",void 0),o([f(cc.Sprite)],e.prototype,"itemBgNode",void 0),o([u],e)}(c.default);i.default=h,cc._RF.pop()},{"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../extension/ListItem":"ListItem","./BuildItem":"BuildItem"}],BuyItem:[function(t,e,i){"use strict";cc._RF.push(e,"4319bIgL1FNKJc43VGozxIB","BuyItem");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/UserData"),r=t("../../scripts/manager/AdManager"),c=t("../../scripts/utils/GlobalFun"),d=t("../../scripts/extension/LanguageData"),l=t("../../scripts/utils/EventName"),p=cc._decorator,u=p.ccclass,f=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.watchBtn=null,e.coinBtn=null,e.diamondBtn=null,e.payBtn=null,e.overBtn=null,e}return n(e,t),e.prototype.init=function(t,e){this._itemData=e,this._payData=t,this.watchBtn.active=!1,this.overBtn.active=!1,"diamonds"==t.costType?(this._buyBtn=this.diamondBtn,this.diamondBtn.getChildByName("costnum").getComponent(cc.Label).string=t.costNum):"video"==t.costType?(this._buyBtn=this.watchBtn,1==t.costNum?(this.watchBtn.getChildByName("costnum").active=!1,this.watchBtn.getChildByName("lab").getComponent(cc.Label).string=d.default.t("free"),this.watchBtn.getChildByName("lab").setPosition(this.watchBtn.getChildByName("lab").position.x,0),this.watchBtn.getChildByName("btn_shipin").setPosition(this.watchBtn.getChildByName("btn_shipin").position.x,0)):(this.watchBtn.getChildByName("costnum").active=!0,this.watchBtn.getChildByName("lab").getComponent(cc.Label).string=d.default.t("receive"),this.watchBtn.getChildByName("lab").setPosition(this.watchBtn.getChildByName("lab").position.x,17),this.watchBtn.getChildByName("btn_shipin").setPosition(this.watchBtn.getChildByName("btn_shipin").position.x,25),this.watchBtn.getChildByName("costnum").getComponent(cc.Label).string=cc.js.formatStr("(%s/%s)",e.nowCostNum,t.costNum))):"pay"==t.costType&&(this._buyBtn=this.payBtn),this._buyBtn.active=!0},e.prototype.updateNowCostnum=function(t){this._itemData.nowCostNum=t,"video"==this._payData.costType&&(this.watchBtn.getChildByName("costnum").getComponent(cc.Label).string=cc.js.formatStr("(%s/%s)",this._itemData.nowCostNum,this._payData.costNum))},e.prototype.changeStateToOver=function(t){void 0===t&&(t=d.default.t("shopItem_2")),this._buyBtn.active=!1,this.overBtn.active=!0,this.overBtn.getChildByName("costnum").getComponent(cc.Label).string=t},e.prototype.onClickBtn=function(){var t=this,e=this._payData.costNum;"diamonds"==this._payData.costType?s.default.getInstance().addDiamonds(-e)>=0?(this._itemData.successCb&&this._itemData.successCb(e),s.default.getInstance().saveUserData()):(this._itemData.successCb&&this._itemData.successCb(0),c.default.noDiamondsCommonPopup()):"video"==this._payData.costType?r.default.getInstance().showRewardAd(function(){t._itemData.nowCostNum+=1,t._itemData.successCb&&t._itemData.successCb(1),t.watchBtn.getChildByName("costnum").getComponent(cc.Label).string=cc.js.formatStr("(%s/%s)",t._itemData.nowCostNum,e),t.updateRewardCD()},function(){},function(){}):this._payData.costType},e.prototype.updateRewardCD=function(){if(this.watchBtn.active){var t=r.default.getInstance().rewardAdCd;t>0?(this.watchBtn.getComponent(cc.Button).interactable=!1,c.default.setBtnIsGrey(this.watchBtn.getComponent(cc.Button)),this.watchBtn.getChildByName("lab").getComponent(cc.Label).string=c.default.formatDateTimeHourEx(t)):(this.watchBtn.getComponent(cc.Button).interactable=!0,c.default.setBtnIsGrey(this.watchBtn.getComponent(cc.Button),new cc.Color(62,96,32)),this.watchBtn.getChildByName("lab").getComponent(cc.Label).string=d.default.t("buildInfoPopup_3"),1==this._payData.costNum?this.watchBtn.getChildByName("lab").getComponent(cc.Label).string=d.default.t("free"):this.watchBtn.getChildByName("lab").getComponent(cc.Label).string=d.default.t("receive"))}},e.prototype.onLoad=function(){this.updateRewardCD(),cc.director.getScene().on(l.default.UPDATE_BY_SECOND,this.updateRewardCD,this)},o([f(cc.Node)],e.prototype,"watchBtn",void 0),o([f(cc.Node)],e.prototype,"coinBtn",void 0),o([f(cc.Node)],e.prototype,"diamondBtn",void 0),o([f(cc.Node)],e.prototype,"payBtn",void 0),o([f(cc.Node)],e.prototype,"overBtn",void 0),o([u],e)}(cc.Component);i.default=h,cc._RF.pop()},{"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0}],BuyTipPopup:[function(t,e,i){"use strict";cc._RF.push(e,"32f8a4mjhlOrZ9QLpCGxa1G","BuyTipPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MstData"),c=t("../../scripts/data/UserData"),d=t("../../scripts/manager/AdManager"),l=t("../entitys/ItemEntity"),p=t("../../scripts/extension/LanguageData"),u=cc._decorator,f=u.ccclass,h=u.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemNum=null,e.itemTip=null,e.itemBg=null,e.item=null,e}return n(e,t),e.prototype.init=function(t){var e;this._okCallback="function"==typeof t.okCallback?t.okCallback:function(){},this._cancelCallback="function"==typeof t.cancelCallback?t.cancelCallback:function(){},this._closeCallback="function"==typeof t.closeCallback?t.closeCallback:function(){};var i=t.id,a=null!==(e=t.num)&&void 0!==e?e:1,n={};n.itemId=i,n.itemNum=a,n.isShowInfo=!0,n.isClickAble=!0,n.itemBg=this.itemBg,this.item.getComponent(l.default).init(n);var o=r.default.getInstance().mstItem[i],s=c.default.getInstance().getNormalItemTotalNumById(i);this.itemNum.string=p.default.t("buyTipPopup_1",{color:"#D77D41",hasNum:s}),this.itemTip.string=p.default.t("buyTipPopup_2",{num:a,name:o.name}),d.default.getInstance().showBanner()},e.prototype.onOkBtnClick=function(){t.prototype.onClose.call(this),this._okCallback()},e.prototype.onCancelBtnClick=function(){this._cancelCallback(),t.prototype.onClose.call(this)},e.prototype.onClose=function(){this._closeCallback(),t.prototype.onClose.call(this)},e.prototype.onDestroy=function(){d.default.getInstance().hideBanner()},e.uiName="BuyTipPopup",o([h(cc.RichText)],e.prototype,"itemNum",void 0),o([h(cc.Label)],e.prototype,"itemTip",void 0),o([h(cc.SpriteFrame)],e.prototype,"itemBg",void 0),o([h(cc.Node)],e.prototype,"item",void 0),o([f],e)}(s.default);i.default=g,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../entitys/ItemEntity":"ItemEntity"}],CellItem:[function(t,e,i){"use strict";cc._RF.push(e,"ef581rvSxZGEqjrIqNpPFW7","CellItem");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=cc._decorator,r=s.ccclass,c=s.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.icon=null,e.bgSpf1=null,e.bgSpf2=null,e}return n(e,t),e.prototype.init=function(t){this.icon.spriteFrame=t%2==0?this.bgSpf1:this.bgSpf2},o([c(cc.Sprite)],e.prototype,"icon",void 0),o([c(cc.SpriteFrame)],e.prototype,"bgSpf1",void 0),o([c(cc.SpriteFrame)],e.prototype,"bgSpf2",void 0),o([r],e)}(cc.Component);i.default=d,cc._RF.pop()},{}],ChildrenDayBtn:[function(t,e,i){"use strict";cc._RF.push(e,"170d1Es+v9BsIXCzY2mcjjJ","ChildrenDayBtn");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/UserData"),r=t("../../scripts/manager/UIManager"),c=t("../../scripts/utils/ActionFunc"),d=t("../../scripts/utils/EventName"),l=t("../../scripts/utils/GlobalFun"),p=t("../prefabs/ChildrenDayPopup"),u=cc._decorator,f=u.ccclass,h=u.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnBg=[],e.itemBg=[],e.itemNode=[],e.completeNode=null,e.bgSprite=null,e.endTimeLab=null,e.isStartAni=!1,e}return n(e,t),e.prototype.initNeedItems=function(){var t=s.default.getInstance().activityData.childrenDay,e=t.taskData[t.taskIndex()];if(e){var i=e.requireItems,a=e.isReceived;if(!e.isComplete)for(var n=0;n<t.taskData.length;n++)t.taskData[n].isComplete&&(i=t.taskData[n].requireItems,a=t.taskData[n].isReceived,e=t.taskData[n]);if(i.length>0){var o=s.default.getInstance().getNormalItemIndexByIds(i);for(this.itemNode[0].active=!1,this.itemNode[1].active=!1,n=0;n<i.length;n++){var r=a||o[n]>0,d=this.itemNode[n];d.active=!0;var p=l.default.getItemIconPathById(i[n]+"");if(p){var u=d.getChildByName("itemicon").getComponent(cc.Sprite);l.default.loadSpriteFrame(u,p)}r?(d.getChildByName("gou").active=!0,d.getComponent(cc.Sprite).spriteFrame=this.itemBg[1]):(d.getChildByName("gou").active=!1,d.getComponent(cc.Sprite).spriteFrame=this.itemBg[0])}}e.isComplete?(this.completeNode.active=!0,this.bgSprite.spriteFrame=this.btnBg[1],this.isStartAni||(this.isStartAni=!0,c.default.zoomAnim2(this.node))):(this.isStartAni&&(this.isStartAni=!1,cc.Tween.stopAllByTarget(this.node),this.node.scale=1),this.completeNode.active=!1,this.bgSprite.spriteFrame=this.btnBg[0])}},e.prototype.onClickActivity=function(){r.default.getInstance().openUI(p.default)},e.prototype.updateTime=function(){var t=s.default.getInstance().activityData.getActivityEndTime("childrenDay");if(t.length>0){var e=t[1]-window.serverTime;e>0?this.endTimeLab.string=l.default.timeFormat(e):cc.director.getScene().emit(d.default.RESET_ACTIVITY),e<86400?(this.endTimeLab.node.color=cc.color(255,0,0,255),this.endTimeLab.getComponent(cc.LabelOutline).color=cc.color(255,255,255,255)):(this.endTimeLab.node.color=cc.color(255,255,255,255),this.endTimeLab.getComponent(cc.LabelOutline).color=cc.color(55,22,2,255))}else cc.director.getScene().emit(d.default.RESET_ACTIVITY)},e.prototype.onLoad=function(){cc.director.getScene().on(d.default.UPDATE_MERGEAREA,this.initNeedItems,this),cc.director.getScene().on(d.default.UPDATE_BY_SECOND,this.updateTime,this),this.updateTime(),this.initNeedItems(),s.default.getInstance().activityData.isFirstLoadActivitu("childrenDay")?(s.default.getInstance().activityData.setShowOneActivity("childrenDay"),s.default.getInstance().updateTaskAndItem(),cc.director.getScene().emit(d.default.UPDATE_MERGEAREA)):s.default.getInstance().activityData.setShowOneActivity("childrenDay")},o([h([cc.SpriteFrame])],e.prototype,"btnBg",void 0),o([h([cc.SpriteFrame])],e.prototype,"itemBg",void 0),o([h([cc.Node])],e.prototype,"itemNode",void 0),o([h(cc.Node)],e.prototype,"completeNode",void 0),o([h(cc.Sprite)],e.prototype,"bgSprite",void 0),o([h(cc.Label)],e.prototype,"endTimeLab",void 0),o([f],e)}(cc.Component);i.default=g,cc._RF.pop()},{"../../scripts/data/UserData":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/utils/ActionFunc":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../prefabs/ChildrenDayPopup":"ChildrenDayPopup"}],ChildrenDayGiftItem:[function(t,e,i){"use strict";cc._RF.push(e,"0cf56MbtOJCf4kulwiOJFF2","ChildrenDayGiftItem");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/MiscConfig"),r=t("../../scripts/data/UserData"),c=t("../../scripts/manager/UIManager"),d=t("../../scripts/prefabs/CommonPopup"),l=t("../../scripts/prefabs/Toast"),p=t("../../scripts/utils/GlobalFun"),u=t("../extension/ListItem"),f=t("../prefabs/AwardPopup"),h=t("./BuyItem"),g=t("./ItemList"),m=t("../../scripts/extension/LanguageData"),v=cc._decorator,_=v.ccclass,y=v.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.starSp=[],e.tipSp=[],e.itemSp=[],e.topProgSp=null,e.bottomProgSp=null,e.lvLab=null,e.lvSp=null,e.normalList=null,e.specialList=null,e.normalNode=null,e.specialNode=null,e.upNode=null,e.upLab=null,e.normalTipSp=null,e.specialTipSp=null,e.progTopBgNode=null,e.progBottomBgNode=null,e._model=null,e._rewardLv=0,e._data=null,e._parentPopup=null,e._progHeight=150,e}return n(e,t),e.prototype.initUI=function(t,e,i){var a,n=this;this._parentPopup=i,this._rewardLv=t,this._data=e,this._model=null!==(a=this._model)&&void 0!==a?a:r.default.getInstance().activityData.childrenDay;for(var o=p.default.getAllReward(e.reward,e.rewardRes),s=[],d=0;d<o.length;d++){var l={};l.itemId=o[d].id,l.itemNum=o[d].num,l.isClickAble=!0,l.isShowInfo=!0,l.bgSize=cc.v2(180,180),l.itemBg=this.itemSp[0],l.isShowNum=!0,l.numOffset=cc.v2(0,5),l.numSize=50,l.iconScale=4e4==o[d].id?.75:1,s.push(l)}this.normalList.init({itemsData:s,spacingX:5});var u=p.default.getAllReward(e.vipReward,e.vipRewardRes),g=[];for(d=0;d<u.length;d++){var m={};m.itemId=u[d].id,m.itemNum=u[d].num,m.itemBg=this.itemSp[1],m.isClickAble=!0,m.isShowInfo=!0,m.bgSize=cc.v2(180,180),m.isShowNum=!0,m.numOffset=cc.v2(0,5),m.numSize=50,m.iconScale=4e4==u[d].id?.75:1,g.push(m)}this.specialList.init({itemsData:g,spacingX:5});var v=this._model;if(this.lvLab.string=t+"",this.lvSp.spriteFrame=v.lv>=t?this.starSp[0]:this.starSp[1],this.topProgSp.node.active=v.lv+1>=t&&1!=t,this.bottomProgSp.node.active=v.lv>=t,this.progTopBgNode.active=1!=t,this.progBottomBgNode.active=this._model.config.lvData[t+1],this.bottomProgSp.node.height=this._progHeight,this.topProgSp.node.height=this._progHeight,this._model.lv==t){var _=this._model.config.lvData[this._model.lv];y=(y=2*this._model.exp/_.exp)>1?1:y,this.bottomProgSp.node.height=this._progHeight*y}else if(this._model.lv+1==t){var y;_=this._model.config.lvData[this._model.lv],y=(y=2*this._model.exp/_.exp-1)<0?0:y,this.topProgSp.node.height=this._progHeight*y}var I=v.getUpExp(t);this.upNode.active=v.lv==t&&I>0,this.upNode.active&&(this.upLab.string=I+""),this._model.firstNormalRewardIndex;var b=this._model.firstSpecialRewardIndex,N=this._model.receiveData[t];if(this.normalNode.active=N&&!N.isNormalReceive,this.specialNode.active=b==t&&N&&!N.isSpecialReceive,this.specialNode.active){var C=this._model.config.lvData[t],k={};k.nowCostNum=v.receiveData[t].videoTimes,k.successCb=function(e){if(v.buySpecialReward(e,t)){var i=p.default.getAllReward(C.vipReward,C.vipRewardRes);c.default.getInstance().openUI(f.default,{data:i},null),n.specialNode.active=!1,n._parentPopup.updateRewardList(),n._parentPopup.initRewardIndex()}},this.specialNode.getComponent(h.default).init(C,k)}N&&N.isNormalReceive?(this.normalTipSp.node.active=!0,this.normalTipSp.spriteFrame=this.tipSp[0],this.normalTipSp.getComponent(cc.Button).enabled=!1):v.lv>=t?this.normalTipSp.node.active=!1:(this.normalTipSp.node.active=!0,this.normalTipSp.spriteFrame=this.tipSp[1],this.normalTipSp.getComponent(cc.Button).enabled=!0),N&&N.isSpecialReceive?(this.specialTipSp.node.active=!0,this.specialTipSp.spriteFrame=this.tipSp[0],this.specialTipSp.getComponent(cc.Button).enabled=!1):b==t&&this._model.isVip?this.specialTipSp.node.active=!1:b<t&&(this.specialTipSp.node.active=!0,this.specialTipSp.spriteFrame=this.tipSp[1],this.specialTipSp.getComponent(cc.Button).enabled=!0)},e.prototype.onClickGetNormalReward=function(){if(this._model.buyNormalReward(this._rewardLv)){var t=this._model.config.lvData[this._rewardLv],e=p.default.getAllReward(t.reward,t.rewardRes);c.default.getInstance().openUI(f.default,{data:e}),this._parentPopup.updateRewardList(),this._parentPopup.initRewardIndex()}},e.prototype.onClickBuyExp=function(){var t=this,e=this._model.lv,i=this._rewardLv;if(e<=i){var a=this._model.getUpExp(this._rewardLv),n={titleText:m.default.t("tips"),contentText:m.default.t("childrenDayGiftPopup_6",{count:a}),model:s.default.COMMON_POPUP_MODEL_2,isLeft:!1,okText:m.default.t("sure"),okCallback:function(){var e=t._model.exp,a=t._model.lv;if(t._model.buyExp(i))t._parentPopup.showPassExpAni(e,a),t._parentPopup.updateRewardList(),t._parentPopup.initRewardIndex(),t.initUI(t._rewardLv,t._data,t._parentPopup);else{var n=m.default.t("noDiamonds");c.default.getInstance().openUI(l.default,{data:{str:n}})}}};c.default.getInstance().openUI(d.default,{data:n})}},e.prototype.onClickTip=function(t,e){var i=this._model.firstSpecialRewardIndex;"2"!=e||this._model.isVip?this._model.lv<this._rewardLv?c.default.getInstance().openUI(l.default,{data:{str:m.default.t("childrenDayGiftPopup_4")}}):i<this._rewardLv&&"2"==e&&c.default.getInstance().openUI(l.default,{data:{str:m.default.t("childrenDayGiftPopup_5")}}):c.default.getInstance().openUI(l.default,{data:{str:m.default.t("childrenDayGiftPopup_3")}})},o([y([cc.SpriteFrame])],e.prototype,"starSp",void 0),o([y([cc.SpriteFrame])],e.prototype,"tipSp",void 0),o([y([cc.SpriteFrame])],e.prototype,"itemSp",void 0),o([y(cc.Sprite)],e.prototype,"topProgSp",void 0),o([y(cc.Sprite)],e.prototype,"bottomProgSp",void 0),o([y(cc.Label)],e.prototype,"lvLab",void 0),o([y(cc.Sprite)],e.prototype,"lvSp",void 0),o([y(g.default)],e.prototype,"normalList",void 0),o([y(g.default)],e.prototype,"specialList",void 0),o([y(cc.Node)],e.prototype,"normalNode",void 0),o([y(cc.Node)],e.prototype,"specialNode",void 0),o([y(cc.Node)],e.prototype,"upNode",void 0),o([y(cc.Label)],e.prototype,"upLab",void 0),o([y(cc.Sprite)],e.prototype,"normalTipSp",void 0),o([y(cc.Sprite)],e.prototype,"specialTipSp",void 0),o([y(cc.Node)],e.prototype,"progTopBgNode",void 0),o([y(cc.Node)],e.prototype,"progBottomBgNode",void 0),o([_],e)}(u.default);i.default=I,cc._RF.pop()},{"../../scripts/data/MiscConfig":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/CommonPopup":void 0,"../../scripts/prefabs/Toast":void 0,"../../scripts/utils/GlobalFun":void 0,"../extension/ListItem":"ListItem","../prefabs/AwardPopup":"AwardPopup","./BuyItem":"BuyItem","./ItemList":"ItemList"}],ChildrenDayGiftPopup:[function(t,e,i){"use strict";cc._RF.push(e,"ac8c6K5riJK7a4hOoOLa/dx","ChildrenDayGiftPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MstData"),c=t("../../scripts/data/UserData"),d=t("../../scripts/manager/AdManager"),l=t("../../scripts/manager/AudioManager"),p=t("../../scripts/manager/UIManager"),u=t("../../scripts/prefabs/Toast"),f=t("../../scripts/utils/EventName"),h=t("../../scripts/utils/GlobalFun"),g=t("../entitys/ChildrenDayGiftItem"),m=t("../extension/List"),v=t("../../scripts/extension/LanguageData"),_=cc._decorator,y=_.ccclass,I=_.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.expProg=null,e.barNode=null,e.lvLab=null,e.expLab=null,e.vipbtn=null,e.rewardList=null,e.guideNode=null,e._model=null,e._lvData=null,e._isExpAniFinished=!0,e}return n(e,t),e.prototype.onLoad=function(){this._model=c.default.getInstance().activityData.childrenDay,this._lvData=r.default.getInstance().mstActivity.childrenDay.config.lvData,this.vipbtn.active=!1,this.updateRewardList(),this.initProgress(),this.initRewardIndex(),h.default.isCanShowBanner()&&d.default.getInstance().showBanner()},e.prototype.initProgress=function(){var t=this._model.config.lvData[this._model.lv],e=this._model.lv,i=this._model.exp;if(e>=this._model.maxLv){this.expProg.progress=1;var a=this._model.config.lvData[this._model.lv-1].exp;this.expLab.string=a+"/"+a,this.lvLab.string=e+""}else this.expProg.progress=i/t.exp,this.expLab.string=i+"/"+t.exp,this.lvLab.string=e+1+""},e.prototype.initRewardIndex=function(){var t=-1!=this._model.firstNormalRewardIndex?this._model.firstNormalRewardIndex:this._model.firstSpecialRewardIndex;t=-1==t?this._model.lv:t,this.rewardList.scrollTo(t-2)},e.prototype.updateRewardList=function(){this.rewardList.numItems=Object.keys(this._lvData).length,cc.director.getScene().emit(f.default.UPDATE_CHILDRENDAY_RED)},e.prototype.itemElementRender=function(t,e){var i=e+1;t.getComponent(g.default).initUI(i,this._lvData[i],this)},e.prototype.showPassExpAni=function(t,e){var i=this;cc.director.getScene().emit(f.default.UPDATE_CHILDRENDAY_LV);var a=this._model.exp,n=this._model.lv;if(n!=e||a!=t)if(this._isExpAniFinished)this._isExpAniFinished=!1,this.updateExpAnimation(this.expProg.node,a,t,n,e,function(){cc.isValid(i)&&(i._isExpAniFinished=!0,i.initProgress())});else{cc.tween(this.expProg.node).stop(),e=parseInt(this.lvLab.string);var o=this.expLab.string,s=o.indexOf("/");t=parseInt(o.slice(0,s)),this.updateExpAnimation(this.expProg.node,a,t,n,e,function(){e=n,t=a,cc.isValid(i)&&(i._isExpAniFinished=!0,i.initProgress())})}},e.prototype.updateExpAnimation=function(t,e,i,a,n,o){var s=this,c=r.default.getInstance().mstActivity.childrenDay.config.lvData,d=cc.tween(t).call(function(){var t=function(){if(a==n){var r=c[n].exp,d={a:i};cc.tween(d).to(.5,{a:e},{progress:function(t,e,i,n){var o=Math.round(t+(e-t)*n);if(cc.isValid(s))if(a==s._model.maxLv){s.expProg.progress=1;var c=s._model.config.lvData[s._model.lv-1].exp;s.expLab.string=c+"/"+c,s.lvLab.string=a+"";var d=v.default.t("childrenDayGiftPopup_10");p.default.getInstance().openUI(u.default,{data:{str:d}})}else s.expProg.progress=o/r,s.expLab.string=o+"/"+r;return t+(e-t)*n}}).call(o).start()}else if(a>n){var f=c[n].exp;d={a:i},cc.tween(d).to(.5,{a:f},{progress:function(t,e,i,a){var n=Math.round(t+(e-t)*a);return cc.isValid(s)&&(s.expLab.string=n+"/"+f,s.expProg.progress=n/f),t+(e-t)*a}}).call(function(){i=0,n++,cc.isValid(s)&&(s.lvLab.string=n+""),t(),l.default.getInstance().playEffect("activityLevelup")}).start()}};t()}),f=cc.tween(t).to(.5,{scale:1.2}).to(.5,{scale:1});return cc.tween(t).parallel(f,d).start()},e.prototype.onDestroy=function(){h.default.isCanShowBanner()&&d.default.getInstance().hideBanner()},e.uiName="ChildrenDayGiftPopup",o([I(cc.ProgressBar)],e.prototype,"expProg",void 0),o([I(cc.Node)],e.prototype,"barNode",void 0),o([I(cc.Label)],e.prototype,"lvLab",void 0),o([I(cc.Label)],e.prototype,"expLab",void 0),o([I(cc.Node)],e.prototype,"vipbtn",void 0),o([I(m.default)],e.prototype,"rewardList",void 0),o([I(cc.Node)],e.prototype,"guideNode",void 0),o([y],e)}(s.default);i.default=b,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/AudioManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/Toast":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../entitys/ChildrenDayGiftItem":"ChildrenDayGiftItem","../extension/List":"List"}],ChildrenDayPopup:[function(t,e,i){"use strict";cc._RF.push(e,"6fbc5KZse9MlbT2LEFnUVqG","ChildrenDayPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/UserData"),c=t("../../scripts/utils/EventName"),d=t("../entitys/ItemList"),l=t("../../scripts/utils/GlobalFun"),p=t("../../scripts/manager/UIManager"),u=t("../../scripts/data/MstData"),f=t("./ChildrenDayGiftPopup"),h=t("../../scripts/prefabs/CommonPopup"),g=t("../../scripts/data/MiscConfig"),m=t("../../scripts/prefabs/Toast"),v=t("../../scripts/manager/AudioManager"),_=t("../../scripts/manager/AdManager"),y=t("../../scripts/extension/LanguageData"),I=cc._decorator,b=I.ccclass,N=I.property,C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemSp=null,e.btnSp=[],e.taskSp=[],e.itemStateSp=[],e.itemNode=null,e.expProg=null,e.barNode=null,e.lvLab=null,e.expLab=null,e.taskNode=null,e.expIconNode=null,e.expProgGuideNode=null,e.lookNode=null,e.endTimeLab=null,e.redNode=null,e.childrenSkel=null,e.particle1Node=null,e.particle2Node=null,e._model=null,e._itemNodeList=[],e._isExpAniFinished=!0,e._lastChooseNode=null,e._rewardNode=[],e._endTime=[],e}return n(e,t),e.prototype.onLoad=function(){var t=this;if(this._endTime=r.default.getInstance().activityData.getActivityEndTime("childrenDay"),this.updateBySecond(),cc.director.getScene().on(c.default.UPDATE_BY_SECOND,this.updateBySecond,this),cc.director.getScene().on(c.default.UPDATE_CHILDRENDAY_LV,this.initProgress,this),cc.director.getScene().on(c.default.UPDATE_CHILDRENDAY_RED,this.initRed,this),this._model=r.default.getInstance().activityData.childrenDay,this.initProgress(),this.initTask(),this.childrenSkel.setAnimation(0,"chid_idle",!1),this.childrenSkel.setCompleteListener(function(){t.particle1Node.stopSystem(),t.particle2Node.stopSystem(),t.childrenSkel.setAnimation(0,"chid_idle",!1)}),this._model.lv>=this._model.maxLv){var e=y.default.t("childrenDayGiftPopup_10");p.default.getInstance().openUI(m.default,{data:{str:e}})}l.default.isCanShowBanner()&&_.default.getInstance().showBanner()},e.prototype.initProgress=function(){var t=this._model.config.lvData[this._model.lv],e=this._model.lv,i=this._model.exp;if(e>=this._model.maxLv){this.expProg.progress=1;var a=this._model.config.lvData[this._model.lv-1].exp;this.expLab.string=a+"/"+a,this.lvLab.string=e+""}else this.expProg.progress=i/t.exp,this.expLab.string=i+"/"+t.exp,this.lvLab.string=e+1+"";this.initRed()},e.prototype.initTask=function(){this._model.sortTask();for(var t=this._model.taskData,e=t.length,i=0;i<t.length;i++){var a=this._itemNodeList[i];a||(a=cc.instantiate(this.itemNode),this.taskNode.addChild(a),this._itemNodeList[i]=a,a.active=!0),this._itemNodeList[i].active=!0,this.initTaskItem(a,i,t[i])}for(i=e;i<this._itemNodeList.length;i++)this._itemNodeList[i].active=!1;var n=this._model.taskIndex();this.onClickChooseTask({target:this._itemNodeList[n].getChildByName("chooseBtn")},this._model.chooseTaskId+"")},e.prototype.initTaskItem=function(t,e,i){var a=this._model.taskBg[i.id];a||(a=e%2,this._model.updatetaskBg(i.id,a)),t.getComponent(cc.Sprite).spriteFrame=this.taskSp[a];for(var n=i.requireItems,o=[],s=0;s<n.length;s++){var c=r.default.getInstance().getNormalItemIndexByIds([n[s]]);(h={}).itemId=n[s],h.itemBg=c.includes(-1)?this.itemStateSp[0]:this.itemStateSp[1],h.isComplete=!c.includes(-1),h.isClickAble=!0,h.isShowInfo=!0,h.bgSize=cc.v2(172,172),o.push(h)}t.getChildByName("requireList").getComponent(d.default).init({itemsData:o,spacingX:25});var p=l.default.getAllReward(i.mstData.reward,i.mstData.rewardRes),u=[],f=0;for(s=0;s<p.length;s++){var h;(h={}).itemId=p[s].id,u.push(h),40003==p[s].id&&(f=s),t.getChildByName("num").getComponent(cc.Label).string="x"+p[s].num}t.getChildByName("rewardList").getComponent(d.default).init({itemsData:u,spacingX:25}),this._rewardNode[e]=t.getChildByName("rewardList").children[f];var g=t.getChildByName("btn");g.getChildByName("txt").getComponent(cc.Label).string="",g.getComponent(cc.Button).clickEvents[0].customEventData=i.id+"";var m=!r.default.getInstance().getNormalItemIndexByIds(n).includes(-1),v=m?"onClickSubmitTask":"onClickGoMerge",_=m?y.default.t("childrenDayGiftPopup_7"):y.default.t("childrenDayGiftPopup_8"),I=m?this.btnSp[0]:this.btnSp[1];g.getComponent(cc.Button).clickEvents[0].handler=v,g.getComponent(cc.Sprite).spriteFrame=I,g.getChildByName("txt").getComponent(cc.Label).string=_,g.getChildByName("txt").getComponent(cc.LabelOutline).color=m?new cc.Color(64,98,35):new cc.Color(157,104,72),t.getChildByName("chooseBtn").getComponent(cc.Button).clickEvents[0].customEventData=i.id+""},e.prototype.initRed=function(){this.redNode.active=-1!=this._model.firstRewardIndex},e.prototype.onClickChooseTask=function(t,e){this._lastChooseNode&&(this._lastChooseNode.getChildByName("bg").active=!1),this._lastChooseNode=t.target,this._lastChooseNode.getChildByName("bg").active=!0,r.default.getInstance().activityData.childrenDay.chooseTask(+e),cc.director.getScene().emit(c.default.UPDATE_MERGEAREA)},e.prototype.onClickSubmitTask=function(t,e){var i=this,a=this._model.exp,n=this._model.lv,o=this._model.taskIndex(+e),s=r.default.getInstance().activityData.childrenDay.submit(o);if(!s.ids.includes(-1)){cc.director.getScene().emit(c.default.UPDATE_MERGEAREA,s.ids),this.initTask(),v.default.getInstance().playEffect("taskComplete");for(var d=0;d<s.reward.length;d++){var l={};l.id=s.reward[d].id,l.startNode=this._rewardNode[o],l.num=s.reward[d].num,40003==l.id&&(l.endNode=this.expIconNode,l.callback=function(){cc.isValid(i.node)&&i.showPassExpAni(a,n)}),cc.director.getScene().emit(c.default.ITEM_FLY,l)}"chid_get"!=this.childrenSkel.animation&&(this.childrenSkel.setAnimation(0,"chid_get",!1),this.particle1Node.resetSystem(),this.particle2Node.resetSystem(),v.default.getInstance().playEffect("childrenRun"),v.default.getInstance().playEffect("paopjiRun"))}},e.prototype.onClickGoMerge=function(){cc.director.getScene().emit(c.default.CLOSE_SCENE),this.onClose()},e.prototype.onClickLookGift=function(){p.default.getInstance().openUI(f.default)},e.prototype.onClickHelp=function(){var t=r.default.getInstance().activityData.getActivityEndTime("childrenDay"),e=l.default.getDateByYMD(t[1]),i=e.split("/")[1],a=e.split("/")[2],n={titleText:y.default.t("happyBingoHelpPopup_2"),contentText:y.default.t("childrenDayGiftPopup_9",{month:i,day:a}),model:g.default.COMMON_POPUP_MODEL_1,isLeft:!0,okText:y.default.t("sure"),okCallback:function(){}};p.default.getInstance().openUI(h.default,{data:n})},e.prototype.onClickChildren=function(){"chid_idle"==this.childrenSkel.animation&&(this.childrenSkel.setAnimation(0,"chid_hit",!1),this.particle1Node.resetSystem(),this.particle2Node.resetSystem(),v.default.getInstance().playEffect("paopji"))},e.prototype.showPassExpAni=function(t,e){var i=this,a=this._model.maxLv;if(e>=a){var n=y.default.t("childrenDayGiftPopup_10");p.default.getInstance().openUI(m.default,{data:{str:n}})}else{var o=this._model.exp,s=this._model.lv;if(s!=e||o!=t)if(this._isExpAniFinished)this._isExpAniFinished=!1,this.updateExpAnimation(this.expProg.node,o,t,s,e,function(){cc.isValid(i)&&(i._isExpAniFinished=!0,i.initProgress())});else{cc.tween(this.expProg.node).stop(),e=parseInt(this.lvLab.string);var r=this.expLab.string,c=r.indexOf("/");t=parseInt(r.slice(0,c)),this.updateExpAnimation(this.expProg.node,o,t,s,e,function(){e=s,t=o,cc.isValid(i)&&(i._isExpAniFinished=!0,i.initProgress())})}}},e.prototype.updateExpAnimation=function(t,e,i,a,n,o){var s=this,r=u.default.getInstance().mstActivity.childrenDay.config.lvData,c=cc.tween(t).call(function(){var t=function(){if(a==n){var c=r[n].exp,d={a:i};cc.tween(d).to(.5,{a:e},{progress:function(t,e,i,n){var o=Math.round(t+(e-t)*n);if(cc.isValid(s))if(a==s._model.maxLv){s.expProg.progress=1;var r=s._model.config.lvData[s._model.lv-1].exp;s.expLab.string=r+"/"+r,s.lvLab.string=a+"";var d=y.default.t("childrenDayGiftPopup_10");p.default.getInstance().openUI(m.default,{data:{str:d}})}else s.expProg.progress=o/c,s.expLab.string=o+"/"+c;return t+(e-t)*n}}).call(o).start()}else if(a>n){var l=r[n].exp;d={a:i},cc.tween(d).to(.5,{a:l},{progress:function(t,e,i,a){var n=Math.round(t+(e-t)*a);return cc.isValid(s)&&(s.expLab.string=n+"/"+l,s.expProg.progress=n/l),t+(e-t)*a}}).call(function(){i=0,n++,cc.isValid(s)&&(s.lvLab.string=n+""),t(),v.default.getInstance().playEffect("activityLevelup")}).start()}};t()}),d=cc.tween(t).to(.5,{scale:1.2}).to(.5,{scale:1});return cc.tween(t).parallel(d,c).start()},e.prototype.updateBySecond=function(){var t=this._endTime;if(t.length>0){var e=t[1]-window.serverTime;e>0?this.endTimeLab.string=l.default.timeFormat(e):(this.onClose(),p.default.getInstance().getUI(f.default)&&p.default.getInstance().closeUI(f.default))}},e.prototype.onDestroy=function(){l.default.isCanShowBanner()&&_.default.getInstance().hideBanner()},e.uiName="ChildrenDayPopup",o([N(cc.SpriteFrame)],e.prototype,"itemSp",void 0),o([N([cc.SpriteFrame])],e.prototype,"btnSp",void 0),o([N([cc.SpriteFrame])],e.prototype,"taskSp",void 0),o([N([cc.SpriteFrame])],e.prototype,"itemStateSp",void 0),o([N(cc.Node)],e.prototype,"itemNode",void 0),o([N(cc.ProgressBar)],e.prototype,"expProg",void 0),o([N(cc.Node)],e.prototype,"barNode",void 0),o([N(cc.Label)],e.prototype,"lvLab",void 0),o([N(cc.Label)],e.prototype,"expLab",void 0),o([N(cc.Node)],e.prototype,"taskNode",void 0),o([N(cc.Node)],e.prototype,"expIconNode",void 0),o([N(cc.Node)],e.prototype,"expProgGuideNode",void 0),o([N(cc.Node)],e.prototype,"lookNode",void 0),o([N(cc.Label)],e.prototype,"endTimeLab",void 0),o([N(cc.Node)],e.prototype,"redNode",void 0),o([N(sp.Skeleton)],e.prototype,"childrenSkel",void 0),o([N(cc.ParticleSystem)],e.prototype,"particle1Node",void 0),o([N(cc.ParticleSystem)],e.prototype,"particle2Node",void 0),o([b],e)}(s.default);i.default=C,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MiscConfig":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/AudioManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/CommonPopup":void 0,"../../scripts/prefabs/Toast":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../entitys/ItemList":"ItemList","./ChildrenDayGiftPopup":"ChildrenDayGiftPopup"}],ChristmasAniPopup:[function(t,e,i){"use strict";cc._RF.push(e,"4fb3bFVModAuLe3LOHMZL3J","ChristmasAniPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/manager/AudioManager"),c=cc._decorator,d=c.ccclass,l=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.santaClausNode=null,e.title=null,e}return n(e,t),e.prototype.onLoad=function(){r.default.getInstance().setMusicVolume(.3),r.default.getInstance().playEffect("christmas"),r.default.getInstance().playEffect("laugh"),this.runAni()},e.prototype.runAni=function(){var t=this;this.title.scale=0,this.santaClausNode.x=820,this.santaClausNode.y=1080,this.santaClausNode.scaleX=-.3,this.santaClausNode.scaleY=.3;var e=cc.tween(this.santaClausNode).to(3,{scaleX:-.8,scaleY:.8}),i=cc.tween(this.santaClausNode).bezierTo(3,cc.v2(820,1080),cc.v2(0,500),cc.v2(-1e3,350)),a=cc.tween(this.santaClausNode).to(2,{scaleX:1,scaleY:1}),n=cc.tween(this.santaClausNode).bezierTo(2,cc.v2(-1e3,350),cc.v2(0,100),cc.v2(0,0));cc.tween(this.santaClausNode).parallel(e,i).call(function(){t.santaClausNode.scaleX*=-1}).parallel(a,n).call(function(){t.santaClausNode.getComponent(cc.Animation).stop(),cc.tween(t.title).to(.5,{scale:1}).call(function(){t.node.getComponent(cc.Button).enabled=!0}).start()}).start()},e.prototype.onCilckClose=function(){r.default.getInstance().setMusicVolume(.7),this.onClose()},e.uiName="ChristmasAniPopup",o([l(cc.Node)],e.prototype,"santaClausNode",void 0),o([l(cc.Node)],e.prototype,"title",void 0),o([d],e)}(s.default);i.default=p,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/manager/AudioManager":void 0}],ChristmasLvItem:[function(t,e,i){"use strict";cc._RF.push(e,"35606nULjFFDYV/MLsBXHcE","ChristmasLvItem");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/MiscConfig"),r=t("../../scripts/data/MstData"),c=t("../../scripts/data/UserData"),d=t("../../scripts/manager/UIManager"),l=t("../../scripts/prefabs/CommonPopup"),p=t("../../scripts/utils/EventName"),u=t("../../scripts/utils/GlobalFun"),f=t("../prefabs/AwardPopup"),h=t("../prefabs/BuildInfoPopup"),g=t("../prefabs/ItemChain"),m=t("../prefabs/UnlockShowPopup"),v=t("./BuildItem"),_=t("../../scripts/extension/LanguageData"),y=cc._decorator,I=y.ccclass,b=y.property,N=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnBg=[],e.itemBg=[],e.lvbg=[],e.itemNode=[],e.bgSprite=null,e.lvSprite=null,e.btnGetAward=null,e.btnUnReceive=null,e.btnUnLock=null,e.progressTop=null,e.progressBom=null,e.levelLab=null,e.expLab=null,e._levelInfo=null,e._rewardList=[],e._isMaxLevel=!1,e}return n(e,t),e.prototype.init=function(t){this._levelInfo=t,this._isMaxLevel=!1;var e=c.default.getInstance().activityData.christmas.level,i=c.default.getInstance().activityData.christmas.exp,a=r.default.getInstance().mstActivity.christmas.config.levelData;this.lvSprite.spriteFrame=this.lvbg[1],1==t.level?(this.lvSprite.spriteFrame=this.lvbg[0],this.progressTop.node.active=!1,this.progressBom.node.active=!0):t.level==a[a.length-1].level?(this.progressTop.node.active=!0,this.progressBom.node.active=!1,this._isMaxLevel=!0):(this.progressTop.node.active=!0,this.progressBom.node.active=!0),e>t.level?(this.bgSprite.spriteFrame=this.btnBg[0],this.expLab.string="",this.progressTop.progress=1,this.progressBom.progress=1,this.btnUnLock.active=!1,c.default.getInstance().activityData.christmas.isReceive[t.level]?(this.btnGetAward.active=!1,this.btnUnReceive.active=!0):(this.btnGetAward.active=!0,this.btnUnReceive.active=!1)):e==t.level?(this.bgSprite.spriteFrame=this.btnBg[0],this.progressTop.progress=1,this.progressBom.progress=i/(a[e-1].exp/2),this.expLab.string="",this.btnUnLock.active=!1,c.default.getInstance().activityData.christmas.isReceive[t.level]?(this.btnGetAward.active=!1,this.btnUnReceive.active=!0):(this.btnGetAward.active=!0,this.btnUnReceive.active=!1)):e+1==t.level?(this.bgSprite.spriteFrame=this.btnBg[1],this.progressTop.progress=(i-a[e-1].exp/2)/(a[e-1].exp/2),this.progressBom.progress=0,this.expLab.string=i+"/"+a[e-1].exp,this.btnGetAward.active=!1,this.btnUnReceive.active=!1,this.btnUnLock.active=!0):(this.bgSprite.spriteFrame=this.btnBg[1],this.progressTop.progress=0,this.progressBom.progress=0,this.btnGetAward.active=!1,this.btnUnReceive.active=!1,this.btnUnLock.active=!0,this.expLab.string=""),this.levelLab.string=t.level,this.initRewardData(t)},e.prototype.initRewardData=function(t){this._rewardList=[],this.itemNode[0].active=!1,this.itemNode[1].active=!1,this.itemNode[0].getChildByName("itemicon").removeAllChildren(),this.itemNode[1].getChildByName("itemicon").removeAllChildren(),this.itemNode[0].getChildByName("itemicon").getComponent(cc.Sprite).spriteFrame=null,this.itemNode[1].getChildByName("itemicon").getComponent(cc.Sprite).spriteFrame=null;var e=0;if(t.reward.length>0)for(var i=0;i<t.reward.length;i++){if(s=u.default.getItemIconPathById(t.reward[i]+"")){var a=this.itemNode[e].getChildByName("itemicon").getComponent(cc.Sprite);u.default.loadSpriteFrame(a,s),this.itemNode[e].active=!0,this.itemNode[e].getChildByName("itemnum").getComponent(cc.Label).string="",this.itemNode[e].getChildByName("chain").active=!0,this.itemNode[e].getComponent(cc.Button).interactable=!0,this._rewardList.push({id:t.reward[i],num:1})}if(++e>=2)break}if(e<2){var n=u.default.rewardResToObj(t.rewardRes);for(var o in n){var s;if((s=u.default.getItemIconPathById(o))&&(a=this.itemNode[e].getChildByName("itemicon").getComponent(cc.Sprite),u.default.loadSpriteFrame(a,s),this.itemNode[e].active=!0,this.itemNode[e].getChildByName("chain").active=!1,this.itemNode[e].getComponent(cc.Button).interactable=!1,this.itemNode[e].getChildByName("itemnum").getComponent(cc.Label).string=n[o],this._rewardList.push({id:Number(o),num:n[o]})),++e>=2)break}}if(e<2){var c=t.rewardSkin,d=function(t){var i=r.default.getInstance().mstBuildingSkin[c[t]];if(!i)return"continue";var a=l.itemNode[e].getChildByName("itemicon");return cc.resources.load("building/"+i.nodeName,cc.Prefab,function(t,e){if(!t){var i=cc.instantiate(e);i.setPosition(cc.v2(0,0)),i.getComponent(v.default).initUnlockShow(110,110),a.addChild(i)}}),l.itemNode[e].active=!0,l.itemNode[e].getChildByName("chain").active=!0,l.itemNode[e].getComponent(cc.Button).interactable=!0,l.itemNode[e].getChildByName("itemnum").getComponent(cc.Label).string="",++e>=2?"break":void 0},l=this;for(i=0;i<c.length&&"break"!==d(i);i++);}},e.prototype.onClickItem1=function(){if(this._levelInfo.reward.length>0)d.default.getInstance().openUI(g.default,{data:this._levelInfo.reward[0]});else if(this._levelInfo.rewardSkin.length>0){var t=r.default.getInstance().mstBuildingSkin[this._levelInfo.rewardSkin[0]];t&&d.default.getInstance().openUI(h.default,{data:{buildId:t.buildingId}})}},e.prototype.onClickItem2=function(){var t;0==this._levelInfo.reward.length?this._levelInfo.rewardSkin.length>0&&(t=r.default.getInstance().mstBuildingSkin[this._levelInfo.rewardSkin[1]])&&d.default.getInstance().openUI(h.default,{data:{buildId:t.buildingId}}):this._levelInfo.rewardSkin.length>0&&(t=r.default.getInstance().mstBuildingSkin[this._levelInfo.rewardSkin[0]])&&d.default.getInstance().openUI(h.default,{data:{buildId:t.buildingId}})},e.prototype.onClickGetAward=function(){var t=this,e=function(){if(t._isMaxLevel){var e={titleText:_.default.t("tips"),contentText:_.default.t("christmasLvItem_1"),model:s.default.COMMON_POPUP_MODEL_1,isLeft:!0,okText:_.default.t("sure"),okCallback:function(){}};d.default.getInstance().openUI(l.default,{data:e})}};c.default.getInstance().activityData.christmas.receiveReward(this._levelInfo.level)&&(this.btnGetAward.active=!1,this.btnUnReceive.active=!0,this.btnUnLock.active=!1,this._rewardList.length>0?d.default.getInstance().openUI(f.default,{data:this._rewardList},null,function(){t._levelInfo.rewardSkin.length>0?d.default.getInstance().openNotice(m.default,{data:{ntype:"building",skinId:t._levelInfo.rewardSkin[0]}},null,function(){e()}):e()}):this._levelInfo.rewardSkin.length>0?d.default.getInstance().openNotice(m.default,{data:{ntype:"building",skinId:this._levelInfo.rewardSkin[0]}},null,function(){e()}):e(),cc.director.getScene().emit(p.default.UPDATE_ACTIVITY))},o([b([cc.SpriteFrame])],e.prototype,"btnBg",void 0),o([b([cc.SpriteFrame])],e.prototype,"itemBg",void 0),o([b([cc.SpriteFrame])],e.prototype,"lvbg",void 0),o([b([cc.Node])],e.prototype,"itemNode",void 0),o([b(cc.Sprite)],e.prototype,"bgSprite",void 0),o([b(cc.Sprite)],e.prototype,"lvSprite",void 0),o([b(cc.Node)],e.prototype,"btnGetAward",void 0),o([b(cc.Node)],e.prototype,"btnUnReceive",void 0),o([b(cc.Node)],e.prototype,"btnUnLock",void 0),o([b(cc.ProgressBar)],e.prototype,"progressTop",void 0),o([b(cc.ProgressBar)],e.prototype,"progressBom",void 0),o([b(cc.Label)],e.prototype,"levelLab",void 0),o([b(cc.Label)],e.prototype,"expLab",void 0),o([I],e)}(cc.Component);i.default=N,cc._RF.pop()},{"../../scripts/data/MiscConfig":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/CommonPopup":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../prefabs/AwardPopup":"AwardPopup","../prefabs/BuildInfoPopup":"BuildInfoPopup","../prefabs/ItemChain":"ItemChain","../prefabs/UnlockShowPopup":"UnlockShowPopup","./BuildItem":"BuildItem"}],ChristmasPopup:[function(t,e,i){"use strict";cc._RF.push(e,"8f9ddvAd3VLVZA4Ywq+Mfq+","ChristmasPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MiscConfig"),c=t("../../scripts/data/MstData"),d=t("../../scripts/data/UserData"),l=t("../../scripts/manager/UIManager"),p=t("../../scripts/prefabs/CommonPopup"),u=t("../../scripts/prefabs/Loading"),f=t("../../scripts/utils/EventName"),h=t("../../scripts/utils/GlobalFun"),g=t("../entitys/ChristmasLvItem"),m=t("../extension/List"),v=t("./ItemChain"),_=t("./ItemInfoPopup"),y=t("../../scripts/extension/LanguageData"),I=cc._decorator,b=I.ccclass,N=I.property,C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.listElement=null,e.btnBg=[],e.itemBg=[],e.itemNode=[],e.taskAwardNode=[],e.btnGetTaskAward=null,e.btnGoMerge=null,e.bgSprite=null,e.endTimeLab=null,e._taskItemList=[],e._taskAwardList=[],e}return n(e,t),e.prototype.init=function(){this.updateTime(),this.initTaskData(),this._taskItemList=c.default.getInstance().mstActivity.christmas.config.levelData},e.prototype.initTaskData=function(){var t=d.default.getInstance().activityData.christmas.taskData[0];if(t){var e=t.requireItems,i=t.isReceived;if(e.length>0){var a=d.default.getInstance().getNormalItemIndexByIds(e);this.itemNode[0].active=!1,this.itemNode[1].active=!1;for(var n=0;n<e.length;n++){var o=i||a[n]>0,s=this.itemNode[n];s.active=!0;var r=h.default.getItemIconPathById(e[n]+"");if(r){var c=s.getChildByName("itemicon").getComponent(cc.Sprite);h.default.loadSpriteFrame(c,r)}o?(s.getChildByName("gou").active=!0,s.getComponent(cc.Sprite).spriteFrame=this.itemBg[1]):(s.getChildByName("gou").active=!1,s.getComponent(cc.Sprite).spriteFrame=this.itemBg[0]),s.getComponent(cc.Button).interactable=!0,s.getChildByName("chain").active=!0}}t.isComplete?(this.btnGetTaskAward.active=!0,this.btnGoMerge.active=!1,this.bgSprite.spriteFrame=this.btnBg[1]):(this.btnGetTaskAward.active=!1,this.btnGoMerge.active=!0,this.bgSprite.spriteFrame=this.btnBg[0]);var l=h.default.rewardResToObj(t.mstData.rewardRes),p=!1;for(var u in l){if("40001"==u)this.taskAwardNode[1].getChildByName("awardNum").getComponent(cc.Label).string=l[u];else{this.taskAwardNode[0].active=!0;var f=h.default.getItemIconPathById(l[u]);h.default.loadSpriteFrame(this.taskAwardNode[0].getChildByName("icon").getComponent(cc.Sprite),f),this.taskAwardNode[0].getChildByName("bg").active=!0,this.taskAwardNode[0].getChildByName("awardNum").getComponent(cc.Label).string=l[u],p=!0}this._taskAwardList.push({id:Number(u),num:l[u]})}!p&&(this.taskAwardNode[0].active=!1,t.mstData.reward.length>0)&&(f=h.default.getItemIconPathById(t.mstData.reward[0]),h.default.loadSpriteFrame(this.taskAwardNode[0].getChildByName("icon").getComponent(cc.Sprite),f),this.taskAwardNode[0].getChildByName("bg").active=!1,this.taskAwardNode[0].getChildByName("awardNum").getComponent(cc.Label).string="x1",this._taskAwardList.push({id:t.mstData.reward[0],num:1}))}},e.prototype.onClickItem1=function(){var t=d.default.getInstance().activityData.christmas.taskData[0];if(t){var e=t.requireItems;c.default.getInstance().mstItem[e[0]].type.includes("Show")?l.default.getInstance().openUI(_.default,{data:e[0]}):l.default.getInstance().openUI(v.default,{data:e[0]})}},e.prototype.onClickItem2=function(){var t=d.default.getInstance().activityData.christmas.taskData[0];if(t){var e=t.requireItems;c.default.getInstance().mstItem[e[0]].type.includes("Show")?l.default.getInstance().openUI(_.default,{data:e[1]}):l.default.getInstance().openUI(v.default,{data:e[1]})}},e.prototype.onClickGetAward=function(){var t=d.default.getInstance().activityData.christmas.taskData[0],e=t.completeTask();e&&(this.initTaskData(),this.flayBell(t),cc.director.getScene().emit(f.default.UPDATE_MERGEAREA,e.cells))},e.prototype.onClickHelp=function(){var t=d.default.getInstance().activityData.getActivityEndTime("christmas");if(!(t.length<=0)){var e=h.default.getDateByYMD(t[0]),i=h.default.getDateByYMD(t[1]),a={titleText:y.default.t("happyBingoHelpPopup_2"),contentText:y.default.t("christmasPopup_2",{startTime:e,endTime:i}),model:r.default.COMMON_POPUP_MODEL_1,isLeft:!0,okText:y.default.t("sure"),okCallback:function(){}};l.default.getInstance().openUI(p.default,{data:a})}},e.prototype.flayBell=function(){var t=this;l.default.getInstance().openUI(u.default,{data:{showBlack:!1}},function(){var e=d.default.getInstance().activityData.christmas.level;t.listElement.scrollTo(e-1,.5),t.scheduleOnce(function(){for(var i=0,a=0;a<t._taskAwardList.length;a++){var n={};if(n.id=t._taskAwardList[a].id,40001==t._taskAwardList[a].id){n.startNode=t.taskAwardNode[1].getChildByName("icon");var o=t.listElement.getItemByListId(e-1);n.endNode=o.getComponent(g.default).lvSprite.node}else n.startNode=t.taskAwardNode[0].getChildByName("icon");n.moveSpeed=2e3,n.num=t._taskAwardList[a].num,n.callback=function(){++i>=t._taskAwardList.length&&(t.updateLevelTask(),l.default.getInstance().closeUI("Loading"))},cc.director.getScene().emit(f.default.ITEM_FLY,n)}},.5)})},e.prototype.itemElementRender=function(t,e){t.getComponent(g.default).init(this._taskItemList[e])},e.prototype.updateTime=function(){var t=d.default.getInstance().activityData.getActivityEndTime("christmas");t.length>0?this.endTimeLab.string=h.default.formatDateTimeDaysPre(t[1]-window.serverTime):this.node.destroy()},e.prototype.updateLevelTask=function(){this.listElement.numItems=this._taskItemList.length,this.listElement.scrollTo(d.default.getInstance().activityData.christmas.level-1,.5)},e.prototype.getTaskNode=function(){return this.node.getChildByName("fram").getChildByName("sdj_20")},e.prototype.getLevelNode=function(){var t=d.default.getInstance().activityData.christmas.level;return this.listElement.getItemByListId(t-1)},e.prototype.onLoad=function(){cc.director.getScene().on(f.default.UPDATE_BY_SECOND,this.updateTime,this),this.updateLevelTask()},e.uiName="ChristmasPopup",o([N(m.default)],e.prototype,"listElement",void 0),o([N([cc.SpriteFrame])],e.prototype,"btnBg",void 0),o([N([cc.SpriteFrame])],e.prototype,"itemBg",void 0),o([N([cc.Node])],e.prototype,"itemNode",void 0),o([N([cc.Node])],e.prototype,"taskAwardNode",void 0),o([N(cc.Node)],e.prototype,"btnGetTaskAward",void 0),o([N(cc.Node)],e.prototype,"btnGoMerge",void 0),o([N(cc.Sprite)],e.prototype,"bgSprite",void 0),o([N(cc.Label)],e.prototype,"endTimeLab",void 0),o([b],e)}(s.default);i.default=C,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MiscConfig":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/CommonPopup":void 0,"../../scripts/prefabs/Loading":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../entitys/ChristmasLvItem":"ChristmasLvItem","../extension/List":"List","./ItemChain":"ItemChain","./ItemInfoPopup":"ItemInfoPopup"}],ContractPopup:[function(t,e,i){"use strict";cc._RF.push(e,"8f294TizIhLXoi/bCbt+97j","ContractPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/UserData"),c=t("../../scripts/manager/AudioManager"),d=t("../../scripts/utils/ActionFunc"),l=t("../../scripts/utils/GlobalFun"),p=t("../../scripts/extension/LanguageData"),u=cc._decorator,f=u.ccclass,h=u.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lbPlayerName=null,e.closeBtn=null,e.lbDate=null,e.tipNode=null,e.sureNode=null,e}return n(e,t),e.prototype.onLoad=function(){this.lbPlayerName.string=p.default.t("contractPopup_1",{id:r.default.getInstance().id}),this.lbDate.string=l.default.getDateByYMD(),d.default.zoomAnim2(this.sureNode)},e.prototype.onClickStamp=function(){var t=this;this.sureNode.stopAllActions(),this.sureNode.scale=1,this.sureNode.getComponent(cc.Button).enabled=!1;var e=this.node.getComponent(cc.Animation);e.on(cc.Animation.EventType.FINISHED,function(){e.off(cc.Animation.EventType.FINISHED),t.closeBtn.active=!0,t.tipNode.active=!0,c.default.getInstance().playEffect("stamp"),c.default.getInstance().playEffect("clamp2")}),e.play()},e.uiName="ContractPopup",o([h(cc.Label)],e.prototype,"lbPlayerName",void 0),o([h(cc.Node)],e.prototype,"closeBtn",void 0),o([h(cc.Label)],e.prototype,"lbDate",void 0),o([h(cc.Node)],e.prototype,"tipNode",void 0),o([h(cc.Node)],e.prototype,"sureNode",void 0),o([f],e)}(s.default);i.default=g,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AudioManager":void 0,"../../scripts/utils/ActionFunc":void 0,"../../scripts/utils/GlobalFun":void 0}],CustomerInfoPopup:[function(t,e,i){"use strict";cc._RF.push(e,"c2ec42wMCxEK6eWkD5W8uXF","CustomerInfoPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MstData"),c=t("../../scripts/data/UserData"),d=t("../../scripts/manager/AdManager"),l=t("../../scripts/manager/SDKManager"),p=t("../../scripts/manager/UIManager"),u=t("../../scripts/prefabs/Toast"),f=t("../../scripts/utils/AppConfig"),h=t("../../scripts/utils/ChannelHelper"),g=t("../../scripts/utils/EventName"),m=t("../../scripts/utils/GlobalFun"),v=t("../entitys/RoleSkinItem"),_=t("../extension/List"),y=t("./AtlasPopup"),I=t("./ChildrenDayPopup"),b=t("./ChristmasPopup"),N=t("./NewYearPopup"),C=t("./UnlockShowPopup"),k=t("../../scripts/extension/LanguageData"),S=cc._decorator,w=S.ccclass,T=S.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nameLab=null,e.areaName=null,e.btnSkinLab=null,e.icon=null,e.btnShare=null,e.videoIcon=null,e.spineNode=null,e.topResNode=null,e.iconCion=null,e.iconDiamond=null,e.iconSkinTicket=null,e.resNum=null,e.dressNum=null,e.btnUse=null,e.listElement=null,e.btnCostIcon=[],e._roleId=null,e._skinList=null,e._curSelect=0,e.parent=null,e._userRoleData=null,e}return n(e,t),e.prototype.init=function(t){this._roleId=t.roleId,this.parent=t.parent,this._userRoleData=c.default.getInstance().roleData[this._roleId],this._skinList=this._userRoleData.mstData.skinIds,this.initData(this._curSelect),h.default.getChannel()==h.HMCHANNEL.WY?this.btnShare.active=!1:this.btnShare.active=!0,this._userRoleData.tipsSkinIndex=[],cc.director.getScene().emit(g.default.UPDATE_ACTIVITY),d.default.getInstance().showBanner()},e.prototype.initData=function(t){var e=r.default.getInstance().mstRoleSkin[this._skinList[t]];this.nameLab.string=e.name,this.dressNum.string=e.skinValue+"",this.areaName.string=1==this._userRoleData.mstData.type?k.default.t("customerInfoPopup_4"):k.default.t("customerInfoPopup_5"),m.default.loadSpriteFrame(this.icon,"textures/role/icon/icon_"+e.icon)},e.prototype.itemElementRender=function(t,e){t.getComponent(v.default).initItemInfo(this._skinList[e],this._roleId)},e.prototype.itemSelectRender=function(t,e){this.updateSkinInfo(e),this.initData(e)},e.prototype.updateRewardCD=function(){var t=this._skinList[this._curSelect],e=r.default.getInstance().mstRoleSkin[t];if(!this._userRoleData.isSkinUnlock(this._curSelect)&&"video"==e.costType){var i=d.default.getInstance().rewardAdCd;i>0?(this.btnUse.interactable=!1,m.default.setBtnIsGrey(this.btnUse),this.btnSkinLab.string=m.default.formatDateTimeHourEx(i)):(this.btnUse.interactable=!0,m.default.setBtnIsGrey(this.btnUse,new cc.Color(62,96,32)),this.btnSkinLab.string=this._userRoleData.skinVideoCountById(t)+"/"+e.costNum)}},e.prototype.updateSkinInfo=function(t){this._curSelect=t;var e=this._skinList[t];this.btnUse.getComponent(cc.Button).interactable=!0;var i=r.default.getInstance().mstRoleSkin[e];t==this._userRoleData.skinIdIndex?(this.btnUse.getComponent(cc.Button).interactable=!1,this.btnSkinLab.string=k.default.t("buildInfoPopup_1"),this.videoIcon.node.active=!1,this.topResNode.active=!1):(this.btnUse.node.active=!0,this._userRoleData.isSkinUnlock(t)?(this.videoIcon.node.active=!1,this.btnSkinLab.string=k.default.t("buildInfoPopup_2")):"coins"==i.costType?(this.videoIcon.node.active=!0,this.videoIcon.spriteFrame=this.btnCostIcon[0],this.btnSkinLab.string="x"+i.costNum):"diamonds"==i.costType?(this.videoIcon.node.active=!0,this.videoIcon.spriteFrame=this.btnCostIcon[1],this.btnSkinLab.string="x"+i.costNum):"skinTicket"==i.costType?(this.videoIcon.node.active=!0,this.videoIcon.spriteFrame=this.btnCostIcon[2],this.btnSkinLab.string="x"+i.costNum):"activity"==i.costType?(c.default.getInstance().activityData.isActivityOpen(i.activityKey)?this.btnUse.getComponent(cc.Button).interactable=!0:this.btnUse.getComponent(cc.Button).interactable=!1,this.btnSkinLab.string=k.default.t("buildInfoPopup_4"),this.videoIcon.node.active=!1):"video"==i.costType?(this.btnSkinLab.string=this._userRoleData.skinVideoCountById(e)+"/"+i.costNum,this.videoIcon.node.active=!0,this.videoIcon.spriteFrame=this.btnCostIcon[3]):"item"==i.costType&&(this.btnSkinLab.string=k.default.t("buildInfoPopup_4"),this.videoIcon.node.active=!1)),"coins"==i.costType?(this.topResNode.active=!0,this.iconCion.active=!0,this.iconDiamond.active=!1,this.iconSkinTicket.active=!1,this.resNum.string=c.default.getInstance().coins+""):"diamonds"==i.costType?(this.topResNode.active=!0,this.iconCion.active=!1,this.iconDiamond.active=!0,this.iconSkinTicket.active=!1,this.resNum.string=c.default.getInstance().diamonds+""):"skinTicket"==i.costType?(this.topResNode.active=!0,this.iconCion.active=!1,this.iconDiamond.active=!1,this.iconSkinTicket.active=!0,this.resNum.string=c.default.getInstance().skinTicket+""):"activity"==i.costType?this.topResNode.active=!1:"video"==i.costType?this.topResNode.active=!1:(i.costType,this.topResNode.active=!1)},e.prototype.onClickShare=function(){var t=k.default.t("share_6"),e=f.default.WX_SHARE_PATH+"share6.jpg";l.default.getInstance().shareAppMessage(t,e,null,function(){},null)},e.prototype.onClickUse=function(){var t=this,e=this._skinList[this._curSelect],i=r.default.getInstance().mstRoleSkin[e];if(this._userRoleData.isSkinUnlock(this._curSelect))this._userRoleData.selectSkin(this._curSelect)?(this.updateSkinInfo(this._curSelect),this.listElement.numItems=this._skinList.length,this.listElement.selectedId=this._userRoleData.skinIdIndex,this.parent&&this.parent.refushRole(),cc.director.getScene().emit(g.default.CHANGROLESKIN,this._roleId),p.default.getInstance().openUI(u.default,{data:{str:k.default.t("buildInfoPopup_5")}})):p.default.getInstance().openUI(u.default,{data:{str:k.default.t("buildInfoPopup_6")}});else if("coins"==i.costType)i.costNum<=c.default.getInstance().coins?this._userRoleData.unLockSkin(this._curSelect)?(this.updateSkinInfo(this._curSelect),this.initData(this._curSelect),this.listElement.numItems=this._skinList.length,cc.director.getScene().emit(g.default.UPDATE_TOPINFO),cc.director.getScene().emit(g.default.UPDATE_ACTIVITY),p.default.getInstance().openNotice(C.default,{data:{ntype:"customer",skinId:e}})):p.default.getInstance().openUI(u.default,{data:{str:k.default.t("buildInfoPopup_7")}}):p.default.getInstance().openUI(u.default,{data:{str:k.default.t("noCoins")}});else if("diamonds"==i.costType)i.costNum<=c.default.getInstance().diamonds?this._userRoleData.unLockSkin(this._curSelect)?(this.updateSkinInfo(this._curSelect),this.initData(this._curSelect),this.listElement.numItems=this._skinList.length,cc.director.getScene().emit(g.default.UPDATE_TOPINFO),cc.director.getScene().emit(g.default.UPDATE_ACTIVITY),p.default.getInstance().openNotice(C.default,{data:{ntype:"customer",skinId:e}})):p.default.getInstance().openUI(u.default,{data:{str:k.default.t("buildInfoPopup_7")}}):m.default.noDiamondsCommonPopup();else if("skinTicket"==i.costType)i.costNum<=c.default.getInstance().skinTicket?this._userRoleData.unLockSkin(this._curSelect)?(this.updateSkinInfo(this._curSelect),this.initData(this._curSelect),this.listElement.numItems=this._skinList.length,cc.director.getScene().emit(g.default.UPDATE_TOPINFO),cc.director.getScene().emit(g.default.UPDATE_ACTIVITY),p.default.getInstance().openNotice(C.default,{data:{ntype:"customer",skinId:e}})):p.default.getInstance().openUI(u.default,{data:{str:k.default.t("buildInfoPopup_7")}}):(p.default.getInstance().openUI(u.default,{data:{str:k.default.t("noSkinTicket")}}),m.default.noSkinTicketPopup());else if("activity"==i.costType){this.onClose(),p.default.getInstance().closeUI(y.default),cc.director.getScene().emit(g.default.CLOSE_SCENE);for(var a=!0,n=0;n<c.default.getInstance().activityData.fields.length;n++){var o=c.default.getInstance().activityData.fields[n],s=cc.sys.localStorage.getItem(o),l=c.default.getInstance().activityData.getActivityEndTime(o);(!s||""==s||l.length>0&&s!==m.default.getDateByYMD(l[0]))&&c.default.getInstance().activityData.isActivityOpen(o)&&(a=!1)}a&&("christmas"==i.activityKey?p.default.getInstance().openUI(b.default):"newYear"==i.activityKey?p.default.getInstance().openUI(N.default):"childrenDay"==i.activityKey&&p.default.getInstance().openUI(I.default))}else"video"==i.costType?d.default.getInstance().showRewardAd(function(){t._userRoleData.addSkinVideoCount(e,t._curSelect)&&(t.initData(t._curSelect),t.updateRewardCD(),p.default.getInstance().openNotice(C.default,{data:{ntype:"customer",skinId:e}}),cc.director.getScene().emit(g.default.UPDATE_ACTIVITY),cc.director.getScene().emit(g.default.UPDATE_TOPINFO)),t.updateSkinInfo(t._curSelect),t.listElement.numItems=t._skinList.length},function(){},function(){}):"item"==i.costType&&(this.onClose(),p.default.getInstance().closeUI(y.default),"foodFestival"==i.activityKey&&m.default.openLimitActivityByName("foodFestival"))},e.prototype.getGuideUseNode=function(){return this.node.getChildByName("bg").getChildByName("skinbg")},e.prototype.onLoad=function(){cc.director.getScene().on(g.default.UPDATE_TOPINFO,this.updateTopInfo,this),this.listElement.numItems=this._skinList.length,this.listElement.selectedId=this._userRoleData.skinIdIndex,this.updateRewardCD(),cc.director.getScene().on(g.default.UPDATE_BY_SECOND,this.updateRewardCD,this)},e.prototype.updateTopInfo=function(){this.updateSkinInfo(this._curSelect)},e.prototype.onDestroy=function(){d.default.getInstance().hideBanner()},e.uiName="CustomerInfoPopup",o([T(cc.Label)],e.prototype,"nameLab",void 0),o([T(cc.Label)],e.prototype,"areaName",void 0),o([T(cc.Label)],e.prototype,"btnSkinLab",void 0),o([T(cc.Sprite)],e.prototype,"icon",void 0),o([T(cc.Node)],e.prototype,"btnShare",void 0),o([T(cc.Sprite)],e.prototype,"videoIcon",void 0),o([T(cc.Node)],e.prototype,"spineNode",void 0),o([T(cc.Node)],e.prototype,"topResNode",void 0),o([T(cc.Node)],e.prototype,"iconCion",void 0),o([T(cc.Node)],e.prototype,"iconDiamond",void 0),o([T(cc.Node)],e.prototype,"iconSkinTicket",void 0),o([T(cc.Label)],e.prototype,"resNum",void 0),o([T(cc.Label)],e.prototype,"dressNum",void 0),o([T(cc.Button)],e.prototype,"btnUse",void 0),o([T(_.default)],e.prototype,"listElement",void 0),o([T([cc.SpriteFrame])],e.prototype,"btnCostIcon",void 0),o([w],e)}(s.default);i.default=P,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/SDKManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/Toast":void 0,"../../scripts/utils/AppConfig":void 0,"../../scripts/utils/ChannelHelper":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../entitys/RoleSkinItem":"RoleSkinItem","../extension/List":"List","./AtlasPopup":"AtlasPopup","./ChildrenDayPopup":"ChildrenDayPopup","./ChristmasPopup":"ChristmasPopup","./NewYearPopup":"NewYearPopup","./UnlockShowPopup":"UnlockShowPopup"}],Customer:[function(t,e,i){"use strict";cc._RF.push(e,"b9690mJaPZG3KLQvOKBQvx/","Customer");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/MstData"),r=t("../../scripts/data/UserData"),c=t("../../scripts/utils/GlobalFun"),d=t("../utils/UndirectedGraph"),l=cc._decorator,p=l.ccclass,u=l.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.customerSp=null,e.gouwuk=null,e.frontche=[],e.backche=[],e.lanzi=[],e.talkNode=null,e.talkbg=null,e.talkLabel=null,e._parent=null,e._birth=null,e._optList=null,e._mapSzie=null,e._customerData=null,e._optIndex=-1,e._curPoint=0,e._mapGraph=null,e._footWidth=0,e._cusScale=.4,e._cusState=1,e._cusDir=1,e._fullState=0,e._isInBuild=!1,e._aniDir="",e._aniType="",e._createtime=null,e._talkDialog=null,e._customerId=null,e.chePos=[cc.v3(61,7,0),cc.v3(-61,7,0),cc.v3(-61,50,0),cc.v3(61,50,0)],e.lanziPos=[cc.v3(-44,5,0),cc.v3(44,5,0),cc.v3(-53,11,0),cc.v3(53,11,0)],e._skinData=null,e}return n(e,t),e.prototype.initCustoMer=function(t,e,i,a,n){this._optList=e,this._customerId=n,this._parent=a,this._birth=t,this._curPoint=t,this._customerData=i,this._optIndex=-1,this._fullState=0,this._mapSzie=this._parent.getMapSize(),this._cusScale=.5,this._footWidth=60,this._createtime=s.default.getInstance().mstMisc.cusDialogueInterval.config;var o=r.default.getInstance().roleData[this._customerData.id].mstSkinData;this._skinData=o,this._talkDialog=o.dialogue,this.initMapGraph()},e.prototype.initMapGraph=function(){var t=this,e=this._skinData,i=function(){t.customerSp.node.zIndex=1,t.node.zIndex=t._mapSzie.height;var i=t._mapGraph.getPintPosByID(t._birth).pos;t.node.setPosition(i),t.loadSpine("textures/role/spine/"+e.icon,function(){t.startMove(),t.startDialog()})};this._mapGraph?i():(this._mapGraph=new d.default,this._mapGraph.initNodeMap(function(){i()}))},e.prototype.initUnlockShow=function(t){var e=this;this.loadSpine("textures/role/spine/"+t,function(){e.customerSp.node.setScale(-1,1),"dianyuan"==t&&e.customerSp.setSkin("dianyuan")})},e.prototype.loadSpine=function(t,e){var i=this;cc.resources.load(t,sp.SkeletonData,function(a,n){a?console.log("\u52a0\u8f7dspine\u9519\u8bef",t,t.length):cc.isValid(i.node)&&(i.customerSp.skeletonData=n,i.playSpineAni("front","idle",1),i._cusDir=2,e())})},e.prototype.playSpineAni=function(t,e,i,a){void 0===i&&(i=this._cusState),void 0===a&&(a=!0),this._aniDir=t,this._aniType=e;var n=t+"_"+e+"_"+i;this.customerSp.setToSetupPose(),this.customerSp.setAnimation(0,n,a),"buy"!=e&&this.showCheOrLanzi(t,e)},e.prototype.startMove=function(){if(-1==this._optIndex){var t=this._mapGraph.findPath(this._curPoint+"","4");this._curPoint=4,this.startCurOpt(t)}else if(this._optList[this._optIndex]){var e=this._optList[this._optIndex];if("number"==typeof e)this._mapGraph.pointIsOpen(e+"")?(t=this._mapGraph.findPath(this._curPoint+"",e+""),this._curPoint=e,this.startCurOpt(t)):(this._optIndex++,this.startMove());else{for(var i=[],a=0;a<e.length;a++)this._mapGraph.pointIsOpen(e[a]+"")&&i.push(e[a]);if(i.length>0){var n=i[c.default.radomBetween(0,i.length-1)];t=this._mapGraph.findPath(this._curPoint+"",n+""),this._curPoint=n,this.startCurOpt(t)}else this._optIndex++,this.startMove()}}else this._curPoint==this._birth?(cc.Tween.stopAllByTarget(this.node),cc.Tween.stopAllByTarget(this.talkNode),this.unscheduleAllCallbacks(),this._parent.deletCustomer(this._customerId,this.node)):(t=this._mapGraph.findPath(this._curPoint+"",this._birth+""),this._curPoint=this._birth,this.startCurOpt(t))},e.prototype.startCurOpt=function(t){var e=this;if(!t)return this._optIndex++,void this.customerAiLogic();for(var i=cc.tween(this.node),a=function(a){var n=t[a].sub(t[a-1]),o=n.mag()/100;i.call(function(){e.setCustomerDir(n)}).to(o,{position:t[a]})},n=1;n<t.length;n++)a(n);i.call(function(){if(4==e._curPoint)return e._optIndex++,i.stop(),void e.startMove();e._curPoint==e._birth?(i.stop(),cc.Tween.stopAllByTarget(e.node),cc.Tween.stopAllByTarget(e.talkNode),e.unscheduleAllCallbacks(),e._parent.deletCustomer(e._customerId,e.node)):(e._optIndex++,i.stop(),e.customerAiLogic())}).start()},e.prototype.customerAiLogic=function(){var t=this,e=this._mapGraph.pointPos[this._curPoint].state,i=this._mapGraph.pointPos[this._curPoint].buildkey,a=s.default.getInstance().mstBuilding[i].actionType;(!a||a.length<=0)&&console.log("\u5f53\u524d\u8282\u70b9\u6ca1\u6709\u4e92\u52a8\u52a8\u4f5c",this._skinData.icon,this._curPoint,i);var n=a[c.default.radomBetween(0,a.length-1)];e&&this._cusState!=e&&(this._cusState=e),a.indexOf(2)>=0&&0==this._fullState&&(n=2);var o=this._mapGraph.pointPos[this._curPoint].dir;if(o){var r="";switch(4==o?(this._cusDir=4,this.customerSp.node.setScale(-this._cusScale,this._cusScale),r="back"):1==o?(this._cusDir=1,this.customerSp.node.setScale(this._cusScale,this._cusScale),r="front"):2==o?(this._cusDir=2,this.customerSp.node.setScale(-this._cusScale,this._cusScale),r="front"):3==o&&(this._cusDir=3,this.customerSp.node.setScale(this._cusScale,this._cusScale),r="back"),n){case 1:this.playSpineAni(r,"buy",1,!1);break;case 2:this._fullState<2&&(this._fullState+=1),this.playSpineAni(r,"buy",1,!1);break;case 11:2==this._cusState?this.playSpineAni(r,"idle",1,!0):this.playSpineAni(r,"idle",this._cusState,!0),this.scheduleOnce(function(){t.startMove()},3);break;case 12:this.playSpineAni(r,"idle",1,!0),this.scheduleOnce(function(){t.startMove()},3);break;case 13:this.node.active=!1,this.scheduleOnce(function(){t.node.active=!0,t.startMove()},3);break;case 21:var d=this.node.position.clone(),l=this.node.parent;this._parent.setCustomerToBuild(this.node,this._mapGraph.pointPos[this._curPoint].buildkey,this._mapGraph.pointPos[this._curPoint].areaid)?(this._isInBuild=!0,this.playSpineAni(r,"sit",1,!0),this.scheduleOnce(function(){t.node.parent=l,t.node.setPosition(d),t.startMove(),t._isInBuild=!1},3)):(2==this._cusState?this.playSpineAni(r,"idle",1,!0):this.playSpineAni(r,"idle",this._cusState,!0),this.scheduleOnce(function(){t.startMove()},1))}}else this.startMove()},e.prototype.showCheOrLanzi=function(t,e){switch(e){case"buy":case"idle":if(2==this._cusState){this.gouwuk.node.active=!0;var i=0;1==this._cusDir?i=2:2==this._cusDir?i=3:3==this._cusDir?i=4:4==this._cusDir&&(i=1),2==i||1==i?(this.gouwuk.node.zIndex=2,this.gouwuk.spriteFrame=this.frontche[this._fullState]):(this.gouwuk.node.zIndex=0,this.gouwuk.spriteFrame=this.backche[this._fullState]),2==i||4==i?this.gouwuk.node.setScale(-this._cusScale,this._cusScale):this.gouwuk.node.setScale(this._cusScale,this._cusScale),this.gouwuk.node.setPosition(this.chePos[i-1])}else this.gouwuk.node.active=!1;break;case"sit":this.gouwuk.node.active=!1;break;case"move":0==this._cusState||1==this._cusState?this.gouwuk.node.active=!1:(this.gouwuk.node.active=!0,2==this._cusState?("front"==t?(this.gouwuk.node.zIndex=2,this.gouwuk.spriteFrame=this.frontche[this._fullState]):"back"==t&&(this.gouwuk.node.zIndex=0,this.gouwuk.spriteFrame=this.backche[this._fullState]),this.gouwuk.node.setPosition(this.chePos[this._cusDir-1])):3==this._cusState&&(this.gouwuk.node.zIndex=2,this.gouwuk.spriteFrame=this.lanzi[this._fullState],this.gouwuk.node.setPosition(this.lanziPos[this._cusDir-1])),2==this._cusDir||4==this._cusDir?this.gouwuk.node.setScale(-this._cusScale,this._cusScale):this.gouwuk.node.setScale(this._cusScale,this._cusScale))}},e.prototype.setCustomerDir=function(t){t.x>0&&t.y>0?4==this._cusDir&&"move"==this._aniType||(this._cusDir=4,this.customerSp.node.setScale(-this._cusScale,this._cusScale),this.playSpineAni("back","move")):t.x>0&&t.y<0?1==this._cusDir&&"move"==this._aniType||(this._cusDir=1,this.customerSp.node.setScale(this._cusScale,this._cusScale),this.playSpineAni("front","move")):t.x<0&&t.y<0?2==this._cusDir&&"move"==this._aniType||(this._cusDir=2,this.customerSp.node.setScale(-this._cusScale,this._cusScale),this.playSpineAni("front","move")):t.x<0&&t.y>0&&(3==this._cusDir&&"move"==this._aniType||(this._cusDir=3,this.customerSp.node.setScale(this._cusScale,this._cusScale),this.playSpineAni("back","move")))},e.prototype.sumZindexOrder=function(){if(this.node.parent&&cc.isValid(this.node)&&this._parent&&!this._isInBuild&&0!=this.node.opacity){var t=cc.v3(this.node.position.x+this._footWidth,this.node.position.y,this.node.position.z),e=cc.v3(this.node.position.x-this._footWidth,this.node.position.y,this.node.position.z),i=[this.node.parent.convertToWorldSpaceAR(t),this.node.parent.convertToWorldSpaceAR(e)],a=[t,e],n=this._parent.sumCustomerZorder(this.node,i,a);if(n.out>0){var o=n.out-Math.floor(this._mapSzie.height-(this._mapSzie.height/2+this.node.position.y)),s=10*Math.abs(o/n.wid);0==n.dir?this.node.zIndex=n.out+s:1==n.dir&&(this.node.zIndex=n.out-s)}else this.node.zIndex=Math.floor(this._mapSzie.height-(this._mapSzie.height/2+this.node.position.y))}},e.prototype.onLoad=function(){var t=this;this.customerSp.setCompleteListener(function(e){"back_buy_1"!=e.animation.name&&"front_buy_1"!=e.animation.name||("buy"!=t._aniType&&t.showCheOrLanzi(t._aniDir,t._aniType),t.startMove())})},e.prototype.startDialog=function(){var t=this,e=c.default.radomBetween(this._createtime[0],this._createtime[1]);cc.tween(this.talkNode).delay(e).call(function(){t.talkbg.active=!0;var e=c.default.radomBetween(0,t._talkDialog.length-1);t.talkLabel.string=t._talkDialog[e]}).delay(3).call(function(){t.talkbg.active=!1,t.startDialog()}).start()},o([u(sp.Skeleton)],e.prototype,"customerSp",void 0),o([u(cc.Sprite)],e.prototype,"gouwuk",void 0),o([u([cc.SpriteFrame])],e.prototype,"frontche",void 0),o([u([cc.SpriteFrame])],e.prototype,"backche",void 0),o([u([cc.SpriteFrame])],e.prototype,"lanzi",void 0),o([u(cc.Node)],e.prototype,"talkNode",void 0),o([u(cc.Node)],e.prototype,"talkbg",void 0),o([u(cc.Label)],e.prototype,"talkLabel",void 0),o([p],e)}(cc.Component);i.default=f,cc._RF.pop()},{"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/utils/GlobalFun":void 0,"../utils/UndirectedGraph":"UndirectedGraph"}],DailyBenefitsPopup:[function(t,e,i){"use strict";cc._RF.push(e,"1f4cfVdUulI2IHYIcgW1uX+","DailyBenefitsPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MstData"),c=t("../../scripts/data/UserData"),d=t("../../scripts/manager/AdManager"),l=t("../../scripts/manager/UIManager"),p=t("../../scripts/utils/EventName"),u=t("../../scripts/utils/GlobalFun"),f=t("../../scripts/utils/StatisticsManager"),h=t("../entitys/BottomInfoPrefab"),g=t("./AwardPopup"),m=t("./ItemChain"),v=t("./ShopPopup"),_=t("../../scripts/extension/LanguageData"),y=cc._decorator,I=y.ccclass,b=y.property,N=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemnode=[],e}return n(e,t),e.prototype.init=function(){d.default.getInstance().showBanner()},e.prototype.onLoad=function(){cc.director.getScene().on(p.default.UPDATE_BY_SECOND,this.updateBySecond,this),this.updateBySecond()},e.prototype.residueTimes=function(t){var e=c.default.getInstance().storeData.dailyGift[t].times;return r.default.getInstance().mstStore.dailyGift.config[t].limitNum-e},e.prototype.updateBySecond=function(){this.updateUI(0,"1"),this.updateUI(1,"2"),this.updateUI(2,"3")},e.prototype.updateUI=function(t,e){var i=this.itemnode[t],a=r.default.getInstance().mstStore.dailyGift.config[e].itemId;i.getChildByName("lbName").getComponent(cc.Label).string=r.default.getInstance().mstItem[a].name;var n=u.default.getItemIconPathById(a);u.default.loadSpriteFrame(i.getChildByName("di_2").getChildByName("itemicon").getComponent(cc.Sprite),n);var o=i.getChildByName("purchaseType"),s=this.residueTimes(e),c=o.getChildByName("lbTimes");s>0&&s<=10?(o.getChildByName("hongdian").active=!0,c.active=!0,c.getComponent(cc.Label).string=s+""):(o.getChildByName("hongdian").active=!1,c.active=!1,c.getComponent(cc.Label).string=s+""),o.getComponent(cc.Button).interactable=!(s<=0);var l=o.getChildByName("lay").getChildByName("lbPrice"),p=o.getChildByName("lay").getChildByName("purchaseIcon");if(s<=0)p&&(p.active=!1),l.getComponent(cc.Label).string=_.default.t("shopItem_2"),l.x=0,l.getComponent(cc.LabelOutline).color=new cc.Color(116,116,116);else{if(p){var f=d.default.getInstance().rewardAdCd;p.active=!0,l.x=36.5,f>0?(o.getComponent(cc.Button).interactable=!1,l.getComponent(cc.Label).string=u.default.formatDateTimeHourEx(f)):l.getComponent(cc.Label).string=_.default.t("free")}else l.x=0,l.getComponent(cc.Label).string=_.default.t("free");l.getComponent(cc.LabelOutline).color=new cc.Color(64,98,35)}},e.prototype.buyItem=function(t,e){var i=this;this.trackEvent(t,0);var a=c.default.getInstance().storeData,n={id:r.default.getInstance().mstStore.dailyGift.config[e].itemId,num:1},o=function(){a.buyItem("dailyGift",e)?(l.default.getInstance().openUI(g.default,{data:[n]}),i.updateUI(t,e)):u.default.noDiamondsCommonPopup()};if(0==t){o();var s=l.default.getInstance().getUI(v.default);s&&s.updateRedPoint();var p=cc.find("Canvas/MergeUIContent/MergeUI/bottomInfoContent/BottomInfoPrefab").getComponent(h.default);p&&p.updateUI()}else d.default.getInstance().showRewardAd(function(){i.trackEvent(t,1),o()},function(){},function(){})},e.prototype.trackEvent=function(t,e){1==t?f.default.trackEventOnXG("video","\u6bcf\u65e5\u798f\u5229-\u4f53\u529b\u5b9d\u7bb1",6,e):2==t&&f.default.trackEventOnXG("video","\u6bcf\u65e5\u798f\u5229-\u52a0\u901f\u9053\u5177",6,e)},e.prototype.onClickCoin=function(){this.buyItem(0,"1")},e.prototype.onClickBuyEngerBox=function(){f.default.trackEventOnXG("common","Ad_button_click"),this.buyItem(1,"2")},e.prototype.onClickBuyFastItem=function(){f.default.trackEventOnXG("common","Ad_button_click"),this.buyItem(2,"3")},e.prototype.onClickShowCoin=function(){var t=r.default.getInstance().mstStore.dailyGift.config[1].itemId;l.default.getInstance().openUI(m.default,{data:t})},e.prototype.onClickShowEngerBox=function(){var t=r.default.getInstance().mstStore.dailyGift.config[2].itemId;l.default.getInstance().openUI(m.default,{data:t})},e.prototype.onClickShowFastItem=function(){var t=r.default.getInstance().mstStore.dailyGift.config[3].itemId;l.default.getInstance().openUI(m.default,{data:t})},e.prototype.onDestroy=function(){d.default.getInstance().hideBanner()},e.uiName="DailyBenefitsPopup",o([b([cc.Node])],e.prototype,"itemnode",void 0),o([I],e)}(s.default);i.default=N,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../../scripts/utils/StatisticsManager":void 0,"../entitys/BottomInfoPrefab":"BottomInfoPrefab","./AwardPopup":"AwardPopup","./ItemChain":"ItemChain","./ShopPopup":"ShopPopup"}],EnergyBottlePopup:[function(t,e,i){"use strict";cc._RF.push(e,"602e1SiDSVPLb6QxcE4/kB7","EnergyBottlePopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/UserData"),c=t("../../scripts/manager/UIManager"),d=t("../../scripts/utils/ActionFunc"),l=t("../../scripts/utils/EventName"),p=t("../../scripts/utils/GlobalFun"),u=t("../entitys/BuyItem"),f=t("./AwardPopup"),h=t("../../scripts/extension/LanguageData"),g=cc._decorator,m=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.buyBtn=null,e.goBtn=null,e.activityEndTime=null,e.buyEndTime=null,e.numLab=null,e.tipLab=null,e.flaskSkel=null,e.buyTimeNode=null,e.flyNode=null,e.tipNode=null,e._model=null,e._config=null,e._activityEndTime=0,e._buyEndTime=0,e._isFullBottle=!1,e}return n(e,t),e.prototype.onLoad=function(){var t=this;this._model=r.default.getInstance().activityData.energyBottle,this._config=this._model.config,this._activityEndTime=r.default.getInstance().activityData.getActivityEndTime("energyBottle")[1],this._buyEndTime=this._model.endTime,this.tipLab.string=h.default.t("energyBottlePopup_1",{data1:this._model.config.energyRate}),this.updateBottleAnimation(),this.updateUI(),this.updateBySecond(),cc.director.getScene().on(l.default.UPDATE_BY_SECOND,this.updateBySecond,this);var e={};e.nowCostNum=this._model.payNum,e.successCb=function(e){t._model.buyEnery(e)&&(r.default.getInstance().changeEnergy(t._config.maxEnergy),t._model.resetData(),c.default.getInstance().openUI(f.default,{data:[{id:30092,num:t._config.maxEnergy}]},null,function(){t.node&&cc.isValid(t.node)&&(t.flaskSkel.setAnimation(0,"vanish",!1),t.updateUI(),cc.Tween.stopAllByTarget(t.tipNode))}))},e.failCb="",this.buyBtn.getComponent(u.default).init(this._config,e)},e.prototype.updateUI=function(){var t=this._model.isFullBottle;this.buyBtn.active=t,this.buyTimeNode.active=t,this.goBtn.active=!t,this._isFullBottle=t,this.numLab.string=this._model.bottleEnery+"/"+this._model.config.maxEnergy},e.prototype.updateBySecond=function(){var t=Math.ceil(this._activityEndTime-window.serverTime);if(t<0?(cc.director.getScene().emit(l.default.UPDATE_ACTIVITY),this.onClose()):this.activityEndTime.string=p.default.timeFormat(t),this._isFullBottle){var e=Math.ceil(this._buyEndTime-window.serverTime);e<0?(this._model.resetData(),this.updateUI(),this.flaskSkel.setAnimation(0,"vanish",!1),cc.Tween.stopAllByTarget(this.tipNode),this.buyBtn.getComponent(u.default).updateNowCostnum(0)):this.buyEndTime.string=p.default.timeFormat(e)}},e.prototype.updateBottleAnimation=function(){var t=this._model.bottleEnery/this._model.config.maxEnergy;t<=.1?this.flaskSkel.setAnimation(0,"status1",!0):t<=.4?this.flaskSkel.setAnimation(0,"status2",!0):t<=.7?this.flaskSkel.setAnimation(0,"status3",!0):t<1?this.flaskSkel.setAnimation(0,"status4",!0):1==t&&(this.flaskSkel.setAnimation(0,"status5",!0),d.default.zoomAnim2(this.tipNode))},e.prototype.onClickToMerge=function(){cc.director.getScene().emit(l.default.CLOSE_SCENE),this.onClose()},e.uiName="EnergyBottlePopup",o([v(cc.Node)],e.prototype,"buyBtn",void 0),o([v(cc.Node)],e.prototype,"goBtn",void 0),o([v(cc.Label)],e.prototype,"activityEndTime",void 0),o([v(cc.Label)],e.prototype,"buyEndTime",void 0),o([v(cc.Label)],e.prototype,"numLab",void 0),o([v(cc.Label)],e.prototype,"tipLab",void 0),o([v(sp.Skeleton)],e.prototype,"flaskSkel",void 0),o([v(cc.Node)],e.prototype,"buyTimeNode",void 0),o([v(cc.Node)],e.prototype,"flyNode",void 0),o([v(cc.Node)],e.prototype,"tipNode",void 0),o([m],e)}(s.default);i.default=_,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/utils/ActionFunc":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../entitys/BuyItem":"BuyItem","./AwardPopup":"AwardPopup"}],EnergyCardPopup:[function(t,e,i){"use strict";cc._RF.push(e,"9d5baugii5Kgby36asBA3Xh","EnergyCardPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MstData"),c=t("../../scripts/data/UserData"),d=t("../../scripts/manager/UIManager"),l=t("../../scripts/utils/EventName"),p=t("../../scripts/utils/GlobalFun"),u=t("../entitys/BuyItem"),f=t("./AwardPopup"),h=t("../../scripts/extension/LanguageData"),g=cc._decorator,m=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.buyItem=null,e.addLab=null,e.oldLab=null,e.timeLab=null,e.effectLab=null,e.effectNode=null,e._endTime=null,e}return n(e,t),e.prototype.onLoad=function(){this.initUI(),this.updateBySecond(),cc.director.getScene().on(l.default.UPDATE_BY_SECOND,this.updateBySecond,this)},e.prototype.initUI=function(){var t=this,e=c.default.getInstance().energyCardModel;this._endTime=e.endTime;var i=e.config;this.oldLab.string=h.default.t("energyCardPopup_1")+" "+r.default.getInstance().mstMisc.maxEnergy.config,this.addLab.string=r.default.getInstance().mstMisc.maxEnergy.config+i.addMaxEnergy,this.timeLab.string=Math.floor(i.cardTime/60/60/24)+"";var a={};a.nowCostNum=e.payNum,a.successCb=function(a){if(e.buyEnergyCard(a)){var n=p.default.getAllReward(i.reward,i.rewardRes);d.default.getInstance().openUI(f.default,{data:n},null),t.buyItem.getComponent(u.default).changeStateToOver(),t.effectNode.active=!0,t.updateBySecond()}},this.buyItem.getComponent(u.default).init(i,a),e.addMaxEnergy>0?this.buyItem.getComponent(u.default).changeStateToOver():this.effectNode.active=!1},e.prototype.updateBySecond=function(){var t=this._endTime-window.serverTime;if(t>0){var e=p.default.timeFormat(t);this.effectLab.string=e}else this.initUI()},e.uiName="EnergyCardPopup",o([v(cc.Node)],e.prototype,"buyItem",void 0),o([v(cc.Label)],e.prototype,"addLab",void 0),o([v(cc.Label)],e.prototype,"oldLab",void 0),o([v(cc.Label)],e.prototype,"timeLab",void 0),o([v(cc.Label)],e.prototype,"effectLab",void 0),o([v(cc.Node)],e.prototype,"effectNode",void 0),o([m],e)}(s.default);i.default=_,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../entitys/BuyItem":"BuyItem","./AwardPopup":"AwardPopup"}],EnergyPopup:[function(t,e,i){"use strict";cc._RF.push(e,"f478bGRJXBJpLbkIleMrzIk","EnergyPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MstData"),c=t("../../scripts/data/UserData"),d=t("../../scripts/manager/AdManager"),l=t("../../scripts/manager/UIManager"),p=t("../../scripts/utils/EventName"),u=t("../../scripts/utils/GlobalFun"),f=t("../../scripts/utils/StatisticsManager"),h=t("./AwardPopup"),g=t("../../scripts/extension/LanguageData"),m=cc._decorator,v=m.ccclass,_=m.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemNode=[],e._shopType="resource",e._item1GoodsId=1,e._item2GoodsId=3,e}return n(e,t),e.prototype.onLoad=function(){f.default.trackEvent("energy_open"),cc.director.getScene().on(p.default.UPDATE_BY_SECOND,this.updateEnergy,this),this.updateUI(),this.updateEnergy(),u.default.isCanShowBanner()&&d.default.getInstance().showBanner()},e.prototype.updateEnergy=function(){var t=this.getResidueTimes(this._item1GoodsId),e=d.default.getInstance().rewardAdCd,i=this.itemNode[0].getChildByName("purchaseType").getChildByName("lay").getChildByName("lbPrice");t>0?e>0?(this.itemNode[0].getChildByName("purchaseType").getComponent(cc.Button).interactable=!1,u.default.setBtnIsGrey(this.itemNode[0].getChildByName("purchaseType").getComponent(cc.Button)),i.getComponent(cc.Label).string=u.default.formatDateTimeHourEx(e)):(this.itemNode[0].getChildByName("purchaseType").getComponent(cc.Button).interactable=!0,i.getComponent(cc.Label).string=g.default.t("free"),u.default.setBtnIsGrey(this.itemNode[0].getChildByName("purchaseType").getComponent(cc.Button),new cc.Color(64,98,35))):(i.getComponent(cc.Label).string=g.default.t("shopItem_2"),u.default.setBtnIsGrey(this.itemNode[0].getChildByName("purchaseType").getComponent(cc.Button)),this.itemNode[0].getChildByName("purchaseType").getComponent(cc.Button).interactable=!1)},e.prototype.updateUI=function(){var t=r.default.getInstance().mstStore.resource.config[this._item1GoodsId];this.itemNode[0].getChildByName("num").getComponent(cc.Label).string="x"+t.itemNum;var e=this.getResidueTimes(this._item1GoodsId);if(e>0)this.itemNode[0].getChildByName("left").getComponent(cc.Label).string=g.default.t("topInfoPrefab_15",{count:e});else{var i=this.itemNode[0].getChildByName("purchaseType").getChildByName("lay").getChildByName("lbPrice");this.itemNode[0].getChildByName("left").getComponent(cc.Label).string="",this.itemNode[0].getChildByName("purchaseType").getChildByName("lay").getChildByName("purchaseIcon").active=!1,i.x=0,i.getComponent(cc.Label).string=g.default.t("shopItem_2"),i.getComponent(cc.LabelOutline).color=new cc.Color(116,116,116),this.itemNode[0].getChildByName("purchaseType").getComponent(cc.Button).interactable=!1}var a=r.default.getInstance().mstStore.resource.config[this._item2GoodsId];this.itemNode[1].getChildByName("num").getComponent(cc.Label).string="x"+a.itemNum;var n=this.getResidueTimes(this._item2GoodsId);n>0&&n<=10?this.itemNode[1].getChildByName("left").getComponent(cc.Label).string=g.default.t("topInfoPrefab_15",{count:e}):n<=0?(i=this.itemNode[1].getChildByName("purchaseType").getChildByName("lbPrice"),this.itemNode[1].getChildByName("left").getComponent(cc.Label).string="",this.itemNode[1].getChildByName("purchaseType").getChildByName("purchaseIcon").active=!1,i.x=0,i.getComponent(cc.Label).string=g.default.t("shopItem_2"),i.getComponent(cc.LabelOutline).color=new cc.Color(116,116,116),this.itemNode[1].getChildByName("purchaseType").getComponent(cc.Button).interactable=!1):(i=this.itemNode[1].getChildByName("purchaseType").getChildByName("lbPrice"),this.itemNode[1].getChildByName("left").getComponent(cc.Label).string="",i.getComponent(cc.Label).string=""+this.getPrice(this._item2GoodsId))},e.prototype.getResidueTimes=function(t){var e=c.default.getInstance().storeData[this._shopType][t].times;return r.default.getInstance().mstStore[this._shopType].config[t].limitNum-e},e.prototype.getPrice=function(t){var e=100,i=r.default.getInstance().mstStore[this._shopType].config[t];if(i.addPrice>0){var a=c.default.getInstance().storeData[this._shopType][t].times;e=a>0?i.costNum*Math.pow(i.addPrice,a):i.costNum}else e=i.costNum;return e},e.prototype.onClickItem1=function(){var t=this;f.default.trackEvent("shop_quick_energy_video_click",{goodsId:this._item1GoodsId+""}),f.default.trackEventOnXG("common","Ad_button_click"),f.default.trackEventOnXG("video","\u8865\u5145\u4f53\u529b",4,0),d.default.getInstance().showRewardAd(function(){if(f.default.trackEventOnXG("video","\u8865\u5145\u4f53\u529b",4,1),f.default.trackEvent("shop_quick_energy_video_success",{goodsId:t._item1GoodsId+""}),c.default.getInstance().storeData.buyItem("resource",t._item1GoodsId)){var e={id:30092,num:r.default.getInstance().mstStore.resource.config[t._item1GoodsId].itemNum};l.default.getInstance().openUI(h.default,{data:[e]}),t.updateUI(),t.updateEnergy()}},function(){f.default.trackEvent("shop_quick_energy_video_fail",{goodsId:t._item1GoodsId+""})},function(){f.default.trackEvent("shop_quick_energy_video_err",{goodsId:t._item1GoodsId+""})})},e.prototype.onClickItem2=function(){if(c.default.getInstance().storeData.buyItem("resource",this._item2GoodsId)){f.default.trackEvent("shop_quick_energy_buy",{goodsId:this._item2GoodsId+""});var t={id:30092,num:r.default.getInstance().mstStore.resource.config[this._item2GoodsId].itemNum};l.default.getInstance().openUI(h.default,{data:[t]}),this.updateUI()}else u.default.noDiamondsCommonPopup()},e.prototype.onDestroy=function(){u.default.isCanShowBanner()&&d.default.getInstance().hideBanner()},e.uiName="EnergyPopup",o([_(cc.Node)],e.prototype,"itemNode",void 0),o([v],e)}(s.default);i.default=y,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../../scripts/utils/StatisticsManager":void 0,"./AwardPopup":"AwardPopup"}],ExchangeCodePopup:[function(t,e,i){"use strict";cc._RF.push(e,"9c1bbGc1CRBp78tckh8lIs9","ExchangeCodePopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/UserData"),c=t("../../scripts/manager/AdManager"),d=t("../../scripts/manager/UIManager"),l=t("../../scripts/prefabs/Loading"),p=t("../../scripts/prefabs/Toast"),u=t("../../scripts/utils/Api"),f=t("./AwardPopup"),h=t("../../scripts/extension/LanguageData"),g=cc._decorator,m=g.ccclass,v=g.property,_={1101:"\u5151\u6362\u7801\u5df2\u8fc7\u671f",1102:"\u65e0\u6548\u5151\u6362\u7801",1103:"\u5df2\u9886\u53d6\u8fc7\u8be5\u5151\u6362\u7801"},y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.editBox=null,e}return n(e,t),e.prototype.onLoad=function(){this.editBox.placeholder=h.default.t("exchangeCodePopup_8")},e.prototype.init=function(){c.default.getInstance().showBanner()},e.prototype.onClickeExchange=function(){var t=this,e=this.editBox.string;!e||e.length<=0?d.default.getInstance().openUI(p.default,{data:{str:h.default.t("exchangeCodePopup_4")}}):d.default.getInstance().openUI(l.default,{},function(){u.default.activity.send({type:"useCDK",para:JSON.stringify({cdkKey:e})},function(e){if(console.log("\u8bf7\u6c42\u5151\u6362\u7801\u8fd4\u56de",e),e&&e.result){t.editBox.string="";var i=[],a=JSON.parse(e.reward);for(var n in a)i.push({id:Number(n),num:Number(a[n])});d.default.getInstance().openUI(p.default,{data:{str:h.default.t("exchangeCodePopup_5")}}),r.default.getInstance().addRewardByKV(a),d.default.getInstance().openUI(f.default,{data:i}),r.default.getInstance().saveUserData()}else{var o=h.default.t("exchangeCodePopup_6");e&&(o=_[e.msg]),d.default.getInstance().openUI(p.default,{data:{str:o}})}d.default.getInstance().closeUI(l.default)},function(){d.default.getInstance().closeUI(l.default)})})},e.prototype.onDestroy=function(){c.default.getInstance().hideBanner()},e.uiName="ExchangeCodePopup",o([v(cc.EditBox)],e.prototype,"editBox",void 0),o([m],e)}(s.default);i.default=y,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/Loading":void 0,"../../scripts/prefabs/Toast":void 0,"../../scripts/utils/Api":void 0,"./AwardPopup":"AwardPopup"}],FoodFestivalHelpPopup:[function(t,e,i){"use strict";cc._RF.push(e,"e5882vbHuJESZDV3U/yzk84","FoodFestivalHelpPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MstData"),c=t("../../scripts/data/UserData"),d=t("../../scripts/manager/UIManager"),l=t("../../scripts/utils/EventName"),p=t("../entitys/ItemEntity"),u=t("./LimitActListPopup"),f=t("../../scripts/extension/LanguageData"),h=cc._decorator,g=h.ccclass,m=h.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rewardItem=null,e.timeTip=null,e.rewardBg=null,e}return n(e,t),e.prototype.onLoad=function(){var t=r.default.getInstance().mstActivity.foodFestival.config,e={};e.itemId=t.lvData[2].reward[0],e.itemNum=1,e.itemBg=this.rewardBg,e.isClickAble=!0,e.isShowInfo=!0,this.rewardItem.getComponent(p.default).init(e),this.timeTip.string=f.default.t("foodFestivalHelpPopup_1",{data1:t.limitTime/86400})},e.prototype.onClickBtn=function(){c.default.getInstance().limitActModel.startActive("foodFestival")&&(cc.director.getScene().emit(l.default.OPEN_LIMIT_ACT_MERGE),d.default.getInstance().closeUI(u.default),this.onClose())},e.uiName="FoodFestivalHelpPopup",o([m(cc.Node)],e.prototype,"rewardItem",void 0),o([m(cc.Label)],e.prototype,"timeTip",void 0),o([m(cc.SpriteFrame)],e.prototype,"rewardBg",void 0),o([g],e)}(s.default);i.default=v,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/utils/EventName":void 0,"../entitys/ItemEntity":"ItemEntity","./LimitActListPopup":"LimitActListPopup"}],FoodFestivalResultPopup:[function(t,e,i){"use strict";cc._RF.push(e,"8c2depkzQJP66DC2wGsA0kJ","FoodFestivalResultPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/UserData"),c=t("../../scripts/manager/UIManager"),d=t("../entitys/ItemList"),l=t("./AwardPopup"),p=cc._decorator,u=p.ccclass,f=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rewardBg=null,e.itemList=null,e._result=0,e}return n(e,t),e.prototype.onLoad=function(){for(var t=this._result=r.default.getInstance().limitActModel.activitySettlement(),e=[],i=0;i<t.length;i++){var a={};a.itemId=t[i].id,a.itemNum=t[i].num,a.itemBg=this.rewardBg,a.isClickAble=!0,a.isShowInfo=!0,e.push(a)}this.itemList.getComponent(d.default).init({itemsData:e,spacingX:10})},e.prototype.onClickBtn=function(){var t=this;c.default.getInstance().openUI(l.default,{data:this._result},null,function(){t.onClose()})},e.uiName="FoodFestivalResultPopup",o([f(cc.SpriteFrame)],e.prototype,"rewardBg",void 0),o([f(cc.Node)],e.prototype,"itemList",void 0),o([u],e)}(s.default);i.default=h,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/UserData":void 0,"../../scripts/manager/UIManager":void 0,"../entitys/ItemList":"ItemList","./AwardPopup":"AwardPopup"}],FoodFestivalUI:[function(t,e,i){"use strict";cc._RF.push(e,"58a493k/T5NHq9osKrTC3bi","FoodFestivalUI");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/MstData"),r=t("../../scripts/data/UserData"),c=t("../../scripts/manager/UIManager"),d=t("../../scripts/prefabs/Toast"),l=t("../../scripts/utils/EventName"),p=t("../../scripts/utils/GlobalFun"),u=t("../prefabs/AwardPopup"),f=t("../scenes/MainScene"),h=t("./ItemList"),g=t("../../scripts/extension/LanguageData"),m=cc._decorator,v=m.ccclass,_=m.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timeLab=null,e.lvLab=null,e.expLab=null,e.expProgress=null,e.itemListContent=null,e.itemListPrefab=null,e.expNode=null,e._foodModel=null,e._oldLevel=0,e._oldExp=0,e._isExpAniFinished=!0,e._allAward=[],e}return n(e,t),e.prototype.onLoad=function(){cc.director.getScene().on(l.default.UPDATE_TOPINFO,this.updateTopInfo,this),cc.director.getScene().on(l.default.UPDATE_BY_SECOND,this.updateBySecond,this),this._foodModel=r.default.getInstance().limitActModel.foodFestival,this.updateActInfo(),this.updateBySecond()},e.prototype.updateActInfo=function(){if(this._oldLevel=4*this._foodModel.lv,this._oldExp=4*this._foodModel.exp,this.lvLab.string=this._foodModel.lv+"",s.default.getInstance().mstActivity.foodFestival.config.lvData[this._foodModel.lv].exp>0?(this.expLab.string=this._foodModel.exp+"/"+s.default.getInstance().mstActivity.foodFestival.config.lvData[this._foodModel.lv].exp,this.expProgress.progress=this._foodModel.exp/s.default.getInstance().mstActivity.foodFestival.config.lvData[this._foodModel.lv].exp):(this.expLab.string="MAX",this.expProgress.progress=0),0==this.itemListContent.childrenCount){var t=cc.instantiate(this.itemListPrefab);this.itemListContent.addChild(t)}var e=this.getItemData();this.itemListContent.children[0].getComponent(h.default).init({itemsData:e,spacingX:10})},e.prototype.getItemData=function(){var t=[],e=s.default.getInstance().mstActivity.foodFestival.config.lvData[this._foodModel.lv+1];if(e)for(var i=e.reward,a=0;a<i.length;a++){var n={};n.itemId=i[a],n.isClickAble=!0,n.isShowInfo=!0,n.bgSize=cc.v2(100,90),n.iconSize=cc.v2(80,80),t.push(n)}return t},e.prototype.updateBySecond=function(){var t=this._foodModel.endTime-window.serverTime;t>0?this.timeLab.string=p.default.timeFormat(t):(cc.director.getScene().off(l.default.UPDATE_BY_SECOND,this.updateBySecond,this),2==cc.find("Canvas").getComponent(f.default).isMainScene&&c.default.getInstance().openUI(d.default,{data:{str:g.default.t("foodFestivalUI_1")}}),cc.director.getScene().emit(l.default.LIMIT_ACT_CLOSE))},e.prototype.getPraiseNode=function(){return this.expNode},e.prototype.updateTopInfo=function(t){void 0===t&&(t="all"),"praise"==t&&this.expAnimation()},e.prototype.showReward=function(){var t=r.default.getInstance().limitActModel.foodFestival.allLevelUpArawd;if(t.length>0){var e=p.default.getAllReward(t,[]);c.default.getInstance().openUI(u.default,{data:e}),r.default.getInstance().limitActModel.foodFestival.allLevelUpArawd=[]}},e.prototype.expAnimation=function(t){var e=this;void 0===t&&(t=null);var i=this._foodModel.exp,a=this._foodModel.lv;if(a!=this._oldLevel/4||i!=this._oldExp/4)if(this._isExpAniFinished)this._isExpAniFinished=!1,this.updateExpAnimation(i,this._oldExp/4,a,this._oldLevel/4,function(){e.showReward(),e.updateActInfo(),e._isExpAniFinished=!0,"function"==typeof t&&t()});else{cc.tween(this.expProgress.node).stop(),this._oldLevel=4*parseInt(this.lvLab.string);var n=this.expLab.string,o=n.indexOf("/");this._oldExp=4*parseInt(n.slice(0,o)),this.updateExpAnimation(i,this._oldExp/4,a,this._oldLevel/4,function(){e.showReward(),e.updateActInfo(),e._isExpAniFinished=!0,"function"==typeof t&&t()})}else s.default.getInstance().mstActivity.foodFestival.config.lvData[a].exp<0&&c.default.getInstance().openUI(d.default,{data:{str:g.default.t("foodFestivalUI_2")}})},e.prototype.updateExpAnimation=function(t,e,i,a,n){var o=this.expLab,r=this.lvLab,c=this.expProgress,d=s.default.getInstance().mstActivity.foodFestival.config.lvData,l=cc.tween(c.node).call(function(){var s=function(){if(i==a){var l=d[a].exp,p={a:e};cc.tween(p).to(.5,{a:t},{progress:function(t,e,i,a){var n=Math.round(t+(e-t)*a);return l<0?(o.string=g.default.t("max"),c.progress=0):(o.string=n+"/"+l,c.progress=n/l),t+(e-t)*a}}).call(n).start()}else if(i>a){var u=d[a].exp;p={a:e},cc.tween(p).to(.5,{a:u},{progress:function(t,e,i,a){var n=Math.round(t+(e-t)*a);return u<0?(o.string=g.default.t("max"),c.progress=0):(o.string=n+"/"+u,c.progress=n/u),t+(e-t)*a}}).call(function(){e=0,a++,r.string=a+"",s()}).start()}};s()}),p=cc.tween(c.node).to(.5,{scale:1.2}).to(.5,{scale:1});return cc.tween(c.node).parallel(p,l).start()},o([_(cc.Label)],e.prototype,"timeLab",void 0),o([_(cc.Label)],e.prototype,"lvLab",void 0),o([_(cc.Label)],e.prototype,"expLab",void 0),o([_(cc.ProgressBar)],e.prototype,"expProgress",void 0),o([_(cc.Node)],e.prototype,"itemListContent",void 0),o([_(cc.Prefab)],e.prototype,"itemListPrefab",void 0),o([_(cc.Node)],e.prototype,"expNode",void 0),o([v],e)}(cc.Component);i.default=y,cc._RF.pop()},{"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/Toast":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../prefabs/AwardPopup":"AwardPopup","../scenes/MainScene":"MainScene","./ItemList":"ItemList"}],FreeBenefitsPopup:[function(t,e,i){"use strict";cc._RF.push(e,"11f799BR2hDrL2yRoZWnArg","FreeBenefitsPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MstData"),c=t("../../scripts/data/UserData"),d=t("../../scripts/manager/AdManager"),l=t("../../scripts/manager/UIManager"),p=t("../../scripts/utils/EventName"),u=t("../../scripts/utils/GlobalFun"),f=t("../../scripts/utils/StatisticsManager"),h=t("./AwardPopup"),g=t("./GashaponPopup"),m=t("./ShopPopup"),v=t("../../scripts/extension/LanguageData"),_=cc._decorator,y=_.ccclass,I=_.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lbTimes=[],e.awardNum=[],e.lbPrice=[],e.btnNode=[],e.videoIcon=[],e.gashapon=null,e.btnGoShop=null,e.btnGoGashapon=null,e}return n(e,t),e.prototype.init=function(){u.default.isCanShowBanner()&&d.default.getInstance().showBanner()},e.prototype.onLoad=function(){cc.director.getScene().on(p.default.UPDATE_BY_SECOND,this.updateBySecond,this),this.updateBySecond(),c.default.getInstance().level>=r.default.getInstance().mstActivity.gashapon.openLevel?this.gashapon.active=!0:this.gashapon.active=!1,this.residueTimes("dailyGift","1")<=0?(this.btnGoShop.interactable=!1,this.btnGoShop.node.getChildByName("lbPrice").getComponent(cc.LabelOutline).color=new cc.Color(116,116,116)):(this.btnGoShop.interactable=!0,this.btnGoShop.node.getChildByName("lbPrice").getComponent(cc.LabelOutline).color=new cc.Color(157,104,72))},e.prototype.updateBySecond=function(){this.updateUI(0,"dailyGift","2"),this.updateUI(1,"dailyGift","3"),this.updateUI(2,"resource","1"),this.updateUI(3,"resource","2"),this.updateUI(4,"resource","4"),this.updateGashpon()},e.prototype.updateGashpon=function(){if(c.default.getInstance().level>=r.default.getInstance().mstActivity.gashapon.openLevel){var t=c.default.getInstance().gashaponData.gashaponTimes,e=c.default.getInstance().gashaponData.buyCD-window.serverTime;t<6&&e<=0?(this.btnGoGashapon.interactable=!0,this.btnGoGashapon.node.getChildByName("lbPrice").getComponent(cc.LabelOutline).color=new cc.Color(157,104,72)):(this.btnGoGashapon.interactable=!1,this.btnGoGashapon.node.getChildByName("lbPrice").getComponent(cc.LabelOutline).color=new cc.Color(116,116,116))}},e.prototype.residueTimes=function(t,e){var i=c.default.getInstance().storeData[t][e].times;return r.default.getInstance().mstStore[t].config[e].limitNum-i},e.prototype.updateUI=function(t,e,i){var a=this.residueTimes(e,i);if(a>0&&a<=10?(this.lbTimes[t].node.active=!0,this.lbTimes[t].string=v.default.t("shopItem_1",{times:a})):(this.lbTimes[t].node.active=!1,this.lbTimes[t].string=v.default.t("shopItem_1",{times:a})),this.btnNode[t].interactable=!(a<=0),this.lbPrice[t].node.x=36.5,u.default.setBtnIsGrey(this.btnNode[t],new cc.Color(64,98,35)),a<=0)this.videoIcon[t].active=!1,this.lbPrice[t].string=v.default.t("shopItem_2"),this.lbPrice[t].node.x=0,this.lbPrice[t].node.getComponent(cc.LabelOutline).color=new cc.Color(116,116,116);else{this.videoIcon[t].active=!0;var n=d.default.getInstance().rewardAdCd;"resource"==e?n>0?(this.btnNode[t].interactable=!1,u.default.setBtnIsGrey(this.btnNode[t]),this.lbPrice[t].string=u.default.formatDateTimeHourEx(n)):this.lbPrice[t].string=v.default.t("free"):"dailyGift"==e&&n>0?(this.btnNode[t].interactable=!1,u.default.setBtnIsGrey(this.btnNode[t]),this.lbPrice[t].string=u.default.formatDateTimeHourEx(n)):this.lbPrice[t].string=v.default.t("free")}if(2==t||3==t||4==t){var o=r.default.getInstance().mstStore[e].config[i].itemNum;this.awardNum[t-2].string="+"+o}},e.prototype.trackEvent=function(t,e){0==t?f.default.trackEventOnXG("video","\u6bcf\u65e5\u798f\u5229-\u4f53\u529b\u5b9d\u7bb1",6,e):1==t?f.default.trackEventOnXG("video","\u6bcf\u65e5\u798f\u5229-\u52a0\u901f\u9053\u5177",6,e):2==t?f.default.trackEventOnXG("video","\u8865\u5145\u4f53\u529b",4,e):3==t&&f.default.trackEventOnXG("video","\u6bcf\u65e5\u8d44\u6e90-\u514d\u8d39\u94bb\u77f3",6,e)},e.prototype.onClickGoShop=function(){l.default.getInstance().openUI(m.default,{data:{key:"dailyGift",type:1}}),this.onClose()},e.prototype.onClickGoGashapon=function(){l.default.getInstance().openUI(g.default),this.onClose()},e.prototype.buyItem=function(t,e,i){var a=this;f.default.trackEventOnXG("common","Ad_button_click"),this.trackEvent(t,0);var n=c.default.getInstance().storeData,o=!1,s=r.default.getInstance().mstStore[e].config,p=s[i].itemId,g=1;"resource"==e&&(g=s[i].itemNum);var m={id:p,num:g};d.default.getInstance().showRewardAd(function(){a.trackEvent(t,1),"dailyGift"==e?o=n.buyItem("dailyGift",i):"resource"==e&&(o=n.buyItem("resource",i)),o?(l.default.getInstance().openUI(h.default,{data:[m]}),a.updateUI(t,e,i)):u.default.noDiamondsCommonPopup()},function(){},function(){})},e.prototype.onClickBuyEngerBox=function(){this.buyItem(0,"dailyGift","2")},e.prototype.onClickBuyFastItem=function(){this.buyItem(1,"dailyGift","3")},e.prototype.onClickEnger=function(){this.buyItem(2,"resource","1")},e.prototype.onClickDiamond=function(){this.buyItem(3,"resource","2")},e.prototype.onClickSkinTicket=function(){this.buyItem(4,"resource","4")},e.prototype.onDestroy=function(){u.default.isCanShowBanner()&&d.default.getInstance().hideBanner()},e.uiName="FreeBenefitsPopup",o([I([cc.Label])],e.prototype,"lbTimes",void 0),o([I([cc.Label])],e.prototype,"awardNum",void 0),o([I([cc.Label])],e.prototype,"lbPrice",void 0),o([I([cc.Button])],e.prototype,"btnNode",void 0),o([I([cc.Node])],e.prototype,"videoIcon",void 0),o([I(cc.Node)],e.prototype,"gashapon",void 0),o([I(cc.Button)],e.prototype,"btnGoShop",void 0),o([I(cc.Button)],e.prototype,"btnGoGashapon",void 0),o([y],e)}(s.default);i.default=b,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../../scripts/utils/StatisticsManager":void 0,"./AwardPopup":"AwardPopup","./GashaponPopup":"GashaponPopup","./ShopPopup":"ShopPopup"}],GameClubPopup:[function(t,e,i){"use strict";cc._RF.push(e,"03ac2RHwtpI6rTi3ND6OvQE","GameClubPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/UserData"),c=t("../../scripts/manager/AdManager"),d=t("../../scripts/manager/SDKManager"),l=t("../../scripts/manager/UIManager"),p=t("../../scripts/prefabs/Loading"),u=t("../../scripts/utils/Api"),f=t("../../scripts/utils/EventName"),h=cc._decorator,g=h.ccclass,m=h.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnNode=null,e}return n(e,t),e.prototype.init=function(){c.default.getInstance().showBanner(),d.default.getInstance().showGameClub(this.btnNode)},e.prototype.onLoad=function(){},e.prototype.onDestroy=function(){c.default.getInstance().hideBanner(),d.default.getInstance().hideGameClub(),l.default.getInstance().openUI(p.default,{},function(){u.default.mail.send({type:"getData",para:JSON.stringify({})},function(t){cc.log("\u83b7\u53d6\u90ae\u4ef6\u8fd4\u56de",t),r.default.getInstance().updateUserData(t),cc.director.getScene().emit(f.default.UPDATE_ACTIVITY),l.default.getInstance().closeUI(p.default)},function(){l.default.getInstance().closeUI(p.default)})})},e.uiName="GameClubPopup",o([m(cc.Node)],e.prototype,"btnNode",void 0),o([g],e)}(s.default);i.default=v,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/UserData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/SDKManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/Loading":void 0,"../../scripts/utils/Api":void 0,"../../scripts/utils/EventName":void 0}],GashaponAwardItem:[function(t,e,i){"use strict";cc._RF.push(e,"931f24EJFtF4YqaMzqzYP1a","GashaponAwardItem");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/UserData"),r=t("./ItemEntity"),c=cc._decorator,d=c.ccclass,l=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bg=null,e.itemNode=null,e.received=null,e._itemID=0,e}return n(e,t),e.prototype.initItem=function(t,e){this._itemID=t;var i={};i.itemId=t,i.itemNum=e>1?e:0,i.itemBg=this.bg,i.isShowInfo=!0,i.isClickAble=!0,i.bgSize=cc.v2(170,170),this.itemNode.getComponent(r.default).init(i),this.refreshReceived()},e.prototype.refreshReceived=function(){-1!==s.default.getInstance().gashaponData.gashaponRewardId.indexOf(this._itemID)?this.received.active=!0:this.received.active=!1},o([l(cc.SpriteFrame)],e.prototype,"bg",void 0),o([l(cc.Node)],e.prototype,"itemNode",void 0),o([l(cc.Node)],e.prototype,"received",void 0),o([d],e)}(cc.Component);i.default=p,cc._RF.pop()},{"../../scripts/data/UserData":void 0,"./ItemEntity":"ItemEntity"}],GashaponPopup:[function(t,e,i){"use strict";cc._RF.push(e,"a21d9AOkXpJXZxzJZvcvFCO","GashaponPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MstData"),c=t("../../scripts/data/UserData"),d=t("../../scripts/manager/AdManager"),l=t("../../scripts/manager/AudioManager"),p=t("../../scripts/manager/UIManager"),u=t("../../scripts/prefabs/Loading"),f=t("../../scripts/prefabs/Toast"),h=t("../../scripts/utils/EventName"),g=t("../../scripts/utils/GlobalFun"),m=t("../../scripts/utils/StatisticsManager"),v=t("../entitys/GashaponAwardItem"),_=t("./AwardPopup"),y=t("../../scripts/extension/LanguageData"),I=cc._decorator,b=I.ccclass,N=I.property,C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gashapon=null,e.awardPre=null,e.scroll=null,e.btnLab=null,e.btnPlay=null,e.videoIcon=null,e.awardNiu=null,e.btnRight=null,e.btnLeft=null,e.niudan=[],e._curAwardIdx=0,e._isStart=!1,e}return n(e,t),e.prototype.init=function(){var t=this;this.refushNewDay(),this.gashapon.on("finished",function(){t.onFinish()}),g.default.isCanShowBanner()&&d.default.getInstance().showBanner()},e.prototype.refushNewDay=function(){this._curAwardIdx=-1;for(var t=c.default.getInstance().gashaponData.gashaponTimes,e=0;e<this.niudan.length;e++)e<t?this.niudan[e].active=!1:(-1==this._curAwardIdx&&(this._curAwardIdx=e),this.niudan[e].active=!0);this.refreshBtnState();var i=r.default.getInstance().mstActivity.gashapon.config.items;for(e=0;e<i.length;e++){var a;this.scroll.content.children[e]?(a=this.scroll.content.children[e]).getComponent(v.default).initItem(i[e].id,i[e].num):((a=cc.instantiate(this.awardPre)).getComponent(v.default).initItem(i[e].id,i[e].num),this.scroll.content.addChild(a))}this.btnRight.active=!0,this.btnLeft.active=!1},e.prototype.onFinish=function(){var t=this,e=c.default.getInstance().getGashaponAwardIndex();cc.director.getScene().emit(h.default.UPDATE_ACTIVITY),e>0?(this.refreshBtnState(),this.niudan[this._curAwardIdx].active=!1,this.awardNiu.getComponent(cc.Sprite).spriteFrame=this.niudan[this._curAwardIdx].getComponent(cc.Sprite).spriteFrame,this._curAwardIdx++,cc.tween(this.awardNiu).delay(.5).to(.4,{position:cc.v3(0,0,0)}).to(.1,{position:cc.v3(0,20,0)}).to(.05,{position:cc.v3(0,0,0)}).delay(.5).call(function(){t._isStart=!1,t.awardNiu.setPosition(cc.v3(0,195,0)),p.default.getInstance().closeUI(u.default);for(var i=r.default.getInstance().mstActivity.gashapon.config.items,a=0;a<i.length;a++)if(e==i[a].id){var n=[{id:i[a].id,num:i[a].num}];p.default.getInstance().openUI(_.default,{data:n});break}t.refreshAwardState()}).start()):(this._isStart=!1,p.default.getInstance().openUI(f.default,{data:{str:y.default.t("gashagonPopup_1")}}),p.default.getInstance().closeUI(u.default))},e.prototype.refreshAwardState=function(){for(var t=this.scroll.content.children,e=0;e<t.length;e++)t[e].getComponent(v.default).refreshReceived()},e.prototype.refreshBtnState=function(){var t=c.default.getInstance().gashaponData.gashaponTimes;if(0==t)this.btnLab.string=y.default.t("free"),this.videoIcon.active=!1,this.btnPlay.interactable=!0;else{var e=d.default.getInstance().rewardAdCd;e>0?(this.btnPlay.interactable=!1,g.default.setBtnIsGrey(this.btnPlay),this.btnLab.string=g.default.formatDateTimeHourEx(e)):(this.videoIcon.active=!0,this.btnLab.string=y.default.t("gashagonPopup_2"),this.btnPlay.interactable=t<6)}},e.prototype.onGetGashaponClicked=function(){var t=this;if(!this._isStart){var e=c.default.getInstance().gashaponData.gashaponTimes;e>=this.niudan.length?p.default.getInstance().openUI(f.default,{data:{str:y.default.t("gashagonPopup_1")}}):0==e?(m.default.trackEvent("gashapon_video_times",{times:""+(e+1)}),m.default.trackEvent("gashapon_free"),p.default.getInstance().openUI(u.default,{data:{showBlack:!1}},function(){l.default.getInstance().playEffect("roll"),t.gashapon.play()})):(m.default.trackEvent("gashapon_video_click"),m.default.trackEventOnXG("common","Ad_button_click"),m.default.trackEventOnXG("video","\u52c7\u6562\u626d\u626d",13,0),d.default.getInstance().showRewardAd(function(){m.default.trackEventOnXG("video","\u52c7\u6562\u626d\u626d",13,1),m.default.trackEvent("gashapon_video_times",{times:""+(e+1)}),m.default.trackEvent("gashapon_video_success"),p.default.getInstance().openUI(u.default,{data:{showBlack:!1}},function(){t._isStart=!0,l.default.getInstance().playEffect("roll"),t.gashapon.play()})},function(){m.default.trackEvent("gashapon_video_fail")},function(){m.default.trackEvent("gashapon_video_err")}))}},e.prototype.onScrollViewEvent=function(t,e){e==cc.ScrollView.EventType.SCROLL_TO_RIGHT?(this.btnRight.active=!1,this.btnLeft.active=!0):e==cc.ScrollView.EventType.SCROLL_TO_LEFT&&(this.btnRight.active=!0,this.btnLeft.active=!1)},e.prototype.ontClickeBtnRight=function(){this.scroll.scrollToRight(.05),this.btnRight.active=!1,this.btnLeft.active=!0},e.prototype.ontClickeBtnLeft=function(){this.scroll.scrollToLeft(.05),this.btnRight.active=!0,this.btnLeft.active=!1},e.prototype.onLoad=function(){m.default.trackEvent("gashapon_open"),cc.director.getScene().on(h.default.UPDATE_BY_SECOND,this.refreshBtnState,this),cc.director.getScene().on(h.default.NEW_DAY,this.refushNewDay,this)},e.prototype.onDestroy=function(){g.default.isCanShowBanner()&&d.default.getInstance().hideBanner()},e.uiName="GashaponPopup",o([N(cc.Animation)],e.prototype,"gashapon",void 0),o([N(cc.Prefab)],e.prototype,"awardPre",void 0),o([N(cc.ScrollView)],e.prototype,"scroll",void 0),o([N(cc.Label)],e.prototype,"btnLab",void 0),o([N(cc.Button)],e.prototype,"btnPlay",void 0),o([N(cc.Node)],e.prototype,"videoIcon",void 0),o([N(cc.Node)],e.prototype,"awardNiu",void 0),o([N(cc.Node)],e.prototype,"btnRight",void 0),o([N(cc.Node)],e.prototype,"btnLeft",void 0),o([N([cc.Node])],e.prototype,"niudan",void 0),o([b],e)}(s.default);i.default=C,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/AudioManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/Loading":void 0,"../../scripts/prefabs/Toast":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../../scripts/utils/StatisticsManager":void 0,"../entitys/GashaponAwardItem":"GashaponAwardItem","./AwardPopup":"AwardPopup"}],GreatValueGiftItem:[function(t,e,i){"use strict";cc._RF.push(e,"eace0D1us9JBKt6OuTrvaad","GreatValueGiftItem");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/MstData"),r=t("../../scripts/data/UserData"),c=t("../../scripts/manager/AdManager"),d=t("../../scripts/manager/UIManager"),l=t("../../scripts/utils/GlobalFun"),p=t("../../scripts/utils/StatisticsManager"),u=t("../extension/ListItem"),f=t("../prefabs/AwardPopup"),h=t("./PassAwardItem"),g=t("../../scripts/extension/LanguageData"),m=cc._decorator,v=m.ccclass,_=m.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.awardItem=null,e.videoCount=null,e.giftName=null,e.btnGetTaskAward=null,e.lbVideo=null,e.receivedNode=null,e.itemRootNode=null,e._giftId=null,e._giftMstData=null,e._giftData=null,e._parent=null,e}return n(e,t),e.prototype.initGreatItemInfo=function(t,e){this._giftId=t,this._giftMstData=s.default.getInstance().mstActivity.greatValueGift.config.gifts[this._giftId],this._giftData=r.default.getInstance().greatValueGift.giftData[this._giftId],this._parent=e,this._giftData.isReceived?(this.btnGetTaskAward.node.active=!1,this.receivedNode.active=!0):(this.btnGetTaskAward.node.active=!0,this.receivedNode.active=!1),this.videoCount.string="("+this._giftData.videoCount+"/"+this._giftMstData.costNum+")",this.giftName.string=this._giftMstData.giftName,this.initItemAward(),this.refushVideoCD()},e.prototype.refushVideoCD=function(){if(this.btnGetTaskAward.node.active){var t=c.default.getInstance().rewardAdCd;t>0?(this.btnGetTaskAward.interactable=!1,l.default.setBtnIsGrey(this.btnGetTaskAward),this.lbVideo.string=l.default.formatDateTimeHourEx(t)):(this.btnGetTaskAward.interactable=!0,l.default.setBtnIsGrey(this.btnGetTaskAward,new cc.Color(64,98,35)),this.lbVideo.string=g.default.t("receive"))}},e.prototype.initItemAward=function(){this.itemRootNode.removeAllChildren();for(var t=this._giftMstData.reward,e=0;e<t.length;e++)this.initItemUI(t[e],1,this.itemRootNode);var i=l.default.rewardResToObj(this._giftMstData.rewardRes);for(var a in i)this.initItemUI(Number(a),i[a],this.itemRootNode)},e.prototype.initItemUI=function(t,e,i){var a=cc.instantiate(this.awardItem);a.getComponent(h.default).initItem(t,e,3),i.addChild(a)},e.prototype.onGetTaskAward=function(){var t=this;p.default.trackEvent("greatValueGift_video_click",{giftName:""+this._giftMstData.giftName}),p.default.trackEventOnXG("common","Ad_button_click"),p.default.trackEventOnXG("video","\u8d85\u503c\u793c\u5305",7,0),c.default.getInstance().showRewardAd(function(){p.default.trackEventOnXG("video","\u8d85\u503c\u793c\u5305",7,1),p.default.trackEvent("greatValueGift_video_success",{giftName:""+t._giftMstData.giftName}),t.getReward(),t._parent.updateRewardCD()},function(){p.default.trackEvent("greatValueGift_video_fail",{giftName:""+t._giftMstData.giftName})},function(){p.default.trackEvent("greatValueGift_video_err",{giftName:""+t._giftMstData.giftName})})},e.prototype.getReward=function(){if(r.default.getInstance().greatValueGift.addGreatValueGiftVideoCount(this._giftId)&&(this.videoCount.string="("+this._giftData.videoCount+"/"+this._giftMstData.costNum+")",this._giftData.videoCount>=this._giftMstData.costNum)){p.default.trackEvent("greatValueGift_receive_reward",{giftName:""+this._giftMstData.giftName});var t=[],e=l.default.rewardResToObj(this._giftMstData.rewardRes);for(var i in e)t.push({id:Number(i),num:e[i]});for(var a=0;a<this._giftMstData.reward.length;a++)t.push({id:this._giftMstData.reward[a],num:1});d.default.getInstance().openUI(f.default,{data:t}),this._parent.refreshGetAward()}},o([_(cc.Prefab)],e.prototype,"awardItem",void 0),o([_(cc.Label)],e.prototype,"videoCount",void 0),o([_(cc.Label)],e.prototype,"giftName",void 0),o([_(cc.Button)],e.prototype,"btnGetTaskAward",void 0),o([_(cc.Label)],e.prototype,"lbVideo",void 0),o([_(cc.Node)],e.prototype,"receivedNode",void 0),o([_(cc.Node)],e.prototype,"itemRootNode",void 0),o([v],e)}(u.default);i.default=y,cc._RF.pop()},{"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/utils/GlobalFun":void 0,"../../scripts/utils/StatisticsManager":void 0,"../extension/ListItem":"ListItem","../prefabs/AwardPopup":"AwardPopup","./PassAwardItem":"PassAwardItem"}],GreatValueGiftPopup:[function(t,e,i){"use strict";cc._RF.push(e,"28fa42zG0RHT51BFHD6ryQ5","GreatValueGiftPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/UserData"),c=t("../../scripts/manager/AdManager"),d=t("../../scripts/utils/EventName"),l=t("../../scripts/utils/GlobalFun"),p=t("../../scripts/utils/StatisticsManager"),u=t("../entitys/GreatValueGiftItem"),f=t("../extension/List"),h=t("../../scripts/extension/LanguageData"),g=cc._decorator,m=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.listElement=null,e.timelab=null,e._greatList=null,e._greatValueGiftModel=null,e}return n(e,t),e.prototype.init=function(){this._greatValueGiftModel=r.default.getInstance().greatValueGift,this.refreshGreatList(),l.default.isCanShowBanner()&&c.default.getInstance().showBanner()},e.prototype.refreshGreatList=function(){var t=this._greatValueGiftModel.giftData,e=this._greatValueGiftModel.config,i=r.default.getInstance().level,a=[];for(var n in e)i>=e[n].minLv&&(e[n].isReceived=t[n].isReceived,e[n].giftId=n,a.push(e[n]));a.sort(function(t,e){return t.index-e.index}),a.sort(function(t,e){return t.isReceived-e.isReceived}),this._greatList=a},e.prototype.itemElementRender=function(t,e){t.getComponent(u.default).initGreatItemInfo(this._greatList[e].giftId,this)},e.prototype.refreshGetAward=function(){this.refreshGreatList(),this.listElement.numItems=this._greatList.length},e.prototype.updateBySecond=function(){var t=l.default.getDateByYMD(),e=(new Date(t).getTime()+864e5)/1e3-window.serverTime,i=l.default.formatDateTimeHourEx(e);this.timelab.string=h.default.t("levelAwardPopup_2",{time:i}),this.updateRewardCD()},e.prototype.refushNewDay=function(){this._greatValueGiftModel=r.default.getInstance().greatValueGift,this.refreshGreatList(),this.listElement.numItems=this._greatList.length},e.prototype.updateRewardCD=function(){for(var t=this.listElement.content.children,e=0;e<t.length;e++)t[e].getComponent(u.default).refushVideoCD()},e.prototype.onLoad=function(){p.default.trackEvent("greatValueGift_open"),this.listElement.numItems=this._greatList.length,this.updateBySecond(),cc.director.getScene().on(d.default.UPDATE_BY_SECOND,this.updateBySecond,this),cc.director.getScene().on(d.default.NEW_DAY,this.refushNewDay,this)},e.prototype.onDestroy=function(){l.default.isCanShowBanner()&&c.default.getInstance().hideBanner()},e.uiName="GreatValueGiftPopup",o([v(f.default)],e.prototype,"listElement",void 0),o([v(cc.Label)],e.prototype,"timelab",void 0),o([m],e)}(s.default);i.default=_,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../../scripts/utils/StatisticsManager":void 0,"../entitys/GreatValueGiftItem":"GreatValueGiftItem","../extension/List":"List"}],GrowthFundItem:[function(t,e,i){"use strict";cc._RF.push(e,"28bf9Wk8ppK9YqJiLo3EFkh","GrowthFundItem");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/UserData"),r=t("../../scripts/manager/AdManager"),c=t("../../scripts/manager/UIManager"),d=t("../../scripts/prefabs/Toast"),l=t("../../scripts/utils/EventName"),p=t("../../scripts/utils/GlobalFun"),u=t("../prefabs/AwardPopup"),f=t("../prefabs/ItemChain"),h=t("./ItemEntity"),g=t("../../scripts/extension/LanguageData"),m=cc._decorator,v=m.ccclass,_=m.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnBg=[],e.itemBg=[],e.itemNode=[],e.bgSprite=null,e.btnGetAward=null,e.lbPrice=null,e.btnUnReceive=null,e.btnUnLock=null,e.progressTop=null,e.progressBom=null,e.levelLab=null,e.costNum=null,e._levelInfo=null,e._rewardList=[],e._parent=null,e}return n(e,t),e.prototype.init=function(t,e,i){this._levelInfo=t,this._parent=i;var a=s.default.getInstance().level;1==t.idx?(this.progressTop.node.active=!1,this.progressBom.node.active=!0):e?(this.progressTop.node.active=!0,this.progressBom.node.active=!1):(this.progressTop.node.active=!0,this.progressBom.node.active=!0);var n=s.default.getInstance().growthFundData.receiveData[t.lv];if(a>t.lv)if(this.bgSprite.spriteFrame=this.btnBg[0],this.progressTop.progress=1,this.progressBom.progress=1,this.btnUnLock.active=!1,n&&n.isReceive)this.btnGetAward.node.active=!1,this.btnUnReceive.active=!0;else{this.btnGetAward.node.active=!0,this.btnUnReceive.active=!1;var o=0;n&&n.videoCount&&(o=n.videoCount),this.costNum.string=o+"/"+t.costNum}else a==t.lv?(this.bgSprite.spriteFrame=this.btnBg[0],this.progressTop.progress=1,this.progressBom.progress=0,this.btnUnLock.active=!1,n&&n.isReceive?(this.btnGetAward.node.active=!1,this.btnUnReceive.active=!0):(this.btnGetAward.node.active=!0,this.btnUnReceive.active=!1,o=0,n&&n.videoCount&&(o=n.videoCount),this.costNum.string=o+"/"+t.costNum)):(t.lv,this.bgSprite.spriteFrame=this.btnBg[1],this.progressTop.progress=0,this.progressBom.progress=0,this.btnGetAward.node.active=!1,this.btnUnReceive.active=!1,this.btnUnLock.active=!0);this.levelLab.string=t.lv,this.initRewardData(t),this.refushVideoCD()},e.prototype.initRewardData=function(t){this._rewardList=[],this.itemNode[0].active=!1,this.itemNode[1].active=!1;var e=0;if(t.reward.length>0)for(var i=0;i<t.reward.length&&(p.default.getItemIconPathById(t.reward[i]+"")&&(this.itemNode[e].active=!0,(o={}).itemId=t.reward[i],o.itemBg=this.itemBg[0],o.isShowInfo=!0,o.isClickAble=!0,o.itemNum=1,o.iconScale=.8,this.itemNode[e].getComponent(h.default).init(o),this._rewardList.push({id:t.reward[i],num:1})),!(++e>=2));i++);if(e<2){var a=p.default.rewardResToObj(t.rewardRes);for(var n in a){var o;if(p.default.getItemIconPathById(n)&&(this.itemNode[e].active=!0,(o={}).itemId=n,o.itemBg=this.itemBg[0],o.isShowInfo=!0,o.isClickAble=!0,o.itemNum=a[n],o.iconScale=.8,this.itemNode[e].getComponent(h.default).init(o),this._rewardList.push({id:Number(n),num:a[n]})),++e>=2)break}}},e.prototype.refushVideoCD=function(){if(this.btnGetAward.node.active){var t=r.default.getInstance().rewardAdCd;t>0?(this.btnGetAward.interactable=!1,p.default.setBtnIsGrey(this.btnGetAward),this.lbPrice.string=p.default.formatDateTimeHourEx(t)):(this.btnGetAward.interactable=!0,p.default.setBtnIsGrey(this.btnGetAward,new cc.Color(64,98,35)),this.lbPrice.string=g.default.t("free"))}},e.prototype.onClickItem1=function(){this._levelInfo.reward.length>0&&c.default.getInstance().openUI(f.default,{data:this._levelInfo.reward[0]})},e.prototype.onClickItem2=function(){this._levelInfo.reward.length>1&&c.default.getInstance().openUI(f.default,{data:this._levelInfo.reward[1]})},e.prototype.onClickGetAward=function(){var t=this;this._levelInfo.lv>s.default.getInstance().growthFundData.curAwardLv?c.default.getInstance().openUI(d.default,{data:{str:g.default.t("childrenDayGiftPopup_5")}}):r.default.getInstance().showRewardAd(function(){if(s.default.getInstance().growthFundData.receiveReward(t._levelInfo.lv))t.btnGetAward.node.active=!1,t.btnUnReceive.active=!0,t.btnUnLock.active=!1,t._rewardList.length>0&&c.default.getInstance().openUI(u.default,{data:t._rewardList}),t._parent.updateRewardCD();else{var e=s.default.getInstance().growthFundData.receiveData[t._levelInfo.lv],i=0;e&&e.videoCount&&(i=e.videoCount),t.costNum.string=i+"/"+t._levelInfo.costNum}cc.director.getScene().emit(l.default.UPDATE_ACTIVITY)},function(){},function(){})},e.prototype.onClickOpenGrowthFund=function(){},o([_([cc.SpriteFrame])],e.prototype,"btnBg",void 0),o([_([cc.SpriteFrame])],e.prototype,"itemBg",void 0),o([_([cc.Node])],e.prototype,"itemNode",void 0),o([_(cc.Sprite)],e.prototype,"bgSprite",void 0),o([_(cc.Button)],e.prototype,"btnGetAward",void 0),o([_(cc.Label)],e.prototype,"lbPrice",void 0),o([_(cc.Node)],e.prototype,"btnUnReceive",void 0),o([_(cc.Node)],e.prototype,"btnUnLock",void 0),o([_(cc.ProgressBar)],e.prototype,"progressTop",void 0),o([_(cc.ProgressBar)],e.prototype,"progressBom",void 0),o([_(cc.Label)],e.prototype,"levelLab",void 0),o([_(cc.Label)],e.prototype,"costNum",void 0),o([v],e)}(cc.Component);i.default=y,cc._RF.pop()},{"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/Toast":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../prefabs/AwardPopup":"AwardPopup","../prefabs/ItemChain":"ItemChain","./ItemEntity":"ItemEntity"}],GrowthFundPopup:[function(t,e,i){"use strict";cc._RF.push(e,"2e8a74vVtxDn6Gb3k9pimcH","GrowthFundPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MstData"),c=t("../../scripts/data/UserData"),d=t("../../scripts/utils/EventName"),l=t("../entitys/GrowthFundItem"),p=t("../extension/List"),u=cc._decorator,f=u.ccclass,h=u.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.listElement=null,e._taskItemList=[],e._curAwardIdx=-1,e}return n(e,t),e.prototype.init=function(){for(var t=r.default.getInstance().mstLevelup,e=1,i=1;t[e];){if(t[e].growthFundReward.length>0||t[e].growthFundRewardRes.length>0){var a={};a.idx=i,a.lv=e,a.reward=t[e].growthFundReward,a.rewardRes=t[e].growthFundRewardRes,a.costNum=t[e].growthFundVideoTimes,this._taskItemList.push(a),c.default.getInstance().growthFundData.receiveData[e]&&c.default.getInstance().growthFundData.receiveData[e].isReceive||-1!==this._curAwardIdx||(this._curAwardIdx=i-1),i++}e++}},e.prototype.onRefushList=function(){this.listElement.numItems=this._taskItemList.length,this.listElement.scrollTo(this._curAwardIdx)},e.prototype.itemElementRender=function(t,e){t.getComponent(l.default).init(this._taskItemList[e],e==this._taskItemList.length-1,this)},e.prototype.updateLevelTask=function(){this.onRefushList()},e.prototype.updateBySecond=function(){this.updateRewardCD()},e.prototype.updateRewardCD=function(){for(var t=this.listElement.content.children,e=0;e<t.length;e++)t[e].getComponent(l.default).refushVideoCD()},e.prototype.onLoad=function(){this.updateLevelTask(),cc.director.getScene().on(d.default.UPDATE_BY_SECOND,this.updateBySecond,this)},e.uiName="GrowthFundPopup",o([h(p.default)],e.prototype,"listElement",void 0),o([f],e)}(s.default);i.default=g,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/utils/EventName":void 0,"../entitys/GrowthFundItem":"GrowthFundItem","../extension/List":"List"}],GuidanceManager:[function(t,e,i){"use strict";cc._RF.push(e,"af1e8K5CLVF176s1U99Jn/4","GuidanceManager");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/MiscConfig"),r=t("../../scripts/data/MiscData"),c=t("../../scripts/data/MstData"),d=t("../../scripts/data/UserData"),l=t("../../scripts/manager/UIManager"),p=t("../../scripts/prefabs/Loading"),u=t("../../scripts/utils/EventName"),f=t("../../scripts/utils/GlobalFun"),h=t("../../scripts/utils/StatisticsManager"),g=t("../entitys/BuildTaskBubble"),m=t("../entitys/HemaPrefab"),v=t("../entitys/TopInfoTaskItem"),_=t("../scenes/MainScene"),y=t("./AtlasPopup"),I=t("./BagPopup"),b=t("./BuildCompletePopup"),N=t("./BuildInfoPopup"),C=t("./BuildTaskPopup"),k=t("./ChildrenDayGiftPopup"),S=t("./ChildrenDayPopup"),w=t("./ChristmasAniPopup"),T=t("./ChristmasPopup"),P=t("./ContractPopup"),D=t("./CustomerInfoPopup"),A=t("./Guide"),B=t("./HappyBingoHelpPopup"),E=t("./HappyBingoPopup"),L=t("./HelpPopup"),M=t("./ItemChain"),O=t("./LockAreaItem"),U=t("./NewUserGiftPopup"),x=t("./NewYearAniPopup"),R=t("./NewYearExchangePopup"),G=t("./NewYearPopup"),F=t("./OpeningPopup"),j=t("./PassPopup"),V=t("./ShopPopup"),H=t("./TaskPopup"),z=t("./UnlockShowPopup"),Y=t("../../scripts/extension/LanguageData"),W=cc._decorator,K=W.ccclass,X=(W.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.GUIDANCETALK={1:Y.default.t("GuidanceManager_1"),"1_1":Y.default.t("GuidanceManager_1_1"),"1_2":Y.default.t("GuidanceManager_1_2"),"1_3":Y.default.t("GuidanceManager_1_3"),"1_4":Y.default.t("GuidanceManager_1_4"),"1_6":Y.default.t("GuidanceManager_1_6"),"1_7":Y.default.t("GuidanceManager_1_7"),"1_8":Y.default.t("GuidanceManager_1_8"),2:Y.default.t("GuidanceManager_2"),3:Y.default.t("GuidanceManager_3"),4:Y.default.t("GuidanceManager_4"),5:Y.default.t("GuidanceManager_5"),6:Y.default.t("GuidanceManager_6"),7:Y.default.t("GuidanceManager_7"),"7_1":Y.default.t("GuidanceManager_7_1"),"7_2":Y.default.t("GuidanceManager_7_2"),"7_3":Y.default.t("GuidanceManager_7_3"),8:Y.default.t("GuidanceManager_8"),"8_1":Y.default.t("GuidanceManager_8_1"),9:Y.default.t("GuidanceManager_9"),10:Y.default.t("GuidanceManager_10"),11:Y.default.t("GuidanceManager_11"),12:Y.default.t("GuidanceManager_12"),13:Y.default.t("GuidanceManager_13"),14:Y.default.t("GuidanceManager_14"),15:Y.default.t("GuidanceManager_15"),"15_1":Y.default.t("GuidanceManager_15_1"),"15_2":Y.default.t("GuidanceManager_15_2"),"15_3":Y.default.t("GuidanceManager_15_3"),16:Y.default.t("GuidanceManager_16"),"16_1":Y.default.t("GuidanceManager_16_1"),"16_2":Y.default.t("GuidanceManager_16_2"),17:Y.default.t("GuidanceManager_17"),18:Y.default.t("GuidanceManager_18"),19:Y.default.t("GuidanceManager_19"),20:Y.default.t("GuidanceManager_20"),21:Y.default.t("GuidanceManager_21"),22:Y.default.t("GuidanceManager_22"),23:Y.default.t("GuidanceManager_23"),"24_1":Y.default.t("GuidanceManager_24_1"),31:Y.default.t("GuidanceManager_31"),32:Y.default.t("GuidanceManager_32"),33:Y.default.t("GuidanceManager_33"),34:Y.default.t("GuidanceManager_34"),35:Y.default.t("GuidanceManager_35"),"28_2":Y.default.t("GuidanceManager_28_2"),"28_3":Y.default.t("GuidanceManager_28_3"),"28_4":Y.default.t("GuidanceManager_28_4"),"28_5":Y.default.t("GuidanceManager_28_5"),"28_6":Y.default.t("GuidanceManager_28_6"),"29_1":Y.default.t("GuidanceManager_29_1"),25:Y.default.t("GuidanceManager_25"),"25_1":Y.default.t("GuidanceManager_25_1"),"25_2":Y.default.t("GuidanceManager_25_2"),"25_3":Y.default.t("GuidanceManager_25_3"),26:Y.default.t("GuidanceManager_26"),27:Y.default.t("GuidanceManager_27"),"27_1":Y.default.t("GuidanceManager_27_1"),"27_2":Y.default.t("GuidanceManager_27_2"),"27_3":Y.default.t("GuidanceManager_27_3"),"27_4":Y.default.t("GuidanceManager_27_4"),30:Y.default.t("GuidanceManager_30"),"30_1":Y.default.t("GuidanceManager_30_1"),"30_2":Y.default.t("GuidanceManager_30_2"),"30_3":Y.default.t("GuidanceManager_30_3"),"30_4":Y.default.t("GuidanceManager_30_4"),36:Y.default.t("GuidanceManager_36"),"36_1":Y.default.t("GuidanceManager_36_1"),"36_2":Y.default.t("GuidanceManager_36_2"),38:Y.default.t("GuidanceManager_38"),"38_1":Y.default.t("GuidanceManager_38_1"),"38_2":Y.default.t("GuidanceManager_38_2"),"38_3":Y.default.t("GuidanceManager_38_3"),"38_4":Y.default.t("GuidanceManager_38_4"),39:Y.default.t("GuidanceManager_39"),"39_1":Y.default.t("GuidanceManager_39_1"),"39_2":Y.default.t("GuidanceManager_39_2"),"39_3":Y.default.t("GuidanceManager_39_3"),"39_5":Y.default.t("GuidanceManager_39_5"),"39_6":Y.default.t("GuidanceManager_39_6"),40:Y.default.t("GuidanceManager_40"),"40_3":Y.default.t("GuidanceManager_40_3"),"40_4":Y.default.t("GuidanceManager_40_4"),"40_5":Y.default.t("GuidanceManager_40_5"),41:Y.default.t("GuidanceManager_41"),"41_1":Y.default.t("GuidanceManager_41_1"),"41_2":Y.default.t("GuidanceManager_41_2"),"41_3":Y.default.t("GuidanceManager_41_3"),"41_5":Y.default.t("GuidanceManager_41_5"),"41_7":Y.default.t("GuidanceManager_41_7"),42:Y.default.t("GuidanceManager_42"),"42_1":Y.default.t("GuidanceManager_42_1"),"42_2":Y.default.t("GuidanceManager_42_2"),"42_3":Y.default.t("GuidanceManager_42_3"),"42_4":Y.default.t("GuidanceManager_42_4"),"42_5":Y.default.t("GuidanceManager_42_5"),"42_6":Y.default.t("GuidanceManager_42_6"),"42_7":Y.default.t("GuidanceManager_42_7"),43:Y.default.t("GuidanceManager_43"),"43_2":Y.default.t("GuidanceManager_43_2"),"43_3":Y.default.t("GuidanceManager_43_3"),"43_4":Y.default.t("GuidanceManager_43_4"),"43_5":Y.default.t("GuidanceManager_43_5"),100:Y.default.t("GuidanceManager_100"),101:Y.default.t("GuidanceManager_101"),102:Y.default.t("GuidanceManager_102"),103:Y.default.t("GuidanceManager_103"),105:Y.default.t("GuidanceManager_105"),106:Y.default.t("GuidanceManager_106"),108:Y.default.t("GuidanceManager_108"),200:Y.default.t("GuidanceManager_200"),201:Y.default.t("GuidanceManager_201"),202:Y.default.t("GuidanceManager_202"),203:Y.default.t("GuidanceManager_203")},e}return n(e,t),Object.defineProperty(e.prototype,"guidance",{get:function(){return d.default.getInstance().guidance},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){cc.director.getScene().on(u.default.GUIDANCE_CONTINUE,this.guideContinue,this),cc.director.getScene().on(u.default.UPDATE_MERGEAREA,this.guideMergeTip,this),cc.director.getScene().on(u.default.LEVEL_UP_GUIDE,this.guideLevelUpTip,this),cc.director.getScene().on(u.default.LIMIT_ACT_GUIDE,this.limitActGuideContinue,this)},e.prototype.guideContinue=function(t){t=t||d.default.getInstance().guidance.progress,cc.isValid(cc.director.getScene())&&this.guide(t)},e.prototype.guide=function(t){if(t&&(this.guidance.progress=t,d.default.getInstance().saveUserData()),"999"!=this.guidance.progress){var e="guidance"+this.guidance.progress;this[e]&&this[e]()}},e.prototype.limitActGuideContinue=function(){var t="guidance"+d.default.getInstance().limitActModel.getGuideStep();this[t]&&this[t]()},e.prototype.guideTalkFun=function(t,e,i,a,n){void 0===e&&(e=this.guidance.progress),void 0===i&&(i=!0),void 0===a&&(a=""),void 0===n&&(n="");var o={talk:this.GUIDANCETALK[e],target:null,isLeft:i,talkerName:a,talkerImg:n};l.default.getInstance().openUI(A.default,{data:o},function(){h.default.trackEvent("guide_guideStart",{step:""+e}),h.default.trackEventOnStart("guide_guideStart_"+e,"\u65b0\u624b\u5f15\u5bfc"+e+"\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:""+e}),h.default.trackEventOnEnd("guide_guideEnd_"+e,"\u65b0\u624b\u5f15\u5bfc"+e+"\u7ed3\u675f"),t()})},e.prototype.guideMergeFun=function(t,e,i,a,n,o){var s;void 0===a&&(a=this.guidance.progress),void 0===n&&(n=1),void 0===o&&(o={});var r=null;1==n?r=this.getMergeManagerClass():2==n&&(r=this.getLimitActMergeManagerClass());var c=r.itemPrefabList[t].node,d=r.itemPrefabList[e].node,p={talk:this.GUIDANCETALK[a],target:null,move:[c,d],guideType:2,descPosY:null!==(s=o.descPosY)&&void 0!==s?s:-200,mergeType:n};l.default.getInstance().openUI(A.default,{data:p},function(){h.default.trackEvent("guide_guideStart",{step:""+a}),h.default.trackEventOnStart("guide_guideStart_"+a,"\u65b0\u624b\u5f15\u5bfc"+a+"\u5f00\u59cb"),r.guideToMerge(t,e,function(){l.default.getInstance().closeUI("Guide")})},function(){h.default.trackEvent("guide_guideEnd",{step:""+a}),h.default.trackEventOnEnd("guide_guideEnd_"+a,"\u65b0\u624b\u5f15\u5bfc"+a+"\u7ed3\u675f"),i()})},e.prototype.guideProduceFun=function(t,e,i,a,n,o){var s;void 0===a&&(a=this.guidance.progress),void 0===n&&(n=1),void 0===o&&(o={});var r=null;1==n?r=this.getMergeManagerClass():2==n&&(r=this.getLimitActMergeManagerClass());var c=r.itemPrefabList[i];r.itemClick(i);var d={talk:this.GUIDANCETALK[a],target:c.node,showMaskOpacity:!1,guideType:2,descPosY:null!==(s=o.descPosY)&&void 0!==s?s:-200};l.default.getInstance().openUI(A.default,{data:d},function(){h.default.trackEvent("guide_guideStart",{step:""+a}),h.default.trackEventOnStart("guide_guideStart_"+a,"\u65b0\u624b\u5f15\u5bfc"+a+"\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:""+a}),h.default.trackEventOnEnd("guide_guideEnd_"+a,"\u65b0\u624b\u5f15\u5bfc"+a+"\u7ed3\u675f"),r.simulateSingleClick(i,e),t()})},e.prototype.guidance1=function(){var t=this;this.guideTalkFun(function(){t.guidance1_1()},"1",!0,"","icon_jiekema_1")},e.prototype.guidance1_1=function(){var t=this;this.guideTalkFun(function(){t.guidance1_2()},"1_1")},e.prototype.guidance1_2=function(){var t=this;this.guideTalkFun(function(){t.guidance1_3()},"1_2",!1,Y.default.t("guidanceManager_1"),"icon_player")},e.prototype.guidance1_3=function(){var t=this;this.guideTalkFun(function(){t.guidance1_4()},"1_3")},e.prototype.guidance1_4=function(){var t=this;l.default.getInstance().openUI(P.default,{},function(){h.default.trackEvent("guide_guideStart",{step:"1_4"}),h.default.trackEventOnStart("guide_guideStart_1_4","\u65b0\u624b\u5f15\u5bfc1_4\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"1_4"}),h.default.trackEventOnEnd("guide_guideEnd_1_4","\u65b0\u624b\u5f15\u5bfc1_4\u7ed3\u675f"),0==cc.find("Canvas").getComponent(_.default).isMainScene?t.guidance1_6():t.guidance1_7()})},e.prototype.guidance1_6=function(){var t=this,e={talk:this.GUIDANCETALK["1_6"],target:this.getBtnMerge(),type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:e},function(){h.default.trackEvent("guide_guideStart",{step:"1_6"}),h.default.trackEventOnStart("guide_guideStart_1_6","\u65b0\u624b\u5f15\u5bfc1_6\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"1_6"}),h.default.trackEventOnEnd("guide_guideEnd_1_6","\u65b0\u624b\u5f15\u5bfc1_6\u7ed3\u675f"),t.guidance1_7()})},e.prototype.guidance1_7=function(){var t=this;this.goToMergeUI(function(){t.guideTalkFun(function(){t.guidance1_8()},"1_7")})},e.prototype.guidance1_8=function(){var t=this;this.guideMergeFun(51,52,function(){t.guideContinue("2")},"1_8")},e.prototype.guidance2=function(){var t=this;this.goToMergeUI(function(){t.guideMergeFun(52,53,function(){t.guideContinue("3")})})},e.prototype.guidance3=function(){var t=this;this.goToMergeUI(function(){t.guideMergeFun(53,59,function(){t.guideContinue("4")})})},e.prototype.guidance4=function(){var t=this;this.goToMergeUI(function(){var e=t.getSpanwerIndex();t.guideProduceFun(function(){t.guideContinue("5")},51,e)})},e.prototype.guidance5=function(){var t=this;this.goToMergeUI(function(){t.guideMergeFun(51,45,function(){t.guideContinue("6")})})},e.prototype.guidance6=function(){var t=this;this.goToMergeUI(function(){var e=t.getBtnTopTaskComplete(),i={talk:t.GUIDANCETALK[t.guidance.progress],target:e,type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:i},function(){h.default.trackEvent("guide_guideStart",{step:""+t.guidance.progress}),h.default.trackEventOnStart("guide_guideStart_"+t.guidance.progress,"\u65b0\u624b\u5f15\u5bfc"+t.guidance.progress+"\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:""+t.guidance.progress}),h.default.trackEventOnEnd("guide_guideEnd_"+t.guidance.progress,"\u65b0\u624b\u5f15\u5bfc"+t.guidance.progress+"\u7ed3\u675f"),t.guidance.progress="7",t.guidance7(),e.getComponent(v.default).onTaskClick()})})},e.prototype.guidance7=function(){var t=this;this.goToMergeUI(function(){var e=t.getBtnTopTask(),i={talk:t.GUIDANCETALK[t.guidance.progress],target:e,type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:i},function(){h.default.trackEvent("guide_guideStart",{step:""+t.guidance.progress}),h.default.trackEventOnStart("guide_guideStart_"+t.guidance.progress,"\u65b0\u624b\u5f15\u5bfc"+t.guidance.progress+"\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:""+t.guidance.progress}),h.default.trackEventOnEnd("guide_guideEnd_"+t.guidance.progress,"\u65b0\u624b\u5f15\u5bfc"+t.guidance.progress+"\u7ed3\u675f"),l.default.getInstance().openUI(C.default,{data:function(){t.guidance7_1()}})})})},e.prototype.guidance7_1=function(){var t=this,e=l.default.getInstance().getUI("BuildTaskPopup");e.node.getComponent(cc.Widget).updateAlignment();var i=e.getBtnGoComplete(),a={talk:this.GUIDANCETALK["7_1"],target:i,type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:a},function(){h.default.trackEvent("guide_guideStart",{step:"7_1"}),h.default.trackEventOnStart("guide_guideStart_7_1","\u65b0\u624b\u5f15\u5bfc7_1\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"7_1"}),h.default.trackEventOnEnd("guide_guideEnd_7_1","\u65b0\u624b\u5f15\u5bfc7_1\u7ed3\u675f");var i=e.getGuideCompleteBuildID();cc.director.getScene().emit(u.default.OPEN_SCENE),t.getHmaPrefabNode().getComponent(m.default).moveToBuild(i,null,function(){t.guidance7_2()}),l.default.getInstance().closeUI(C.default)})},e.prototype.guidance7_2=function(){var t=this,e=this.getBtnBuildBubble(),i={talk:this.GUIDANCETALK["7_2"],target:e,type:"tip",scale:!0,guideType:2};l.default.getInstance().openUI(A.default,{data:i},function(){h.default.trackEvent("guide_guideStart",{step:"7_2"}),h.default.trackEventOnStart("guide_guideStart_7_2","\u65b0\u624b\u5f15\u5bfc7_2\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"7_2"}),h.default.trackEventOnEnd("guide_guideEnd_7_2","\u65b0\u624b\u5f15\u5bfc7_2\u7ed3\u675f");var i=e.getComponent(g.default);l.default.getInstance().openUI(b.default,{data:{task:i._taskInfo,build:i._buildInfo}},function(){t.guidance7_3()})})},e.prototype.guidance7_3=function(){var t=this,e=l.default.getInstance().getUI("BuildCompletePopup");e.node.getComponent(cc.Widget).updateAlignment();var i=e.completeNode,a={talk:this.GUIDANCETALK["7_3"],target:i,type:"tip",guideType:2,descPosY:-500};l.default.getInstance().openUI(A.default,{data:a},function(){h.default.trackEvent("guide_guideStart",{step:"7_3"}),h.default.trackEventOnStart("guide_guideStart_7_3","\u65b0\u624b\u5f15\u5bfc7_3\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"7_3"}),h.default.trackEventOnEnd("guide_guideEnd_7_3","\u65b0\u624b\u5f15\u5bfc7_3\u7ed3\u675f"),t.guidance.progress="8",e.onBuildingClicked(function(){t.guidance8()})})},e.prototype.guidance8=function(){var t=this,e={talk:this.GUIDANCETALK[this.guidance.progress],target:this.getBtnMerge(),type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:e},function(){h.default.trackEvent("guide_guideStart",{step:""+t.guidance.progress}),h.default.trackEventOnStart("guide_guideStart_"+t.guidance.progress,"\u65b0\u624b\u5f15\u5bfc"+t.guidance.progress+"\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:""+t.guidance.progress}),h.default.trackEventOnEnd("guide_guideEnd_"+t.guidance.progress,"\u65b0\u624b\u5f15\u5bfc"+t.guidance.progress+"\u7ed3\u675f"),t.guidance8_1()})},e.prototype.guidance8_1=function(){var t=this;this.goToMergeUI(function(){var e=t.getSpanwerIndex();t.guideProduceFun(function(){t.guideContinue("9")},51,e,"8_1")})},e.prototype.guidance9=function(){var t=this;this.goToMergeUI(function(){t.guideMergeFun(45,46,function(){t.guideContinue("10")})})},e.prototype.guidance10=function(){var t=this;this.goToMergeUI(function(){t.guideMergeFun(46,44,function(){t.guideContinue("11")})})},e.prototype.guidance11=function(){var t=this;this.goToMergeUI(function(){var e=t.getBtnTopTaskComplete(),i={talk:t.GUIDANCETALK[t.guidance.progress],target:e,type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:i},function(){h.default.trackEvent("guide_guideStart",{step:""+t.guidance.progress}),h.default.trackEventOnStart("guide_guideStart_"+t.guidance.progress,"\u65b0\u624b\u5f15\u5bfc"+t.guidance.progress+"\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:""+t.guidance.progress}),h.default.trackEventOnEnd("guide_guideEnd_"+t.guidance.progress,"\u65b0\u624b\u5f15\u5bfc"+t.guidance.progress+"\u7ed3\u675f"),t.guidance.progress="12",t.guidance12(),e.getComponent(v.default).onTaskClick(),h.default.trackEventOnXG("deepAuth")})})},e.prototype.guidance12=function(){var t=this;this.goToMergeUI(function(){var e=t.getSpanwerIndex();t.guideProduceFun(function(){t.guideContinue("13")},1,e)})},e.prototype.guidance13=function(){var t=this;this.goToMergeUI(function(){t.guideMergeFun(44,50,function(){t.guideContinue("14")})})},e.prototype.guidance14=function(){var t=this;this.goToMergeUI(function(){var e=t.getBtnTopTaskComplete(),i={talk:t.GUIDANCETALK[t.guidance.progress],target:e,type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:i},function(){h.default.trackEvent("guide_guideStart",{step:""+t.guidance.progress}),h.default.trackEventOnStart("guide_guideStart_"+t.guidance.progress,"\u65b0\u624b\u5f15\u5bfc"+t.guidance.progress+"\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:""+t.guidance.progress}),h.default.trackEventOnEnd("guide_guideEnd_"+t.guidance.progress,"\u65b0\u624b\u5f15\u5bfc"+t.guidance.progress+"\u7ed3\u675f"),t.guidance.progress="15",t.guidance15(),e.getComponent(v.default).onTaskClick()})})},e.prototype.guidance15=function(){var t=this;this.goToMergeUI(function(){var e=t.getBtnTopTask(),i={talk:t.GUIDANCETALK[t.guidance.progress],target:e,type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:i},function(){h.default.trackEvent("guide_guideStart",{step:""+t.guidance.progress}),h.default.trackEventOnStart("guide_guideStart_"+t.guidance.progress,"\u65b0\u624b\u5f15\u5bfc"+t.guidance.progress+"\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:""+t.guidance.progress}),h.default.trackEventOnEnd("guide_guideEnd_"+t.guidance.progress,"\u65b0\u624b\u5f15\u5bfc"+t.guidance.progress+"\u7ed3\u675f"),l.default.getInstance().openUI(C.default,{data:function(){t.guidance15_1()}})})})},e.prototype.guidance15_1=function(){var t=this,e=l.default.getInstance().getUI("BuildTaskPopup");e.node.getComponent(cc.Widget).updateAlignment();var i=e.getBtnGoComplete(),a={talk:this.GUIDANCETALK["15_1"],target:i,type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:a},function(){h.default.trackEvent("guide_guideStart",{step:"15_1"}),h.default.trackEventOnStart("guide_guideStart_15_1","\u65b0\u624b\u5f15\u5bfc15_1\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"15_1"}),h.default.trackEventOnEnd("guide_guideEnd_15_1","\u65b0\u624b\u5f15\u5bfc15_1\u7ed3\u675f");var i=e.getGuideCompleteBuildID();l.default.getInstance().closeUI(C.default),cc.director.getScene().emit(u.default.OPEN_SCENE),t.getHmaPrefabNode().getComponent(m.default).moveToBuild(i,null,function(){t.guidance15_2()})})},e.prototype.guidance15_2=function(){var t=this,e=this.getBtnBuildBubble(),i={talk:this.GUIDANCETALK["15_2"],target:e,type:"tip",scale:!0,guideType:2};l.default.getInstance().openUI(A.default,{data:i},function(){h.default.trackEvent("guide_guideStart",{step:"15_2"}),h.default.trackEventOnStart("guide_guideStart_15_2","\u65b0\u624b\u5f15\u5bfc15_2\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"15_2"}),h.default.trackEventOnEnd("guide_guideEnd_15_2","\u65b0\u624b\u5f15\u5bfc15_2\u7ed3\u675f");var i=e.getComponent(g.default);l.default.getInstance().openUI(b.default,{data:{task:i._taskInfo,build:i._buildInfo}},function(){t.guidance15_3()})})},e.prototype.guidance15_3=function(){var t=this,e=l.default.getInstance().getUI("BuildCompletePopup");e.node.getComponent(cc.Widget).updateAlignment();var i=e.completeNode,a={talk:this.GUIDANCETALK["15_3"],target:i,type:"tip",guideType:2,descPosY:-500};l.default.getInstance().openUI(A.default,{data:a},function(){h.default.trackEvent("guide_guideStart",{step:"15_3"}),h.default.trackEventOnStart("guide_guideStart_15_3","\u65b0\u624b\u5f15\u5bfc15_3\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"15_3"}),h.default.trackEventOnEnd("guide_guideEnd_15_3","\u65b0\u624b\u5f15\u5bfc15_3\u7ed3\u675f"),t.guidance.progress="100",e.onBuildingClicked()})},e.prototype.guideLevelUpTip=function(){if(!l.default.getInstance().getUI(z.default)){var t=c.default.getInstance().mstStore.dailyGift.openLevel,e=c.default.getInstance().mstMisc.bagConfig.config.openLevel,i=c.default.getInstance().mstActivity.pass.openLevel,a=c.default.getInstance().mstMisc.tradingConfig.config[0];"100"==this.guidance.progress?this.guideContinue("16"):d.default.getInstance().level>=t&&!this.guidance.isShopComplete?this.guideContinue("25"):d.default.getInstance().level>=4&&!this.guidance.isLockAreakComplete?this.guideContinue("36"):d.default.getInstance().level>=e&&!this.guidance.isBagComplete?this.guideContinue("27"):d.default.getInstance().level>=i&&!this.guidance.isPassComplete?this.guideContinue("30"):d.default.getInstance().level>=a&&!this.guidance.isTradingComplete?this.guideContinue("38"):this.onStartActivityGuide()}},e.prototype.guidance16=function(){var t=this;this.guideTalkFun(function(){0==cc.find("Canvas").getComponent(_.default).isMainScene?t.guidance16_1():t.guidance16_2()})},e.prototype.guidance16_1=function(){var t=this,e={talk:this.GUIDANCETALK["16_1"],target:this.getBtnMerge(),type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:e},function(){h.default.trackEvent("guide_guideStart",{step:"16_1"}),h.default.trackEventOnStart("guide_guideStart_16_1","\u65b0\u624b\u5f15\u5bfc16_1\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"16_1"}),h.default.trackEventOnEnd("guide_guideEnd_16_1","\u65b0\u624b\u5f15\u5bfc16_1\u7ed3\u675f"),t.guidance16_2()})},e.prototype.guidance16_2=function(){var t=this;this.goToMergeUI(function(){var e={talk:t.GUIDANCETALK["16_2"],target:t.getBtnBox(),guideType:2};l.default.getInstance().openUI(A.default,{data:e},function(){h.default.trackEvent("guide_guideStart",{step:"16_2"}),h.default.trackEventOnStart("guide_guideStart_16_2","\u65b0\u624b\u5f15\u5bfc16_2\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"16_2"}),h.default.trackEventOnEnd("guide_guideEnd_16_2","\u65b0\u624b\u5f15\u5bfc16_2\u7ed3\u675f"),t.guideContinue("17")})})},e.prototype.guidance17=function(){var t=this;this.goToMergeUI(function(){var e=t.getBoxIndex(),i=t.getMergeManagerClass(),a=i.itemPrefabList[e],n={talk:t.GUIDANCETALK[t.guidance.progress],target:a.node,type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:n},function(){h.default.trackEvent("guide_guideStart",{step:""+t.guidance.progress}),h.default.trackEventOnStart("guide_guideStart_"+t.guidance.progress,"\u65b0\u624b\u5f15\u5bfc"+t.guidance.progress+"\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:""+t.guidance.progress}),h.default.trackEventOnEnd("guide_guideEnd_"+t.guidance.progress,"\u65b0\u624b\u5f15\u5bfc"+t.guidance.progress+"\u7ed3\u675f"),i.itemClick(e),cc.director.getScene().emit(u.default.UPDATE_ITEM_INFO,e),t.guideContinue("18")})})},e.prototype.guidance18=function(){var t=this;this.goToMergeUI(function(){var e={talk:t.GUIDANCETALK[t.guidance.progress],target:t.getBtnBoxLock(),guideType:2};l.default.getInstance().openUI(A.default,{data:e},function(){h.default.trackEvent("guide_guideStart",{step:""+t.guidance.progress}),h.default.trackEventOnStart("guide_guideStart_"+t.guidance.progress,"\u65b0\u624b\u5f15\u5bfc"+t.guidance.progress+"\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:""+t.guidance.progress}),h.default.trackEventOnEnd("guide_guideEnd_"+t.guidance.progress,"\u65b0\u624b\u5f15\u5bfc"+t.guidance.progress+"\u7ed3\u675f"),t.guideContinue("19")})})},e.prototype.guidance19=function(){var t=this;this.goToMergeUI(function(){var e=t.getBoxIndex();cc.director.getScene().emit(u.default.UPDATE_ITEM_INFO,e);var i={talk:t.GUIDANCETALK[t.guidance.progress],target:t.getBtnChain(),type:"tip",guideType:2},a=t.getBoxId().id;l.default.getInstance().openUI(A.default,{data:i},function(){h.default.trackEvent("guide_guideStart",{step:""+t.guidance.progress}),h.default.trackEventOnStart("guide_guideStart_"+t.guidance.progress,"\u65b0\u624b\u5f15\u5bfc"+t.guidance.progress+"\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:""+t.guidance.progress}),h.default.trackEventOnEnd("guide_guideEnd_"+t.guidance.progress,"\u65b0\u624b\u5f15\u5bfc"+t.guidance.progress+"\u7ed3\u675f"),l.default.getInstance().openUI(M.default,{data:a},function(){t.guideContinue("20")})})})},e.prototype.guidance20=function(){var t=this;this.goToMergeUI(function(){var e=l.default.getInstance().getUI("ItemChain").node;e.getComponent(cc.Widget).updateAlignment();var i=e.getChildByName("frame").getChildByName("closeBtn");i.getComponent(cc.Widget).updateAlignment();var a={talk:t.GUIDANCETALK[t.guidance.progress],target:i};l.default.getInstance().openUI(A.default,{data:a},function(){h.default.trackEvent("guide_guideStart",{step:""+t.guidance.progress}),h.default.trackEventOnStart("guide_guideStart_"+t.guidance.progress,"\u65b0\u624b\u5f15\u5bfc"+t.guidance.progress+"\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:""+t.guidance.progress}),h.default.trackEventOnEnd("guide_guideEnd_"+t.guidance.progress,"\u65b0\u624b\u5f15\u5bfc"+t.guidance.progress+"\u7ed3\u675f");var e=t.getBoxIndex();d.default.getInstance().itemData[e].isOpened?t.guideContinue("22"):t.guideContinue("21")})})},e.prototype.guidance21=function(){var t=this;this.goToMergeUI(function(){var e={talk:t.GUIDANCETALK[t.guidance.progress],target:t.getBtnBoxSpeed(),type:"tip",guideType:2},i=t.getBoxIndex();if(cc.director.getScene().emit(u.default.UPDATE_ITEM_INFO,i),t.getTopInfoPrefabJS().guideFreeDiamond(!0),d.default.getInstance().itemData[i].isOpened)return l.default.getInstance().closeUI(A.default),t.guideContinue("22"),void t.unscheduleAllCallbacks();var a=d.default.getInstance().itemData[i].coolingTime;t.scheduleOnce(function(){"21"==t.guidance.progress&&(l.default.getInstance().closeUI(A.default),t.guideContinue("22"),t.getTopInfoPrefabJS().guideFreeDiamond(!1))},a),l.default.getInstance().openUI(A.default,{data:e},function(){h.default.trackEvent("guide_guideStart",{step:""+t.guidance.progress}),h.default.trackEventOnStart("guide_guideStart_"+t.guidance.progress,"\u65b0\u624b\u5f15\u5bfc"+t.guidance.progress+"\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:""+t.guidance.progress}),h.default.trackEventOnEnd("guide_guideEnd_"+t.guidance.progress,"\u65b0\u624b\u5f15\u5bfc"+t.guidance.progress+"\u7ed3\u675f"),d.default.getInstance().itemData[i].isOpened?t.guideContinue("22"):d.default.getInstance().itemData[i].clearCoolTime(!0)&&(d.default.getInstance().updateTaskAndItem(),cc.director.getScene().emit(u.default.UPDATE_MERGEAREA,[i]),cc.director.getScene().emit(u.default.UPDATE_ITEM_INFO,i),t.getTopInfoPrefabJS().guideFreeDiamond(!1),t.guideContinue("22"))})})},e.prototype.guidance22=function(){var t=this;this.goToMergeUI(function(){var e=t.getBoxIndex(),i=t.getMergeManagerClass(),a=i.itemPrefabList[e];i.itemClick(e);var n={talk:t.GUIDANCETALK[t.guidance.progress],target:a.node,type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:n},function(){h.default.trackEvent("guide_guideStart",{step:""+t.guidance.progress}),h.default.trackEventOnStart("guide_guideStart_"+t.guidance.progress,"\u65b0\u624b\u5f15\u5bfc"+t.guidance.progress+"\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:""+t.guidance.progress}),h.default.trackEventOnEnd("guide_guideEnd_"+t.guidance.progress,"\u65b0\u624b\u5f15\u5bfc"+t.guidance.progress+"\u7ed3\u675f"),i.simulateSingleClick(e),cc.director.getScene().emit(u.default.UPDATE_ITEM_INFO,e),t.guideContinue("23")})})},e.prototype.guidance23=function(){var t=this;this.goToMergeUI(function(){var e=t.getDiamondItemIndex(),i=t.getMergeManagerClass(),a=i.itemPrefabList[e];i.itemClick(e);var n={talk:t.GUIDANCETALK[t.guidance.progress],target:a.node,type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:n},function(){h.default.trackEvent("guide_guideStart",{step:""+t.guidance.progress}),h.default.trackEventOnStart("guide_guideStart_"+t.guidance.progress,"\u65b0\u624b\u5f15\u5bfc"+t.guidance.progress+"\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:""+t.guidance.progress}),h.default.trackEventOnEnd("guide_guideEnd_"+t.guidance.progress,"\u65b0\u624b\u5f15\u5bfc"+t.guidance.progress+"\u7ed3\u675f"),t.guidance.progress="24",t.guidance24(),i.simulateSingleClick(e)})})},e.prototype.guidance24=function(){0==cc.find("Canvas").getComponent(_.default).isMainScene?this.guidance24_1():this.guideContinue("31")},e.prototype.guidance24_1=function(){var t=this,e={talk:this.GUIDANCETALK["24_1"],target:this.getBtnMerge(),type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:e},function(){h.default.trackEvent("guide_guideStart",{step:"24_1"}),h.default.trackEventOnStart("guide_guideStart_24_1","\u65b0\u624b\u5f15\u5bfc24_1\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"24_1"}),h.default.trackEventOnEnd("guide_guideEnd_24_1","\u65b0\u624b\u5f15\u5bfc24_1\u7ed3\u675f"),t.guideContinue("31")})},e.prototype.guidance31=function(){var t=this;this.goToMergeUI(function(){var e=t.getSpanwerIndex();t.guideProduceFun(function(){t.guideContinue("32")},51,e)})},e.prototype.guidance32=function(){var t=this;this.goToMergeUI(function(){t.guideMergeFun(45,58,function(){t.guideContinue("33")})})},e.prototype.guidance33=function(){var t=this;this.goToMergeUI(function(){var e=t.getSpanwerIndex();t.guideProduceFun(function(){t.guideContinue("34")},1,e)})},e.prototype.guidance34=function(){var t=this;this.goToMergeUI(function(){t.guideMergeFun(45,60,function(){t.guideContinue("35")})})},e.prototype.guidance35=function(){var t=this;this.goToMergeUI(function(){var e=t.getBtnTopTaskComplete(),i={talk:t.GUIDANCETALK[t.guidance.progress],target:e,type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:i},function(){h.default.trackEvent("guide_guideStart",{step:""+t.guidance.progress}),h.default.trackEventOnStart("guide_guideStart_"+t.guidance.progress,"\u65b0\u624b\u5f15\u5bfc"+t.guidance.progress+"\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:""+t.guidance.progress}),h.default.trackEventOnEnd("guide_guideEnd_"+t.guidance.progress,"\u65b0\u624b\u5f15\u5bfc"+t.guidance.progress+"\u7ed3\u675f"),t.guidance.progress="28",t.guidance28(),e.getComponent(v.default).onTaskClick()})})},e.prototype.guidance28=function(){var t=this;this.goToMergeUI(function(){l.default.getInstance().getUI("TaskPopup")?t.guidance28_1():t.guidance28_2()})},e.prototype.guidance28_1=function(){var t=this,e=l.default.getInstance().getUI("TaskPopup").node.getChildByName("fram").getChildByName("btnClose"),i={talk:this.GUIDANCETALK["28_1"],target:e};l.default.getInstance().openUI(A.default,{data:i},function(){h.default.trackEvent("guide_guideStart",{step:"28_1"}),h.default.trackEventOnStart("guide_guideStart_28_1","\u65b0\u624b\u5f15\u5bfc28_1\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"28_1"}),h.default.trackEventOnEnd("guide_guideEnd_28_1","\u65b0\u624b\u5f15\u5bfc28_1\u7ed3\u675f"),t.guidance28_2()})},e.prototype.guidance28_2=function(){var t=this,e=this.getBtnTopTask(),i={talk:this.GUIDANCETALK["28_2"],target:e,type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:i},function(){h.default.trackEvent("guide_guideStart",{step:"28_2"}),h.default.trackEventOnStart("guide_guideStart_28_2","\u65b0\u624b\u5f15\u5bfc28_2\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"28_2"}),h.default.trackEventOnEnd("guide_guideEnd_28_2","\u65b0\u624b\u5f15\u5bfc28_2\u7ed3\u675f"),l.default.getInstance().openUI(C.default,{data:function(){t.guidance28_3()}})})},e.prototype.guidance28_3=function(){var t=this,e=l.default.getInstance().getUI("BuildTaskPopup");e.node.getComponent(cc.Widget).updateAlignment();var i=e.getBtnGoComplete(),a={talk:this.GUIDANCETALK["28_3"],target:i,type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:a},function(){h.default.trackEvent("guide_guideStart",{step:"28_3"}),h.default.trackEventOnStart("guide_guideStart_28_3","\u65b0\u624b\u5f15\u5bfc28_3\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"28_3"}),h.default.trackEventOnEnd("guide_guideEnd_28_3","\u65b0\u624b\u5f15\u5bfc28_3\u7ed3\u675f");var i=e.getGuideCompleteBuildID();l.default.getInstance().closeUI(C.default),cc.director.getScene().emit(u.default.OPEN_SCENE),t.getHmaPrefabNode().getComponent(m.default).moveToBuild(i,null,function(){t.guidance28_4()})})},e.prototype.guidance28_4=function(){var t=this,e=this.getBtnBuildBubble(),i={talk:this.GUIDANCETALK["28_4"],target:e,type:"tip",scale:!0,guideType:2};l.default.getInstance().openUI(A.default,{data:i},function(){h.default.trackEvent("guide_guideStart",{step:"28_4"}),h.default.trackEventOnStart("guide_guideStart_28_4","\u65b0\u624b\u5f15\u5bfc28_4\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"28_4"}),h.default.trackEventOnEnd("guide_guideEnd_28_4","\u65b0\u624b\u5f15\u5bfc28_4\u7ed3\u675f");var i=e.getComponent(g.default);l.default.getInstance().openUI(b.default,{data:{task:i._taskInfo,build:i._buildInfo}},function(){t.guidance28_5()})})},e.prototype.guidance28_5=function(){var t=this,e=l.default.getInstance().getUI("BuildCompletePopup");e.node.getComponent(cc.Widget).updateAlignment();var i=e.completeNode,a={talk:this.GUIDANCETALK["28_5"],target:i,type:"tip",guideType:2,descPosY:-500};l.default.getInstance().openUI(A.default,{data:a},function(){h.default.trackEvent("guide_guideStart",{step:"28_5"}),h.default.trackEventOnStart("guide_guideStart_28_5","\u65b0\u624b\u5f15\u5bfc28_5\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"28_5"}),h.default.trackEventOnEnd("guide_guideEnd_28_5","\u65b0\u624b\u5f15\u5bfc28_5\u7ed3\u675f"),t.guidance.progress="29",e.onBuildingClicked(function(){t.guidance28_6()})})},e.prototype.guidance28_6=function(){var t=this;this.guideTalkFun(function(){t.guideContinue(29)},"28_6")},e.prototype.guidance29=function(){var t=this;l.default.getInstance().openUI(F.default,{},function(){h.default.trackEvent("guide_guideStart",{step:"29"}),h.default.trackEventOnStart("guide_guideStart_29","\u65b0\u624b\u5f15\u5bfc29\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"29"}),h.default.trackEventOnEnd("guide_guideEnd_29","\u65b0\u624b\u5f15\u5bfc29\u7ed3\u675f"),t.guidance29_1()})},e.prototype.guidance29_1=function(){var t=this;this.guideTalkFun(function(){l.default.getInstance().openNotice(z.default,{data:{ntype:"customer",id:1}},null,function(){r.default.getInstance().isIOSPayOpen?l.default.getInstance().openUI(U.default,{},null,function(){t.guidance37()}):t.guidance37()}),t.guidance.setComGuideComplete(),cc.director.getScene().emit(u.default.UPDATE_ACTIVITY),t.guidance.progress="101",d.default.getInstance().saveUserData()},"29_1")},e.prototype.guidance37=function(){var t=this,e={talk:this.GUIDANCETALK[37],target:this.getBtnMerge(),type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:e},function(){h.default.trackEvent("guide_guideStart",{step:"37"}),h.default.trackEventOnStart("guide_guideStart_37","\u65b0\u624b\u5f15\u5bfc37\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"37"}),h.default.trackEventOnEnd("guide_guideEnd_37","\u65b0\u624b\u5f15\u5bfc37\u7ed3\u675f"),t.goToMergeUI(),l.default.getInstance().closeUI(A.default)})},e.prototype.guidance25=function(){var t=this;this.guideTalkFun(function(){0==cc.find("Canvas").getComponent(_.default).isMainScene?t.guidance25_1():t.guidance25_2()})},e.prototype.guidance25_1=function(){var t=this,e={talk:this.GUIDANCETALK["25_1"],target:this.getBtnMerge(),type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:e},function(){h.default.trackEvent("guide_guideStart",{step:"25_1"}),h.default.trackEventOnStart("guide_guideStart_25_1","\u65b0\u624b\u5f15\u5bfc25_1\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"25_1"}),h.default.trackEventOnEnd("guide_guideEnd_25_1","\u65b0\u624b\u5f15\u5bfc25_1\u7ed3\u675f"),t.guidance25_2()})},e.prototype.guidance25_2=function(){var t=this;this.goToMergeUI(function(){var e={talk:t.GUIDANCETALK["25_2"],target:t.getBtnShop(),type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:e},function(){h.default.trackEvent("guide_guideStart",{step:"25_2"}),h.default.trackEventOnStart("guide_guideStart_25_2","\u65b0\u624b\u5f15\u5bfc25_2\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"25_2"}),h.default.trackEventOnEnd("guide_guideEnd_25_2","\u65b0\u624b\u5f15\u5bfc25_2\u7ed3\u675f"),l.default.getInstance().openUI(V.default,{data:{key:"dailyGift",type:1}},function(){t.guidance25_3()})})})},e.prototype.guidance25_3=function(){var t=this,e=l.default.getInstance().getUI("ShopPopup");e.node.getComponent(cc.Widget).updateAlignment(),e.nodeContentGird.getComponent(cc.Layout).updateLayout();var i=e.nodeContentGird.children[0].getComponent("ShopItem").btnPurchaseType.node,a={talk:this.GUIDANCETALK["25_3"],target:i,guideType:2};l.default.getInstance().openUI(A.default,{data:a},function(){h.default.trackEvent("guide_guideStart",{step:"25_3"}),h.default.trackEventOnStart("guide_guideStart_25_3","\u65b0\u624b\u5f15\u5bfc25_3\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"25_3"}),h.default.trackEventOnEnd("guide_guideEnd_25_3","\u65b0\u624b\u5f15\u5bfc25_3\u7ed3\u675f"),t.guideContinue(26)})},e.prototype.guidance26=function(){var t=this;this.guidance.setShopGuideComplete(),this.guideTalkFun(function(){var e=c.default.getInstance().mstMisc.bagConfig.config.openLevel,i=c.default.getInstance().mstActivity.pass.openLevel,a=c.default.getInstance().mstMisc.tradingConfig.config[0];d.default.getInstance().level>=4&&!t.guidance.isLockAreakComplete?t.guideContinue("36"):d.default.getInstance().level>=e&&!t.guidance.isBagComplete?(t.guideContinue("27"),l.default.getInstance().closeUI("ShopPopup")):d.default.getInstance().level>=i&&!t.guidance.isPassComplete?t.guideContinue("30"):d.default.getInstance().level>=a&&!t.guidance.isTradingComplete?t.guideContinue("38"):(t.guidance.progress="102",d.default.getInstance().saveUserData())})},e.prototype.guidance36=function(){var t=this;this.guideTalkFun(function(){0==cc.find("Canvas").getComponent(_.default).isMainScene?t.guidance36_1():t.guidance36_2()})},e.prototype.guidance36_1=function(){var t=this,e={talk:this.GUIDANCETALK["36_1"],target:this.getBtnMerge(),type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:e},function(){h.default.trackEvent("guide_guideStart",{step:"36_1"}),h.default.trackEventOnStart("guide_guideStart_36_1","\u65b0\u624b\u5f15\u5bfc36_1\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"36_1"}),h.default.trackEventOnEnd("guide_guideEnd_36_1","\u65b0\u624b\u5f15\u5bfc36_1\u7ed3\u675f"),t.guidance36_2()})},e.prototype.guidance36_2=function(){var t=this;this.goToMergeUI(function(){var e=t.getFourArea(),i={talk:t.GUIDANCETALK["36_2"],target:e.getChildByName("Bg"),guideType:2,descPosY:-500};l.default.getInstance().openUI(A.default,{data:i},function(){h.default.trackEvent("guide_guideStart",{step:"36_2"}),h.default.trackEventOnStart("guide_guideStart_36_2","\u65b0\u624b\u5f15\u5bfc36_2\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"36_2"}),h.default.trackEventOnEnd("guide_guideEnd_36_2","\u65b0\u624b\u5f15\u5bfc36_2\u7ed3\u675f"),t.guidance.setLockAreaGuideComplete();var i=c.default.getInstance().mstMisc.bagConfig.config.openLevel,a=c.default.getInstance().mstActivity.pass.openLevel,n=c.default.getInstance().mstMisc.tradingConfig.config[0];d.default.getInstance().level>=i&&!t.guidance.isBagComplete?(t.guidance.progress="27",t.guidance27(),l.default.getInstance().closeUI("ShopPopup")):d.default.getInstance().level>=a&&!t.guidance.isPassComplete?(t.guidance.progress="30",t.guidance30()):d.default.getInstance().level>=n&&!t.guidance.isTradingComplete?(t.guidance.progress="38",t.guidance38()):t.guidance.progress="999",e.getComponent(O.default).onClickUnLockArea()})})},e.prototype.guidance27=function(){var t=this;this.guideTalkFun(function(){0==cc.find("Canvas").getComponent(_.default).isMainScene?t.guidance27_1():t.guidance27_2()})},e.prototype.guidance27_1=function(){var t=this,e={talk:this.GUIDANCETALK["27_1"],target:this.getBtnMerge(),type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:e},function(){h.default.trackEvent("guide_guideStart",{step:"27_1"}),h.default.trackEventOnStart("guide_guideStart_27_1","\u65b0\u624b\u5f15\u5bfc27_1\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"27_1"}),h.default.trackEventOnEnd("guide_guideEnd_27_1","\u65b0\u624b\u5f15\u5bfc27_1\u7ed3\u675f"),t.guidance27_2()})},e.prototype.guidance27_2=function(){var t=this;this.goToMergeUI(function(){var e={talk:t.GUIDANCETALK["27_2"],target:t.getBtnBag(),type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:e},function(){h.default.trackEvent("guide_guideStart",{step:"27_2"}),h.default.trackEventOnStart("guide_guideStart_27_2","\u65b0\u624b\u5f15\u5bfc27_2\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"27_2"}),h.default.trackEventOnEnd("guide_guideEnd_27_2","\u65b0\u624b\u5f15\u5bfc27_2\u7ed3\u675f"),l.default.getInstance().openUI(I.default,{},function(){t.guidance27_3()})})})},e.prototype.guidance27_3=function(){var t=this,e=l.default.getInstance().getUI("BagPopup").node;e.getComponent(cc.Widget).updateAlignment();var i=e.getChildByName("frame").getChildByName("btn_help"),a={talk:this.GUIDANCETALK["27_3"],target:i,type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:a},function(){h.default.trackEvent("guide_guideStart",{step:"27_3"}),h.default.trackEventOnStart("guide_guideStart_27_3","\u65b0\u624b\u5f15\u5bfc27_3\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"27_3"}),h.default.trackEventOnEnd("guide_guideEnd_27_3","\u65b0\u624b\u5f15\u5bfc27_3\u7ed3\u675f"),l.default.getInstance().openUI(L.default,{},function(){t.guidance27_4()})})},e.prototype.guidance27_4=function(){var t=this;this.guideTalkFun(function(){t.guidance.setBagGuideComplete();var e=c.default.getInstance().mstActivity.pass.openLevel,i=c.default.getInstance().mstMisc.tradingConfig.config[0];d.default.getInstance().level>=e&&!t.guidance.isPassComplete?t.guideContinue("30"):d.default.getInstance().level>=i&&!t.guidance.isTradingComplete?t.guideContinue("38"):(t.guidance.progress="999",t.node.active=!1,d.default.getInstance().saveUserData())},"27_4")},e.prototype.guidance30=function(){var t=this;r.default.getInstance().isIOSPayOpen&&this.guideTalkFun(function(){1==cc.find("Canvas").getComponent(_.default).isMainScene?t.guidance30_1():t.guidance30_2()},"30")},e.prototype.guidance30_1=function(){var t=this,e=this.getMergeBackBtnNode(),i={talk:this.GUIDANCETALK["30_1"],target:e,type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:i},function(){h.default.trackEvent("guide_guideStart",{step:"30_1"}),h.default.trackEventOnStart("guide_guideStart_30_1","\u65b0\u624b\u5f15\u5bfc30_1\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"30_1"}),h.default.trackEventOnEnd("guide_guideEnd_30_1","\u65b0\u624b\u5f15\u5bfc30_1\u7ed3\u675f"),t.goToMainUI(),t.guidance30_2()})},e.prototype.guidance30_2=function(){var t=this,e=this.getPassBtnNode(),i={talk:this.GUIDANCETALK["30_2"],target:e,type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:i},function(){h.default.trackEvent("guide_guideStart",{step:"30_2"}),h.default.trackEventOnStart("guide_guideStart_30_2","\u65b0\u624b\u5f15\u5bfc30_2\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"30_2"}),h.default.trackEventOnEnd("guide_guideEnd_30_2","\u65b0\u624b\u5f15\u5bfc30_2\u7ed3\u675f"),l.default.getInstance().openUI(j.default,{},function(){t.guidance30_3()})})},e.prototype.guidance30_3=function(){var t=this,e=l.default.getInstance().getUI("PassPopup").node.getChildByName("bg").getChildByName("titleContent").getChildByName("radioButton").getChildByName("toggle1"),i={talk:this.GUIDANCETALK["30_3"],target:e,guideType:2};l.default.getInstance().openUI(A.default,{data:i},function(){h.default.trackEvent("guide_guideStart",{step:"30_3"}),h.default.trackEventOnStart("guide_guideStart_30_3","\u65b0\u624b\u5f15\u5bfc30_3\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"30_3"}),h.default.trackEventOnEnd("guide_guideEnd_30_3","\u65b0\u624b\u5f15\u5bfc30_3\u7ed3\u675f"),t.guidance30_4()})},e.prototype.guidance30_4=function(){var t=this;this.guideTalkFun(function(){var e=c.default.getInstance().mstMisc.tradingConfig.config[0];d.default.getInstance().level>=e&&!t.guidance.isTradingComplete?t.guideContinue("38"):t.guidance.progress="999",t.guidance.setPassGuideComplete(),d.default.getInstance().saveUserData(),h.default.trackEventOnXG("common","Guide")},"30_4")},e.prototype.guidance38=function(){var t=this;this.guideTalkFun(function(){0==cc.find("Canvas").getComponent(_.default).isMainScene?t.guidance38_1():t.guidance38_2()})},e.prototype.guidance38_1=function(){var t=this,e={talk:this.GUIDANCETALK["38_1"],target:this.getBtnMerge(),type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:e},function(){h.default.trackEvent("guide_guideStart",{step:"38_1"}),h.default.trackEventOnStart("guide_guideStart_38_1","\u65b0\u624b\u5f15\u5bfc38_1\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"38_1"}),h.default.trackEventOnEnd("guide_guideEnd_38_1","\u65b0\u624b\u5f15\u5bfc38_1\u7ed3\u675f"),t.guidance38_2()})},e.prototype.guidance38_2=function(){var t=this;this.goToMergeUI(function(){var e={talk:t.GUIDANCETALK["38_2"],target:t.getBtnTask(),type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:e},function(){h.default.trackEvent("guide_guideStart",{step:"38_2"}),h.default.trackEventOnStart("guide_guideStart_38_2","\u65b0\u624b\u5f15\u5bfc38_2\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"38_2"}),h.default.trackEventOnEnd("guide_guideEnd_38_2","\u65b0\u624b\u5f15\u5bfc38_2\u7ed3\u675f"),l.default.getInstance().openUI(H.default,{},function(){t.guidance38_3()})})})},e.prototype.guidance38_3=function(){var t=this;this.goToMergeUI(function(){var e=l.default.getInstance().getUI("TaskPopup");e.node.getComponent(cc.Widget).updateAlignment();var i={talk:t.GUIDANCETALK["38_3"],target:e.toggleList[1].node,guideType:2};l.default.getInstance().openUI(A.default,{data:i},function(){h.default.trackEvent("guide_guideStart",{step:"38_3"}),h.default.trackEventOnStart("guide_guideStart_38_3","\u65b0\u624b\u5f15\u5bfc38_3\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"38_3"}),h.default.trackEventOnEnd("guide_guideEnd_38_3","\u65b0\u624b\u5f15\u5bfc38_3\u7ed3\u675f"),t.guidance38_4()})})},e.prototype.guidance38_4=function(){var t=this,e=l.default.getInstance().getUI("TaskPopup");e.node.getComponent(cc.Widget).updateAlignment();var i=e.scrollViews[1].content.children[0],a={talk:this.GUIDANCETALK["38_4"],target:i,guideType:2};l.default.getInstance().openUI(A.default,{data:a},function(){h.default.trackEvent("guide_guideStart",{step:"38_4"}),h.default.trackEventOnStart("guide_guideStart_38_4","\u65b0\u624b\u5f15\u5bfc38_4\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"38_4"}),h.default.trackEventOnEnd("guide_guideEnd_38_4","\u65b0\u624b\u5f15\u5bfc38_4\u7ed3\u675f"),t.guidance.progress="999",t.guidance.setTradingGuideComplete(),d.default.getInstance().saveUserData()})},e.prototype.onStartActivityGuide=function(){var t=this;1==cc.find("Canvas").getComponent(_.default).isMainScene&&(d.default.getInstance().activityData.isOneActivityGuideOpen("christmas")?l.default.getInstance().openUI(w.default,{},null,function(){d.default.getInstance().guidance.progress="39",t.guidance39()}):d.default.getInstance().activityData.isOneActivityGuideOpen("newYear")?l.default.getInstance().openUI(x.default,{},null,function(){d.default.getInstance().guidance.progress="41",t.guidance41()}):d.default.getInstance().activityData.isOneActivityGuideOpen("happyBingo")?(d.default.getInstance().guidance.progress="42",this.guidance42()):d.default.getInstance().activityData.isOneActivityGuideOpen("childrenDay")&&(d.default.getInstance().guidance.progress="100",this.guidance100()))},e.prototype.guidance39=function(){var t=this;this.guideTalkFun(function(){t.guidance39_1()},"39",!0,Y.default.t("guidanceManager_2"),"sdj_28")},e.prototype.guidance39_1=function(){var t=this;this.guideTalkFun(function(){t.guidance39_2()},"39_1",!1,Y.default.t("guidanceManager_1"),"icon_player")},e.prototype.guidance39_2=function(){var t=this;this.guideTalkFun(function(){t.guidance39_3()},"39_2",!0,Y.default.t("guidanceManager_2"),"sdj_28")},e.prototype.guidance39_3=function(){var t=this;this.guideTalkFun(function(){t.guidance39_4()},"39_3",!1,Y.default.t("guidanceManager_1"),"icon_player")},e.prototype.guidance39_4=function(){var t=this,e=this.getTopActivityNode(),i={talk:this.GUIDANCETALK["39_4"],target:e,type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:i},function(){h.default.trackEvent("guide_guideStart",{step:"39_4"}),h.default.trackEventOnStart("guide_guideStart_39_4","\u65b0\u624b\u5f15\u5bfc39_4\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"39_4"}),h.default.trackEventOnEnd("guide_guideEnd_39_4","\u65b0\u624b\u5f15\u5bfc39_4\u7ed3\u675f"),l.default.getInstance().openUI(T.default,{},function(){t.guidance39_5()})})},e.prototype.guidance39_5=function(){var t=this,e=l.default.getInstance().getUI("ChristmasPopup");e.node.getComponent(cc.Widget).updateAlignment();var i=e.getTaskNode(),a={talk:this.GUIDANCETALK["39_5"],target:i,type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:a},function(){h.default.trackEvent("guide_guideStart",{step:"39_5"}),h.default.trackEventOnStart("guide_guideStart_39_5","\u65b0\u624b\u5f15\u5bfc39_5\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"39_5"}),h.default.trackEventOnEnd("guide_guideEnd_39_5","\u65b0\u624b\u5f15\u5bfc39_5\u7ed3\u675f"),t.guidance39_6()})},e.prototype.guidance39_6=function(){var t=this,e=l.default.getInstance().getUI("ChristmasPopup");e.node.getComponent(cc.Widget).updateAlignment();var i=e.getLevelNode(),a={talk:this.GUIDANCETALK["39_6"],target:i,guideType:2};l.default.getInstance().openUI(A.default,{data:a},function(){h.default.trackEvent("guide_guideStart",{step:"39_5"}),h.default.trackEventOnStart("guide_guideStart_39_5","\u65b0\u624b\u5f15\u5bfc39_5\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"39_5"}),h.default.trackEventOnEnd("guide_guideEnd_39_5","\u65b0\u624b\u5f15\u5bfc39_5\u7ed3\u675f"),t.guidance.progress="999",d.default.getInstance().saveUserData();var e=d.default.getInstance().activityData.getActivityEndTime("christmas");e.length>0&&cc.sys.localStorage.setItem("christmas",f.default.getDateByYMD(e[0]))})},e.prototype.guidance40=function(){var t=this;this.guidance.progress="999",d.default.getInstance().saveUserData(),this.guideTalkFun(function(){1==cc.find("Canvas").getComponent(_.default).isMainScene?t.guidance40_1():t.guidance40_2()},"40")},e.prototype.guidance40_1=function(){var t=this,e=this.getMergeBackBtnNode(),i={talk:this.GUIDANCETALK["40_1"],target:e,type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:i},function(){h.default.trackEvent("guide_guideStart",{step:"40_1"}),h.default.trackEventOnStart("guide_guideStart_40_1","\u65b0\u624b\u5f15\u5bfc40_1\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"40_1"}),h.default.trackEventOnEnd("guide_guideEnd_40_1","\u65b0\u624b\u5f15\u5bfc40_1\u7ed3\u675f"),t.goToMainUI(),t.guidance40_2()})},e.prototype.guidance40_2=function(){var t=this,e=this.getDressUpBtnNode(),i={talk:this.GUIDANCETALK["40_2"],target:e,type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:i},function(){h.default.trackEvent("guide_guideStart",{step:"40_2"}),h.default.trackEventOnStart("guide_guideStart_40_2","\u65b0\u624b\u5f15\u5bfc40_1\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"40_2"}),h.default.trackEventOnEnd("guide_guideEnd_40_2","\u65b0\u624b\u5f15\u5bfc40_2\u7ed3\u675f");for(var e=d.default.getInstance().unlockSceneAreaIds,i=0,a=0;a<e.length;a++){for(var n=c.default.getInstance().mstSceneArea[e[a]].buildingIds,o=0;o<n.length;o++)if("area"!=c.default.getInstance().mstBuilding[n[o]].type&&d.default.getInstance().buildingData[n[o]].isHaveTips){i=n[o];break}if(i>0)break}l.default.getInstance().openUI(y.default,{data:{choose:1,buildId:i,callback:function(){l.default.getInstance().closeUI("Loading");var e=l.default.getInstance().getUI("AtlasPopup").getGuideItemNode();e.isGetAward?t.guidance40_4(e.node):t.guidance40_3(e.node)}}},function(){l.default.getInstance().openUI(p.default,{data:{showBlack:!1}})})})},e.prototype.guidance40_3=function(t){var e=this,i={talk:this.GUIDANCETALK["40_3"],target:t,guideType:2};l.default.getInstance().openUI(A.default,{data:i},function(){h.default.trackEvent("guide_guideStart",{step:"40_3"}),h.default.trackEventOnStart("guide_guideStart_40_3","\u65b0\u624b\u5f15\u5bfc40_3\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"40_3"}),h.default.trackEventOnEnd("guide_guideEnd_40_3","\u65b0\u624b\u5f15\u5bfc40_3\u7ed3\u675f"),e.guidance40_4(t)})},e.prototype.guidance40_4=function(t){var e=this,i={talk:this.GUIDANCETALK["40_4"],target:t,type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:i},function(){h.default.trackEvent("guide_guideStart",{step:"40_4"}),h.default.trackEventOnStart("guide_guideStart_40_4","\u65b0\u624b\u5f15\u5bfc40_4\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"40_4"}),h.default.trackEventOnEnd("guide_guideEnd_40_4","\u65b0\u624b\u5f15\u5bfc40_4\u7ed3\u675f");var t=l.default.getInstance().getUI("AtlasPopup").getGuieUseId();l.default.getInstance().openUI(N.default,{data:{buildId:t}},function(){e.guidance40_5()})})},e.prototype.guidance40_5=function(){var t=l.default.getInstance().getUI("BuildInfoPopup");t.node.getComponent(cc.Widget).updateAlignment();var e=t.getGuideUseNode(),i={talk:this.GUIDANCETALK["40_5"],target:e,type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:i},function(){h.default.trackEvent("guide_guideStart",{step:"40_5"}),h.default.trackEventOnStart("guide_guideStart_40_5","\u65b0\u624b\u5f15\u5bfc40_5\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"40_5"}),h.default.trackEventOnEnd("guide_guideEnd_40_5","\u65b0\u624b\u5f15\u5bfc40_5\u7ed3\u675f"),cc.sys.localStorage.setItem("checkSkin","true")})},e.prototype.guidance200=function(){var t=this;this.guidance.progress="999",d.default.getInstance().saveUserData(),this.guideTalkFun(function(){1==cc.find("Canvas").getComponent(_.default).isMainScene?t.guidance201():t.guidance202()},"200")},e.prototype.guidance201=function(){var t=this,e=this.getMergeBackBtnNode(),i={talk:this.GUIDANCETALK[201],target:e,type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:i},function(){h.default.trackEvent("guide_guideStart",{step:"40_1"}),h.default.trackEventOnStart("guide_guideStart_40_1","\u65b0\u624b\u5f15\u5bfc40_1\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"40_1"}),h.default.trackEventOnEnd("guide_guideEnd_40_1","\u65b0\u624b\u5f15\u5bfc40_1\u7ed3\u675f"),t.goToMainUI(),t.guidance202()})},e.prototype.guidance202=function(){var t=this,e=this.getDressUpBtnNode(),i={talk:this.GUIDANCETALK[202],target:e,type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:i},function(){h.default.trackEvent("guide_guideStart",{step:"202"}),h.default.trackEventOnStart("guide_guideStart_202","\u65b0\u624b\u5f15\u5bfc202\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"202"}),h.default.trackEventOnEnd("guide_guideEnd_202","\u65b0\u624b\u5f15\u5bfc202\u7ed3\u675f");var e="0",i=d.default.getInstance().roleData;for(var a in i)if(i[a].isHaveTips){e=a;break}l.default.getInstance().openUI(y.default,{data:{choose:2,roleId:e,callback:function(){l.default.getInstance().closeUI("Loading");var e=l.default.getInstance().getUI("AtlasPopup").getGuideItemRoleNode();e.isGetAward?t.guidance204(e.node):t.guidance203(e.node)}}},function(){l.default.getInstance().openUI(p.default,{data:{showBlack:!1}})})})},e.prototype.guidance203=function(t){var e=this,i={talk:this.GUIDANCETALK[203],target:t,guideType:2};l.default.getInstance().openUI(A.default,{data:i},function(){h.default.trackEvent("guide_guideStart",{step:"203"}),h.default.trackEventOnStart("guide_guideStart_203","\u65b0\u624b\u5f15\u5bfc203\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"203"}),h.default.trackEventOnEnd("guide_guideEnd_203","\u65b0\u624b\u5f15\u5bfc203\u7ed3\u675f"),e.guidance204(t)})},e.prototype.guidance204=function(t){var e=this,i={talk:this.GUIDANCETALK[204],target:t,type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:i},function(){h.default.trackEvent("guide_guideStart",{step:"204"}),h.default.trackEventOnStart("guide_guideStart_204","\u65b0\u624b\u5f15\u5bfc204\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"204"}),h.default.trackEventOnEnd("guide_guideEnd_204","\u65b0\u624b\u5f15\u5bfc204\u7ed3\u675f");var t=l.default.getInstance().getUI("AtlasPopup").getGuieUseRoleId();l.default.getInstance().openUI(D.default,{data:{roleId:t}},function(){e.guidance205()})})},e.prototype.guidance205=function(){var t=l.default.getInstance().getUI("CustomerInfoPopup");t.node.getComponent(cc.Widget).updateAlignment();var e=t.getGuideUseNode(),i={talk:this.GUIDANCETALK[205],target:e,type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:i},function(){h.default.trackEvent("guide_guideStart",{step:"205"}),h.default.trackEventOnStart("guide_guideStart_205","\u65b0\u624b\u5f15\u5bfc205\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"205"}),h.default.trackEventOnEnd("guide_guideEnd_205","\u65b0\u624b\u5f15\u5bfc205\u7ed3\u675f"),cc.sys.localStorage.setItem("checkSkin","true")})},e.prototype.guidance41=function(){var t=this;this.guideTalkFun(function(){t.guidance41_1()},"41",!0,Y.default.t("guidanceManager_3"),"cjhd_18")},e.prototype.guidance41_1=function(){var t=this;this.guideTalkFun(function(){t.guidance41_2()},"41_1",!1,Y.default.t("guidanceManager_1"),"icon_player")},e.prototype.guidance41_2=function(){var t=this;this.guideTalkFun(function(){t.guidance41_3()},"41_2",!0,Y.default.t("guidanceManager_3"),"cjhd_18")},e.prototype.guidance41_3=function(){var t=this;this.guideTalkFun(function(){t.guidance41_4()},"41_3",!1,Y.default.t("guidanceManager_1"),"icon_player")},e.prototype.guidance41_4=function(){var t=this,e=this.getTopActivityNode(),i={talk:this.GUIDANCETALK["41_4"],target:e,type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:i},function(){h.default.trackEvent("guide_guideStart",{step:"41_4"}),h.default.trackEventOnStart("guide_guideStart_41_4","\u65b0\u624b\u5f15\u5bfc41_4\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"41_4"}),h.default.trackEventOnEnd("guide_guideEnd_41_4","\u65b0\u624b\u5f15\u5bfc41_4\u7ed3\u675f"),l.default.getInstance().openUI(G.default,{},function(){t.guidance41_5()})})},e.prototype.guidance41_5=function(){var t=this,e=l.default.getInstance().getUI("NewYearPopup");e.node.getComponent(cc.Widget).updateAlignment();var i=e.getTaskNode(),a={talk:this.GUIDANCETALK["41_5"],target:i,type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:a},function(){h.default.trackEvent("guide_guideStart",{step:"41_5"}),h.default.trackEventOnStart("guide_guideStart_41_5","\u65b0\u624b\u5f15\u5bfc41_5\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"41_5"}),h.default.trackEventOnEnd("guide_guideEnd_41_5","\u65b0\u624b\u5f15\u5bfc41_5\u7ed3\u675f"),t.guidance41_6()})},e.prototype.guidance41_6=function(){var t=this,e=l.default.getInstance().getUI("NewYearPopup");e.node.getComponent(cc.Widget).updateAlignment();var i=e.getExchangeNode(),a={talk:this.GUIDANCETALK["41_6"],target:i,type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:a},function(){h.default.trackEvent("guide_guideStart",{step:"41_6"}),h.default.trackEventOnStart("guide_guideStart_41_6","\u65b0\u624b\u5f15\u5bfc41_6\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"41_6"}),h.default.trackEventOnEnd("guide_guideEnd_41_6","\u65b0\u624b\u5f15\u5bfc41_6\u7ed3\u675f"),l.default.getInstance().openUI(R.default,{},function(){t.guidance41_7()})})},e.prototype.guidance41_7=function(){var t=this,e=l.default.getInstance().getUI("NewYearExchangePopup");e.node.getComponent(cc.Widget).updateAlignment();var i=e.getExchangeNode(),a={talk:this.GUIDANCETALK["41_7"],target:i,type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:a},function(){h.default.trackEvent("guide_guideStart",{step:"41_7"}),h.default.trackEventOnStart("guide_guideStart_41_7","\u65b0\u624b\u5f15\u5bfc41_7\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"41_7"}),h.default.trackEventOnEnd("guide_guideEnd_41_7","\u65b0\u624b\u5f15\u5bfc41_7\u7ed3\u675f"),t.guidance.progress="999",d.default.getInstance().saveUserData();var e=d.default.getInstance().activityData.getActivityEndTime("newYear");e.length>0&&cc.sys.localStorage.setItem("newYear",f.default.getDateByYMD(e[0]))})},e.prototype.guidance42=function(){var t=this;this.guidance.progress="999",this.guideTalkFun(function(){t.guidance42_1()},"42",!0,Y.default.t("guidanceManager_4"),"cjhd_16")},e.prototype.guidance42_1=function(){var t=this;this.guideTalkFun(function(){t.guidance42_2()},"42_1",!1,Y.default.t("guidanceManager_1"),"icon_player")},e.prototype.guidance42_2=function(){var t=this;this.guideTalkFun(function(){t.guidance42_3()},"42_2",!0,Y.default.t("guidanceManager_4"),"cjhd_19")},e.prototype.guidance42_3=function(){var t=this;this.guideTalkFun(function(){t.guidance42_4()},"42_3",!1,Y.default.t("guidanceManager_1"),"icon_player")},e.prototype.guidance42_4=function(){var t=this;this.guideTalkFun(function(){t.guidance42_5()},"42_4",!0,Y.default.t("guidanceManager_4"),"cjhd_16")},e.prototype.guidance42_5=function(){var t=this;this.guideTalkFun(function(){t.guidance42_6()},"42_5",!1,Y.default.t("guidanceManager_1"),"icon_player")},e.prototype.guidance42_6=function(){var t=this,e={target:this.getTopActivityNode(),type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:e},function(){h.default.trackEvent("guide_guideStart",{step:"42_6"}),h.default.trackEventOnStart("guide_guideStart_42_6","\u65b0\u624b\u5f15\u5bfc42_6\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"42_6"}),h.default.trackEventOnEnd("guide_guideEnd_42_6","\u65b0\u624b\u5f15\u5bfc42_6\u7ed3\u675f"),l.default.getInstance().openUI(E.default,{},function(){t.guidance42_7()})})},e.prototype.guidance42_7=function(){var t=this,e=l.default.getInstance().getUI("HappyBingoPopup");e.node.getComponent(cc.Widget).updateAlignment();var i=e.getTaskNode(),a={talk:this.GUIDANCETALK["42_6"],target:i,type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:a},function(){h.default.trackEvent("guide_guideStart",{step:"42_7"}),h.default.trackEventOnStart("guide_guideStart_42_7","\u65b0\u624b\u5f15\u5bfc42_7\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"42_7"}),h.default.trackEventOnEnd("guide_guideEnd_42_7","\u65b0\u624b\u5f15\u5bfc42_7\u7ed3\u675f"),t.guidance42_8()})},e.prototype.guidance42_8=function(){var t=this,e=l.default.getInstance().getUI("HappyBingoPopup");e.node.getComponent(cc.Widget).updateAlignment();var i={target:e.getHelpNode(),type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:i},function(){h.default.trackEvent("guide_guideStart",{step:"42_8"}),h.default.trackEventOnStart("guide_guideStart_42_8","\u65b0\u624b\u5f15\u5bfc42_8\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"42_8"}),h.default.trackEventOnEnd("guide_guideEnd_42_8","\u65b0\u624b\u5f15\u5bfc42_8\u7ed3\u675f"),l.default.getInstance().openUI(B.default,{},function(){t.guidance42_9()})})},e.prototype.guidance42_9=function(){var t=this,e=l.default.getInstance().getUI("HappyBingoHelpPopup");e.node.getComponent(cc.Widget).updateAlignment();var i=e.getTipNode(),a={talk:this.GUIDANCETALK["42_7"],target:i,type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:a},function(){h.default.trackEvent("guide_guideStart",{step:"42_9"}),h.default.trackEventOnStart("guide_guideStart_42_9","\u65b0\u624b\u5f15\u5bfc42_9\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"42_9"}),h.default.trackEventOnEnd("guide_guideEnd_42_9","\u65b0\u624b\u5f15\u5bfc42_9\u7ed3\u675f"),t.guidance.progress="999",d.default.getInstance().saveUserData();var e=d.default.getInstance().activityData.getActivityEndTime("happyBingo");e.length>0&&cc.sys.localStorage.setItem("happyBingo",f.default.getDateByYMD(e[0]))})},e.prototype.guidance43=function(){var t=this;this.guideMergeFun(32,39,function(){t.guidance43_1()},"43",2,{descPosY:-600})},e.prototype.guidance43_1=function(){var t=this;d.default.getInstance().limitActModel.foodFestival.guideStep="43_1";var e=+this.geItemByIdIndex(3017,2);cc.director.getScene().emit(u.default.UPDATE_LIMITITEM_INFO,e),this.getLimitActMergeUIClass().guideFreeDiamond(!0);var i=d.default.getInstance().limitActModel.itemData[e].decayTime;i<=0&&(l.default.getInstance().closeUI(A.default),this.getLimitActMergeUIClass().guideFreeDiamond(!1),this.unscheduleAllCallbacks()),this.scheduleOnce(function(){console.log("\u65f6\u95f4\u5230\u5173\u95ed\u5f15\u5bfc"),l.default.getInstance().closeUI(A.default),t.getLimitActMergeUIClass().guideFreeDiamond(!1)},i);var a={talk:"",target:this.getLimitActMergeManagerClass().itemBgPrefabList[e].node,type:"tip"};l.default.getInstance().openUI(A.default,{data:a},function(){},function(){d.default.getInstance().limitActModel.itemData[e].decayTime>0?t.guidance43_2():t.guidance43_3()})},e.prototype.guidance43_2=function(){var t=this,e=+this.geItemByIdIndex(3017,2);d.default.getInstance().limitActModel.foodFestival.guideStep="43_2",this.unscheduleAllCallbacks(),this.getLimitActMergeManagerClass().itemClick(e),cc.director.getScene().emit(u.default.UPDATE_LIMITITEM_INFO,e);var i={talk:this.GUIDANCETALK["43_2"],target:this.getBtnBoxSpeed(2),type:"tip",guideType:2};this.getLimitActMergeUIClass().guideFreeDiamond(!0);var a=d.default.getInstance().limitActModel.itemData[e].decayTime;a<=0&&(l.default.getInstance().closeUI(A.default),this.getLimitActMergeUIClass().guideFreeDiamond(!1),this.unscheduleAllCallbacks()),this.scheduleOnce(function(){l.default.getInstance().closeUI(A.default),t.getLimitActMergeUIClass().guideFreeDiamond(!1)},a),l.default.getInstance().openUI(A.default,{data:i},function(){},function(){d.default.getInstance().limitActModel.itemData[e].decayTime>0&&d.default.getInstance().limitActModel.itemData[e].speedupDecay(!0)&&(d.default.getInstance().updateTaskAndItem(),t.getLimitActMergeUIClass().guideFreeDiamond(!1),cc.director.getScene().emit(u.default.UPDATE_ITEM_INFO,e),cc.director.getScene().emit(u.default.UPDATE_LIMIT_MERGEAREA,[e])),t.guidance43_3()})},e.prototype.guidance43_3=function(){var t=this;d.default.getInstance().limitActModel.foodFestival.guideStep="43_3";var e=+this.geItemByIdIndex(3018,2);this.guideProduceFun(function(){t.guidance43_4()},3061,e,"43_3",2,{descPosY:-600})},e.prototype.guidance43_4=function(){var t=this;-1!=d.default.getInstance().limitActModel.foodFestival.itemData[32].id?(d.default.getInstance().limitActModel.foodFestival.guideStep="43_4",this.guideMergeFun(32,31,function(){t.guidance43_5()},"43_4",2,{descPosY:-600})):d.default.getInstance().limitActModel.foodFestival.guideStep="0"},e.prototype.guidance43_5=function(){var t=this;d.default.getInstance().limitActModel.foodFestival.guideStep="43_5";var e=this.getLimitActMergeManagerClass(),i=+this.geItemByIdIndex(3001,2),a=e.itemPrefabList[i],n={talk:this.GUIDANCETALK["43_5"],target:a.node,showMaskOpacity:!0,guideType:2,descPosY:-600};l.default.getInstance().openUI(A.default,{data:n},function(){},function(){d.default.getInstance().limitActModel.foodFestival.guideStep="0",t.getLimitActMergeManagerClass().itemClick(i)})},e.prototype.guidance100=function(){var t=this;this.guidance.progress="999",this.guideTalkFun(function(){t.guidance101()},"100",!0,Y.default.t("guidanceManager_5"),"jiekema_etj")},e.prototype.guidance101=function(){var t=this;this.guideTalkFun(function(){t.guidance102()},"101",!1,Y.default.t("guidanceManager_1"),"icon_player")},e.prototype.guidance102=function(){var t=this;this.guideTalkFun(function(){t.guidance103()},"102",!0,Y.default.t("guidanceManager_5"),"jiekema_etj")},e.prototype.guidance103=function(){var t=this;this.guideTalkFun(function(){t.guidance104()},"103",!1,Y.default.t("guidanceManager_1"),"icon_player")},e.prototype.guidance104=function(){var t=this,e={target:this.getTopActivityNode(),type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:e},function(){h.default.trackEvent("guide_guideStart",{step:"104"}),h.default.trackEventOnStart("guide_guideStart_104","\u65b0\u624b\u5f15\u5bfc104\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"104"}),h.default.trackEventOnEnd("guide_guideEnd_104","\u65b0\u624b\u5f15\u5bfc104\u7ed3\u675f"),l.default.getInstance().openUI(S.default,{},function(){t.guidance105()})})},e.prototype.guidance105=function(){var t=this,e=l.default.getInstance().getUI("ChildrenDayPopup");e.node.getComponent(cc.Widget).updateAlignment();var i=e.taskNode,a={talk:this.GUIDANCETALK[105],target:i,type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:a},function(){h.default.trackEvent("guide_guideStart",{step:"105"}),h.default.trackEventOnStart("guide_guideStart_105","\u65b0\u624b\u5f15\u5bfc105\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"105"}),h.default.trackEventOnEnd("guide_guideEnd_105","\u65b0\u624b\u5f15\u5bfc105\u7ed3\u675f"),t.guidance106()})},e.prototype.guidance106=function(){var t=this,e=l.default.getInstance().getUI("ChildrenDayPopup");e.node.getComponent(cc.Widget).updateAlignment();var i=e.expProgGuideNode,a={talk:this.GUIDANCETALK[106],target:i,type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:a},function(){h.default.trackEvent("guide_guideStart",{step:"106"}),h.default.trackEventOnStart("guide_guideStart_106","\u65b0\u624b\u5f15\u5bfc106\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"106"}),h.default.trackEventOnEnd("guide_guideEnd_106","\u65b0\u624b\u5f15\u5bfc106\u7ed3\u675f"),t.guidance107()})},e.prototype.guidance107=function(){var t=this,e=l.default.getInstance().getUI("ChildrenDayPopup");e.node.getComponent(cc.Widget).updateAlignment();var i={target:e.lookNode,type:"tip",guideType:2};l.default.getInstance().openUI(A.default,{data:i},function(){h.default.trackEvent("guide_guideStart",{step:"107"}),h.default.trackEventOnStart("guide_guideStart_107","\u65b0\u624b\u5f15\u5bfc107\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"107"}),h.default.trackEventOnEnd("guide_guideEnd_107","\u65b0\u624b\u5f15\u5bfc107\u7ed3\u675f"),l.default.getInstance().openUI(k.default,{},function(){t.guidance108()})})},e.prototype.guidance108=function(){var t=this,e=l.default.getInstance().getUI("ChildrenDayGiftPopup");e.node.getComponent(cc.Widget).updateAlignment();var i=e.guideNode,a={talk:this.GUIDANCETALK[108],target:i,type:"tip",guideType:2,descPosY:700};l.default.getInstance().openUI(A.default,{data:a},function(){h.default.trackEvent("guide_guideStart",{step:"108"}),h.default.trackEventOnStart("guide_guideStart_108","\u65b0\u624b\u5f15\u5bfc108\u5f00\u59cb")},function(){h.default.trackEvent("guide_guideEnd",{step:"108"}),h.default.trackEventOnEnd("guide_guideEnd_108","\u65b0\u624b\u5f15\u5bfc108\u7ed3\u675f"),t.guidance.progress="999",d.default.getInstance().saveUserData();var e=d.default.getInstance().activityData.getActivityEndTime("childrenDay");e.length>0&&cc.sys.localStorage.setItem("childrenDay",f.default.getDateByYMD(e[0]))})},e.prototype.guideMergeTip=function(){if(!this.guidance.isGuideBubble){var t=this.getBubbleItemIndex();t>=0&&this.guideBubble(t)}},e.prototype.guideBubble=function(t){var e=this;cc.director.getScene().emit(u.default.UPDATE_ITEM_INFO,t),this.getTopInfoPrefabJS().guideFreeDiamond(!0);var i={talk:Y.default.t("GuidanceManager_bubble"),target:null},a=d.default.getInstance().itemData[t].decayTime;a<=0&&(l.default.getInstance().closeUI(A.default),this.getTopInfoPrefabJS().guideFreeDiamond(!1),this.unscheduleAllCallbacks()),this.scheduleOnce(function(){console.log("\u65f6\u95f4\u5230\u5173\u95ed\u5f15\u5bfc"),l.default.getInstance().closeUI(A.default),e.getTopInfoPrefabJS().guideFreeDiamond(!1)},a),l.default.getInstance().openUI(A.default,{data:i},function(){h.default.trackEvent("guide_bubbleStart"),h.default.trackEventOnStart("guide_bubbleStart","\u65b0\u624b\u5f15\u5bfc\u6c14\u6ce1\u7269\u54c1\u5f00\u59cb")},function(){d.default.getInstance().itemData[t].decayTime>0&&e.guideBubble1(t)})},e.prototype.guideBubble1=function(t){var e=this;this.unscheduleAllCallbacks();var i=this.getMergeManagerClass(),a=i.itemPrefabList[t];i.itemClick(t),cc.director.getScene().emit(u.default.UPDATE_ITEM_INFO,t);var n={talk:"",target:a.node},o=d.default.getInstance().itemData[t].decayTime;o<=0&&(l.default.getInstance().closeUI(A.default),this.getTopInfoPrefabJS().guideFreeDiamond(!1),this.unscheduleAllCallbacks()),this.scheduleOnce(function(){l.default.getInstance().closeUI(A.default),e.getTopInfoPrefabJS().guideFreeDiamond(!1)},o),l.default.getInstance().openUI(A.default,{data:n},function(){},function(){d.default.getInstance().itemData[t].decayTime>0&&e.guideBubble2(t)})},e.prototype.guideBubble2=function(t){var e=this;this.unscheduleAllCallbacks();var i={talk:"",target:this.getBtnBoxSpeed(),type:"tip"},a=d.default.getInstance().itemData[t].decayTime;a<=0&&(l.default.getInstance().closeUI(A.default),this.getTopInfoPrefabJS().guideFreeDiamond(!1),this.unscheduleAllCallbacks()),this.scheduleOnce(function(){l.default.getInstance().closeUI(A.default),e.getTopInfoPrefabJS().guideFreeDiamond(!1)},a),l.default.getInstance().openUI(A.default,{data:i},function(){},function(){if(d.default.getInstance().itemData[t].decayTime>0){var i=d.default.getInstance().itemData[t].buyItem(!0);i&&(h.default.trackEvent("guide_bubbleEnd"),h.default.trackEventOnEnd("guide_bubbleEnd","\u65b0\u624b\u5f15\u5bfc\u6c14\u6ce1\u7269\u54c1\u7ed3\u675f"),d.default.getInstance().updateTaskAndItem(),cc.director.getScene().emit(u.default.UPDATE_ITEM_INFO,t),cc.director.getScene().emit(u.default.UPDATE_MERGEAREA,[t]),e.getTopInfoPrefabJS().guideFreeDiamond(!1),i.newCustomerId>0&&l.default.getInstance().openNotice(z.default,{data:{ntype:"customer",id:i.newCustomerId}}),i.newItemId>=0&&c.default.getInstance().mstItem[i.newItemId].isUnlockShow&&l.default.getInstance().openNotice(z.default,{data:{ntype:"item",id:i.newItemId}})),e.guidance.setGuideBubbleComplete()}})},e.prototype.getMergeBackBtnNode=function(){return cc.find("Canvas/MergeUIContent/MergeUI/bottomInfoContent/BottomInfoPrefab/Root/BtnReturn")},e.prototype.getPassBtnNode=function(){return cc.find("Canvas/SceneUIContent/HemaPrefab/hemaUI/right/btnPass")},e.prototype.getBtnBuildBubble=function(){return cc.find("Canvas/SceneUIContent/HemaPrefab/root/gamenode/pupnode").children[0]},e.prototype.getBtnTopTaskComplete=function(){return cc.find("Canvas/MergeUIContent/MergeUI/topInfoContent/TopInfoPrefab/tasks/tasksScrollView/view/content").children[0]},e.prototype.getTopActivityNode=function(){return cc.find("Canvas/MergeUIContent/MergeUI/topInfoContent/TopInfoPrefab/tasks/activityNode").children[0]},e.prototype.getBtnTopTask=function(){return cc.find("Canvas/MergeUIContent/MergeUI/topInfoContent/TopInfoPrefab/tasks/btnTask")},e.prototype.getBtnMerge=function(){var t=cc.find("Canvas/SceneUIContent/HemaPrefab/hemaUI/btnMerge");return t.getComponent(cc.Widget).updateAlignment(),t},e.prototype.getDressUpBtnNode=function(){var t=cc.find("Canvas/SceneUIContent/HemaPrefab/hemaUI/btnDressUp");return t.getComponent(cc.Widget).updateAlignment(),t},e.prototype.getHmaPrefabNode=function(){return cc.find("Canvas/SceneUIContent/HemaPrefab")},e.prototype.getMergeManagerClass=function(){return cc.find("Canvas/MergeUIContent/MergeUI/MergeManager").getComponent("MergeManager")},e.prototype.getLimitActMergeManagerClass=function(){return cc.find("Canvas/LimitActMergeUIContent/LimitActMergeUI/MergeManager").getComponent("LimitActMergeManager")},e.prototype.getLimitActMergeUIClass=function(){return cc.find("Canvas/LimitActMergeUIContent/LimitActMergeUI").getComponent("LimitActMergeUI")},e.prototype.getSpanwerIndex=function(t){void 0===t&&(t=1);var e=null;for(var i in 1==t?e=d.default.getInstance().itemData:2==t&&(e=d.default.getInstance().limitActModel.itemData),e){var a=e[i].id;if(a>0&&c.default.getInstance().mstItem[a].isSpawner)return i}},e.prototype.getBoxIndex=function(){for(var t in d.default.getInstance().itemData){var e=d.default.getInstance().itemData[t].id;if(e>0&&c.default.getInstance().mstItem[e].isBox)return t}},e.prototype.getBoxId=function(){for(var t in d.default.getInstance().itemData){var e=d.default.getInstance().itemData[t].id;if(e>0&&c.default.getInstance().mstItem[e].isBox)return d.default.getInstance().itemData[t]}},e.prototype.getDiamondItemIndex=function(){for(var t in d.default.getInstance().itemData){var e=d.default.getInstance().itemData[t].id;if(e>0&&"diamond"==c.default.getInstance().mstItem[e].type)return t}return-1},e.prototype.getBubbleItemIndex=function(t){void 0===t&&(t=1);var e=null;for(var i in 1==t?e=d.default.getInstance().itemData:2==t&&(e=d.default.getInstance().limitActModel.itemData),e)if(e[i].id>0&&e[i].state==s.default.ITEM_STATE_BUBBLE)return parseInt(i);return-1},e.prototype.geItemByIdIndex=function(t,e){void 0===e&&(e=1);var i=null;for(var a in 1==e?i=d.default.getInstance().itemData:2==e&&(i=d.default.getInstance().limitActModel.itemData),i)if(t==i[a].id)return a;return""},e.prototype.getBtnTaskOpen=function(){return cc.find("Canvas/MergeUIContent/MergeUI/bottomInfoContent/BottomInfoPrefab/Root/btnTask")},e.prototype.getTopInfoPrefabJS=function(){return cc.find("Canvas/MergeUIContent/MergeUI/topInfoContent/TopInfoPrefab").getComponent("TopInfoPrefab")},e.prototype.getBtnBoxLock=function(){return cc.find("Canvas/MergeUIContent/MergeUI/topInfoContent/TopInfoPrefab").getComponent("TopInfoPrefab").speedUpBtnNode},e.prototype.getBtnBoxSpeed=function(t){void 0===t&&(t=1);var e=null;return 1==t?e=cc.find("Canvas/MergeUIContent/MergeUI/topInfoContent/TopInfoPrefab").getComponent("TopInfoPrefab").speedUpBtnNode:2==t&&(e=cc.find("Canvas/LimitActMergeUIContent/LimitActMergeUI").getComponent("LimitActMergeUI").speedUpBtnNode),e},e.prototype.getBtnChain=function(){return cc.find("Canvas/MergeUIContent/MergeUI/topInfoContent/TopInfoPrefab").getComponent("TopInfoPrefab").itemChainNode},e.prototype.getBtnBox=function(){return cc.find("Canvas/MergeUIContent/MergeUI/bottomInfoContent/BottomInfoPrefab/Root/BtnAward")},e.prototype.getBtnShop=function(){return cc.find("Canvas/MergeUIContent/MergeUI/bottomInfoContent/BottomInfoPrefab/Root/BtnShop")},e.prototype.getBtnTask=function(){return cc.find("Canvas/MergeUIContent/MergeUI/bottomInfoContent/BottomInfoPrefab/Root/BtnTask")},e.prototype.getBtnBag=function(){return cc.find("Canvas/MergeUIContent/MergeUI/bottomInfoContent/BottomInfoPrefab/Root/BtnBag")},e.prototype.goToMergeUI=function(t){void 0===t&&(t=null),0==cc.find("Canvas").getComponent(_.default).isMainScene&&cc.director.getScene().emit(u.default.CLOSE_SCENE);var e=this.getMergeManagerClass();e.isLoadAreaOneFinish?t&&t():l.default.getInstance().openUI(p.default,{data:{showBlack:!1}},function(){e.isLoadAreaOneFinish?(l.default.getInstance().closeUI(p.default),t&&t()):e.setFinishCallBack(function(){l.default.getInstance().closeUI(p.default),t&&t()})})},e.prototype.goToMainUI=function(){1==cc.find("Canvas").getComponent(_.default).isMainScene&&cc.director.getScene().emit(u.default.OPEN_SCENE)},e.prototype.getFourArea=function(){return cc.find("Canvas/MergeUIContent/MergeUI/MergeManager").getComponent("MergeManager").areaNode[0].getChildByName("lockAreaContent").children[0]},o([K],e)}(cc.Component));i.default=X,cc._RF.pop()},{"../../scripts/data/MiscConfig":void 0,"../../scripts/data/MiscData":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/Loading":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../../scripts/utils/StatisticsManager":void 0,"../entitys/BuildTaskBubble":"BuildTaskBubble","../entitys/HemaPrefab":"HemaPrefab","../entitys/TopInfoTaskItem":"TopInfoTaskItem","../scenes/MainScene":"MainScene","./AtlasPopup":"AtlasPopup","./BagPopup":"BagPopup","./BuildCompletePopup":"BuildCompletePopup","./BuildInfoPopup":"BuildInfoPopup","./BuildTaskPopup":"BuildTaskPopup","./ChildrenDayGiftPopup":"ChildrenDayGiftPopup","./ChildrenDayPopup":"ChildrenDayPopup","./ChristmasAniPopup":"ChristmasAniPopup","./ChristmasPopup":"ChristmasPopup","./ContractPopup":"ContractPopup","./CustomerInfoPopup":"CustomerInfoPopup","./Guide":"Guide","./HappyBingoHelpPopup":"HappyBingoHelpPopup","./HappyBingoPopup":"HappyBingoPopup","./HelpPopup":"HelpPopup","./ItemChain":"ItemChain","./LockAreaItem":"LockAreaItem","./NewUserGiftPopup":"NewUserGiftPopup","./NewYearAniPopup":"NewYearAniPopup","./NewYearExchangePopup":"NewYearExchangePopup","./NewYearPopup":"NewYearPopup","./OpeningPopup":"OpeningPopup","./PassPopup":"PassPopup","./ShopPopup":"ShopPopup","./TaskPopup":"TaskPopup","./UnlockShowPopup":"UnlockShowPopup"}],Guide:[function(t,e,i){"use strict";cc._RF.push(e,"ab458cBoShL064+N7/MrCYp","Guide");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/UserData"),c=t("../../scripts/manager/AdManager"),d=t("../../scripts/manager/AudioManager"),l=t("../../scripts/utils/ActionFunc"),p=t("../../scripts/utils/GlobalFun"),u=t("../entitys/HemaPrefab"),f=t("../../scripts/extension/LanguageData"),h=cc._decorator,g=h.ccclass,m=h.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.light=null,e.aperture=null,e.touch=null,e.block=null,e.maskNode=null,e.hand=null,e.talkNode=null,e.lbTalk=null,e.descNode=null,e.lbDesc=null,e.followBlock=null,e.roleNode=null,e.lbTalkerName=null,e.handMoveTime=.5,e.talkSpeed=.05,e._data=null,e._isSpeakEnd=!1,e}return n(e,t),e.prototype.init=function(t){this.maskNode.parent.active=!0,this._data=t},e.prototype.onLoad=function(){this.node.getComponent(cc.Widget).updateAlignment(),this.node.getChildByName("Root").getComponent(cc.Widget).updateAlignment(),this.updateUI(),c.default.getInstance().hideBanner()},e.prototype.updateUI=function(){this.initTalk(),this.registerTouch()},e.prototype.initTalk=function(){var t=this;this._data.guideType=this._data.guideType?this._data.guideType:1,1==this._data.guideType?(this.talkNode.active=!0,this.descNode.active=!1,this._data.talk?(this._isSpeakEnd=!1,this.showTalk(),l.default.printerAnim(this.lbTalk,this._data.talk,function(){t._isSpeakEnd=!0})):(this._isSpeakEnd=!0,this.closeTalk())):(this._data.descPosY=isNaN(this._data.descPosY)?null:this._data.descPosY,this.talkNode.active=!1,this.descNode.active=!0,this._data.talk?(this.lbDesc.string=p.default.getRichText(this._data.talk),this._isSpeakEnd=!0,this.closeTalk(),this.maskNode.y<=0?(this.descNode.setPosition(this.maskNode.position),this.descNode.x=0,null!=this._data.descPosY?this.descNode.y=this._data.descPosY:this.descNode.y+=this.maskNode.height+100):(this.descNode.setPosition(this.maskNode.position),this.descNode.x=0,null!=this._data.descPosY?this.descNode.y=this._data.descPosY:this.descNode.y-=this.maskNode.height+100)):(this.descNode.active=!1,this._isSpeakEnd=!0,this.closeTalk()))},e.prototype.showTalk=function(){this.talkNode.active=!0,this.light.opacity=0,this.hand.opacity=0,this.maskNode.opacity=0,this._data.talkerImg=this._data.talkerImg?this._data.talkerImg:"icon_jiekema_2",this._data.talkerName=this._data.talkerName?this._data.talkerName:f.default.t("guide_1"),this._data.isLeft=void 0===this._data.isLeft||this._data.isLeft;var t="textures/role/talkerIcon/"+this._data.talkerImg;p.default.loadSpriteFrame(this.roleNode,t),this.lbTalkerName.string=this._data.talkerName,this._data.isLeft?(this.roleNode.x=-377,this.lbTalkerName.node.parent.x=-360):(this.roleNode.x=377,this.lbTalkerName.node.parent.x=360)},e.prototype.closeTalk=function(){this.talkNode.active=!1,this.light.opacity=255,this.hand.opacity=255,this.maskNode.opacity=255,this._data.target?(this.touch.active=!0,this.initMask()):(this.touch.active=!1,this._data.move&&this._data.move.length>1?this.initMerge():this.onClose())},e.prototype.onClickTalk=function(){this._isSpeakEnd?this.closeTalk():this.onClickSpeak()},e.prototype.onClickSpeak=function(){this._isSpeakEnd||(this._isSpeakEnd=!0,this.lbTalk.node.stopAllActions(),this.lbTalk.string=p.default.getRichText(this._data.talk))},e.prototype.initMask=function(){void 0===this._data.type&&(this._data.type="mask"),void 0===this._data.showMask&&(this._data.showMask=!0),void 0===this._data.showMaskOpacity&&(this._data.showMaskOpacity=!0),void 0===this._data.scale&&(this._data.scale=!1),void 0===this._data.showHand&&(this._data.showHand=!0),void 0===this._data.showLight&&(this._data.showLight=!0),this._data.showMask?(this.maskNode.active=!0,this._data.showMaskOpacity?this.block.opacity=180:this.block.opacity=0):this.maskNode.active=!1,this._data.showHand?this.hand.active=!0:this.hand.active=!1,this._data.showLight?this.light.active=!0:this.light.active=!1;var t=this._data.target,e=t.parent.convertToWorldSpaceAR(t.position),i=this.node.convertToNodeSpaceAR(e),a=1;if(this._data.scale&&(a=cc.find("Canvas/SceneUIContent/HemaPrefab").getComponent(u.default).optNode.scale),this.maskNode.width=t.width*a,this.maskNode.height=t.height*a,this.maskNode.setPosition(i),this.hand.setPosition(i),this.hand.getComponent(cc.Animation).play(),this.light.setPosition(i),this.light.width=t.width*a+15,this.light.height=t.height*a+15,"follow"==this._data.type)this.followBlock.active=!0,this.maskNode.width=250,this.maskNode.height=500,this.light.width=265,this.light.height=515,this.block.getComponent(cc.Widget).alignMode=cc.Widget.AlignMode.ALWAYS;else if("show"==this._data.type){this.touch.active=!1,this.maskNode.height=400,this.maskNode.width=950;var n=cc.find("Canvas/MergeUIContent/MergeUI/MergeManager").getComponent("MergeManager").itemPrefabList[24].node,o=n.parent.convertToWorldSpaceAR(n.position),s=this.node.convertToNodeSpaceAR(o);this.maskNode.x=s.x,this.maskNode.y=s.y}},e.prototype.initMerge=function(){if(this.block.opacity=0,this.light.active=!1,2==this._data.move.length){var t=this._data.move[0].parent.convertToWorldSpaceAR(this._data.move[0].position),e=this._data.move[1].parent.convertToWorldSpaceAR(this._data.move[1].position),i=this.node.convertToNodeSpaceAR(t),a=this.node.convertToNodeSpaceAR(e),n=p.default.getTimeByPosAndSpeed(i,a,200),o=l.default.toAndFroAnimation(this.hand,i,a,n);if(l.default.playAction(this.hand,o,!1,null,!0),!this._data.target){this.maskNode.height=400,this.maskNode.width=950;var s=null;1==this._data.mergeType?s=cc.find("Canvas/MergeUIContent/MergeUI/MergeManager").getComponent("MergeManager").itemPrefabList[52].node:2==this._data.mergeType&&(cc.find("Canvas/LimitActMergeUIContent/LimitActMergeUI/MergeManager").getComponent("LimitActMergeManager"),s=this._data.move[0],this.maskNode.height=s.width,this.maskNode.width=s.height);var r=s.parent.convertToWorldSpaceAR(s.position),c=this.node.convertToNodeSpaceAR(r);this.maskNode.x=c.x,this.maskNode.y=c.y}}},e.prototype.registerTouch=function(){var t=this;this.touch.on(cc.Node.EventType.TOUCH_END,function(e){t._isSpeakEnd?t.onMaskClick():t.onClickSpeak(),e.stopPropagation()})},e.prototype.onMaskClick=function(){this.talkNode.active?this.closeTalk():this._isSpeakEnd&&("mask"==this._data.type&&this._data.target?(this._data.target.emit(cc.Node.EventType.TOUCH_START,new cc.Event(cc.Node.EventType.TOUCH_START,!1)),this._data.target.emit(cc.Node.EventType.TOUCH_END,new cc.Event(cc.Node.EventType.TOUCH_END,!1))):"tip"==this._data.type&&d.default.getInstance().playEffect("clickBtn"),this.onClose())},e.prototype.update=function(){this._data&&"follow"==this._data.type&&this.followTarget()},e.prototype.followTarget=function(){if(this._data.target&&cc.isValid(this.node)&&cc.isValid(this._data.target)){var t=this._data.target,e=t.parent.convertToWorldSpaceAR(t.position),i=this.node.convertToNodeSpaceAR(e);this.maskNode.setPosition(cc.v2(i.x,i.y+94)),this.light.setPosition(cc.v2(i.x,i.y+94))}},e.prototype.onClickCloseGuide=function(){r.default.getInstance().closeGuide(),cc.game.restart()},e.uiName="Guide",o([m(cc.Node)],e.prototype,"light",void 0),o([m(cc.Node)],e.prototype,"aperture",void 0),o([m(cc.Node)],e.prototype,"touch",void 0),o([m(cc.Node)],e.prototype,"block",void 0),o([m(cc.Node)],e.prototype,"maskNode",void 0),o([m(cc.Node)],e.prototype,"hand",void 0),o([m(cc.Node)],e.prototype,"talkNode",void 0),o([m(cc.RichText)],e.prototype,"lbTalk",void 0),o([m(cc.Node)],e.prototype,"descNode",void 0),o([m(cc.RichText)],e.prototype,"lbDesc",void 0),o([m(cc.Node)],e.prototype,"followBlock",void 0),o([m(cc.Node)],e.prototype,"roleNode",void 0),o([m(cc.Label)],e.prototype,"lbTalkerName",void 0),o([m(cc.Float)],e.prototype,"handMoveTime",void 0),o([m(cc.Float)],e.prototype,"talkSpeed",void 0),o([g],e)}(s.default);i.default=v,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/AudioManager":void 0,"../../scripts/utils/ActionFunc":void 0,"../../scripts/utils/GlobalFun":void 0,"../entitys/HemaPrefab":"HemaPrefab"}],HappyBingoBtn:[function(t,e,i){"use strict";cc._RF.push(e,"d6b31Z5h+pNlqedsq42HKIZ","HappyBingoBtn");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/UserData"),r=t("../../scripts/manager/UIManager"),c=t("../../scripts/utils/ActionFunc"),d=t("../../scripts/utils/EventName"),l=t("../../scripts/utils/GlobalFun"),p=t("../prefabs/HappyBingoPopup"),u=cc._decorator,f=u.ccclass,h=u.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.completedSp=null,e.noCompletedSp=null,e.uiNode=null,e.endTimeLab=null,e.btnLab=null,e._happyBingo=null,e._endTime=[],e._isStartAni=!1,e}return n(e,t),e.prototype.onClickActivity=function(){r.default.getInstance().openUI(p.default)},e.prototype.updateCompleted=function(){var t=this._happyBingo.isCanSubmit();t&&!this._isStartAni?(c.default.zoomAnim2(this.uiNode),this._isStartAni=!0,this.uiNode.getChildByName("btnSure").getComponent(cc.Sprite).spriteFrame=this.completedSp,this.btnLab.getComponent(cc.LabelOutline).color=cc.color().fromHEX("#406223")):!t&&this._isStartAni&&(cc.Tween.stopAllByTarget(this.uiNode),this._isStartAni=!1,this.uiNode.getChildByName("btnSure").getComponent(cc.Sprite).spriteFrame=this.noCompletedSp,this.btnLab.getComponent(cc.LabelOutline).color=cc.color().fromHEX("#9D6848"))},e.prototype.updateTime=function(){var t=this._endTime;if(t.length>0){var e=t[1]-window.serverTime;e>0?this.endTimeLab.string=l.default.timeFormat(e):cc.director.getScene().emit(d.default.RESET_ACTIVITY)}else cc.director.getScene().emit(d.default.RESET_ACTIVITY)},e.prototype.onLoad=function(){this._endTime=s.default.getInstance().activityData.getActivityEndTime("happyBingo"),this._happyBingo=s.default.getInstance().activityData.happyBingo,cc.director.getScene().on(d.default.UPDATE_MERGEAREA,this.updateCompleted,this),cc.director.getScene().on(d.default.UPDATE_BY_SECOND,this.updateTime,this),this.updateTime(),this.updateCompleted(),s.default.getInstance().activityData.isFirstLoadActivitu("happyBingo")?(s.default.getInstance().activityData.setShowOneActivity("happyBingo"),s.default.getInstance().updateTaskAndItem(),cc.director.getScene().emit(d.default.UPDATE_MERGEAREA)):s.default.getInstance().activityData.setShowOneActivity("happyBingo")},o([h(cc.SpriteFrame)],e.prototype,"completedSp",void 0),o([h(cc.SpriteFrame)],e.prototype,"noCompletedSp",void 0),o([h(cc.Node)],e.prototype,"uiNode",void 0),o([h(cc.Label)],e.prototype,"endTimeLab",void 0),o([h(cc.Label)],e.prototype,"btnLab",void 0),o([f],e)}(cc.Component);i.default=g,cc._RF.pop()},{"../../scripts/data/UserData":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/utils/ActionFunc":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../prefabs/HappyBingoPopup":"HappyBingoPopup"}],HappyBingoHelpPopup:[function(t,e,i){"use strict";cc._RF.push(e,"5b53bg+AypEjqIb3ekZrhWh","HappyBingoHelpPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=cc._decorator,c=r.ccclass,d=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lineGroup=null,e.tipNode=null,e}return n(e,t),e.prototype.onLoad=function(){var t=1,e=this.lineGroup.children[0].children[0];e.position=cc.v3(0,100),cc.tween(e).repeatForever(cc.tween(e).delay(2).to(.5,{opacity:0}).call(function(){t<5?(e.position=cc.v3(0,100-50*t),e.angle=0):(e.position=cc.v3(50*(t-5)-100,0),e.angle=90),t=(t+1)%10}).to(.5,{opacity:255})).start();var i=this.lineGroup.children[1].children[0];cc.tween(i).repeatForever(cc.tween(e).delay(2).to(.5,{opacity:0}).call(function(){i.angle=(i.angle+90)%360}).to(.5,{opacity:255})).start();var a=this.lineGroup.children[2].children[0];cc.tween(a).repeatForever(cc.tween(e).delay(2).to(.5,{opacity:0}).to(.5,{opacity:255})).start()},e.prototype.getTipNode=function(){return this.tipNode},e.uiName="HappyBingoHelpPopup",o([d(cc.Node)],e.prototype,"lineGroup",void 0),o([d(cc.Node)],e.prototype,"tipNode",void 0),o([c],e)}(s.default);i.default=l,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0}],HappyBingoItem:[function(t,e,i){"use strict";cc._RF.push(e,"14497F/A65KRaq7oDULCk47","HappyBingoItem");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/MstData"),r=t("../../scripts/data/UserData"),c=t("../../scripts/manager/UIManager"),d=t("../../scripts/utils/GlobalFun"),l=t("../prefabs/HappyBingoSubmitPopup"),p=cc._decorator,u=p.ccclass,f=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bgComSp=null,e.bgNoComSp=null,e.bgSp=null,e.bgNode=null,e.iconNode=null,e.completeNode=null,e._parentNode=null,e._happyBingoModel=null,e._index=0,e}return n(e,t),e.prototype.init=function(t,e){this._parentNode=t,this._happyBingoModel=r.default.getInstance().activityData.happyBingo,this._index=e},e.prototype.updateUI=function(t){if(this._happyBingoModel.receiveIndex.includes(this._index)||this._happyBingoModel.isCompleted)this.iconNode.active=!1,this.bgNode.active=!0,this.completeNode.active=!1;else{var e="textures/itemIcon/"+s.default.getInstance().mstItem[t[0]].icon;d.default.loadSpriteFrame(this.iconNode,e);var i=r.default.getInstance().getNormalItemIndexByIds(t);this.completeNode.active=!i.includes(-1),this.bgSp.spriteFrame=i.includes(-1)?this.bgNoComSp:this.bgComSp,this.bgNode.active=!1,this.iconNode.active||this.itemTurnAnimation()}},e.prototype.updateItemCompleted=function(t){if(!this._happyBingoModel.receiveIndex.includes(this._index)&&!this._happyBingoModel.isCompleted){var e=!r.default.getInstance().getNormalItemIndexByIds(t).includes(-1);this.completeNode.active=e,this.bgSp.spriteFrame=e?this.bgComSp:this.bgNoComSp}},e.prototype.playItemAnimation=function(){var t=this;this.bgNode.active=!0,this.bgNode.scale=0,this.completeNode.active=!1,cc.tween(this.iconNode).to(.3,{scale:0}).call(function(){t.iconNode.scale=1,t.iconNode.active=!1}).start(),cc.tween(this.bgNode).delay(.3).to(.3,{scale:1}).call(function(){t.itemLineAnimation(),t._parentNode.updateGroupReward(t._index)}).start()},e.prototype.itemLineAnimation=function(t){var e=this;void 0===t&&(t=-1),t>=0?this.scheduleOnce(function(){cc.tween(e.bgNode).to(.3,{scale:1.2}).to(.3,{scale:1}).start()},t):cc.tween(this.bgNode).to(.3,{scale:1.2}).to(.3,{scale:1}).start()},e.prototype.itemTurnAnimation=function(){var t=this.iconNode;t.scaleX=0,t.active=!0,this.bgNode.active=!0,cc.tween(this.bgNode).to(.3,{scaleX:0}).start(),cc.tween(t).delay(.3).to(.3,{scaleX:1}).start()},e.prototype.onClickItem=function(){this._happyBingoModel.receiveIndex.includes(this._index)||this._happyBingoModel.isCompleted||c.default.getInstance().openUI(l.default,{data:{index:this._index,parentNode:this._parentNode}})},o([f(cc.SpriteFrame)],e.prototype,"bgComSp",void 0),o([f(cc.SpriteFrame)],e.prototype,"bgNoComSp",void 0),o([f(cc.Sprite)],e.prototype,"bgSp",void 0),o([f(cc.Node)],e.prototype,"bgNode",void 0),o([f(cc.Node)],e.prototype,"iconNode",void 0),o([f(cc.Node)],e.prototype,"completeNode",void 0),o([u],e)}(cc.Component);i.default=h,cc._RF.pop()},{"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/utils/GlobalFun":void 0,"../prefabs/HappyBingoSubmitPopup":"HappyBingoSubmitPopup"}],HappyBingoPopup:[function(t,e,i){"use strict";cc._RF.push(e,"58145ByE3JIiL/R0CZb4c4Z","HappyBingoPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MstData"),c=t("../../scripts/data/UserData"),d=t("../../scripts/manager/AudioManager"),l=t("../../scripts/manager/UIManager"),p=t("../../scripts/prefabs/Toast"),u=t("../../scripts/utils/ActionFunc"),f=t("../../scripts/utils/EventName"),h=t("../../scripts/utils/GlobalFun"),g=t("../../scripts/utils/StatisticsManager"),m=t("../entitys/BuildItem"),v=t("../entitys/HappyBingoItem"),_=t("../entitys/ItemEntity"),y=t("./AwardPopup"),I=t("./HappyBingoHelpPopup"),b=t("./HappyBingoSubmitPopup"),N=t("./UnlockShowPopup"),C=t("../../scripts/extension/LanguageData"),k=cc._decorator,S=k.ccclass,w=k.property,T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cardSV=null,e.rewardItem=null,e.itemNode=null,e.proNode=null,e.proBg=null,e.proGroup=null,e.awardGroup=null,e.cardGroup=null,e.awardIconGroup=null,e.awardNumGroup=null,e.awardComGroup=null,e.lineNode=null,e.endTimeLab=null,e.helpNode=null,e._happyBingoModel=null,e._taskModel=[],e._totalNum=0,e._lineReward={},e._endTime=[],e._completedRewardNode=[],e._proLong=250,e}return n(e,t),e.prototype.init=function(){this._happyBingoModel=c.default.getInstance().activityData.happyBingo,this._happyBingoModel.nextLv(),this.initCompleteReward(),this.updateProgress(),this.initCompletedRewardAnimation();for(var t=0;t<this.cardGroup.children.length;t++)this.cardGroup.children[t].getComponent(v.default).init(this,t);if(this.updateGroup(),this._happyBingoModel.isCompleted){var e=C.default.t("happyBingoPopup_1");l.default.getInstance().openUI(p.default,{data:{str:e}})}},e.prototype.initCompleteReward=function(){var t,e,i=0,a=this._proLong,n=this._happyBingoModel.completeReward,o=function(o){var c={},d=n[o],l=null!==(t=d.rewardRes[0])&&void 0!==t?t:d.reward[0],p=null!==(e=d.rewardRes[1])&&void 0!==e?e:0;m.default;var u=cc.instantiate(s.rewardItem);if(30098==+l){var f=r.default.getInstance().mstBuildingSkin[p].nodeName;f&&cc.resources.load("building/"+f,cc.Prefab,function(t,e){if(!t){var i=cc.instantiate(e);i.getComponent(m.default).initUnlockShow(130,130),c.iconNode=i,c.itemId=l,c.itemNum=p,c.isClickAble=!0,c.isShowInfo=!0,u.getChildByName("reward").getChildByName("ItemEntity").getComponent(_.default).init(c)}})}else{if(c.itemId=l,!c.itemId)return"continue";c.itemNum=p,c.isClickAble=!0,c.isShowInfo=!0,u.getChildByName("reward").getChildByName("ItemEntity").getComponent(_.default).init(c)}i++,s.awardGroup.addChild(u),u.x=a*i,u.y=0,u.getChildByName("lab").getComponent(cc.Label).string=o+"";var h=s._happyBingoModel.completeRewardIndex.includes(+o);u.getChildByName("com").active=!h&&+o<s._happyBingoModel.lv,s._completedRewardNode.push(u);var g=u.getChildByName("reward").getChildByName("btn");g.getComponent(cc.Button).clickEvents[0].customEventData=o,g.active=h,u.getChildByName("num").active=+o==s._happyBingoModel.lv},s=this;for(var c in n)o(c);this._totalNum=i,this.proGroup.width=a*i+150,this.proBg.width=a*i,this.updateScrollTo()},e.prototype.initCompletedRewardAnimation=function(){for(var t=0;t<this._completedRewardNode.length;t++)this._happyBingoModel.completeRewardIndex.includes(t+1)&&this.playOneCompletedRewardAnimation(t)},e.prototype.playOneCompletedRewardAnimation=function(t){var e=this._completedRewardNode[t].getChildByName("reward");u.default.zoomAnim2(e),this._completedRewardNode[t].getChildByName("num").active=!1,this._completedRewardNode[t].getChildByName("com").active=!1,e.getChildByName("btn").active=!0},e.prototype.stopOneCompletedRewardAnimation=function(t){var e=this._completedRewardNode[t].getChildByName("reward");cc.Tween.stopAllByTarget(e),e.scale=1,e.getChildByName("btn").active=!1,this._completedRewardNode[t].getChildByName("com").active=t+1<this._happyBingoModel.lv},e.prototype.updateReward=function(){var t=this._happyBingoModel.isCompleted?this._happyBingoModel.config[this._happyBingoModel.lv-1]:this._happyBingoModel.config[this._happyBingoModel.lv],e=t.rewardRes,i=t.reward,a=null,n=null;e.length>0?(a=e[0],n=e[1]):(a=i[0],n=1);for(var o=this._happyBingoModel.getRceivedRewardIndexArr(),s=0;s<this.awardIconGroup.children.length;s++){var c="textures/itemIcon/"+r.default.getInstance().mstItem[a].icon;h.default.loadSpriteFrame(this.awardIconGroup.children[s],c),this.awardNumGroup.children[s].getComponent(cc.Label).string="x"+n,this.awardComGroup.children[s].active=o.includes(s)||this._happyBingoModel.isCompleted}},e.prototype.updateProgress=function(){var t=(this._happyBingoModel.receiveIndex.length+25*(this._happyBingoModel.lv-1))/(25*this._totalNum);this.proNode.width=t*this._totalNum*this._proLong;var e=this._completedRewardNode[this._happyBingoModel.lv-1];e&&(e.getChildByName("num").active=!0,e.getChildByName("num").getComponent(cc.Label).string=this._happyBingoModel.receiveIndex.length+"/25")},e.prototype.updateScrollTo=function(t,e){void 0===t&&(t=0),void 0===e&&(e=!1);var i=this._proLong,a=this._happyBingoModel.completeRewardIndex.length>0&&!e?this._happyBingoModel.completeRewardIndex[0]:this._happyBingoModel.lv-1,n=this.awardGroup.children[a]?this.awardGroup.children[a].x-1.5*i:1e3;this.cardSV.scrollToOffset(cc.v2(n,0),t)},e.prototype.updateGroup=function(){this._taskModel=this._happyBingoModel.taskData;for(var t=0;t<this.cardGroup.children.length;t++)this.updateItem(t);this._lineReward=this._happyBingoModel.getLineReward(),this.updateReward()},e.prototype.updateGroupCompleted=function(){for(var t=0;t<this.cardGroup.children.length;t++){var e=this.cardGroup.children[t],i=this._taskModel[t]?this._taskModel[t].requireItems:null;e.getComponent(v.default).updateItemCompleted(i)}},e.prototype.updateItem=function(t){var e=this.cardGroup.children[t],i=this._taskModel[t]?this._taskModel[t].requireItems:null;e.getComponent(v.default).updateUI(i)},e.prototype.updateGroupReward=function(t){for(var e=this._happyBingoModel.getWireIndexAarr(t),i=0;i<e.length;i++){if(this._happyBingoModel.receiveIndex.length>=25){var a=C.default.t("happyBingoPopup_2");l.default.getInstance().openUI(p.default,{data:{str:a}})}this.playerAnimationByArr(e[i],t),this.playLineAnimationByArr(e[i])}e.length>0&&d.default.getInstance().playEffect("bingoLine")},e.prototype.playerAnimationByArr=function(t,e){for(var i=0,a=1,n=t.indexOf(e),o=0;o<t.length;o++){var s=t[n+a],r=t[n-a];if(!s&&!r)break;i+=.1,s&&this.cardGroup.children[s].getComponent(v.default).itemLineAnimation(i),r&&this.cardGroup.children[r].getComponent(v.default).itemLineAnimation(i),a++}},e.prototype.playLineAnimationByArr=function(t){var e=this,i=cc.instantiate(this.lineNode);this.lineNode.parent.addChild(i);var a=t[0],n=t[4];i.position=this.cardGroup.children[t[2]].position,Math.floor(a/5)==Math.floor(n/5)?(i.height=690,i.angle=90):Math.floor(a%5)==Math.floor(n%5)?(i.height=690,i.angle=0):t[4]%6==0?(i.height=970,i.angle=45):t[4]%4==0&&(i.height=970,i.angle=-45),i.opacity=0,d.default.getInstance().playEffect("bingoLine"),cc.tween(i).to(.4,{opacity:255}).to(.4,{opacity:0}).call(function(){d.default.getInstance().playEffect("bingoLine")}).to(.4,{opacity:255}).to(.4,{opacity:0}).call(function(){d.default.getInstance().playEffect("bingoLine")}).to(.4,{opacity:255}).to(.4,{opacity:0}).call(function(){i.destroy()}).start();var o=this._happyBingoModel.getRewardIndexByWireArr(t),s=this.awardIconGroup.children[o],r=this.awardNumGroup.children[o],c=this._happyBingoModel.receiveIndex.length>=25;cc.tween(s).to(.4,{opacity:0}).to(.4,{opacity:255}).to(.4,{opacity:0}).to(.4,{opacity:255}).to(.4,{opacity:0}).to(.4,{opacity:255}).call(function(){e.awardComGroup.children[o].active=!0,e.getAwardByLine(t,c)}).start(),cc.tween(r).to(.4,{opacity:0}).to(.4,{opacity:255}).to(.4,{opacity:0}).to(.4,{opacity:255}).to(.4,{opacity:0}).to(.4,{opacity:255}).start()},e.prototype.getAwardByLine=function(t,e){var i=this,a=this._happyBingoModel.getRewardIndexByWireArr(t),n=this._lineReward.id,o=this._lineReward.num,s={};s.id=n,s.startNode=this.awardIconGroup.children[a],s.num=o,s.infoType="diamond",s.callback=function(){cc.director.getScene().emit(f.default.UPDATE_REWARD),cc.isValid(i)&&i._happyBingoModel.receiveIndex.length>=25&&e&&(g.default.trackEvent("activity_happyBingo_complete",{bingoId:i._happyBingoModel.lv+""}),i._happyBingoModel.nextLv(),i._happyBingoModel.isCompleted||(i.updateGroup(),c.default.getInstance().updateTaskAndItem(),i.updateProgress(),d.default.getInstance().playEffect("bingoUpdate")),i.updateScrollTo(.3,!0),i.playOneCompletedRewardAnimation(i._happyBingoModel.lv-2))},cc.director.getScene().emit(f.default.ITEM_FLY,s)},e.prototype.itemAnimation=function(t,e){this.cardGroup.children[t].getComponent(v.default).playItemAnimation(),this.getAwardByIndex(t,e)},e.prototype.getAwardByIndex=function(t,e){var i={id:"30093"};i.startNode=this.cardGroup.children[t],i.num=e,i.infoType="coin",cc.director.getScene().emit(f.default.ITEM_FLY,i)},e.prototype.updateBySecond=function(){var t=this._endTime;if(t.length>0){var e=t[1]-window.serverTime;e>0?this.endTimeLab.string=h.default.timeFormat(e):(this.onClose(),l.default.getInstance().getUI(b.default)&&l.default.getInstance().closeUI(b.default))}},e.prototype.onClickGetCompletedReward=function(t,e){var i,a,n=this;if(this.stopOneCompletedRewardAnimation(+e-1),this._happyBingoModel.getCompletedReward(+e)){for(var o=this._happyBingoModel.completeReward[e].reward,s=this._happyBingoModel.completeReward[e].rewardRes,r=null!==(i=s[0])&&void 0!==i?i:o[0],c=null!==(a=s[1])&&void 0!==a?a:1,d=[],u=0;u<o.length;u++)d.push({id:o[u],num:1});for(u=0;u<s.length;u++)d.push({id:s[u],num:s[u+1]}),u++;30098==+r?l.default.getInstance().openNotice(N.default,{data:{ntype:"building",skinId:c}},null,function(){if(n._happyBingoModel.isCompleted&&0==n._happyBingoModel.completeRewardIndex.length){var t=C.default.t("happyBingoPopup_1");l.default.getInstance().openUI(p.default,{data:{str:t}})}}):l.default.getInstance().openUI(y.default,{data:d},null,function(){if(n._happyBingoModel.isCompleted&&0==n._happyBingoModel.completeRewardIndex.length){var t=C.default.t("happyBingoPopup_1");l.default.getInstance().openUI(p.default,{data:{str:t}})}})}},e.prototype.onClickHelp=function(){l.default.getInstance().openUI(I.default)},e.prototype.getTaskNode=function(){return this.cardGroup.parent},e.prototype.getHelpNode=function(){return this.helpNode},e.prototype.onLoad=function(){this._endTime=c.default.getInstance().activityData.getActivityEndTime("happyBingo"),this.updateBySecond(),cc.director.getScene().on(f.default.UPDATE_BY_SECOND,this.updateBySecond,this)},e.uiName="HappyBingoPopup",o([w(cc.ScrollView)],e.prototype,"cardSV",void 0),o([w(cc.Node)],e.prototype,"rewardItem",void 0),o([w(cc.Prefab)],e.prototype,"itemNode",void 0),o([w(cc.Node)],e.prototype,"proNode",void 0),o([w(cc.Node)],e.prototype,"proBg",void 0),o([w(cc.Node)],e.prototype,"proGroup",void 0),o([w(cc.Node)],e.prototype,"awardGroup",void 0),o([w(cc.Node)],e.prototype,"cardGroup",void 0),o([w(cc.Node)],e.prototype,"awardIconGroup",void 0),o([w(cc.Node)],e.prototype,"awardNumGroup",void 0),o([w(cc.Node)],e.prototype,"awardComGroup",void 0),o([w(cc.Node)],e.prototype,"lineNode",void 0),o([w(cc.Label)],e.prototype,"endTimeLab",void 0),o([w(cc.Node)],e.prototype,"helpNode",void 0),o([S],e)}(s.default);i.default=T,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AudioManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/Toast":void 0,"../../scripts/utils/ActionFunc":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../../scripts/utils/StatisticsManager":void 0,"../entitys/BuildItem":"BuildItem","../entitys/HappyBingoItem":"HappyBingoItem","../entitys/ItemEntity":"ItemEntity","./AwardPopup":"AwardPopup","./HappyBingoHelpPopup":"HappyBingoHelpPopup","./HappyBingoSubmitPopup":"HappyBingoSubmitPopup","./UnlockShowPopup":"UnlockShowPopup"}],HappyBingoSubmitPopup:[function(t,e,i){"use strict";cc._RF.push(e,"abbf7/zxbVPiIuSjYnRU/rg","HappyBingoSubmitPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MstData"),c=t("../../scripts/data/UserData"),d=t("../../scripts/manager/AudioManager"),l=t("../../scripts/manager/UIManager"),p=t("../../scripts/prefabs/Toast"),u=t("../../scripts/utils/EventName"),f=t("../../scripts/utils/StatisticsManager"),h=t("../entitys/ItemEntity"),g=t("../../scripts/extension/LanguageData"),m=cc._decorator,v=m.ccclass,_=m.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.submitItem=null,e.submitItemBg=null,e.submitItemComBg=null,e.rewardItem=null,e.rewardItemBg=null,e.itemName=null,e._index=0,e._allAwards=[],e._parentNode=null,e._happyBingoModel=null,e._coinNum=0,e}return n(e,t),e.prototype.init=function(t){this._index=t.index,this._parentNode=t.parentNode;var e=this._happyBingoModel=c.default.getInstance().activityData.happyBingo,i=e.config[e.lv],a=e.taskData[this._index],n=a.requireItems,o={};o.itemId=n[0],o.isShowInfo=!0,o.isClickAble=!0,o.bgSize=cc.v2(144,144),this.itemName.string=r.default.getInstance().mstItem[n[0]].name,c.default.getInstance().getNormalItemIndexByIds(n).includes(-1)?o.itemBg=this.submitItemBg:(o.isComplete=!0,o.itemBg=this.submitItemComBg),this.submitItem.getComponent(h.default).init(o);var s=a.coins;this._coinNum=s;var d={itemId:"30093"};d.itemNum=s,d.isShowInfo=!0,d.isClickAble=!0,d.itemBg=this.rewardItemBg,this.rewardItem.getComponent(h.default).init(d),this._allAwards.push({id:i.rewardRes[0],num:i.rewardRes[1]})},e.prototype.onClickSubmit=function(){var t=this._happyBingoModel.isStartHappyBingo,e=this._happyBingoModel.submit(this._index);e.includes(-1)?l.default.getInstance().openUI(p.default,{data:{str:g.default.t("happyBingoSubmitPopup_1")}}):(this.onClose(),this._happyBingoModel.taskData[this._index].completeTask(),this._happyBingoModel.getAward(this._index),c.default.getInstance().updateTaskAndItem(),cc.director.getScene().emit(u.default.UPDATE_MERGEAREA,e),this._parentNode.itemAnimation(this._index,this._coinNum),this._parentNode.updateProgress(),this._parentNode.updateGroupCompleted(),d.default.getInstance().playEffect("taskComplete"),!t&&this._happyBingoModel.isStartHappyBingo&&f.default.trackEvent("activity_happyBingo_start"))},e.uiName="HappyBingoSubmitPopup",o([_(cc.Node)],e.prototype,"submitItem",void 0),o([_(cc.SpriteFrame)],e.prototype,"submitItemBg",void 0),o([_(cc.SpriteFrame)],e.prototype,"submitItemComBg",void 0),o([_(cc.Node)],e.prototype,"rewardItem",void 0),o([_(cc.SpriteFrame)],e.prototype,"rewardItemBg",void 0),o([_(cc.Label)],e.prototype,"itemName",void 0),o([v],e)}(s.default);i.default=y,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AudioManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/Toast":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/StatisticsManager":void 0,"../entitys/ItemEntity":"ItemEntity"}],HelpCommonPopup:[function(t,e,i){"use strict";cc._RF.push(e,"09946BqzPpCCYPqJXonTEz4","HelpCommonPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/manager/AdManager"),c=cc._decorator,d=c.ccclass,l=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scrollNode=null,e.labNode=null,e}return n(e,t),e.prototype.init=function(t){this.scrollNode.content.removeAllChildren();for(var e=t.contentText,i=0;i<e.length;i++){var a=cc.instantiate(this.labNode);a.getComponent(cc.RichText).string=e[i],this.scrollNode.content.addChild(a)}r.default.getInstance().showBanner()},e.prototype.onOkBtnClick=function(){t.prototype.onClose.call(this)},e.prototype.onDestroy=function(){r.default.getInstance().hideBanner()},e.uiName="HelpCommonPopup",o([l(cc.ScrollView)],e.prototype,"scrollNode",void 0),o([l(cc.Node)],e.prototype,"labNode",void 0),o([d],e)}(s.default);i.default=p,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/manager/AdManager":void 0}],HelpPopup:[function(t,e,i){"use strict";cc._RF.push(e,"79fdeuKWWlPGbqU6bSA2tUZ","HelpPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/manager/AdManager"),c=cc._decorator,d=c.ccclass,l=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(){r.default.getInstance().showBanner()},e.prototype.onDestroy=function(){r.default.getInstance().hideBanner()},e.uiName="HelpPopup",o([d],e)}(s.default));i.default=l,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/manager/AdManager":void 0}],HelpQuestionPopup:[function(t,e,i){"use strict";cc._RF.push(e,"c761aq55FRP7p1J81smVVhv","HelpQuestionPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MiscConfig"),c=t("../../scripts/data/MstData"),d=t("../../scripts/manager/AdManager"),l=t("../../scripts/manager/UIManager"),p=t("../../scripts/prefabs/CommonPopup"),u=t("../../scripts/utils/GlobalFun"),f=t("../extension/List"),h=t("../../scripts/extension/LanguageData"),g=cc._decorator,m=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.listElement=null,e._config=null,e}return n(e,t),e.prototype.init=function(){this._config=c.default.getInstance().mstHelp,u.default.isCanShowBanner()&&d.default.getInstance().showBanner()},e.prototype.itemElementRender=function(t,e){t.active=!0,t.x=0;var i=e+1;t.children[0].getComponent(cc.Label).string=i+"."+this._config[i].question,t.getComponent(cc.Button).clickEvents[0].customEventData=i+""},e.prototype.onClickQuestion=function(t,e){var i={titleText:h.default.t("helpQuestionPopup_2"),contentText:this._config[e].answer,model:r.default.COMMON_POPUP_MODEL_1,isLeft:!0,okText:h.default.t("helpQuestionPopup_1"),okCallback:function(){}};l.default.getInstance().openUI(p.default,{data:i})},e.prototype.onLoad=function(){this.listElement.numItems=Object.getOwnPropertyNames(this._config).length},e.prototype.onDestroy=function(){u.default.isCanShowBanner()&&d.default.getInstance().hideBanner()},e.uiName="HelpQuestionPopup",o([v(f.default)],e.prototype,"listElement",void 0),o([m],e)}(s.default);i.default=_,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MiscConfig":void 0,"../../scripts/data/MstData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/CommonPopup":void 0,"../../scripts/utils/GlobalFun":void 0,"../extension/List":"List"}],HemaPrefab:[function(t,e,i){"use strict";cc._RF.push(e,"b5f48sXG9ZAk6JMuWWr3iOS","HemaPrefab");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../prefabs/AtlasPopup"),r=t("../prefabs/BuildTaskPopup"),c=t("../prefabs/EnergyBottlePopup"),d=t("../prefabs/FreeBenefitsPopup"),l=t("../prefabs/GameClubPopup"),p=t("../prefabs/LevelAwardPopup"),u=t("../prefabs/Levelup"),f=t("../prefabs/LimitActListPopup"),h=t("../prefabs/MailsPopup"),g=t("../prefabs/NewUserGiftPopup"),m=t("../prefabs/PassPopup"),v=t("../prefabs/PlayerGroupPopup"),_=t("../prefabs/RankPopup"),y=t("../prefabs/SelfBlindBoxPopup"),I=t("../prefabs/Setting"),b=t("../prefabs/SuperBenefitsPopup"),N=t("../prefabs/UnlockShowPopup"),C=t("../prefabs/WelfareCenterPopup"),k=t("./BuildItem"),S=t("./BuildTaskBubble"),w=t("./Customer"),T=t("../prefabs/SkinGiftPopup"),P=t("../prefabs/FoodFestivalResultPopup"),D=t("../prefabs/TaskGiftPopup"),A=t("../../scripts/utils/GlobalFun"),B=t("../../scripts/data/MiscConfig"),E=t("../../scripts/data/UserData"),L=t("../../scripts/data/MstData"),M=t("../../scripts/utils/StatisticsManager"),O=t("../../scripts/utils/EventName"),U=t("../../scripts/manager/UIManager"),x=t("../../scripts/prefabs/Loading"),R=t("../../scripts/utils/Api"),G=t("../../scripts/prefabs/Toast"),F=t("../../scripts/utils/ActionFunc"),j=t("../../scripts/manager/AudioManager"),V=t("../../scripts/data/MiscData"),H=t("../../scripts/utils/ChannelHelper"),z=t("../prefabs/GashaponPopup"),Y=t("../../scripts/extension/LanguageData"),W=cc._decorator,K=W.ccclass,X=W.property,q=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.floor=null,e.customerNode=[],e.pupNode=null,e.optNode=null,e.btnBuildTask=null,e.btnBuildTaskRed=null,e.btnAltasRed=null,e.btnNewUserGift=null,e.btnLevelUpGift=null,e.btnSuperBenefits=null,e.btnBlindBox=null,e.btnGashapon=null,e.btnGashaponRed=null,e.btnPass=null,e.btnPassRed=null,e.btnFreeBenefits=null,e.btnFreeBenefitsRed=null,e.btnGameClub=null,e.btnGameClubRed=null,e.btnMailsRed=null,e.btnDressUp=null,e.btnDressUpRed=null,e.skinGift=null,e.welfareCenter=null,e.welfareCenterRed=null,e.btnRankNode=null,e.btnEnergyBottleNode=null,e.btnActivity=null,e.btnTaskGift=null,e.btnActivityTime=null,e.btnActivitySp=null,e.btnActivityRed=null,e.customerPre=null,e.buildTaskBubble=null,e._mapSizi=new cc.Size(8270,5700),e._buildAtals={},e._customerAtals={},e._pupItem={},e._isMoved=!1,e._minScale=0,e._maxScale=0,e._loadCompleteCallback=null,e._lastPos=null,e._createtime=null,e._xishu=null,e._colliders={},e._customerPool=null,e.isLoadFinish=!1,e._customerCount=0,e._screenRect=null,e._screenBuildRect=null,e._waijingnode=null,e._buildPrefab={},e._isLoadBuilingNow=!1,e._unLockAreas=null,e.guideCallBack=null,e}return n(e,t),e.prototype.touchMove=function(t){if(!this._isMoved){var e=t.getTouches(),i=this.optNode;if(e.length>=2){var a,n=e[0].getDelta(),o=e[1].getDelta(),s=this.node.convertToNodeSpaceAR(e[0].getLocation()),r=this.node.convertToNodeSpaceAR(e[1].getLocation()),c=s.sub(r),d=n.sub(o);(a=Math.abs(c.x)>Math.abs(c.y)?(c.x+d.x)/c.x*i.scale:(c.y+d.y)/c.y*i.scale)<this._minScale?i.scale=this._minScale:a>this._maxScale?i.scale=this._maxScale:i.scale=a,this._lastPos?(i.x=this._lastPos.x*this.optNode.scale,i.y=this._lastPos.y*this.optNode.scale,this._lastPos=cc.v2(i.x/this.optNode.scale,i.y/this.optNode.scale)):this._lastPos=cc.v2(i.x/this.optNode.scale,i.y/this.optNode.scale),this.resetRootData()}else if(1==e.length){var l=t.getDelta();l.x=l.x*this.optNode.scale,l.y=l.y*this.optNode.scale,i.setPosition(i.position.add(l)),this.resetRootData()}}},e.prototype.touchEnd=function(){this._lastPos=null},e.prototype.resetRootData=function(){var t=this.optNode,e=cc.view.getVisibleSize();t.x>0&&t.x>this._mapSizi.width/2*this.optNode.scale-e.width/2&&(t.x=this._mapSizi.width/2*this.optNode.scale-e.width/2),t.x<0&&t.x<e.width/2-this._mapSizi.width/2*this.optNode.scale&&(t.x=e.width/2-this._mapSizi.width/2*this.optNode.scale),t.y>0&&t.y>this._mapSizi.height/2*this.optNode.scale-e.height/2&&(t.y=this._mapSizi.height/2*this.optNode.scale-e.height/2),t.y<0&&t.y<e.height/2-this._mapSizi.height/2*this.optNode.scale&&(t.y=e.height/2-this._mapSizi.height/2*this.optNode.scale)},e.prototype.startCreateCustomer=function(){var t=this;this.createCustomer();var e=A.default.radomBetween(this._createtime[0],this._createtime[1])*this._xishu;this.scheduleOnce(function(){t.startCreateCustomer()},e)},e.prototype.createCustomer=function(){var t=this;if(!(this._customerCount>=B.default.MAX_CUSTOMER_COUNT)){var e=E.default.getInstance().getRandomCustomerId();if(e>=0){var i=L.default.getInstance().mstRole[e],a=i.routeIds[A.default.radomBetween(0,i.routeIds.length-1)],n=L.default.getInstance().mstRoute[a].routes,o=function(){var e=A.default.radomBetween(1,3),a=window.serverTime,o=t._customerPool.get();if(o)t.customerNode[0].addChild(o),(s=o.getComponent(w.default)).initCustoMer(e,n,i,t,a),t._customerAtals[a]=s;else{var s,r=cc.instantiate(t.customerPre);t.customerNode[0].addChild(r),(s=r.getComponent(w.default)).initCustoMer(e,n,i,t,a),t._customerAtals[a]=s}t._customerCount++};this.customerPre?o():cc.resources.load("entitys/Customer",cc.Prefab,function(e,i){e||(t.customerPre=i,o())})}}},e.prototype.deletCustomer=function(t,e){this._customerPool.put(e),delete this._customerAtals[t],this._customerCount--},e.prototype.setCustomerToBuild=function(t,e,i){var a=this._buildAtals[i];if(a){var n=a[e];if(n)return n.setCustomer(t)}return!1},e.prototype.showArea=function(t){for(var e=1;e<9;e++){var i=!1;t.indexOf(e+"")>=0&&(i=!0);var a,n,o=this.floor.getChildByName("diban_"+e);i?((a=o.getChildByName("areafloor"))&&(a.active=!0),(n=o.getChildByName("region"))&&(n.active=!1)):((a=o.getChildByName("areafloor"))&&(a.active=!1),(n=o.getChildByName("region"))&&(n.active=!0))}},e.prototype.createBuildingPre=function(t,e,i){var a=this;if(void 0===i&&(i=null),this._buildAtals[t]||(this._buildAtals[t]={}),this._buildAtals[t][e])i&&i();else{var n=E.default.getInstance().buildingData[e].mstSkinData,o=n.nodeName,s=n.buildingPos,r=cc.v3(s[0],s[1],0),c=this.customerNode[t-1].convertToWorldSpaceAR(r);if(this._screenBuildRect.contains(c))if(this._buildPrefab[o]){var d=cc.instantiate(this._buildPrefab[o]);this.customerNode[t-1].addChild(d);var l=d.getComponent(k.default);l.initBuildData(e),this._buildAtals[t][e]=l,this.showBuildTaskBubble(e),i&&i()}else{var p="building/"+o;cc.resources.load(p,cc.Prefab,function(n,s){if(n)cc.log("\u52a0\u8f7d\u5931\u8d25\u5efa\u7b51\u5931\u8d25",o);else{var r=cc.instantiate(s);a.customerNode[t-1].addChild(r);var c=r.getComponent(k.default);c.initBuildData(e),a._buildAtals[t][e]=c,a._buildPrefab[o]=s,a.showBuildTaskBubble(e),i&&i()}})}else i&&i()}},e.prototype.ChangeBuilingSkin=function(t){var e=this,i=function(i){if(a._buildAtals[i][t]){a._buildAtals[i][t].node.destroy();var n=E.default.getInstance().buildingData[t].mstSkinData.nodeName;return cc.resources.load("building/"+n,cc.Prefab,function(a,n){if(!a){var o=cc.instantiate(n);e.customerNode[Number(i)-1].addChild(o);var s=o.getComponent(k.default);s.initBuildData(t),e._buildAtals[i][t]=s}}),"break"}},a=this;for(var n in this._buildAtals)if("break"===i(n))break},e.prototype.ChangeRoleSkin=function(){var t=this._buildAtals;for(var e in t){var i=t[e];for(var a in i)i[a].getComponent(k.default).initEmployee()}},e.prototype.loadFloor=function(){var t=this,e=E.default.getInstance().unlockSceneAreaIds,i=this.floor.getChildByName("diban_1");this._colliders[1]=i.getComponent(cc.PolygonCollider);var a=2,n=function(i){i>8?t.loadEndLog():(cc.resources.load("environment/diban_"+i,cc.Prefab,function(a,n){if(!a){var o,s,r=cc.instantiate(n);e.indexOf(i+"")>=0?((o=r.getChildByName("areafloor"))&&(o.active=!0),(s=r.getChildByName("region"))&&(s.active=!1)):((o=r.getChildByName("areafloor"))&&(o.active=!1),(s=r.getChildByName("region"))&&(s.active=!0)),r.parent=t.floor,t._colliders[i]=r.getComponent(cc.PolygonCollider)}}),setTimeout(function(){n(++a)}))};n(a)},e.prototype.loadWaiJing=function(){var t=this;cc.resources.load("environment/waijing",cc.Prefab,function(e,i){if(!e){var a=cc.instantiate(i);a.parent=t.floor,t._waijingnode=a,t.loadFloor()}})},e.prototype.loadEndLog=function(){this.isLoadFinish=!0,this.updateBuildTask(),this.startCreateCustomer(),this._loadCompleteCallback&&this._loadCompleteCallback()},e.prototype.showBuildTaskBubble=function(t){var e=this;E.default.getInstance().buildingTaskData.forEach(function(i){e._pupItem[i.id]||L.default.getInstance().mstBuildingTask[i.id].buildingId==t&&e.updateBuildTaskByID(i)})},e.prototype.onClickMerge=function(){M.default.trackEvent("merge_click"),cc.director.getScene().emit(O.default.CLOSE_SCENE)},e.prototype.onClickBuildingTask=function(){M.default.trackEvent("buildingTask_click"),U.default.getInstance().openUI(r.default)},e.prototype.onClickSet=function(){M.default.trackEvent("setting_click"),U.default.getInstance().openUI(I.default)},e.prototype.onClickAtlas=function(){M.default.trackEvent("atlas_click"),U.default.getInstance().openUI(s.default)},e.prototype.onClickDressUp=function(){for(var t=E.default.getInstance().unlockSceneAreaIds,e=0,i=0;i<t.length;i++){for(var a=L.default.getInstance().mstSceneArea[t[i]].buildingIds,n=0;n<a.length;n++)if("area"!=L.default.getInstance().mstBuilding[a[n]].type&&E.default.getInstance().buildingData[a[n]].isHaveTips){e=a[n];break}if(e>0)break}U.default.getInstance().openUI(s.default,{data:{choose:1,buildId:e}})},e.prototype.onClickMails=function(){U.default.getInstance().openUI(x.default,{},function(){R.default.mail.send({type:"getData",para:JSON.stringify({})},function(t){cc.log("\u83b7\u53d6\u90ae\u4ef6\u8fd4\u56de",t),E.default.getInstance().updateUserData(t),U.default.getInstance().openUI(h.default),U.default.getInstance().closeUI(x.default)},function(){U.default.getInstance().closeUI(x.default),U.default.getInstance().openUI(G.default,{data:{str:Y.default.t("hemaPrefab_1")}})})})},e.prototype.onClickPlayerGroup=function(){U.default.getInstance().openUI(v.default)},e.prototype.onClickLevelUpGift=function(){M.default.trackEvent("levelupGift_click"),U.default.getInstance().openUI(p.default)},e.prototype.onClickNewUserGift=function(){M.default.trackEvent("newUserGift_click"),U.default.getInstance().openUI(g.default)},e.prototype.onClickSuperBenefits=function(){M.default.trackEvent("pindaodao_click"),U.default.getInstance().openUI(x.default,{},function(){R.default.getActivityData.send({type:"friendsHelp"},function(t){var e;e=t.data?JSON.parse(t.data):[],U.default.getInstance().openUI(b.default,{data:e}),U.default.getInstance().closeUI(x.default)},function(){U.default.getInstance().closeUI(x.default)})})},e.prototype.onClickBlindBox=function(){M.default.trackEvent("blindBox_click"),E.default.getInstance().myOpenSelfBlindBox>0?U.default.getInstance().openUI(x.default,{},function(){var t={date:A.default.getDateByYMD(),shareUserId:E.default.getInstance().id,receivedId:E.default.getInstance().myOpenSelfBlindBox};R.default.activity.send({type:"blindBox",para:JSON.stringify(t)},function(t){if(t.data){var e=JSON.parse(t.data);U.default.getInstance().openUI(y.default,{data:e.receivedIds})}else U.default.getInstance().openUI(G.default,{data:{str:Y.default.t("hemaPrefab_4")}});U.default.getInstance().closeUI(x.default)},function(){U.default.getInstance().closeUI(x.default)})}):U.default.getInstance().openUI(y.default,{data:[]})},e.prototype.onClickGashapon=function(){M.default.trackEvent("gashapon_click"),U.default.getInstance().openUI(z.default)},e.prototype.onClickPass=function(){M.default.trackEvent("pass_click"),U.default.getInstance().openUI(m.default)},e.prototype.onClickFreeBnenfits=function(){U.default.getInstance().openUI(d.default),this.btnFreeBenefitsRed.active&&(this.btnFreeBenefitsRed.active=!1)},e.prototype.onClickGameClub=function(){U.default.getInstance().openUI(l.default),this.btnGameClubRed.active&&(this.btnGameClubRed.active=!1)},e.prototype.onClickSkinGift=function(){U.default.getInstance().openUI(T.default);var t=this.skinGift.getChildByName("hongdian");t.active&&(t.active=!1)},e.prototype.onClickWelfareCenter=function(){U.default.getInstance().openUI(C.default)},e.prototype.onClickLimitAct=function(){var t=this,e=E.default.getInstance().limitActModel.activityOpenState();1==e?cc.director.getScene().emit(O.default.OPEN_LIMIT_ACT_MERGE):2==e?U.default.getInstance().openUI(P.default,{},null,function(){U.default.getInstance().openUI(f.default),t.btnActivityRed.active=!1}):0==e&&U.default.getInstance().openUI(f.default)},e.prototype.onClickEnergyBottle=function(){U.default.getInstance().openUI(c.default)},e.prototype.onClickRank=function(){U.default.getInstance().openUI(_.default)},e.prototype.onClickActivity=function(){U.default.getInstance().openUI(_.default)},e.prototype.onClickTaskGift=function(){U.default.getInstance().openUI(D.default),this.btnTaskGift.getChildByName("hongdian").active=!1},e.prototype.updateBuildTask=function(){var t=this,e=E.default.getInstance().buildingTaskData,i=[];e.forEach(function(e){t._pupItem[e.id]||i.push(e)}),this.loadBuildTaskBubble(i),E.default.getInstance().getCompleteBuildingTaskId().length>0?this.btnBuildTaskRed.active||(this.btnBuildTaskRed.active=!0,F.default.zoomAnim2(this.btnBuildTask)):this.btnBuildTaskRed.active&&(this.btnBuildTaskRed.active=!1,cc.Tween.stopAllByTarget(this.btnBuildTask),this.btnBuildTask.scale=1)},e.prototype.loadBuildTaskBubble=function(t){var e=this,i=0,a=function(n){n>=t.length||(e._pupItem[t[n].id]?a(++i):e.updateBuildTaskByID(t[n],function(){a(++i)}))};a(i)},e.prototype.updateBuildTaskByID=function(t,e){var i=this;if(void 0===e&&(e=null),t.mstData){var a=t.mstData,n=L.default.getInstance().mstBuilding[a.buildingId],o=E.default.getInstance().buildingData[a.buildingId].skinIdIndex,s=n.skinIds[o],r=L.default.getInstance().mstBuildingSkin[s];if(a.costCoins<=0)e&&e();else{for(var c=null,d=1;d<9;d++)this._buildAtals[d]&&this._buildAtals[d][a.buildingId]&&(c=this._buildAtals[d][a.buildingId]);var l=0;if(c){var p=c.unLock;l=p?r.buildingPos[1]+p.height*p.scaleY/4:r.buildingPos[1];var u=function(){if(i._pupItem[t.id])i.guideCallBack&&(i.guideCallBack(),i.guideCallBack=null);else{var a=cc.instantiate(i.buildTaskBubble);a.setPosition(cc.v3(r.buildingPos[0]+60,l+59.5,0)),i.pupNode.addChild(a),a.getComponent(S.default).initTaskInfo(t),i._pupItem[t.id]=a,i.guideCallBack&&(i.guideCallBack(),i.guideCallBack=null)}e&&e()};this.buildTaskBubble?u():cc.resources.load("entitys/BuildTaskBubble",cc.Prefab,function(t,e){t||(i.buildTaskBubble=e,u())})}else e&&e()}}else e&&e()},e.prototype.unLockBuild=function(t){var e=this,i=t.last.mstData,a=t.next,n=t.callback,o=t.customer,s=t.oldLev;if(this._pupItem[i.id]&&(this._pupItem[i.id].destroy(),delete this._pupItem[i.id]),parseInt(i.unlockSceneAreaId)>0){var r=-1;if(a[0]){var c=L.default.getInstance().mstBuildingTask[a[0].id];r=Number(c.buildingId)}this.moveToBuild(i.buildingId,function(){e._buildAtals[i.unlockSceneAreaId][i.buildingId].showUnlockAni(function(){var t;t=E.default.getInstance().unlockSceneAreaIds,e.showArea(t),e._unLockAreas.push(i.unlockSceneAreaId+""),e.updateBuildTask(),j.default.getInstance().playEffect("unLockSceneArea"),E.default.getInstance().level>s?U.default.getInstance().openUI(u.default,{data:{historyLevel:s}},function(){},function(){r>=0&&e.moveToBuild(r)}):r>=0&&e.moveToBuild(r)})})}else{var d=-1;a[0]&&(c=L.default.getInstance().mstBuildingTask[a[0].id],d=Number(c.buildingId));var l=function(a){if(p._buildAtals[a][i.buildingId])return p.moveToBuild(i.buildingId,function(){e._buildAtals[a][i.buildingId].showUnlockAni(function(){e.updateBuildTask();var a=function(){L.default.getInstance().mstBuilding[i.buildingId].isUnlockShow?U.default.getInstance().openNotice(N.default,{data:{ntype:"building",id:i.buildingId}},null,function(){E.default.getInstance().level>s&&U.default.getInstance().openUI(u.default,{data:{historyLevel:s}}),d>=0&&e.moveToBuild(d,n)}):(E.default.getInstance().level>s&&U.default.getInstance().openUI(u.default,{data:{historyLevel:s}}),d>=0&&e.moveToBuild(d,n))};o>=0&&!n?U.default.getInstance().openNotice(N.default,{data:{ntype:"customer",id:t.customer}},null,function(){a()}):a()})}),"break"},p=this;for(var f in this._buildAtals)if("break"===l(f))break}this.updateAltasRed()},e.prototype.updateNewUserGift=function(){var t=L.default.getInstance().mstActivity.newUserGift;E.default.getInstance().level>=t.openLevel&&0==E.default.getInstance().newUserGiftTimes&&E.default.getInstance().guidance.isComGuideComplete&&V.default.getInstance().isIOSPayOpen?this.btnNewUserGift.active=!0:this.btnNewUserGift.active=!1},e.prototype.updateLevelUpGift=function(){E.default.getInstance().levelupAwardData().length>0&&V.default.getInstance().isIOSPayOpen?this.btnLevelUpGift.active=!0:this.btnLevelUpGift.active=!1},e.prototype.updateSuperBenefits=function(){var t=H.default.getChannel();if("android"!=t)if(t!=H.HMCHANNEL.WY)if(E.default.getInstance().level>=L.default.getInstance().mstActivity.kanyidao.openLevel){var e=E.default.getInstance().superBenefitsRewardTimes;this.btnSuperBenefits.active=!(e>0)}else this.btnSuperBenefits.active=!1;else this.btnSuperBenefits.active=!1;else this.btnSuperBenefits.active=!1},e.prototype.updateBlindBox=function(){var t=H.default.getChannel();"android"!=t&&t!=H.HMCHANNEL.WY&&E.default.getInstance().level>=L.default.getInstance().mstActivity.blindBox.openLevel?this.btnBlindBox.active=!0:this.btnBlindBox.active=!1},e.prototype.updateGashapon=function(){if(E.default.getInstance().level>=L.default.getInstance().mstActivity.gashapon.openLevel){this.btnGashapon.active=!0;var t=E.default.getInstance().gashaponData.gashaponTimes;this.btnGashaponRed.active=0==t}else this.btnGashapon.active=!1},e.prototype.updatePass=function(){if(E.default.getInstance().level>=L.default.getInstance().mstActivity.pass.openLevel&&V.default.getInstance().isIOSPayOpen){this.btnPass.active=!0;var t=E.default.getInstance().passModel,e=t.isHavePassAward(),i=t.isHavePassTaskAward();this.btnPassRed.active=!(!e&&!i)}else this.btnPass.active=!1},e.prototype.updateMailsRed=function(){var t=!1,e=E.default.getInstance().mail;for(var i in e)if(!e[i].isReceive){t=!0;break}this.btnMailsRed.active=!!t},e.prototype.updateGameClub=function(){E.default.getInstance().guidance.isComGuideComplete,this.btnGameClub.active=!1},e.prototype.updateFreeBenefits=function(){var t=L.default.getInstance().mstStore.dailyGift.openLevel;E.default.getInstance().level>=t?this.btnFreeBenefits.active=!0:this.btnFreeBenefits.active=!1},e.prototype.updateSkinGift=function(){var t=L.default.getInstance().mstActivity.skinGift.openLevel;E.default.getInstance().level>=t&&V.default.getInstance().isIOSPayOpen?this.skinGift.active=!!E.default.getInstance().skinGiftModel.giftId:this.skinGift.active=!1},e.prototype.updateDressUp=function(){if(E.default.getInstance().level>=2){this.btnDressUp.active=!0;for(var t=E.default.getInstance().unlockSceneAreaIds,e=!1,i=0;i<t.length;i++){for(var a=L.default.getInstance().mstSceneArea[t[i]].buildingIds,n=0;n<a.length;n++)if("area"!=L.default.getInstance().mstBuilding[a[n]].type&&E.default.getInstance().buildingData[a[n]].isHaveTips){e=!0;break}if(e)break}e?this.btnDressUpRed.active||(this.btnDressUpRed.active=!0,F.default.zoomAnim2(this.btnDressUp)):this.btnDressUpRed.active&&(this.btnDressUpRed.active=!1,cc.Tween.stopAllByTarget(this.btnDressUp),this.btnDressUp.scale=1),this.btnDressUpRed.active=e}else this.btnDressUp.active=!1,cc.Tween.stopAllByTarget(this.btnDressUp),this.btnDressUp.scale=1},e.prototype.updateWelfareCenter=function(){var t=!1,e=!1,i=!1,a=!1,n=!1;if(E.default.getInstance().level>=L.default.getInstance().mstActivity.vipCrad.openLevel&&V.default.getInstance().isIOSPayOpen&&(t=!0,e=!0),E.default.getInstance().level>=L.default.getInstance().mstActivity.greatValueGift.openLevel&&V.default.getInstance().isIOSPayOpen&&(t=!0),E.default.getInstance().level>=L.default.getInstance().mstActivity.growthFund.openLevel&&V.default.getInstance().isIOSPayOpen&&(t=!0,i=!0),E.default.getInstance().level>=L.default.getInstance().mstActivity.weeklyGift.openLevel&&V.default.getInstance().isIOSPayOpen&&(t=!0,a=!0),E.default.getInstance().level>=L.default.getInstance().mstActivity.energyCard.openLevel&&V.default.getInstance().isIOSPayOpen&&(t=!0,n=!0),this.welfareCenter.active=t,t){if(a&&E.default.getInstance().weeklyGiftModel.isRed&&!E.default.getInstance().weeklyGiftModel.isAllReceived())return void(this.welfareCenterRed.active=!0);if(e){var o=E.default.getInstance().vipCardDailyRewardTimes,s=E.default.getInstance().superVipCardDailyRewardTimes;if(E.default.getInstance().isVipCard&&o<=0||E.default.getInstance().isSuperVipCard&&s<=0)return void(this.welfareCenterRed.active=!0);if(E.default.getInstance().isSuperVipRed&&(o<=0||s<=0))return void(this.welfareCenterRed.active=!0)}if(i)for(var r=L.default.getInstance().mstLevelup,c=1;r[c];){if((r[c].growthFundReward.length>0||r[c].growthFundRewardRes.length>0)&&E.default.getInstance().level>=c&&(!E.default.getInstance().growthFundData.receiveData[c]||!E.default.getInstance().growthFundData.receiveData[c].isReceive))return void(this.welfareCenterRed.active=!0);c++}if(n&&E.default.getInstance().energyCardModel.isRed&&E.default.getInstance().energyCardModel.endTime<=window.serverTime)return void(this.welfareCenterRed.active=!0);this.welfareCenterRed.active=!1}},e.prototype.updateRank=function(){},e.prototype.updateEnergyBottle=function(){var t=E.default.getInstance().activityData.isActivityOpen("energyBottle")&&V.default.getInstance().isIOSPayOpen;if(this.btnEnergyBottleNode.active=t,t){var e=E.default.getInstance().activityData.energyBottle,i=e.isFullBottle;this.btnEnergyBottleNode.getChildByName("hongdian").active=i,i&&Math.ceil(e.endTime-window.serverTime)<0&&(e.resetData(),this.updateEnergyBottleRed())}},e.prototype.updateEnergyBottleRed=function(){this.btnEnergyBottleNode.getChildByName("hongdian").active=this.btnEnergyBottleNode.active&&E.default.getInstance().activityData.energyBottle.isFullBottle},e.prototype.updateLimitActivity=function(){this.btnActivity.active=E.default.getInstance().limitActModel.getAllCanOpenActivity().length>0},e.prototype.updateLimitActivityTime=function(){var t=E.default.getInstance().limitActModel.getEndTime()-window.serverTime;t>0?(this.btnActivityTime.string=A.default.timeFormat(t),this.btnActivityTime.node.active=!0,this.btnActivitySp.active=!1,t<86400?(this.btnActivityTime.node.color=cc.color(255,0,0,255),this.btnActivityTime.getComponent(cc.LabelOutline).enabled=!1):(this.btnActivityTime.node.color=cc.color(255,255,255,255),this.btnActivityTime.getComponent(cc.LabelOutline).enabled=!0)):(this.btnActivityTime.node.active=!1,this.btnActivitySp.active=!0)},e.prototype.updateTaskGift=function(){this.btnTaskGift.active=this.btnTaskGift.active&&V.default.getInstance().isIOSPayOpen&&E.default.getInstance().activityData.isActivityOpen("taskGift")&&E.default.getInstance().activityData.taskGift.isOpen()},e.prototype.updateLimitActivityRed=function(){this.btnActivityRed.active=2==E.default.getInstance().limitActModel.activityOpenState()},e.prototype.updateBySecond=function(){this.updateEnergyBottle(),this.updateTaskGift(),this.updateLimitActivityTime()},e.prototype.updateActive=function(){this.updateNewUserGift(),this.updateLevelUpGift(),this.updateSuperBenefits(),this.updateBlindBox(),this.updateGashapon(),this.updatePass(),this.updateFreeBenefits(),this.updateMailsRed(),this.updateGameClub(),this.updateSkinGift(),this.updateDressUp(),this.updateWelfareCenter(),this.updateRank(),this.updateEnergyBottle(),this.updateEnergyBottleRed(),this.updateLimitActivity(),this.updateLimitActivityRed()},e.prototype.updateAltasRed=function(){var t=E.default.getInstance().isHaveItemUnlockAward();t<0&&(t=E.default.getInstance().isHaveBuildingUnlockAward()),t<0&&(t=E.default.getInstance().isHaveCustomerUnlockAward()),this.btnAltasRed.active=t>=0},e.prototype.openScene=function(){this.updateActive(),this.updateAltasRed()},e.prototype.moveToBuild=function(t,e,i){var a=this;void 0===e&&(e=null),void 0===i&&(i=null);var n=L.default.getInstance().mstBuilding[t],o=E.default.getInstance().buildingData[t].skinIdIndex,s=n.skinIds[o],r=L.default.getInstance().mstBuildingSkin[s],c=cc.v2(r.buildingPos[0],r.buildingPos[1]),d=-c.x*this.optNode.scale,l=-c.y*this.optNode.scale,p=cc.view.getVisibleSize();c.x>0&&c.x*this.optNode.scale>this._mapSizi.width/2*this.optNode.scale-p.width/2&&(d=-(this._mapSizi.width/2*this.optNode.scale-p.width/2)),c.x<0&&c.x*this.optNode.scale<p.width/2-this._mapSizi.width/2*this.optNode.scale&&(d=-(p.width/2-this._mapSizi.width/2*this.optNode.scale)),c.y>0&&c.y*this.optNode.scale>this._mapSizi.height/2*this.optNode.scale-p.height/2&&(l=-(this._mapSizi.height/2*this.optNode.scale-p.height/2)),c.y<0&&c.y*this.optNode.scale<p.height/2-this._mapSizi.height/2*this.optNode.scale&&(l=-(p.height/2-this._mapSizi.height/2*this.optNode.scale)),this._isMoved=!0;var u=cc.tween().to(.5,{position:cc.v3(d,l,0)});F.default.playAction(this.optNode,u,!0,function(){a._isMoved=!1,E.default.getInstance().buildingTaskData.forEach(function(e){e.mstData.buildingId==t&&a._pupItem[e.id]&&cc.tween(a._pupItem[e.id]).to(.5,{scale:1.5}).to(.5,{scale:1}).start()}),e&&e(),a.pupNode.childrenCount>0?i&&i():a.guideCallBack=i})},e.prototype.getMapSize=function(){return this._mapSizi},e.prototype.init=function(t){void 0===t&&(t=null),this._loadCompleteCallback=t},e.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.touchEnd,this),cc.director.getScene().on(O.default.PERFORMTASK,this.moveToBuild,this),cc.director.getScene().on(O.default.UNLOCKBUILD,this.unLockBuild,this),cc.director.getScene().on(O.default.UPDATE_BY_SECOND,this.updateBySecond,this),cc.director.getScene().on(O.default.UPDATE_ACTIVITY,this.updateActive,this),cc.director.getScene().on(O.default.NEW_DAY,this.updateActive,this),cc.director.getScene().on(O.default.OPEN_SCENE,this.openScene,this),cc.director.getScene().on(O.default.LEVELUP,this.openScene,this),cc.director.getScene().on(O.default.CHANGBUILDINGSKIN,this.ChangeBuilingSkin,this),cc.director.getScene().on(O.default.CHANGROLESKIN,this.ChangeRoleSkin,this),cc.director.getCollisionManager().enabled=!0,this.onSetStartInfo()},e.prototype.onSetStartInfo=function(){this._buildAtals={},this._customerPool=new cc.NodePool;var t=cc.view.getVisibleSize();this._screenRect=cc.rect(0,0,t.width,t.height),this._screenBuildRect=cc.rect(-400,-400,t.width+800,t.height+800),this._unLockAreas=A.default.clone(E.default.getInstance().unlockSceneAreaIds);var e=t.width/this._mapSizi.width,i=t.height/this._mapSizi.height;this._maxScale=1.5,this._minScale=e<i?i:e,this._minScale<.7&&(this._minScale=.7),this._createtime=L.default.getInstance().mstMisc.customerInterval.config,this._xishu=L.default.getInstance().mstLevelup[E.default.getInstance().level].customerIntervalRatio,this.loadWaiJing(),this.updateBySecond(),this.updateActive(),this.openScene(),this.schedule(this.updateSceneItem,.05)},e.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.TOUCH_MOVE,this.touchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this.touchEnd,this),cc.director.getCollisionManager().enabled=!1},e.prototype.sumCustomerZorder=function(t,e,i){var a=t.position,n=t.parent.convertToWorldSpaceAR(a),o={out:this._mapSizi.height,dir:0},s={out:0,dir:0},r=s,c=0;for(var d in this._colliders){var l=this._colliders[d];if(l&&l.world&&cc.Intersection.pointInPolygon(n,l.world.points)){c=Number(d);break}}if(c>0){t.parent=this.customerNode[c-1];var p=this._buildAtals[c];for(var u in p){var f,h=(f=p[u]).zIndexByCustomerPos(n,e,i);h.out>0&&(1==h.dir&&o.out>=h.out?o=h:0==h.dir&&s.out<=h.out&&(s=h))}1!=c&&(f=this._buildAtals[1][5])&&f.zIndexByCustomerPos(n,e,i)}return o.out!==this._mapSizi.height&&0!==s.out?r=o.out<s.out?o:s:o.out!==this._mapSizi.height?r=o:0!==s.out&&(r=s),r},e.prototype.imgInScreenLog=function(){var t=this,e=[];for(var i in this._colliders){var a=this._colliders[i].node.getBoundingBoxToWorld();cc.Intersection.rectRect(this._screenRect,a)?(e.push(Number(i)),this._colliders[i].node.opacity=255):this._colliders[i].node.opacity=0}for(var n=1;n<9;n++)if(e.includes(n)){if(255!=this.customerNode[n-1].opacity&&(this.customerNode[n-1].opacity=255),!this._isLoadBuilingNow&&this._unLockAreas){var o=this._buildAtals[n],s=L.default.getInstance().mstSceneArea[n].buildingIds;if(this._unLockAreas.indexOf(n+"")>=0)for(var r=0;r<s.length;r++)o&&o[s[r]]?(a=o[s[r]].node.getBoundingBoxToWorld(),cc.Intersection.rectRect(this._screenRect,a)?255!=o[s[r]].node.opacity&&(o[s[r]].node.opacity=255):0!=o[s[r]].node.opacity&&(o[s[r]].node.opacity=0)):this._isLoadBuilingNow||(this._isLoadBuilingNow=!0,this.createBuildingPre(n,s[r],function(){t._isLoadBuilingNow=!1}));else o&&o[s[0]]||this._isLoadBuilingNow||(this._isLoadBuilingNow=!0,this.createBuildingPre(n,s[0],function(){t._isLoadBuilingNow=!1}))}}else 0!=this.customerNode[n-1].opacity&&(this.customerNode[n-1].opacity=0);for(var c in this._customerAtals){var d=this._customerAtals[c];d&&(a=d.node.getBoundingBoxToWorld(),cc.Intersection.rectRect(this._screenRect,a)?255!=d.node.opacity&&(d.node.isYinshen||(d.node.opacity=255)):0!=d.node.opacity&&(d.node.opacity=0),d.node.opacity>0&&d.sumZindexOrder())}this._waijingnode&&this._waijingnode.children.forEach(function(e){var i=e.getBoundingBoxToWorld();cc.Intersection.rectRect(t._screenRect,i)?255!=e.opacity&&(e.opacity=255):0!=e.opacity&&(e.opacity=0)})},e.prototype.updateSceneItem=function(){this.isLoadFinish&&0!=this.node.parent.opacity&&this.imgInScreenLog()},o([X(cc.Node)],e.prototype,"floor",void 0),o([X([cc.Node])],e.prototype,"customerNode",void 0),o([X(cc.Node)],e.prototype,"pupNode",void 0),o([X(cc.Node)],e.prototype,"optNode",void 0),o([X(cc.Node)],e.prototype,"btnBuildTask",void 0),o([X(cc.Node)],e.prototype,"btnBuildTaskRed",void 0),o([X(cc.Node)],e.prototype,"btnAltasRed",void 0),o([X(cc.Node)],e.prototype,"btnNewUserGift",void 0),o([X(cc.Node)],e.prototype,"btnLevelUpGift",void 0),o([X(cc.Node)],e.prototype,"btnSuperBenefits",void 0),o([X(cc.Node)],e.prototype,"btnBlindBox",void 0),o([X(cc.Node)],e.prototype,"btnGashapon",void 0),o([X(cc.Node)],e.prototype,"btnGashaponRed",void 0),o([X(cc.Node)],e.prototype,"btnPass",void 0),o([X(cc.Node)],e.prototype,"btnPassRed",void 0),o([X(cc.Node)],e.prototype,"btnFreeBenefits",void 0),o([X(cc.Node)],e.prototype,"btnFreeBenefitsRed",void 0),o([X(cc.Node)],e.prototype,"btnGameClub",void 0),o([X(cc.Node)],e.prototype,"btnGameClubRed",void 0),o([X(cc.Node)],e.prototype,"btnMailsRed",void 0),o([X(cc.Node)],e.prototype,"btnDressUp",void 0),o([X(cc.Node)],e.prototype,"btnDressUpRed",void 0),o([X(cc.Node)],e.prototype,"skinGift",void 0),o([X(cc.Node)],e.prototype,"welfareCenter",void 0),o([X(cc.Node)],e.prototype,"welfareCenterRed",void 0),o([X(cc.Node)],e.prototype,"btnRankNode",void 0),o([X(cc.Node)],e.prototype,"btnEnergyBottleNode",void 0),o([X(cc.Node)],e.prototype,"btnActivity",void 0),o([X(cc.Node)],e.prototype,"btnTaskGift",void 0),o([X(cc.Label)],e.prototype,"btnActivityTime",void 0),o([X(cc.Node)],e.prototype,"btnActivitySp",void 0),o([X(cc.Node)],e.prototype,"btnActivityRed",void 0),o([K],e)}(cc.Component);i.default=q,cc._RF.pop()},{"../../scripts/data/MiscConfig":void 0,"../../scripts/data/MiscData":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AudioManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/Loading":void 0,"../../scripts/prefabs/Toast":void 0,"../../scripts/utils/ActionFunc":void 0,"../../scripts/utils/Api":void 0,"../../scripts/utils/ChannelHelper":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../../scripts/utils/StatisticsManager":void 0,"../prefabs/AtlasPopup":"AtlasPopup","../prefabs/BuildTaskPopup":"BuildTaskPopup","../prefabs/EnergyBottlePopup":"EnergyBottlePopup","../prefabs/FoodFestivalResultPopup":"FoodFestivalResultPopup","../prefabs/FreeBenefitsPopup":"FreeBenefitsPopup","../prefabs/GameClubPopup":"GameClubPopup","../prefabs/GashaponPopup":"GashaponPopup","../prefabs/LevelAwardPopup":"LevelAwardPopup","../prefabs/Levelup":"Levelup","../prefabs/LimitActListPopup":"LimitActListPopup","../prefabs/MailsPopup":"MailsPopup","../prefabs/NewUserGiftPopup":"NewUserGiftPopup","../prefabs/PassPopup":"PassPopup","../prefabs/PlayerGroupPopup":"PlayerGroupPopup","../prefabs/RankPopup":"RankPopup","../prefabs/SelfBlindBoxPopup":"SelfBlindBoxPopup","../prefabs/Setting":"Setting","../prefabs/SkinGiftPopup":"SkinGiftPopup","../prefabs/SuperBenefitsPopup":"SuperBenefitsPopup","../prefabs/TaskGiftPopup":"TaskGiftPopup","../prefabs/UnlockShowPopup":"UnlockShowPopup","../prefabs/WelfareCenterPopup":"WelfareCenterPopup","./BuildItem":"BuildItem","./BuildTaskBubble":"BuildTaskBubble","./Customer":"Customer"}],ItemBgPrefab:[function(t,e,i){"use strict";cc._RF.push(e,"a6b6bOStSlKZb8haeepo866","ItemBgPrefab");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/UserData"),r=t("../../scripts/utils/EventName"),c=cc._decorator,d=c.ccclass,l=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemBg=null,e.taskNeedSpriteFrame=null,e.spawnerSpriteFrame=null,e.speedUpSpriteFrame=null,e.animation=null,e._index=-1,e._itemData=null,e}return n(e,t),e.prototype.init=function(t){this._index=t,this._itemData=s.default.getInstance().itemData[this._index],this.updateItemBgState()},e.prototype.initLimitAct=function(t){this._index=t,this._itemData=s.default.getInstance().limitActModel.itemData[this._index],this.updateItemBgState()},e.prototype.onLoad=function(){cc.director.getScene().on(r.default.UPDATE_MERGEAREA,this.updateItemBgState,this),cc.director.getScene().on(r.default.LEVELUP,this.updateItemBgState,this)},e.prototype.updateItemBgState=function(){this._itemData.isSpawnerBoost?this.itemBg.spriteFrame=this.speedUpSpriteFrame:this._itemData.isTaskNeed||this._itemData.isActivityNeed?this.itemBg.spriteFrame=this.taskNeedSpriteFrame:this._itemData.id>0&&this._itemData.mstData.isProducer&&this._itemData.isOpened&&!this._itemData.isCool?this.itemBg.spriteFrame=this.spawnerSpriteFrame:this.itemBg.spriteFrame=null},e.prototype.showNewAnim=function(t){void 0===t&&(t=!1),t?this.animation.playAdditive("ani_new_item"):this.animation.stop("ani_new_item")},o([l(cc.Sprite)],e.prototype,"itemBg",void 0),o([l(cc.SpriteFrame)],e.prototype,"taskNeedSpriteFrame",void 0),o([l(cc.SpriteFrame)],e.prototype,"spawnerSpriteFrame",void 0),o([l(cc.SpriteFrame)],e.prototype,"speedUpSpriteFrame",void 0),o([l(cc.Animation)],e.prototype,"animation",void 0),o([d],e)}(cc.Component);i.default=p,cc._RF.pop()},{"../../scripts/data/UserData":void 0,"../../scripts/utils/EventName":void 0}],ItemChainItem:[function(t,e,i){"use strict";cc._RF.push(e,"fcd33zu9YtDXo5x8uSSPt3s","ItemChainItem");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/MstData"),r=t("../../scripts/data/UserData"),c=t("../../scripts/manager/UIManager"),d=t("../../scripts/utils/GlobalFun"),l=t("../prefabs/ItemInfoPopup"),p=cc._decorator,u=p.ccclass,f=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.normalSPF=null,e.currentSPF=null,e.yellowSPF=null,e.bg=null,e.icon=null,e.webbedNode=null,e.lbLevel=null,e.nodeArrow=null,e.itemId=-1,e.current=!1,e.showNext=!1,e.showLevel=!0,e.isBottom=!1,e.isWebbed=!1,e}return n(e,t),e.prototype.init=function(t,e,i,a,n,o){void 0===n&&(n=!1),void 0===o&&(o=!1),this.itemId=t,this.current=e,this.showNext=i,this.showLevel=a,this.isBottom=n,this.isWebbed=o,this.updateUI()},e.prototype.updateUI=function(){if(this.isBottom||r.default.getInstance().isItemUnlock(this.itemId)||this.current){this.bg.node.getComponent(cc.Button).enabled=!0;var t=d.default.getItemIconPathById(this.itemId);d.default.loadSpriteFrame(this.icon,t)}else this.bg.node.getComponent(cc.Button).enabled=!1;if(this.isBottom?(this.bg.spriteFrame=this.yellowSPF,this.isWebbed?this.webbedNode.active=!0:this.webbedNode.active=!1):this.current?this.bg.spriteFrame=this.currentSPF:this.bg.spriteFrame=this.normalSPF,this.showNext?this.nodeArrow.active=!0:this.nodeArrow.active=!1,this.showLevel){var e=s.default.getInstance().mstItem[this.itemId].level;this.lbLevel.string=""+e,this.lbLevel.node.active=!0}else this.lbLevel.node.active=!1},e.prototype.onClickItem=function(){c.default.getInstance().openUI(l.default,{data:this.itemId})},o([f(cc.SpriteFrame)],e.prototype,"normalSPF",void 0),o([f(cc.SpriteFrame)],e.prototype,"currentSPF",void 0),o([f(cc.SpriteFrame)],e.prototype,"yellowSPF",void 0),o([f(cc.Sprite)],e.prototype,"bg",void 0),o([f(cc.Sprite)],e.prototype,"icon",void 0),o([f(cc.Node)],e.prototype,"webbedNode",void 0),o([f(cc.Label)],e.prototype,"lbLevel",void 0),o([f(cc.Node)],e.prototype,"nodeArrow",void 0),o([u],e)}(cc.Component);i.default=h,cc._RF.pop()},{"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/utils/GlobalFun":void 0,"../prefabs/ItemInfoPopup":"ItemInfoPopup"}],ItemChain:[function(t,e,i){"use strict";cc._RF.push(e,"764fbhfYxBEmrDecTY56f+v","ItemChain");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MstData"),c=t("../../scripts/manager/AdManager"),d=t("../../scripts/utils/GlobalFun"),l=t("../entitys/ItemChainItem"),p=t("../../scripts/extension/LanguageData"),u=cc._decorator,f=u.ccclass,h=u.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scrollLayout=null,e.lbItemName=null,e.lbItemName2=null,e.itemChainItem=null,e.itemContent=null,e.itemContent2=null,e.itemId=-1,e}return n(e,t),e.prototype.init=function(t){this.itemId=t,this.updateUI(),d.default.isCanShowBanner()&&c.default.getInstance().showBanner()},e.prototype.updateUI=function(){this.lbItemName.string=r.default.getInstance().mstItem[this.itemId].typeName;var t=r.default.getInstance().getItemChainIdById(this.itemId);if(this.updateItem(t),r.default.getInstance().mstItem[this.itemId].spawnItem.length>0){var e=r.default.getInstance().mstItem[this.itemId].spawnItemReDup;this.updateSpawner(e),e.length>0?(this.lbItemName2.node.active=!0,this.lbItemName2.string=p.default.t("itemChain_1")):this.lbItemName2.node.active=!1}else if(r.default.getInstance().isNormalItem(this.itemId)){var i=r.default.getInstance().getSpawnerListByItemId(this.itemId);this.updateSpawner(i),i.length>0?(this.lbItemName2.string=p.default.t("itemChain_2"),this.lbItemName2.node.active=!0):this.lbItemName2.node.active=!1}else this.updateSpawner([]),this.lbItemName2.node.active=!1},e.prototype.updateItem=function(t){for(var e=0;e<t.length;e++){var i=cc.instantiate(this.itemChainItem);i.parent=this.itemContent;var a=t[e],n=e!==t.length-1;i.getComponent(l.default).init(a,a==this.itemId,n,!0)}},e.prototype.updateSpawner=function(t){if(0==t.length)this.itemContent2.parent.active=!1;else for(var e=r.default.getInstance().mstItem[this.itemId].spawnWebbed,i=0;i<t.length;i++){var a=cc.instantiate(this.itemChainItem);a.parent=this.itemContent2;var n=t[i];a.getComponent(l.default).init(n,n==this.itemId,!1,!1,!0,e)}},e.prototype.onDestroy=function(){d.default.isCanShowBanner()&&c.default.getInstance().hideBanner()},e.uiName="ItemChain",o([h(cc.Layout)],e.prototype,"scrollLayout",void 0),o([h(cc.Label)],e.prototype,"lbItemName",void 0),o([h(cc.Label)],e.prototype,"lbItemName2",void 0),o([h(cc.Prefab)],e.prototype,"itemChainItem",void 0),o([h(cc.Node)],e.prototype,"itemContent",void 0),o([h(cc.Node)],e.prototype,"itemContent2",void 0),o([f],e)}(s.default);i.default=g,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MstData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/utils/GlobalFun":void 0,"../entitys/ItemChainItem":"ItemChainItem"}],ItemEntity:[function(t,e,i){"use strict";cc._RF.push(e,"388a3vfX71BxJUE6zdf2YDQ","ItemEntity");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/MstData"),r=t("../../scripts/manager/UIManager"),c=t("../../scripts/utils/GlobalFun"),d=t("../../scripts/utils/StatisticsManager"),l=t("../prefabs/BuildInfoPopup"),p=t("../prefabs/CustomerInfoPopup"),u=t("../prefabs/ItemChain"),f=t("../prefabs/ItemInfoPopup"),h=t("./BuildItem"),g=cc._decorator,m=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bg=null,e.icon=null,e.completeNode=null,e.infoNode=null,e.itemNum=null,e._data=null,e._itemData=null,e}return n(e,t),e.prototype.init=function(t){var e,i=this;if(t.itemId){if(this._data=t,t.itemNum=null!==(e=t.itemNum)&&void 0!==e?e:0,cc.isValid(this.node)){if(this.bg.spriteFrame=t.itemBg,this.node.getComponent(cc.Button).enabled=t.isClickAble,this.infoNode.active=t.isShowInfo,this.completeNode.active=t.isComplete,this.itemNum.active=(1==+t.itemNum&&t.isShowNum||+t.itemNum>1)&&30098!=+t.itemId&&4e4!=+t.itemId,this.itemNum.getComponent(cc.Label).string="x"+t.itemNum,t.numSize&&(this.itemNum.getComponent(cc.Label).fontSize=t.numSize),this._itemData=30098==+t.itemId||4e4==+t.itemId?null:s.default.getInstance().mstItem[t.itemId],t.iconPath){var a=t.iconPath;c.default.loadSpriteFrame(this.icon,a,function(){t.iconSize&&cc.isValid(i.icon.node)&&(i.icon.node.width=t.iconSize.x,i.icon.node.height=t.iconSize.y)})}else t.iconNode?(this.icon.node.addChild(t.iconNode),this.icon.enabled=!1,t.iconNode.x=0,t.iconNode.y=0):this._itemData&&(a="textures/itemIcon/"+this._itemData.icon,c.default.loadSpriteFrame(this.icon,a,function(){t.iconSize&&cc.isValid(i.icon.node)&&(i.icon.node.width=t.iconSize.x,i.icon.node.height=t.iconSize.y)}));if(t.iconScale&&(this.icon.node.scale=t.iconScale),t.iconNode||(this.icon.node.removeAllChildren(),this.icon.enabled=!0),t.bgSize?(this.node.width=t.bgSize.x,this.node.height=t.bgSize.y):t.itemBg&&(this.node.width=t.itemBg.getRect().width,this.node.height=t.itemBg.getRect().height),t.numOffset&&(this.itemNum.getComponent(cc.Widget).right=t.numOffset.x,this.itemNum.getComponent(cc.Widget).bottom=t.numOffset.y),4e4==t.itemId){var n=s.default.getInstance().mstRoleSkin[t.itemNum];c.default.loadSpriteFrame(this.icon,"textures/role/icon/icon_"+n.icon)}else if(30098==t.itemId&&!t.iconNode){var o=s.default.getInstance().mstBuildingSkin[t.itemNum].nodeName;cc.resources.load("building/"+o,cc.Prefab,function(t,e){if(!t&&cc.isValid(i.icon)){var a=cc.instantiate(e);i.icon.node.addChild(a),a.setPosition(cc.v2(0,0)),a.getComponent(h.default).initUnlockShow(200,200)}})}}}else console.error("ItemEntity \u7269\u54c1Id\u9519\u8bef,\u4e0d\u80fd\u4e3a\u7a7a")},e.prototype.onClickInfo=function(){if("TaskPopup"==this._data.uiName?d.default.trackEvent("order_item_click"):"TopInfoPrefab"==this._data.uiName&&d.default.trackEvent("topInfo_item_click"),30098==+this._data.itemId){var t=s.default.getInstance().mstBuildingSkin[this._data.itemNum];r.default.getInstance().openUI(l.default,{data:{buildId:t.buildingId}})}else 4e4==+this._data.itemId?(t=s.default.getInstance().mstRoleSkin[this._data.itemNum],r.default.getInstance().openUI(p.default,{data:{roleId:t.roleId}})):this._itemData.type.includes("Show")?r.default.getInstance().openUI(f.default,{data:this._data.itemId}):r.default.getInstance().openUI(u.default,{data:this._data.itemId})},o([v(cc.Sprite)],e.prototype,"bg",void 0),o([v(cc.Sprite)],e.prototype,"icon",void 0),o([v(cc.Node)],e.prototype,"completeNode",void 0),o([v(cc.Node)],e.prototype,"infoNode",void 0),o([v(cc.Node)],e.prototype,"itemNum",void 0),o([m],e)}(cc.Component);i.default=_,cc._RF.pop()},{"../../scripts/data/MstData":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/utils/GlobalFun":void 0,"../../scripts/utils/StatisticsManager":void 0,"../prefabs/BuildInfoPopup":"BuildInfoPopup","../prefabs/CustomerInfoPopup":"CustomerInfoPopup","../prefabs/ItemChain":"ItemChain","../prefabs/ItemInfoPopup":"ItemInfoPopup","./BuildItem":"BuildItem"}],ItemFly:[function(t,e,i){"use strict";cc._RF.push(e,"17f63V3YZhOkr/zTW/owNC5","ItemFly");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/MstData"),r=t("../../scripts/manager/AudioManager"),c=t("../../scripts/manager/UIManager"),d=t("../../scripts/prefabs/Loading"),l=t("../../scripts/utils/EventName"),p=t("../../scripts/utils/GlobalFun"),u=t("../scenes/MainScene"),f=cc._decorator,h=f.ccclass,g=f.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemNode=null,e.boomSpeed=800,e.radius=300,e.moveSpeed=2500,e.itemPool=null,e._moveSpeed=null,e}return n(e,t),e.prototype.onLoad=function(){this.itemPool=new cc.NodePool,cc.director.getScene().on(l.default.ITEM_FLY,this.itemFly,this)},e.prototype.itemFly=function(t){var e,i=t.id,a=t.startNode||cc.find("Canvas/mainUI"),n=t.endNode,o=t.num||1;this._moveSpeed=t.moveSpeed||this.moveSpeed;var r=!!t.showLoading&&t.showLoading,c=t.callback,d=null!==(e=t.infoType)&&void 0!==e?e:"all",l=s.default.getInstance().mstItem[i];l?("expShow"==l.type?(i=s.default.getInstance().getExpId(),n=t.endNode?t.endNode:cc.find("Canvas/mainUI/topInfo/exp/star")):"energyShow"==l.type?(i=s.default.getInstance().getEnergyId(),n=t.endNode?t.endNode:cc.find("Canvas/mainUI/topInfo/energy/icon")):"coinShow"==l.type?(i=s.default.getInstance().getCoinId(),n=t.endNode?t.endNode:cc.find("Canvas/mainUI/topInfo/coins/icon")):"diamondShow"==l.type?(i=s.default.getInstance().getDiamondId(),n=t.endNode?t.endNode:cc.find("Canvas/mainUI/topInfo/diamonds/icon")):n="skinTicketShow"==l.type?t.endNode?t.endNode:cc.find("Canvas/mainUI/topInfo/exp/star"):"skipAdShow"==l.type?t.endNode?t.endNode:cc.find("Canvas/mainUI/topInfo/exp/star"):"foodMedal"==l.type?2==cc.find("Canvas").getComponent(u.default).isMainScene?t.endNode?t.endNode:cc.find("Canvas/LimitActMergeUIContent/LimitActMergeUI/bottomInfoContent/BtnReturn"):t.endNode?t.endNode:cc.find("Canvas/MergeUIContent/MergeUI/bottomInfoContent/BottomInfoPrefab").getComponent("BottomInfoPrefab").btnAward:2==cc.find("Canvas").getComponent(u.default).isMainScene?t.endNode?t.endNode:cc.find("Canvas/LimitActMergeUIContent/LimitActMergeUI/bottomInfoContent/BtnAward"):t.endNode?t.endNode:cc.find("Canvas/MergeUIContent/MergeUI/bottomInfoContent/BottomInfoPrefab").getComponent("BottomInfoPrefab").btnAward,this.fly(i,a,n,o,c,r,d)):c&&c()},e.prototype.fly=function(t,e,i,a,n,o,s){var p=this;void 0===a&&(a=1),void 0===o&&(o=!1),a=a>50?50:a;var u=e.parent.convertToWorldSpaceAR(e.position),f=this.node.convertToNodeSpaceAR(u);u=i.parent.convertToWorldSpaceAR(i.position);var h=this.node.convertToNodeSpaceAR(u),g=0,m=function(t,e,i,a,n,u){t.scale=0;var f=n/30>1?n/30:1,h=1==n?0:Math.floor((Math.random()-Math.random())*p.radius*f),m=1==n?0:Math.floor((Math.random()-Math.random())*p.radius*f),v=Math.sqrt(Math.pow(h,2)+Math.pow(m,2))/p.boomSpeed,_=Math.sqrt(Math.pow(i.x-a.x,2)+Math.pow(i.y-a.y,2))/p._moveSpeed;t.setPosition(i);var y=cc.v2(i.x+h,i.y+m),I=cc.Vec2.ZERO,b=Math.random();I=b>.5?p.getBezierPos(y,a,!0):I=p.getBezierPos(y,a,!1),o?c.default.getInstance().openUI(d.default,{data:{showBlack:!1}},function(){cc.tween(t).to(v,{position:y,scale:1},{easing:"quadOut"}).bezierTo(_,t.position,I,a).call(function(){++g==n&&(cc.director.getScene().emit(l.default.UPDATE_TOPINFO,s),"function"==typeof u&&(c.default.getInstance().closeUI("Loading"),u())),p.pushCoin(t),r.default.getInstance().playEffect("addResource")}).start()}):cc.tween(t).to(v,{position:y,scale:1},{easing:"quadOut"}).bezierTo(_,t.position,I,a).call(function(){++g==n&&(cc.director.getScene().emit(l.default.UPDATE_TOPINFO,s),"function"==typeof u&&u()),p.pushCoin(t),r.default.getInstance().playEffect("addResource")}).start()},v=a,_=function(){v<=0||p.scheduleOnce(function(){v--;var e=p.getItemNode();p.loadIcon(e,t),m(e,0,f,h,a,n),_()})};_()},e.prototype.getItemNode=function(){var t=null;return(t=this.itemPool.size()>0?this.itemPool.get():cc.instantiate(this.itemNode)).parent=this.node,t.active=!0,t},e.prototype.pushCoin=function(t){t.removeFromParent(!1),this.itemPool.put(t)},e.prototype.getBezierPos=function(t,e,i){var a=-(t.x-e.x)/(t.y-e.y),n=cc.v2((t.x+e.x)/2,(t.y+e.y)/2),o=Math.abs(cc.Vec2.len(t.sub(e))),s=(cc.v2(),Math.abs(o/2/(p.default.radomBetween(50,180)/100)*Math.cos(a))),r=Math.abs(o/2/(p.default.radomBetween(50,180)/100)*Math.sin(a));return i?n.add(cc.v2(s,r)):n.sub(cc.v2(s,r))},e.prototype.loadIcon=function(t,e){var i=p.default.getItemIconPathById(e);p.default.loadSpriteFrame(t,i)},o([g(cc.Node)],e.prototype,"itemNode",void 0),o([g(cc.Float)],e.prototype,"boomSpeed",void 0),o([g(cc.Float)],e.prototype,"radius",void 0),o([g(cc.Float)],e.prototype,"moveSpeed",void 0),o([h],e)}(cc.Component);i.default=m,cc._RF.pop()},{"../../scripts/data/MstData":void 0,"../../scripts/manager/AudioManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/Loading":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../scenes/MainScene":"MainScene"}],ItemImgPrefab:[function(t,e,i){"use strict";cc._RF.push(e,"3b87dqLpw1GkJe/C7Iuhlto","ItemImgPrefab");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/MiscConfig"),r=t("../../scripts/data/UserData"),c=t("../../scripts/utils/ActionFunc"),d=t("../../scripts/utils/EventName"),l=t("../../scripts/utils/GlobalFun"),p=cc._decorator,u=p.ccclass,f=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.animation=null,e.icon=null,e._index=-1,e._itemData=null,e._isLimitItem=!1,e}return n(e,t),e.prototype.init=function(t){this._index=t,this._itemData=r.default.getInstance().itemData[this._index],this.updateIcon(),this.stopTipAnim(),this.updateState()},e.prototype.initLimitAct=function(t){this._isLimitItem=!0,this._index=t,this._itemData=r.default.getInstance().limitActModel.itemData[this._index],this.updateIcon(),this.stopTipAnim(),this.updateState()},e.prototype.onLoad=function(){cc.director.getScene().on(d.default.UNLIMIT_ENERGY,this.updateSpawnerAndBoxAnimState,this)},e.prototype.updateState=function(){this.updateSpawnerAndBoxAnimState()},e.prototype.updateSpawnerAndBoxAnimState=function(){this.animation.setCurrentTime(0),this._itemData.id>0&&this._itemData.mstData.isProducer?this._itemData.mstData.isSpawner&&!this._itemData.isCool?this.animation.playAdditive("ani_spawnerIcon"):this._itemData.mstData.isBox&&this._itemData.isOpened?this.animation.playAdditive("ani_spawnerIcon"):this.animation.stop("ani_spawnerIcon"):this.animation.stop("ani_spawnerIcon")},e.prototype.updateIcon=function(){if(this._itemData.state==s.default.ITEM_STATE_lOCK||this._itemData.state==s.default.ITEM_STATE_UNKNOWN||-1===this._index||this._itemData.id<=0)this.icon.spriteFrame=null;else{var t=l.default.getItemIconPathById(this._itemData.id+"");t&&l.default.loadSpriteFrame(this.icon,t)}},e.prototype.showOutPutAnim=function(t){t?this.animation.playAdditive("ani_output"):this.animation.stop("ani_output")},e.prototype.showUnlockAnim=function(){var t=this;c.default.playAnim(this.animation,"ani_unknown_unlockIcon",function(){t._isLimitItem?t.initLimitAct(t._index):t.init(t._index)})},e.prototype.showTipAnim=function(){this.animation.play("ani_mergeTip")},e.prototype.stopTipAnim=function(){this.icon.node.scale=1,this.animation.stop("ani_mergeTip"),this.icon.node.scale=1,this.updateState()},e.prototype.onClick=function(t){var e=this;this._index==t?(this.animation.setCurrentTime(0),this.animation.play("ani_selectedIcon"),this.animation.on("finished",function(){e.updateState(),e.animation.off(cc.Animation.EventType.FINISHED)})):this.stopTipAnim()},o([f(cc.Animation)],e.prototype,"animation",void 0),o([f(cc.Sprite)],e.prototype,"icon",void 0),o([u],e)}(cc.Component);i.default=h,cc._RF.pop()},{"../../scripts/data/MiscConfig":void 0,"../../scripts/data/UserData":void 0,"../../scripts/utils/ActionFunc":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0}],ItemInfoPopup:[function(t,e,i){"use strict";cc._RF.push(e,"031efxPg8NOrrLKnu0oD6on","ItemInfoPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MstData"),c=t("../../scripts/manager/AdManager"),d=t("../../scripts/utils/GlobalFun"),l=cc._decorator,p=l.ccclass,u=l.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemName=null,e.descLab=null,e.itemIcon=null,e}return n(e,t),e.prototype.init=function(t){var e=this,i=r.default.getInstance().mstItem[t];this.itemName.string=i.name,this.descLab.string=i.desc;var a=d.default.getItemIconPathById(t);d.default.loadSpriteFrame(this.itemIcon,a,function(){e.itemIcon.node.scale=1}),c.default.getInstance().showBanner()},e.prototype.onDestroy=function(){c.default.getInstance().hideBanner()},e.uiName="ItemInfoPopup",o([u(cc.Label)],e.prototype,"itemName",void 0),o([u(cc.Label)],e.prototype,"descLab",void 0),o([u(cc.Sprite)],e.prototype,"itemIcon",void 0),o([p],e)}(s.default);i.default=f,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MstData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/utils/GlobalFun":void 0}],ItemList:[function(t,e,i){"use strict";cc._RF.push(e,"38428ijlwhMS7GN0EjC8Ypg","ItemList");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("./ItemEntity"),r=cc._decorator,c=r.ccclass,d=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemEntity=null,e._itemEntityJS=[],e}return n(e,t),e.prototype.init=function(t){if(t.spacingX=t.spacingX?t.spacingX:14,this._itemEntityJS.length<t.itemsData.length)for(var e=t.itemsData.length-this._itemEntityJS.length,i=0;i<e;i++){var a=cc.instantiate(this.itemEntity),n=a.getComponent(s.default);this.node.addChild(a),this._itemEntityJS.push(n)}for(i=0;i<this._itemEntityJS.length;i++)i<t.itemsData.length?(this._itemEntityJS[i].node.active=!0,this._itemEntityJS[i].init(t.itemsData[i])):this._itemEntityJS[i].node.active=!1;this.node.getComponent(cc.Layout).spacingX=t.spacingX,this.node.getComponent(cc.Layout).updateLayout()},o([d(cc.Prefab)],e.prototype,"itemEntity",void 0),o([c],e)}(cc.Component);i.default=l,cc._RF.pop()},{"./ItemEntity":"ItemEntity"}],ItemPrefab:[function(t,e,i){"use strict";cc._RF.push(e,"a7848PP3N5O4J3kw2gYbI8z","ItemPrefab");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/MiscConfig"),r=t("../../scripts/data/UserData"),c=t("../../scripts/utils/ActionFunc"),d=t("../../scripts/utils/EventName"),l=t("../scenes/MainScene"),p=cc._decorator,u=p.ccclass,f=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.leftCount=null,e.nodeDoubleClick=null,e.nodeOpen=null,e.nodeEntry=null,e.nodeUnLimit=null,e.nodeBoxOpenTip=null,e.nodeClock=null,e.spClock=null,e.nodeMaxLv=null,e.taskNeed=null,e.passNeed=null,e.nodePropUI=null,e.animation=null,e.choose=null,e.nodeBubble=null,e.nodeCobweb=null,e.nodeUnKnow=null,e.graySpf=null,e.redSpf=null,e.costEneryIcon=null,e.notCostEneryIcon=null,e.unLimitEnergyIcon=null,e.chargeProgress=null,e._index=-1,e._itemData=null,e.mergeManager=null,e._isLimitItem=!1,e}return n(e,t),Object.defineProperty(e.prototype,"itemData",{get:function(){return this._itemData},enumerable:!1,configurable:!0}),e.prototype.init=function(t,e){void 0===e&&(e=null),this._index=t,e&&(this.mergeManager=e),this._itemData=r.default.getInstance().itemData[this._index],this.updateState()},e.prototype.initLimitAct=function(t,e){void 0===e&&(e=null),this._isLimitItem=!0,this._index=t,e&&(this.mergeManager=e),this._itemData=r.default.getInstance().limitActModel.itemData[this._index],this.updateState()},e.prototype.onLoad=function(){cc.director.getScene().on(d.default.UPDATE_MERGEAREA,this.updateItemBgState,this),cc.director.getScene().on(d.default.LEVELUP,this.updateItemBgState,this),cc.director.getScene().on(d.default.UNLIMIT_ENERGY,this.updateSpawnerAndBoxAnimState,this),cc.director.getScene().on(d.default.USE_PROP,this.showIsMergeAbleAnim,this),cc.director.getScene().on(d.default.UPDATE_BY_SECOND,this.updateBySecond,this)},e.prototype.updateState=function(){this.animation.setCurrentTime(0),this.updateItemBgState(),this.updateCollectAnim(),this.updateClock(),this.updateMaxLevelState(),this.updateSpawnerAndBoxAnimState(),this.updateTipLabel(),this.updateChargeGress()},e.prototype.updateChargeGress=function(){this._itemData.mstData&&this._itemData.mstData.rechargeAttribute.length>0?(this.chargeProgress.node.active=!0,this.chargeProgress.progress=this._itemData.chargeValue/this._itemData.mstData.rechargeAttribute[0]):this.chargeProgress.node.active=!1},e.prototype.updateBySecond=function(){this.updateClock(),this.updateAutoSpawner()},e.prototype.updateClock=function(){if(this.spClock.spriteFrame=this.graySpf,this._itemData.mstData&&this._itemData.mstData.isSpawner&&this._itemData.state==s.default.ITEM_STATE_NORMAL)if(this._itemData.isCool){this.nodeClock.active||(this.nodeClock.active=!0);var t=this._itemData.mstData.rechargeTime,e=this._itemData.coolingTime;this.spClock.fillRange=e/t}else this._itemData.lastCoolingTime>0?(this._itemData.updateInfo(),this._isLimitItem?this.initLimitAct(this._index):this.init(this._index)):window.serverTime-this._itemData.lastRecoverTime>=this._itemData.mstData.rechargeSingleTime&&(this._itemData.isSpawnerBoost||this._itemData.updateInfo()),this.nodeClock.active&&(this.nodeClock.active=!1,this.refreshItemInfoPrefab());else this._itemData.mstData&&this._itemData.mstData.isBox&&this._itemData.state==s.default.ITEM_STATE_NORMAL?!this._itemData.isOpened&&this._itemData.coolingTime&&this._itemData.lastCoolingTime?(this.nodeClock.active||(this.nodeClock.active=!0),t=this._itemData.mstData.openingTime,e=this._itemData.coolingTime,this.spClock.fillRange=e/t):this._itemData.isOpened?this._itemData.isOpened&&this.nodeClock.active&&(this.nodeClock.active&&(this.nodeClock.active=!1,this.refreshItemInfoPrefab()),this.updateState()):this.nodeClock.active&&(this.nodeClock.active=!1,this.refreshItemInfoPrefab()):this._itemData.mstData&&this._itemData.decayAttribute.length>0?this._itemData.isAttenuationOver?(this._itemData.updateInfo(),this._isLimitItem?this.initLimitAct(this._index):this.init(this._index),this.refreshItemInfoPrefab(),r.default.getInstance().updateTaskAndItem(),cc.director.getScene().emit(d.default.UPDATE_MERGEAREA,[this._index])):(this.nodeClock.active=!0,this.spClock.spriteFrame=this.redSpf,t=this._itemData.decayAttribute[0],e=this._itemData.decayTime,this.spClock.fillRange=e/t):this.nodeClock.active&&(this.nodeClock.active=!1,this.refreshItemInfoPrefab())},e.prototype.updateAutoSpawner=function(){var t;this._itemData&&this._itemData.mstData&&this._itemData.mstData.autoSpawner&&this._itemData.state==s.default.ITEM_STATE_NORMAL&&!this._itemData.isCool&&(this._isLimitItem?(t=r.default.getInstance().clickItem(this._index,-1,1)).move.length>0&&this.mergeManager&&this.mergeManager.dealAutoMergeResult(t,this._index):1==cc.find("Canvas").getComponent(l.default).isMainScene&&(t=r.default.getInstance().clickItem(this._index)).move.length>0&&this.mergeManager&&this.mergeManager.dealAutoMergeResult(t,this._index),this.refreshItemInfoPrefab())},e.prototype.updateTipLabel=function(){this.nodeDoubleClick.active=!1,this.nodeOpen.active=!1,this._itemData&&this._itemData.isSpawnerBoost?this.nodeDoubleClick.active=!1:this._itemData.mstData&&this._itemData.mstData.isSpawner?this._itemData.isCool||this._itemData.leftCount!=this._itemData.mstData.itemCount||this._itemData.mstData.autoSpawner||(this.nodeDoubleClick.active=!0):this._itemData.mstData&&this._itemData.mstData.isBox&&(this._itemData.isOpened||(!this._itemData.isOpened&&this._itemData.coolingTime&&this._itemData.lastCoolingTime?this.nodeOpen.active=!1:this.nodeOpen.active=!0))},e.prototype.setChooseState=function(t){this.choose.active=t},e.prototype.updateMaxLevelState=function(){this._itemData&&this._itemData.mstData&&this._itemData.state!=s.default.ITEM_STATE_UNKNOWN&&this._itemData.isMaxLevel&&this._itemData.mstData.level>1?this.nodeMaxLv.active=!0:this.nodeMaxLv.active=!1},e.prototype.updateSpawnerAndBoxAnimState=function(){var t=r.default.getInstance().isUnlimitedEnergy;this._itemData.mstData&&this._itemData.mstData.isProducer?(this._itemData.mstData.isSpawner&&!this._itemData.isCool?this.animation.playAdditive("ani_spawnerItem"):this._itemData.mstData.isBox&&this._itemData.isOpened?this.animation.playAdditive("ani_spawnerItem"):this.animation.stop("ani_spawnerItem"),t?this._itemData.mstData.energyCost>0?this.nodeEntry.getComponent(cc.Sprite).spriteFrame=this.unLimitEnergyIcon:this.nodeEntry.getComponent(cc.Sprite).spriteFrame=this.notCostEneryIcon:this._itemData.mstData.energyCost>0?this.nodeEntry.getComponent(cc.Sprite).spriteFrame=this.costEneryIcon:this.nodeEntry.getComponent(cc.Sprite).spriteFrame=this.notCostEneryIcon):this.animation.stop("ani_spawnerItem")},e.prototype.updateItemBgState=function(){this.taskNeed.active=!1,this.passNeed.active=!1,this.leftCount.node.active=!1,this._itemData.isSpawnerBoost?(this.leftCount.node.active=!0,this.leftCount.string=this._itemData.leftCount+""):((this._itemData.isTaskNeed||this._itemData.isActivityNeed)&&(this.taskNeed.active=!0),this._itemData.isPassNeed&&(this.passNeed.active=!0)),this._itemData.state==s.default.ITEM_STATE_NORMAL?this.setStateNormal():this._itemData.state==s.default.ITEM_STATE_COBWEB?this.setStateCoweb():this._itemData.state==s.default.ITEM_STATE_BUBBLE?this.setStateBubble():this._itemData.state==s.default.ITEM_STATE_UNKNOWN?this.setStateUnnown():this._itemData.state==s.default.ITEM_STATE_lOCK&&this.setStateLock()},e.prototype.setStateNormal=function(){this.nodeCobweb.active=!1,this.nodeUnKnow.active=!1,this.nodeBubble.active=!1},e.prototype.setStateCoweb=function(){this.nodeCobweb.active=!0,this.nodeUnKnow.active=!1,this.nodeBubble.active=!1},e.prototype.setStateUnnown=function(){this.nodeCobweb.active=!0,this.nodeUnKnow.active=!0,this.nodeBubble.active=!1},e.prototype.setStateLock=function(){},e.prototype.setStateBubble=function(){this.nodeCobweb.active=!1,this.nodeUnKnow.active=!1,this.nodeBubble.active=!0},e.prototype.updateCollectAnim=function(){this._itemData.mstData&&this._itemData.mstData.collectable?this.animation.playAdditive("ani_shine"):this.animation.stop("ani_shine")},e.prototype.showUnlockAnim=function(){var t=this;this.nodeUnKnow.active=!1,c.default.playAnim(this.animation,"ani_unknown_unlock",function(){t._isLimitItem?t.initLimitAct(t._index):t.init(t._index)})},e.prototype.refreshItemInfoPrefab=function(){this.choose.active&&(this._isLimitItem?cc.director.getScene().emit(d.default.UPDATE_LIMITITEM_INFO,this._index):cc.director.getScene().emit(d.default.UPDATE_ITEM_INFO,this._index))},e.prototype.setSelect=function(t){this.choose.active=t},e.prototype.onClick=function(t){this._index==t?(this.animation.playAdditive("ani_selected"),this.setChooseState(!0),this._isLimitItem?cc.director.getScene().emit(d.default.UPDATE_LIMITITEM_INFO,this._index):cc.director.getScene().emit(d.default.UPDATE_ITEM_INFO,this._index)):this.setChooseState(!1)},e.prototype.showIsMergeAbleAnim=function(t,e){void 0===e&&(e=0),t>=0?(this.nodePropUI.active=!0,this._itemData.id>0&&this._itemData.state==s.default.ITEM_STATE_NORMAL&&r.default.getInstance().isMergeable(t,this._index,e)?(this.nodePropUI.getChildByName("normal").active=!1,this.nodePropUI.getChildByName("canUse").active=!0,this.animation.playAdditive("ani_canUse")):(this.nodePropUI.getChildByName("normal").active=!0,this.nodePropUI.getChildByName("canUse").active=!1)):(this.animation.stop("ani_canUse"),this.nodePropUI.active=!1)},o([f(cc.Label)],e.prototype,"leftCount",void 0),o([f(cc.Node)],e.prototype,"nodeDoubleClick",void 0),o([f(cc.Node)],e.prototype,"nodeOpen",void 0),o([f(cc.Node)],e.prototype,"nodeEntry",void 0),o([f(cc.Node)],e.prototype,"nodeUnLimit",void 0),o([f(cc.Node)],e.prototype,"nodeBoxOpenTip",void 0),o([f(cc.Node)],e.prototype,"nodeClock",void 0),o([f(cc.Sprite)],e.prototype,"spClock",void 0),o([f(cc.Node)],e.prototype,"nodeMaxLv",void 0),o([f(cc.Node)],e.prototype,"taskNeed",void 0),o([f(cc.Node)],e.prototype,"passNeed",void 0),o([f(cc.Node)],e.prototype,"nodePropUI",void 0),o([f(cc.Animation)],e.prototype,"animation",void 0),o([f(cc.Node)],e.prototype,"choose",void 0),o([f(cc.Node)],e.prototype,"nodeBubble",void 0),o([f(cc.Node)],e.prototype,"nodeCobweb",void 0),o([f(cc.Node)],e.prototype,"nodeUnKnow",void 0),o([f(cc.SpriteFrame)],e.prototype,"graySpf",void 0),o([f(cc.SpriteFrame)],e.prototype,"redSpf",void 0),o([f(cc.SpriteFrame)],e.prototype,"costEneryIcon",void 0),o([f(cc.SpriteFrame)],e.prototype,"notCostEneryIcon",void 0),o([f(cc.SpriteFrame)],e.prototype,"unLimitEnergyIcon",void 0),o([f(cc.ProgressBar)],e.prototype,"chargeProgress",void 0),o([u],e)}(cc.Component);i.default=h,cc._RF.pop()},{"../../scripts/data/MiscConfig":void 0,"../../scripts/data/UserData":void 0,"../../scripts/utils/ActionFunc":void 0,"../../scripts/utils/EventName":void 0,"../scenes/MainScene":"MainScene"}],ItemTempPrefab:[function(t,e,i){"use strict";cc._RF.push(e,"a99361N1O1FoboW/gp4xPxw","ItemTempPrefab");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/utils/EventName"),r=t("../../scripts/data/MiscConfig"),c=t("../../scripts/utils/GlobalFun"),d=t("../../scripts/data/UserData"),l=t("../../scripts/data/MstData"),p=cc._decorator,u=p.ccclass,f=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemBg=null,e.canMergeAnimNode=null,e.taskNeedSpriteFrame=null,e.speedUpSpriteFrame=null,e.leftCount=null,e.nodeDoubleClick=null,e.nodeOpen=null,e.animation=null,e.nodeClock=null,e.spClock=null,e.choose=null,e.nodeCobweb=null,e.nodeUnKnow=null,e.nodeMaxLv=null,e.nodeEntry=null,e.nodeUnLimit=null,e.nodeBoxOpenTip=null,e.nodeBubble=null,e.icon=null,e.graySpf=null,e.redSpf=null,e.costEneryIcon=null,e.notCostEneryIcon=null,e.unLimitEnergyIcon=null,e._index=-1,e._itemData=null,e._isOpenning=!1,e._isLimitItem=!1,e}return n(e,t),e.prototype.init=function(t){this._index=t,this._itemData=d.default.getInstance().itemData[this._index],this.updateIcon(),this.updateState()},e.prototype.initLimitAct=function(t){this._isLimitItem=!0,this._index=t,this._itemData=d.default.getInstance().limitActModel.itemData[this._index],this.updateIcon(),this.updateState()},e.prototype.onLoad=function(){cc.director.getScene().on(s.default.UPDATE_BY_SECOND,this.updateBySecond,this)},e.prototype.updateIcon=function(){if(this._itemData.state==r.default.ITEM_STATE_lOCK)this.icon.spriteFrame=null;else{var t=c.default.getItemIconPathById(this._itemData.id);t&&c.default.loadSpriteFrame(this.icon,t)}},e.prototype.updateState=function(){this.resetStateOverAll(),(-1===this._index||this._itemData.id<=0)&&(this.icon.spriteFrame=null),this._itemData.state==r.default.ITEM_STATE_NORMAL?this.setStateNormal():this._itemData.state==r.default.ITEM_STATE_BUBBLE&&this.setStateBubble(),this._itemData.mstData&&this._itemData.mstData.isSpawner?this.updateSpanerState():this._itemData.mstData&&this._itemData.mstData.isBox&&this.updateBoxState(),this._itemData&&this._itemData.decayAttribute.length>0&&this.updateDecayAtt()},e.prototype.updateBySecond=function(){this.node.active&&(this._itemData.mstData&&this._itemData.mstData.isSpawner?this.updateSpanerState():this._itemData.mstData&&this._itemData.mstData.isBox&&this.updateBoxState(),this._itemData.mstData&&this._itemData.decayAttribute.length>0&&this.updateDecayAtt())},e.prototype.showClock=function(t){this.nodeClock.active=t,this.spClock.node.active=t,this._itemData&&this._itemData.decayAttribute.length>0?this.spClock.spriteFrame=this.redSpf:this.spClock.spriteFrame=this.graySpf},e.prototype.resetStateOverAll=function(){this.animation.setCurrentTime(0),this.showCollectAnim(),this.itemBg.spriteFrame=null,this.showClock(!1),this.showMaxLevelState(),this.showOpenAnim(!1),this.updateSpawnerAndBoxAnimState()},e.prototype.setStateNormal=function(){this.nodeCobweb.active=!1,this.nodeUnKnow.active=!1,this.nodeBubble.active=!1},e.prototype.setStateBubble=function(){this.nodeCobweb.active=!1,this.nodeUnKnow.active=!1,this.nodeBubble.active=!0},e.prototype.updateSpanerState=function(){if(this._itemData)if(this._itemData.isCool){var t=this._itemData.mstData.rechargeTime,e=this._itemData.coolingTime;this.spClock.fillRange=e/t,this.showClock(!0)}else this.showClock(!1),this._itemData.lastCoolingTime?(this._itemData.updateInfo(),this.init(this._index)):window.serverTime-this._itemData.lastRecoverTime>=this._itemData.mstData.rechargeSingleTime&&(this._itemData.isSpawnerBoost||this._itemData.updateInfo())},e.prototype.updateBoxState=function(){if(this._itemData)if(!this._itemData.isOpened&&this._itemData.coolingTime&&this._itemData.lastCoolingTime){var t=this._itemData.mstData.openingTime,e=this._itemData.coolingTime;this.spClock.fillRange=e/t,this.showClock(!0)}else this._itemData.isOpened?(this.showOpenAnim(!0),this.showClock(!1)):this.showClock(!1)},e.prototype.updateDecayAtt=function(){if(this._itemData.isAttenuationOver)this._itemData.updateInfo(),this.init(this._index);else{this.showClock(!0);var t=this._itemData.decayAttribute[0],e=this._itemData.decayTime;this.spClock.fillRange=e/t}},e.prototype.showMaxLevelState=function(){if(this._itemData&&this._itemData.mstData&&this._itemData.state!=r.default.ITEM_STATE_UNKNOWN){var t=l.default.getInstance().getItemMaxLevelById(this._itemData.id),e=this._itemData.mstData.level;this.nodeMaxLv.active=e>=t&&t>1}else this.nodeMaxLv.active=!1},e.prototype.updateSpawnerAndBoxAnimState=function(){var t=d.default.getInstance().isUnlimitedEnergy;this._itemData.mstData&&this._itemData.mstData.isProducer?(this._itemData.mstData.isSpawner&&!this._itemData.isCool?this.animation.playAdditive("ani_spawner"):this._itemData.mstData.isBox&&this._itemData.isOpened?this.animation.playAdditive("ani_spawner"):this.animation.stop("ani_spawner"),t?this._itemData.mstData&&this._itemData.mstData.energyCost>0?this.nodeEntry.getComponent(cc.Sprite).spriteFrame=this.unLimitEnergyIcon:this.nodeEntry.getComponent(cc.Sprite).spriteFrame=this.notCostEneryIcon:this._itemData.mstData&&this._itemData.mstData.energyCost>0?this.nodeEntry.getComponent(cc.Sprite).spriteFrame=this.costEneryIcon:this.nodeEntry.getComponent(cc.Sprite).spriteFrame=this.notCostEneryIcon):this.animation.stop("ani_spawner")},e.prototype.showCollectAnim=function(){this._itemData.mstData&&this._itemData.mstData.collectable?this.animation.playAdditive("ani_shine"):this.animation.stop("ani_shine")},e.prototype.showOpenAnim=function(t){if(this.nodeBoxOpenTip.active=t,t&&!this._isOpenning)if(this.animation.playAdditive("ani_canOpen"),this._itemData.mstData&&this._itemData.mstData.energyCost>0){var e=d.default.getInstance().isUnlimitedEnergy;this.nodeBoxOpenTip.getComponent(cc.Sprite).spriteFrame=e?this.unLimitEnergyIcon:this.costEneryIcon}else this.nodeBoxOpenTip.getComponent(cc.Sprite).spriteFrame=this.notCostEneryIcon;else t||this.animation.stop("ani_canOpen");this._isOpenning=t},e.prototype.showCanMergeAnim=function(t){this.canMergeAnimNode.active=!!t},o([f(cc.Sprite)],e.prototype,"itemBg",void 0),o([f(cc.Node)],e.prototype,"canMergeAnimNode",void 0),o([f(cc.SpriteFrame)],e.prototype,"taskNeedSpriteFrame",void 0),o([f(cc.SpriteFrame)],e.prototype,"speedUpSpriteFrame",void 0),o([f(cc.Label)],e.prototype,"leftCount",void 0),o([f(cc.Node)],e.prototype,"nodeDoubleClick",void 0),o([f(cc.Node)],e.prototype,"nodeOpen",void 0),o([f(cc.Animation)],e.prototype,"animation",void 0),o([f(cc.Node)],e.prototype,"nodeClock",void 0),o([f(cc.Sprite)],e.prototype,"spClock",void 0),o([f(cc.Node)],e.prototype,"choose",void 0),o([f(cc.Node)],e.prototype,"nodeCobweb",void 0),o([f(cc.Node)],e.prototype,"nodeUnKnow",void 0),o([f(cc.Node)],e.prototype,"nodeMaxLv",void 0),o([f(cc.Node)],e.prototype,"nodeEntry",void 0),o([f(cc.Node)],e.prototype,"nodeUnLimit",void 0),o([f(cc.Node)],e.prototype,"nodeBoxOpenTip",void 0),o([f(cc.Node)],e.prototype,"nodeBubble",void 0),o([f(cc.Sprite)],e.prototype,"icon",void 0),o([f(cc.SpriteFrame)],e.prototype,"graySpf",void 0),o([f(cc.SpriteFrame)],e.prototype,"redSpf",void 0),o([f(cc.SpriteFrame)],e.prototype,"costEneryIcon",void 0),o([f(cc.SpriteFrame)],e.prototype,"notCostEneryIcon",void 0),o([f(cc.SpriteFrame)],e.prototype,"unLimitEnergyIcon",void 0),o([u],e)}(cc.Component);i.default=h,cc._RF.pop()},{"../../scripts/data/MiscConfig":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0}],LevelAwardPopup:[function(t,e,i){"use strict";cc._RF.push(e,"3b842sdMbRHe7IKuuh3tAx+","LevelAwardPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MstData"),c=t("../../scripts/data/UserData"),d=t("../../scripts/manager/AdManager"),l=t("../../scripts/manager/UIManager"),p=t("../../scripts/utils/EventName"),u=t("../../scripts/utils/GlobalFun"),f=t("../../scripts/utils/StatisticsManager"),h=t("../entitys/ItemList"),g=t("./AwardPopup"),m=t("../../scripts/extension/LanguageData"),v=cc._decorator,_=v.ccclass,y=v.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.toggleContent=null,e.toggleItem=null,e.itembg=null,e.awardIcon=null,e.itemContent=null,e.lbRemaining=null,e.lbCost=null,e.levlab=null,e.toggleScroll=null,e.btnGetAward=null,e.lbVideo=null,e._currentIndex=0,e._itemData=null,e._callBack=null,e._isGetAward=!1,e._levelConfig=null,e}var i;return n(e,t),i=e,e.prototype.init=function(t){t&&(this._callBack=t.callback),this._levelConfig=r.default.getInstance().mstActivity.levelupGift.config,this.updateUI(),u.default.isCanShowBanner()&&d.default.getInstance().showBanner()},e.prototype.onLoad=function(){f.default.trackEvent("levelupGift_open"),this.updateRewardCD(),cc.director.getScene().on(p.default.UPDATE_BY_SECOND,this.showTime,this)},e.prototype.start=function(){cc.director.getScene().on(p.default.UPDATE_ACTIVITY,this.activityUpdate,this)},e.prototype.activityUpdate=function(t){"levelupGift"==t&&this.updateUI()},e.prototype.updateUI=function(){var t=this;for(var e in this.toggleContent.node.children)this.toggleContent.node.children[e].active=!1;var i=c.default.getInstance().levelupAwardData();if(this._currentIndex=i.length-1,i.length>0){for(this.initInfo(i[this._currentIndex]),e=0;e<i.length;e++){var a=m.default.t("levelAwardPopup_1",{lv:i[e]});if(this.toggleContent.node.children[e])this.toggleContent.node.children[e].active=!0,this.toggleContent.toggleItems[e].node.getChildByName("select").getChildByName("label").getComponent(cc.Label).string=a,this.toggleContent.toggleItems[e].node.getChildByName("unselect").getChildByName("label").getComponent(cc.Label).string=a;else{var n=cc.instantiate(this.toggleItem.node);n.getChildByName("select").getChildByName("label").getComponent(cc.Label).string=a,n.getChildByName("unselect").getChildByName("label").getComponent(cc.Label).string=a,n.setParent(this.toggleContent.node)}}this.scheduleOnce(function(){t.toggleContent.toggleItems[t._currentIndex].isChecked=!0,t.toggleScroll.scrollToRight(.05)},.05)}else this.onClose()},e.prototype.onClickRadioGrp=function(t){var e=this.toggleContent.toggleItems.indexOf(t);if(e!==this._currentIndex){this._currentIndex=e;var i=c.default.getInstance().levelupAwardData();this.initInfo(i[this._currentIndex])}},e.prototype.initInfo=function(t){for(var e in this.levlab.string=t,this._itemData=this.getLevelAwardData(t),this.itemContent.children)this.itemContent.children[e].active=!1;this.awardIcon.node.active=!0,this.lbCost.string=c.default.getInstance().levelupAwardRecord[t].videoCount+"/"+this._levelConfig.lvData[t].costNum,this.showTime();var i=[];for(e=0;e<this._itemData.item.length;e++){var a={itemId:this._itemData.item[e].id,itemNum:this._itemData.item[e].num,itemBg:this.itembg,isClickAble:!0,isShowInfo:!0};i.push(a)}this.itemContent.getComponent(h.default).init({itemsData:i,spacingX:150})},e.prototype.getLevelAwardData=function(t){var e={item:[],level:t},i=[],a=r.default.getInstance().mstActivity.levelupGift.config.lvData[t];if(a.rewardRes.length>0){var n=u.default.rewardResToObj(a.rewardRes);for(var o in n)(c={id:0,num:0}).id=Number(o),c.num=n[o],i.push(c)}for(var s in a.reward){var c;(c={id:0,num:1}).id=a.reward[s],i.push(c)}return e.item=i,e},e.prototype.showTime=function(){if(this._itemData){var t=r.default.getInstance().mstActivity.levelupGift.config.limitTime,e=this._itemData.level,i=t-window.serverTime+c.default.getInstance().levelupAwardRecord[""+e].startTime;this.lbRemaining.string=m.default.t("levelAwardPopup_2",{time:u.default.formatDateTimeHourEx(i)}),this.updateRewardCD()}},e.prototype.updateRewardCD=function(){if(this.btnGetAward.node.active){var t=d.default.getInstance().rewardAdCd;t>0?(this.btnGetAward.interactable=!1,u.default.setBtnIsGrey(this.btnGetAward),this.lbVideo.string=u.default.formatDateTimeHourEx(t)):(this.btnGetAward.interactable=!0,u.default.setBtnIsGrey(this.btnGetAward,new cc.Color(64,98,35)),this.lbVideo.string=m.default.t("receive"))}},e.prototype.onClickAward=function(){var t=this;f.default.trackEvent("levelupGift_video_click",{level:""+this._itemData.level}),f.default.trackEventOnXG("common","Ad_button_click"),f.default.trackEventOnXG("video","\u5347\u7ea7\u793c\u5305",8,0),this._itemData&&d.default.getInstance().showRewardAd(function(){f.default.trackEventOnXG("video","\u5347\u7ea7\u793c\u5305",8,1),f.default.trackEvent("levelupGift_video_success",{level:""+t._itemData.level}),t.getAward(),t.updateRewardCD()},function(){f.default.trackEvent("levelupGift_video_fail",{level:""+t._itemData.level})},function(){f.default.trackEvent("levelupGift_video_err",{level:""+t._itemData.level})})},e.prototype.onClose=function(){!this._isGetAward&&this._callBack&&this._callBack(),t.prototype.onClose.call(this)},e.prototype.getAward=function(){var t=this;c.default.getInstance().addLevelVideoCount(this._itemData.level)&&c.default.getInstance().levelupAwardRecord[""+this._itemData.level].videoCount>=r.default.getInstance().mstActivity.levelupGift.config.lvData[this._itemData.level].costNum&&(f.default.trackEvent("levelupGift_receive_reward",{level:""+this._itemData.level}),c.default.getInstance().getLevelAward(this._itemData.level),this._isGetAward=!0,l.default.getInstance().openUI(g.default,{data:this._itemData.item},null,function(){t._isGetAward=!1,l.default.getInstance().getUI(i)||cc.director.getScene().emit(p.default.LEVEL_UP_GUIDE)}),cc.director.getScene().emit(p.default.UPDATE_ACTIVITY,"levelupGift")),this.lbCost.string="("+c.default.getInstance().levelupAwardRecord[this._itemData.level].videoCount+"/"+r.default.getInstance().mstActivity.levelupGift.config.lvData[this._itemData.level].costNum+")"},e.prototype.onDestroy=function(){u.default.isCanShowBanner()&&d.default.getInstance().hideBanner()},e.uiName="LevelAwardPopup",o([y(cc.ToggleContainer)],e.prototype,"toggleContent",void 0),o([y(cc.Toggle)],e.prototype,"toggleItem",void 0),o([y(cc.SpriteFrame)],e.prototype,"itembg",void 0),o([y(cc.Sprite)],e.prototype,"awardIcon",void 0),o([y(cc.Node)],e.prototype,"itemContent",void 0),o([y(cc.Label)],e.prototype,"lbRemaining",void 0),o([y(cc.Label)],e.prototype,"lbCost",void 0),o([y(cc.Label)],e.prototype,"levlab",void 0),o([y(cc.ScrollView)],e.prototype,"toggleScroll",void 0),o([y(cc.Button)],e.prototype,"btnGetAward",void 0),o([y(cc.Label)],e.prototype,"lbVideo",void 0),i=o([_],e)}(s.default);i.default=I,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../../scripts/utils/StatisticsManager":void 0,"../entitys/ItemList":"ItemList","./AwardPopup":"AwardPopup"}],LevelUpAwardPopup:[function(t,e,i){"use strict";cc._RF.push(e,"0def7Kwh89IR6GevB0HyAZV","LevelUpAwardPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MiscConfig"),c=t("../../scripts/data/MstData"),d=t("../../scripts/data/UserData"),l=t("../../scripts/manager/AdManager"),p=t("../../scripts/manager/UIManager"),u=t("../../scripts/prefabs/Toast"),f=t("../entitys/levelUpAwardItem"),h=t("./ShopPopup"),g=t("../../scripts/extension/LanguageData"),m=cc._decorator,v=m.ccclass,_=m.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itembg=null,e.levelupAward=null,e.level=null,e.experience=null,e.experienceValue=null,e.awardPrefab=null,e.dressTicketLab=null,e._awardList=[],e}return n(e,t),e.prototype.init=function(){var t=d.default.getInstance().exp,e=c.default.getInstance().mstLevelup,i=d.default.getInstance().level;this.level.string=""+i,i>=r.default.MAX_LEVEL?(this.experience.progress=0,this.experienceValue.string=g.default.t("max")):(this.experience.progress=t/e[i].exp,this.experienceValue.string=t.toString()+"/"+e[i].exp.toString()),this.dressTicketLab.string=d.default.getInstance().skinTicket+"",this.setLvelupAward(),l.default.getInstance().showBanner()},e.prototype.setLvelupAward=function(){var t=d.default.getInstance().level+1,e=c.default.getInstance().mstLevelup[t].reward;if(this._awardList=this._awardList.concat(e),this._awardList.length>0)for(var i=0;i<this._awardList.length;i++){var a=cc.instantiate(this.awardPrefab);a.getComponent(f.default).init({itemId:this._awardList[i]}),cc.isValid(this.node)&&this.levelupAward.addChild(a)}},e.prototype.onTiketChecked=function(){var t=this,e=c.default.getInstance().mstStore.dailyGift.openLevel;d.default.getInstance().level<e?p.default.getInstance().openUI(u.default,{data:{str:g.default.t("mainScene_1",{shopOpenLevel:e})}}):p.default.getInstance().openUI(h.default,{data:{key:"resource",type:1}},function(){},function(){cc.isValid(t.node)&&(t.dressTicketLab.string=d.default.getInstance().skinTicket+"")})},e.prototype.onDestroy=function(){l.default.getInstance().hideBanner()},e.uiName="LevelUpAwardPopup",o([_(cc.SpriteFrame)],e.prototype,"itembg",void 0),o([_(cc.Node)],e.prototype,"levelupAward",void 0),o([_(cc.Label)],e.prototype,"level",void 0),o([_(cc.ProgressBar)],e.prototype,"experience",void 0),o([_(cc.Label)],e.prototype,"experienceValue",void 0),o([_(cc.Prefab)],e.prototype,"awardPrefab",void 0),o([_(cc.Label)],e.prototype,"dressTicketLab",void 0),o([v],e)}(s.default);i.default=y,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MiscConfig":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/Toast":void 0,"../entitys/levelUpAwardItem":"levelUpAwardItem","./ShopPopup":"ShopPopup"}],Levelup:[function(t,e,i){"use strict";cc._RF.push(e,"d889bt0QOtAQ4rsoXsDiEDn","Levelup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MstData"),c=t("../../scripts/data/UserData"),d=t("../../scripts/manager/AdManager"),l=t("../../scripts/manager/AudioManager"),p=t("../../scripts/manager/UIManager"),u=t("../../scripts/utils/EventName"),f=t("../../scripts/utils/GlobalFun"),h=t("../entitys/ItemEntity"),g=t("./AwardPopup"),m=t("./LevelAwardPopup"),v=cc._decorator,_=v.ccclass,y=v.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itembg=null,e.star=null,e.level=null,e.levelupNode=null,e.levelupAward=null,e.awardPrefab=null,e._levelUpData=null,e._awardList=[],e}return n(e,t),e.prototype.init=function(t){var e=this;this._levelUpData=t,l.default.getInstance().playEffect("levelup"),this.levelupNode.active=!1;var i=this.star.node.getComponent(cc.Animation);i&&i.on(cc.Animation.EventType.FINISHED,function(){i.off(cc.Animation.EventType.FINISHED);var t=c.default.getInstance().level;e.level.string=t+""}),this.setLvelupAward(),f.default.isCanShowBanner()&&d.default.getInstance().showBanner()},e.prototype.setLvelupAward=function(){for(var t=this._levelUpData.historyLevel+1;t<=c.default.getInstance().level;t++){var e=t,i=r.default.getInstance().mstLevelup[e].reward;this._awardList=this._awardList.concat(i)}if(this._awardList.length>0)for(this.levelupNode.active=!0,t=0;t<this._awardList.length;t++){var a=cc.instantiate(this.awardPrefab);a.getComponent(h.default).init({itemId:this._awardList[t],itemBg:this.itembg}),cc.isValid(this.node)&&this.levelupAward.addChild(a)}else this.levelupNode.active=!1},e.prototype.onCloseClick=function(){var t=[];for(var e in this._awardList){var i=this._awardList[e];t.push({id:i,num:1})}p.default.getInstance().openUI(g.default,{data:t},null,function(){var t=c.default.getInstance().levelupAwardData(),e=c.default.getInstance().guidance;t.length>0?p.default.getInstance().openUI(m.default,{data:{callback:function(){e.isGuideComplete()&&!c.default.getInstance().activityData.isActivityGuideOpen()||cc.director.getScene().emit(u.default.LEVEL_UP_GUIDE)}}}):e.isGuideComplete()&&!c.default.getInstance().activityData.isActivityGuideOpen()||cc.director.getScene().emit(u.default.LEVEL_UP_GUIDE)}),this.onClose()},e.prototype.onDestroy=function(){f.default.isCanShowBanner()&&d.default.getInstance().hideBanner()},e.uiName="Levelup",o([y(cc.SpriteFrame)],e.prototype,"itembg",void 0),o([y(cc.Sprite)],e.prototype,"star",void 0),o([y(cc.Label)],e.prototype,"level",void 0),o([y(cc.Node)],e.prototype,"levelupNode",void 0),o([y(cc.Node)],e.prototype,"levelupAward",void 0),o([y(cc.Prefab)],e.prototype,"awardPrefab",void 0),o([_],e)}(s.default);i.default=I,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/AudioManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../entitys/ItemEntity":"ItemEntity","./AwardPopup":"AwardPopup","./LevelAwardPopup":"LevelAwardPopup"}],LimitActListPopup:[function(t,e,i){"use strict";cc._RF.push(e,"8302b8dCM5O1oI0WlHaOuRk","LimitActListPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MstData"),c=t("../../scripts/data/UserData"),d=t("../../scripts/manager/UIManager"),l=t("../extension/List"),p=t("./FoodFestivalHelpPopup"),u=t("../../scripts/extension/LanguageData"),f=cc._decorator,h=f.ccclass,g=f.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.listElement=null,e.itemBg=[],e._itemBgIndex=["foodFestival"],e._activityTypeList=[],e}return n(e,t),e.prototype.onLoad=function(){this._activityTypeList=c.default.getInstance().limitActModel.getAllCanOpenActivity(),this._activityTypeList.push(""),this.listElement.numItems=this._activityTypeList.length},e.prototype.itemElementRender=function(t,e){var i=this._activityTypeList[e];if(""==i)t.getChildByName("noNode").active=!0;else{t.getChildByName("noNode").active=!1;var a=r.default.getInstance().mstActivity[i].config.limitTime/86400;t.getChildByName("tipLab").getComponent(cc.Label).string=u.default.t("limitActListPopup_1",{data1:a}),t.getChildByName("goBtn").getComponent(cc.Button).clickEvents[0].customEventData=i,t.getComponent(cc.Sprite).spriteFrame=this.itemBg[this._itemBgIndex.indexOf(i)]}},e.prototype.onClickBtn=function(t,e){"foodFestival"==e&&this.openStartFoodFestvial()},e.prototype.openStartFoodFestvial=function(){d.default.getInstance().openUI(p.default)},e.uiName="LimitActListPopup",o([g(l.default)],e.prototype,"listElement",void 0),o([g([cc.SpriteFrame])],e.prototype,"itemBg",void 0),o([h],e)}(s.default);i.default=m,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/UIManager":void 0,"../extension/List":"List","./FoodFestivalHelpPopup":"FoodFestivalHelpPopup"}],LimitActMergeManager:[function(t,e,i){"use strict";cc._RF.push(e,"1779655UpBFz4geY7apLZWr","LimitActMergeManager");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("./ItemPrefab"),r=t("../prefabs/Levelup"),c=t("./CellItem"),d=t("./ItemTempPrefab"),l=t("../prefabs/UnlockShowPopup"),p=t("./ItemBgPrefab"),u=t("./ItemImgPrefab"),f=t("./LimitActMergeUI"),h=t("../../scripts/utils/EventName"),g=t("../../scripts/data/MiscConfig"),m=t("../../scripts/data/UserData"),v=t("../../scripts/utils/GlobalFun"),_=t("../../scripts/data/MstData"),y=t("../../scripts/manager/UIManager"),I=t("../../scripts/manager/AudioManager"),b=t("../../scripts/prefabs/Toast"),N=t("../../scripts/prefabs/CommonPopup"),C=t("../../scripts/extension/LanguageData"),k=cc._decorator,S=k.ccclass,w=k.property,T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tempContent=null,e.areaNode=null,e.touchNode=null,e.tolerateDis=50,e.mapIndex=1,e.guideBagPutCallback=null,e.itemTempPrefab=null,e.isLoadAreaOneFinish=!1,e.isLoadAreaTwoFinish=!1,e.touchIndex=-1,e.tempItem=null,e.tipList=[],e._guideIndex1=null,e._guideIndex2=null,e._guideCallback=null,e._lastSeletIdx=-1,e.itemIconPrefabList={},e.itemBgPrefabList={},e.itemPrefabList={},e}return n(e,t),e.prototype.onLoad=function(){var t=this;cc.director.getScene().on(h.default.UPDATE_MERGEAREA,this.updateMergeArea,this),cc.director.getScene().on(h.default.RECEIVE_AWARD,this.awardItem,this),cc.director.getScene().on(h.default.UPDATE_LIMIT_MERGEAREA,this.updateMergeArea,this),cc.resources.load("entitys/ItemTempPrefab",cc.Prefab,function(e,i){e||(t.itemTempPrefab=i,t.tempItem=cc.instantiate(t.itemTempPrefab).getComponent(d.default),t.tempItem.node.parent=t.tempContent,t.tempItem.node.active=!1,t._lastSeletIdx=-1)})},e.prototype.loadItems=function(t){var e=this;void 0===t&&(t=null);var i=this.areaNode.getChildByName("cellsContent"),a=this.areaNode.getChildByName("itemsContent"),n=a.getChildByName("itemsImgContent"),o=a.getChildByName("itemsBgContent"),r=a.getChildByName("itemsStateContent"),d=g.default.GAME_WIDTH*g.default.GAME_HEIGHT,l=g.default.ITEM_SIZE_WIDTH,f=g.default.ITEM_SIZE_HEIGHT,h=(new Date).getTime(),m=0,v=function(a){if(a>=d)return e.readyToTip(),e.addTouchEvent(),e.isLoadAreaOneFinish=!0,t&&t(),void console.log("\u7269\u54c1\u52a0\u8f7d\u7ed3\u675f\u7528\u65f6\u95f4: "+((new Date).getTime()-h));var g=!1,_=!1,y=!1,I=!1,b=function(){g&&_&&y&&I&&setTimeout(function(){v(++m)})},N=Math.floor(a/7),C=a%7*l+l/2,k=-N*f-f/2;cc.resources.load("entitys/CellItem",cc.Prefab,function(t,e){if(!t){var n=cc.instantiate(e);n.parent=i,n.setPosition(cc.v2(C,k)),n.width=l,n.height=f,n.getComponent(c.default).init(a),g=!0,b()}}),cc.resources.load("entitys/ItemBgPrefab",cc.Prefab,function(t,i){if(!t){var n=cc.instantiate(i);n.parent=o,n.setPosition(cc.v2(C,k)),n.width=l,n.height=f;var s=n.getComponent(p.default);s.initLimitAct(a),e.itemBgPrefabList[a]=s,y=!0,b()}}),cc.resources.load("entitys/ItemImgPrefab",cc.Prefab,function(t,i){if(!t){var o=cc.instantiate(i);o.parent=n,o.setPosition(cc.v2(C,k)),o.width=l,o.height=f;var s=o.getComponent(u.default);s.initLimitAct(a),e.itemIconPrefabList[a]=s,I=!0,b()}}),cc.resources.load("entitys/ItemPrefab",cc.Prefab,function(t,i){if(!t){var n=cc.instantiate(i);n.parent=r,n.setPosition(cc.v2(C,k)),n.width=l,n.height=f;var o=n.getComponent(s.default);o.initLimitAct(a,e),e.itemPrefabList[a]=o,_=!0,b()}})};v(m)},e.prototype.addTouchEvent=function(){var t=this;this.touchNode.on(cc.Node.EventType.TOUCH_START,function(e){t.stopToTip(),t.touchStart(e)},this),this.touchNode.on(cc.Node.EventType.TOUCH_MOVE,function(e){t.touchMove(e)},this),this.touchNode.on(cc.Node.EventType.TOUCH_CANCEL,function(){t.readyToTip(),t.touchCancel()},this),this.touchNode.on(cc.Node.EventType.TOUCH_END,function(e){t.readyToTip(),t.touchEnd(e)},this)},e.prototype.touchStart=function(t){var e=t.getLocation(),i=this.touchNode.convertToNodeSpaceAR(e),a=this.getIndexByLocation(i);if(this.touchIndex=a,this.isCanMoveByIndex(this.touchIndex)){cc.director.getScene().emit(h.default.UPDATE_LIMITITEM_INFO,this.touchIndex),this.tempItem.node.active=!0,this.tempItem.showCanMergeAnim(!1),this.itemPrefabList[this.touchIndex].node.active=!1,this.itemBgPrefabList[this.touchIndex].node.active=!1,this.itemIconPrefabList[this.touchIndex].node.active=!1,this.tempItem.initLimitAct(this.touchIndex),this.tempItem.node.position=this.itemPrefabList[this.touchIndex].node.position;var n=m.default.getInstance().limitActModel.itemData,o=n[this.touchIndex].mstData.propAttribute;"spawnerBoost"==o[0]&&o[1]>0?cc.director.getScene().emit(h.default.USE_PROP,this.touchIndex,1):"timeSkip"==o[0]&&o[1]>0?cc.director.getScene().emit(h.default.USE_PROP,this.touchIndex,1):"duplicator"==o[0]&&o[1]>0?cc.director.getScene().emit(h.default.USE_PROP,this.touchIndex,1):"scissors"==o[0]&&o[1]>0?cc.director.getScene().emit(h.default.USE_PROP,this.touchIndex,1):n[this.touchIndex].mstData.fusionAttribute.length>0&&cc.director.getScene().emit(h.default.USE_PROP,this.touchIndex,1)}},e.prototype.checkTolerateDis=function(t){var e=this.getPositionByIndex(this.touchIndex);v.default.getDisByPos(e,t)>=this.tolerateDis&&(this.tempItem&&this.tempItem.node&&!this.tempItem.node.active&&(this.tempItem.node.active=!0,this.itemPrefabList[this.touchIndex].node.active=!1,this.itemBgPrefabList[this.touchIndex].node.active=!1,this.itemIconPrefabList[this.touchIndex].node.active=!1),this.setIsChoose(this.touchIndex,!1))},e.prototype.touchMove=function(t){if(cc.isValid(this.tempItem)&&this.tempItem.node.active){this.tempItem.node.x+=t.getDelta().x,this.tempItem.node.y+=t.getDelta().y;var e=t.getLocation(),i=this.touchNode.convertToNodeSpaceAR(e),a=this.getIndexByLocation(i);a=a,this.checkTolerateDis(i),this.touchIndex!=a&&m.default.getInstance().isMergeable(this.touchIndex,a,1)?this.tempItem.showCanMergeAnim(!0):this.tempItem.showCanMergeAnim(!1)}},e.prototype.touchEnd=function(t){var e=t.getLocation(),i=this.touchNode.convertToNodeSpaceAR(e),a=this.getIndexByLocation(i);if(a=a,cc.director.getScene().emit(h.default.USE_PROP,-1),!this._guideIndex1&&!this._guideIndex2||this.touchIndex==this._guideIndex1&&a==this._guideIndex2){if(a==this.touchIndex)return this.simulateClickItem(a),this.reBackPos();var n=m.default.getInstance().getItemData(1),o=n[this.touchIndex].id,s=n[a].id,r=m.default.getInstance().merge(this.touchIndex,a,1);r.touchId=o,r.endId=s;var c=m.default.getInstance().limitActModel.itemData[a];"change"==r.result&&c.state==g.default.ITEM_STATE_lOCK?(this.reBackPos(),this.itemClick(this.touchIndex)):("noCells"!=r.result&&c.state==g.default.ITEM_STATE_TELEPORT&&this.showTeleportAni(r.cells[1]),this.reBackPos(),this.dealMergeResult(r,a),this._guideCallback&&this._guideCallback(),this._guideIndex1=null,this._guideIndex2=null,this._guideCallback=null)}else this.reBackPos()},e.prototype.touchCancel=function(){return cc.director.getScene().emit(h.default.USE_PROP,-1),this.setIsChoose(this.touchIndex,!1),this.itemClick(this.touchIndex),this.reBackPos()},e.prototype.getPositionByIndex=function(t){var e=g.default.ITEM_SIZE_WIDTH,i=g.default.ITEM_SIZE_HEIGHT,a=t%7*e+e/2,n=-Math.floor(t/7)*i-i/2;return cc.v3(a,n)},e.prototype.getDistanceByTwnPoint=function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},e.prototype.awardItem=function(t){var e=this;if(t.cells&&!(t.cells.length<1)&&0!=t.isAct){var i=t.cells[0],a=cc.instantiate(this.itemTempPrefab);a.getComponent("ItemTempPrefab").initLimitAct(i),a.parent=this.tempContent;var n=t.originNode,o=n.parent.convertToWorldSpaceAR(n.position),s=this.tempContent.convertToNodeSpaceAR(o);a.setPosition(s),a.active=!0;var r=this.getPositionByIndex(i),c=this.getDistanceByTwnPoint(s,r)/2e3;this.itemClick(-1),cc.tween(a).to(c,{position:r}).call(function(){e.updateMergeArea(t.cells),a.destroy()}).start()}},e.prototype.collectItem=function(t,e){var i=this.itemPrefabList[t].node,a=i,n=_.default.getInstance().mstItem[e].itemCount,o=_.default.getInstance().mstItem,s=0,r={};o&&"exp"==o[e].type?s=30091:o&&"energy"==o[e].type?s=30092:o&&"coin"==o[e].type?s=30093:o&&"diamond"==o[e].type?s=30094:o&&"praise"==o[e].type?(n=1,s=e,r.endNode=cc.find("Canvas/LimitActMergeUIContent/LimitActMergeUI").getComponent(f.default).getExpNode(),r.infoType="praise"):o&&"unlimitedEnergy"==o[e].type?(s=e,r.endNode=cc.find("Canvas/mainUI/topInfo/energy/icon")):s=30092,r.id=s,r.startNode=a,r.num=n,r.callback=function(){o&&"unlimitedEnergy"==o[e].type&&cc.director.getScene().emit(h.default.UNLIMIT_ENERGY),r.infoType},i.getComponent("ItemPrefab").initLimitAct(t),cc.director.getScene().emit(h.default.ITEM_FLY,r)},e.prototype.updateMergeArea=function(t){for(var e in void 0===t&&(t=[]),t){var i=t[e];this.itemPrefabList[i]&&this.itemPrefabList[i].initLimitAct(i),this.itemBgPrefabList[i]&&this.itemBgPrefabList[i].initLimitAct(i),this.itemIconPrefabList[i]&&this.itemIconPrefabList[i].initLimitAct(i)}this.stopToTip(),this.readyToTip()},e.prototype.simulateSingleClick=function(t,e){void 0===e&&(e=-1),this.touchIndex=t,this.itemClick(t),this.simulateClickItem(t,e)},e.prototype.simulateClickItem=function(t,e){if(void 0===e&&(e=-1),!(this.touchIndex<=-1)){if(this.itemPrefabList[this.touchIndex].choose.active){var i=this.itemPrefabList[this.touchIndex],a=m.default.getInstance().limitActModel.itemData[this.touchIndex].id,n=_.default.getInstance().mstItem[a];if(n&&n.autoSpawner&&m.default.getInstance().limitActModel.itemData[this.touchIndex].state==g.default.ITEM_STATE_NORMAL&&!m.default.getInstance().limitActModel.itemData[this.touchIndex].isCool)return;if(i.itemData.mstData&&i.itemData.mstData.isSpawner&&m.default.getInstance().limitActModel.itemData[this.touchIndex].isCool)return void this.tipRefreshCD(this.touchIndex);if(m.default.getInstance().limitActModel.itemData[this.touchIndex].state==g.default.ITEM_STATE_BUBBLE)return void this.tipRefreshBubble(this.touchIndex);if(i.itemData.mstData&&i.itemData.mstData.isBox&&!m.default.getInstance().limitActModel.itemData[this.touchIndex].isOpened&&m.default.getInstance().limitActModel.itemData[this.touchIndex].coolingTime&&m.default.getInstance().limitActModel.itemData[this.touchIndex].lastCoolingTime)return void this.tipRefreshBox(this.touchIndex);var o=m.default.getInstance().level,s=m.default.getInstance().clickItem(this.touchIndex,e,1);m.default.getInstance().level>o&&y.default.getInstance().openUI(r.default,{data:{historyLevel:o}}),this.dealMergeResult(s,this.touchIndex)}this.itemClick(this.touchIndex)}},e.prototype.dealMergeResult=function(t,e){var i=this;if(t){if(this.updateMergeArea(t.cells),"spawn"==t.result)this.itemIconPrefabList[e].showOutPutAnim(!0),I.default.getInstance().playEffect("output"),cc.director.getScene().emit(h.default.UPDATE_TOPINFO);else if("merge"==t.result||"fusion"==t.result||"charge"==t.result){var a=t.touchId,n=t.endId;if(3053==a&&3019==n)I.default.getInstance().playEffect("cleanTheBrush");else if(3041==a&&3016==n)I.default.getInstance().playEffect("freshBuns");else if("snack"==_.default.getInstance().mstItem[a].type&&3081==n)I.default.getInstance().playEffect("snacks");else{var o=e,s=m.default.getInstance().limitActModel.itemData[o].id,r=_.default.getInstance().mstItem[s].level-1;r=(r=r<1?1:r)>7?7:r,I.default.getInstance().playEffect("merge"+r)}var c=t.cells[1];this.itemBgPrefabList[c].showNewAnim(!0)}else"collect"==t.result?this.collectItem(t.cells[0],t.collectId):"noCells"==t.result?y.default.getInstance().openUI(b.default,{data:{str:C.default.t("bagItem_1")}}):"maxOpening"==t.result&&y.default.getInstance().openUI(b.default,{data:{str:C.default.t("mergeManager_1")}});if(t.move){var d=function(a){p.itemPrefabList[t.move[a]].node.active=!1,p.itemBgPrefabList[t.move[a]].node.active=!1,p.itemIconPrefabList[t.move[a]].node.active=!1,p.moveCreateItem(e,t.move[a],function(){i.itemPrefabList[t.move[a]].node.active=!0,i.itemBgPrefabList[t.move[a]].node.active=!0,i.itemIconPrefabList[t.move[a]].node.active=!0,i.updateMergeArea([t.move[a]])})},p=this;for(var u in t.move)d(u)}if(t.unlockItemIndex)for(var u in t.unlockItemIndex)this.lockAreaItemAnim(t.unlockItemIndex[u]);m.default.getInstance().limitActModel.itemData[e].state!=g.default.ITEM_STATE_TELEPORT&&this.itemClick(e),t.newCustomerId>0&&y.default.getInstance().openNotice(l.default,{data:{ntype:"customer",id:t.newCustomerId}}),t.newItemId>=0&&_.default.getInstance().mstItem[t.newItemId].isUnlockShow&&y.default.getInstance().openNotice(l.default,{data:{ntype:"item",id:t.newItemId}})}},e.prototype.dealAutoMergeResult=function(t,e){var i=this;if(t){if(t.cells.length>0&&(m.default.getInstance().updateTaskAndItem(),this.updateMergeArea(t.cells)),t.unlockItemIndex)for(var a in t.unlockItemIndex)this.lockAreaItemAnim(t.unlockItemIndex[a]);if(t.move){var n=function(a){I.default.getInstance().playEffect("output"),o.itemPrefabList[t.move[a]].node.active=!1,o.itemBgPrefabList[t.move[a]].node.active=!1,o.itemIconPrefabList[t.move[a]].node.active=!1,o.moveCreateItem(e,t.move[a],function(){i.itemPrefabList[t.move[a]].node.active=!0,i.itemBgPrefabList[t.move[a]].node.active=!0,i.itemIconPrefabList[t.move[a]].node.active=!0,i.updateMergeArea([t.move[a]])})},o=this;for(var a in t.move)n(a)}t.newCustomerId>0&&y.default.getInstance().openNotice(l.default,{data:{ntype:"customer",id:t.newCustomerId}}),t.newItemId>=0&&_.default.getInstance().mstItem[t.newItemId].isUnlockShow&&y.default.getInstance().openNotice(l.default,{data:{ntype:"item",id:t.newItemId}})}},e.prototype.itemClick=function(t){this._lastSeletIdx>=0&&this.itemPrefabList[this._lastSeletIdx].onClick(t),t>=0&&(this.itemPrefabList[t].onClick(t),this.itemIconPrefabList[t].onClick(t)),this._lastSeletIdx=t},e.prototype.setIsChoose=function(t,e){this.itemPrefabList[t]&&this.itemPrefabList[t].setSelect(e)},e.prototype.getIndexByLocation=function(t){var e=g.default.ITEM_SIZE_WIDTH,i=g.default.ITEM_SIZE_HEIGHT,a=Math.floor(Math.abs(t.x)/e),n=Math.floor(Math.abs(t.y)/i),o=7*n+a;return o>g.default.GAME_HEIGHT*g.default.GAME_WIDTH-1||o<0?-1:1==this.mapIndex?7*n+a:7*n+a+g.default.GAME_HEIGHT*g.default.GAME_WIDTH},e.prototype.moveCreateItem=function(t,e,i){var a=this;void 0===i&&(i=null);var n=cc.instantiate(this.itemTempPrefab);n.getComponent("ItemTempPrefab").initLimitAct(e),n.parent=this.tempContent;var o=this.getPositionByIndex(t);n.setPosition(o),n.active=!0;var s=this.getPositionByIndex(e),r=this.getDistanceByTwnPoint(o,s)/2e3;cc.tween(n).to(r,{position:s}).call(function(){i&&i(),a.updateMergeArea([e]),n.destroy()}).start()},e.prototype.showTeleportAni=function(t){var e=cc.instantiate(this.itemTempPrefab);if(e.getComponent("ItemTempPrefab").initLimitAct(t),e.parent=this.tempContent,e.position=this.tempItem.node.position,e.active=!0,cc.isValid(e)){var i=cc.v3(942.5,-138,0);1==m.default.getInstance().mergeArea&&(i=cc.v3(72.5,-138,0)),cc.tween(e).to(.1,{scale:1.5}).delay(.1).to(.3,{scale:0,position:i,angle:-360}).call(function(){e.destroy()}).start()}},e.prototype.reBackPos=function(){this.itemPrefabList[this.touchIndex]&&(this.itemPrefabList[this.touchIndex].node.active=!0),this.itemBgPrefabList[this.touchIndex]&&(this.itemBgPrefabList[this.touchIndex].node.active=!0),this.itemIconPrefabList[this.touchIndex]&&(this.itemIconPrefabList[this.touchIndex].node.active=!0),cc.isValid(this.tempItem)&&(this.tempItem.node.active=!1)},e.prototype.isCanMoveByIndex=function(t){var e=m.default.getInstance().limitActModel.itemData;return e[t].state==g.default.ITEM_STATE_NORMAL&&e[t].id>0||e[t].state==g.default.ITEM_STATE_BUBBLE&&e[t].id>0},e.prototype.readyToTip=function(t){var e=this;void 0===t&&(t=!0),cc.tween(this.node).delay(3).call(function(){if(t)for(var i in e.tipList=m.default.getInstance().getMergeTip(1),e.tipList)e.itemIconPrefabList[e.tipList[i]]&&e.itemIconPrefabList[e.tipList[i]].showTipAnim()}).start()},e.prototype.stopToTip=function(){for(var t in this.node.stopAllActions(),this.tipList)this.itemIconPrefabList[this.tipList[t]]&&this.itemIconPrefabList[this.tipList[t]].stopTipAnim();this.tipList=[]},e.prototype.lockAreaItemAnim=function(t){this.itemPrefabList[t].showUnlockAnim(),this.itemIconPrefabList[t].showUnlockAnim()},e.prototype.tipRefreshCD=function(t){if(this.isCanVideoSpeedUp(t)){var e=cc.find("Canvas/LimitActMergeUIContent/LimitActMergeUI").getComponent("LimitActMergeUI"),i={contentText:C.default.t("mergeManager_2"),model:g.default.COMMON_POPUP_MODEL_2,isVideo:!0,okCallback:function(){e.onClickVideoSpeedUp()}};y.default.getInstance().openUI(N.default,{data:i})}},e.prototype.tipRefreshBubble=function(t){if(this.isCanVideoSpeedUp(t)){var e=cc.find("Canvas/LimitActMergeUIContent/LimitActMergeUI").getComponent("LimitActMergeUI"),i={contentText:"\u662f\u5426\u89c2\u770b\u89c6\u9891\u83b7\u5f97\u6c14\u6ce1\u7269\u54c1",model:g.default.COMMON_POPUP_MODEL_2,isVideo:!0,okCallback:function(){m.default.getInstance().limitActModel.itemData[t].state==g.default.ITEM_STATE_BUBBLE?e.onClickVideoSpeedUp():y.default.getInstance().openUI(b.default,{data:{str:C.default.t("mergeManager_4")}})}};y.default.getInstance().openUI(N.default,{data:i})}},e.prototype.isCanVideoSpeedUp=function(t){return!!m.default.getInstance().limitActModel.itemData[t].isShowVideo},e.prototype.tipRefreshBox=function(t){if(this.isCanVideoSpeedUp(t)){var e=cc.find("Canvas/LimitActMergeUIContent/LimitActMergeUI").getComponent("LimitActMergeUI"),i={contentText:C.default.t("mergeManager_2"),model:g.default.COMMON_POPUP_MODEL_2,okCallback:function(){e.onClickVideoSpeedUp()}};y.default.getInstance().openUI(N.default,{data:i})}},e.prototype.getItemByIndex=function(t){return this.itemPrefabList[t].node},e.prototype.guideToMerge=function(t,e,i){void 0===i&&(i=function(){}),this._guideIndex1=t,this._guideIndex2=e,this._guideCallback=i},o([w(cc.Node)],e.prototype,"tempContent",void 0),o([w(cc.Node)],e.prototype,"areaNode",void 0),o([w(cc.Node)],e.prototype,"touchNode",void 0),o([w(cc.Float)],e.prototype,"tolerateDis",void 0),o([w(cc.Integer)],e.prototype,"mapIndex",void 0),o([S],e)}(cc.Component);i.default=T,cc._RF.pop()},{"../../scripts/data/MiscConfig":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AudioManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/CommonPopup":void 0,"../../scripts/prefabs/Toast":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../prefabs/Levelup":"Levelup","../prefabs/UnlockShowPopup":"UnlockShowPopup","./CellItem":"CellItem","./ItemBgPrefab":"ItemBgPrefab","./ItemImgPrefab":"ItemImgPrefab","./ItemPrefab":"ItemPrefab","./ItemTempPrefab":"ItemTempPrefab","./LimitActMergeUI":"LimitActMergeUI"}],LimitActMergeUI:[function(t,e,i){"use strict";cc._RF.push(e,"e25f8dlfnlD36WG6FGH5CwA","LimitActMergeUI");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../prefabs/LimitActivityGiftPopup"),r=t("../prefabs/ItemChain"),c=t("../prefabs/ShopPopup"),d=t("../prefabs/UnlockShowPopup"),l=t("./FoodFestivalUI"),p=t("./LimitActMergeManager"),u=t("../../scripts/utils/EventName"),f=t("../../scripts/data/MiscData"),h=t("../../scripts/data/UserData"),g=t("../../scripts/data/MiscConfig"),m=t("../../scripts/data/MstData"),v=t("../../scripts/data/userModel/UserItemModel"),_=t("../../scripts/manager/AdManager"),y=t("../../scripts/manager/AudioManager"),I=t("../../scripts/manager/UIManager"),b=t("../../scripts/prefabs/Toast"),N=t("../../scripts/utils/GlobalFun"),C=t("../../scripts/utils/StatisticsManager"),k=t("../../scripts/extension/LanguageData"),S=cc._decorator,w=S.ccclass,T=S.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bg1=null,e.bg2=null,e.actInfoNode=null,e.itemNameContent=null,e.itemInfoBtnContent=null,e.btnRebackNode=null,e.lbName=null,e.itemChainNode=null,e.lbTime=null,e.lbDes=null,e.speedUpBtnNode=null,e.clearVideoIcon=null,e.lbSpeedUpText=null,e.speedUpIconNode=null,e.lbSpeedUpPrice=null,e.lbVideoCount=null,e.sellBtnNode=null,e.lbsellText=null,e.lbsellPrice=null,e.videoBtnNode=null,e.lbVideoBtnText=null,e.btnAward=null,e.icon=null,e.awardCount=null,e.giftNode=null,e.mergeManager=null,e._loadCompleteCallback=null,e._chooseItemIndex=-1,e._tempItemData=null,e._rewardId=null,e._isFree=!1,e}return n(e,t),e.prototype.init=function(t){void 0===t&&(t=null),this._loadCompleteCallback=t},e.prototype.onLoad=function(){var t=this;cc.director.getScene().on(u.default.UPDATE_LIMITITEM_INFO,this.updateItemInfo,this),cc.director.getScene().on(u.default.UPDATE_BY_SECOND,this.updateBySecond,this),cc.director.getScene().on(u.default.UPDATE_LIMIT_REWARD,this.updateReward,this),this.mergeManager.getComponent(p.default).loadItems(function(){"function"==typeof t._loadCompleteCallback&&t._loadCompleteCallback()}),this.giftNode.active=f.default.getInstance().isIOSPayOpen,this.adapterScreen(),this.updateBySecond(),this.updateItemInfo(),this.updateReward(),this.loadActTopInfo()},e.prototype.adapterScreen=function(){var t=cc.view.getVisibleSize().width,e=cc.view.getVisibleSize().height;if(e/t>1920/1080){var i=1920/1080*t;this.bg1.height+=(e-i)/2,this.bg2.height+=(e-i)/2}},e.prototype.updateItemInfo=function(t){if(void 0===t&&(t=-1),this._chooseItemIndex!=t&&(this._tempItemData=null,this._chooseItemIndex=t),-1==this._chooseItemIndex||this._tempItemData||h.default.getInstance().limitActModel.itemData[this._chooseItemIndex].id<0)if(this.itemNameContent.active=!1,this.itemInfoBtnContent.active=!1,this._tempItemData){this.btnRebackNode.active=!0;var e=m.default.getInstance().mstItem[this._tempItemData.id].name,i=m.default.getInstance().mstItem[this._tempItemData.id].level;this.lbDes.string=k.default.t("topInfoPrefab_1",{itemName:e,itemLevel:i})}else this.btnRebackNode.active=!1,this.lbDes.string=k.default.t("topInfoPrefab_2");else{this.itemNameContent.active=!0,this.itemInfoBtnContent.active=!0,this.btnRebackNode.active=!1;var a=h.default.getInstance().limitActModel.itemData[this._chooseItemIndex];if(this.lbName.string=k.default.t("topInfoPrefab_3",{itemName:a.mstData.name,lv:a.mstData.level}),this.lbTime.node.parent.active=!0,this.videoBtnNode.node.active=!1,this.lbVideoBtnText.string=k.default.t("topInfoPrefab_14"),this.speedUpBtnNode.active=!1,this.speedUpIconNode.active=!0,this.lbSpeedUpText.node.height=40,this.lbSpeedUpText.node.y=41,a.mstData.isBox&&a.state==g.default.ITEM_STATE_NORMAL)if(a.isOpened)this.lbTime.node.parent.active=!1,this.lbTime.string="";else if(a.coolingTime>=0){var n=a.coolingTime;if(this.lbTime.string=N.default.formatDateTimeHourEx(n),a.isShowVideo){this.videoBtnNode.node.active=!0;var o=m.default.getInstance().mstMisc.clearMaxTimeByVideoTimes.config-h.default.getInstance().clearVideoTimes;this.lbVideoCount.string=o<=10?k.default.t("topInfoPrefab_15",{count:o}):""}this.speedUpBtnNode.active=!0,this.lbSpeedUpText.node.height=40,this.lbSpeedUpText.string=k.default.t("topInfoPrefab_4"),this.lbSpeedUpPrice.string=""+a.clearCoolDiamonds,this.guideFree()}else this.speedUpBtnNode.active=!0,this.speedUpIconNode.active=!1,this.lbSpeedUpText.node.height=40,this.lbSpeedUpText.string=k.default.t("topInfoPrefab_5"),this.lbSpeedUpPrice.string="",this.lbSpeedUpText.node.y=20,this.lbTime.string=N.default.formatDateTimeHourEx(a.mstData.openingTime);else if(a.mstData.isSpawner&&a.state==g.default.ITEM_STATE_NORMAL)(n=a.coolingTime)>0?(this.lbTime.string=N.default.formatDateTimeHourEx(n),a.isShowVideo&&(this.videoBtnNode.node.active=!0,o=m.default.getInstance().mstMisc.clearMaxTimeByVideoTimes.config-h.default.getInstance().clearVideoTimes,this.lbVideoCount.string=o<=10?k.default.t("topInfoPrefab_15",{count:o}):""),this.speedUpBtnNode.active=!0,this.lbSpeedUpText.node.height=40,this.lbSpeedUpText.string=k.default.t("topInfoPrefab_4"),this.lbSpeedUpPrice.string=""+a.clearCoolDiamonds,this.guideFree()):this.lbTime.node.parent.active=!1;else if(a.decayAttribute&&a.decayAttribute.length>0)if(this.lbTime.string=N.default.formatDateTimeHourEx(a.decayTime),a.state==g.default.ITEM_STATE_BUBBLE){var s=a.mstData.diamondsPrice;a.isShowVideo&&(this.lbVideoBtnText.string=k.default.t("topInfoPrefab_16"),this.videoBtnNode.node.active=!0,o=m.default.getInstance().mstMisc.getBubbleByVideoTimes.config-h.default.getInstance().bubbleVideoTimes,this.lbVideoCount.string=o<=10?k.default.t("topInfoPrefab_15",{count:o}):""),this.speedUpBtnNode.active=!0,this.lbSpeedUpText.node.height=40,this.lbSpeedUpText.string=k.default.t("buildInfoPopup_3"),this.lbSpeedUpPrice.string=s,this.guideFree()}else a.mstData.decayAttribute[0],a.isShowVideo&&(this.videoBtnNode.node.active=!0,o=m.default.getInstance().mstMisc.clearMaxTimeByVideoTimes.config-h.default.getInstance().clearVideoTimes,this.lbVideoCount.string=o<=10?k.default.t("topInfoPrefab_15",{count:o}):""),this.speedUpBtnNode.active=!0,this.lbSpeedUpText.node.height=40,this.lbSpeedUpText.string=k.default.t("topInfoPrefab_4"),this.lbSpeedUpPrice.string=""+a.clearDecayDiamonds,this.guideFree();else this.lbTime.node.parent.active=!1;this.itemChainNode.active=!0,a.state==g.default.ITEM_STATE_NORMAL?a.mstData.rechargeAttribute&&a.mstData.rechargeAttribute.length>0?this.lbDes.string=a.mstData.desc+k.default.t("topInfoPrefab_17",{chargeValue:a.chargeValue,rechargeAttribute:a.mstData.rechargeAttribute[0]}):this.lbDes.string=a.mstData.desc:a.state==g.default.ITEM_STATE_BUBBLE?this.lbDes.string=k.default.t("topInfoPrefab_7"):a.state==g.default.ITEM_STATE_COBWEB?this.lbDes.string=k.default.t("topInfoPrefab_8"):a.state==g.default.ITEM_STATE_UNKNOWN?(this.lbName.string=k.default.t("topInfoPrefab_9"),this.lbDes.string=k.default.t("topInfoPrefab_10"),this.itemChainNode.active=!1):(a.state,g.default.ITEM_STATE_lOCK),this.sellBtnNode.active=!1,this.lbsellText.string=k.default.t("topInfoPrefab_11"),this.lbsellText.node.y=14.3,this.sellBtnNode.children[1].active=!0,this.sellBtnNode.children[2].active=!0,a.mstData.deleteAble&&a.state==g.default.ITEM_STATE_NORMAL&&(this.sellBtnNode.active=!0,this.lbsellPrice.string=a.mstData.sellCoins)}this.updateRewardCD()},e.prototype.updatelbTime=function(){if(!(-1==this._chooseItemIndex||this._tempItemData||h.default.getInstance().limitActModel.itemData[this._chooseItemIndex].id<0)){var t=h.default.getInstance().limitActModel.itemData[this._chooseItemIndex];if(t.mstData.isBox&&t.state==g.default.ITEM_STATE_NORMAL){if(!t.isOpened&&t.coolingTime>=0){var e=t.coolingTime;this.lbTime.string=N.default.formatDateTimeHourEx(e),this.lbSpeedUpPrice.string=""+t.clearCoolDiamonds,this.guideFree()}}else t.mstData.isSpawner&&t.state==g.default.ITEM_STATE_NORMAL?(e=t.coolingTime)>0&&(this.lbTime.string=N.default.formatDateTimeHourEx(e),this.lbSpeedUpPrice.string=""+t.clearCoolDiamonds,this.guideFree()):t.decayAttribute&&t.decayAttribute.length>0&&(this.lbTime.string=N.default.formatDateTimeHourEx(t.decayTime),this.guideFree())}},e.prototype.updateRewardCD=function(){if(this.videoBtnNode.node.active){var t=_.default.getInstance().rewardAdCd;if(t>0)this.videoBtnNode.interactable=!1,N.default.setBtnIsGrey(this.videoBtnNode),this.clearVideoIcon.active=!1,this.lbVideoBtnText.node.x=0,this.lbVideoBtnText.node.y=0,this.lbVideoBtnText.string=N.default.formatDateTimeHourEx(t);else if(this.videoBtnNode.interactable=!0,N.default.setBtnIsGrey(this.videoBtnNode,new cc.Color(64,98,35)),this.clearVideoIcon.active=!0,this.lbVideoBtnText.node.x=15,this.lbVideoBtnText.node.y=3.5,this.lbVideoBtnText.string=k.default.t("topInfoPrefab_14"),this._chooseItemIndex>0){var e=h.default.getInstance().itemData[this._chooseItemIndex];e.decayAttribute&&e.decayAttribute.length>0&&e.state==g.default.ITEM_STATE_BUBBLE&&e.isShowVideo&&(this.lbVideoBtnText.string=k.default.t("topInfoPrefab_16"))}}},e.prototype.updateBySecond=function(){this.updatelbTime(),this.updateReward(),this.updateRewardCD()},e.prototype.onClickVideoSpeedUp=function(){var t=this;C.default.trackEventOnXG("common","Ad_button_click");var e=h.default.getInstance().limitActModel.itemData[this._chooseItemIndex],i=m.default.getInstance().mstItem[e.id],a=null;if(i.isSpawner&&e.state==g.default.ITEM_STATE_NORMAL)e.isCool&&(C.default.trackEventOnXG("video","\u4ea7\u51fa\u7269\u54c1CD",15,0),e.clearCoolDiamonds<=m.default.getInstance().mstMisc.clearMaxTimeByVideo.config&&(a=function(){e.clearCoolTime(!0),h.default.getInstance().addClearVideoTimes(),C.default.trackEventOnXG("video","\u4ea7\u51fa\u7269\u54c1CD",15,1)}));else if(i.isBox&&e.state==g.default.ITEM_STATE_NORMAL)!e.isOpened&&e.coolingTime&&e.lastCoolingTime&&(C.default.trackEventOnXG("video","\u5f00\u5b9d\u7bb1",16,0),e.clearCoolDiamonds<=m.default.getInstance().mstMisc.clearMaxTimeByVideo.config&&(a=function(){e.clearCoolTime(!0),h.default.getInstance().addClearVideoTimes(),C.default.trackEventOnXG("video","\u5f00\u5b9d\u7bb1",16,1)}));else if(e.decayAttribute&&e.decayAttribute.length>0)if(e.state==g.default.ITEM_STATE_BUBBLE){var n=e.id;C.default.trackEventOnXG("video","\u6c14\u6ce1\u8d2d\u4e70",17,0),a=function(){var t=e.buyItem(!0,n);h.default.getInstance().addBulleVideoTimes(),y.default.getInstance().playEffect("bubbleBreak"),t&&t.newCustomerId>0&&I.default.getInstance().openNotice(d.default,{data:{ntype:"customer",id:t.newCustomerId}}),t&&t.newItemId>=0&&m.default.getInstance().mstItem[t.newItemId].isUnlockShow&&I.default.getInstance().openNotice(d.default,{data:{ntype:"item",id:t.newItemId}}),C.default.trackEventOnXG("video","\u6c14\u6ce1\u8d2d\u4e70",17,1)}}else e.clearDecayDiamonds<=m.default.getInstance().mstMisc.clearMaxTimeByVideo.config&&(C.default.trackEventOnXG("video","\u7269\u54c1\u52a0\u901f",18,0),a=function(){e.speedupDecay(!0),h.default.getInstance().addClearVideoTimes(),C.default.trackEventOnXG("video","\u7269\u54c1\u52a0\u901f",18,1)});_.default.getInstance().showRewardAd(function(){a&&a(),t.updateItemInfo(t._chooseItemIndex),cc.director.getScene().emit(u.default.UPDATE_TOPINFO),cc.director.getScene().emit(u.default.UPDATE_MERGEAREA,[t._chooseItemIndex])},function(){},function(){},"topInfo_speedup_video")},e.prototype.onClickSpeedUp=function(){var t=h.default.getInstance().limitActModel.itemData[this._chooseItemIndex],e=m.default.getInstance().mstItem[t.id],i=0,a=null;e.isSpawner&&t.state==g.default.ITEM_STATE_NORMAL?t.isCool&&(i=t.clearCoolDiamonds,a=function(){t.clearCoolTime(),C.default.trackEvent("topInfo_clearCoolTime_click",{itemId:t.id})}):e.isBox&&t.state==g.default.ITEM_STATE_NORMAL?!t.isOpened&&t.coolingTime<0?"maxOpening"==h.default.getInstance().clickItem(this._chooseItemIndex).result&&I.default.getInstance().openUI(b.default,{data:{str:k.default.t("topInfoPrefab_12")}}):!t.isOpened&&t.coolingTime&&t.lastCoolingTime&&(i=t.clearCoolDiamonds,a=function(){t.clearCoolTime(),C.default.trackEvent("topInfo_clearCoolTime_click",{itemId:t.id})}):t.decayAttribute&&t.decayAttribute.length>0&&(t.state==g.default.ITEM_STATE_BUBBLE?(i=e.diamondsPrice,a=function(){var e=t.buyItem();y.default.getInstance().playEffect("bubbleBreak"),C.default.trackEvent("topInfo_buyBubble_click",{itemId:t.id}),e&&e.newCustomerId>0&&I.default.getInstance().openNotice(d.default,{data:{ntype:"customer",id:e.newCustomerId}}),e&&e.newItemId>=0&&m.default.getInstance().mstItem[e.newItemId].isUnlockShow&&I.default.getInstance().openNotice(d.default,{data:{ntype:"item",id:e.newItemId}})}):(i=t.clearDecayDiamonds,a=function(){t.speedupDecay(),C.default.trackEvent("topInfo_speedupDecay_click",{itemId:t.id})})),h.default.getInstance().diamonds>=i?(a&&a(),this.updateItemInfo(this._chooseItemIndex),cc.director.getScene().emit(u.default.UPDATE_TOPINFO),cc.director.getScene().emit(u.default.UPDATE_MERGEAREA,[this._chooseItemIndex])):N.default.noDiamondsCommonPopup()},e.prototype.onClickSell=function(){this._tempItemData=h.default.getInstance().limitActModel.itemData[this._chooseItemIndex].zipData(),h.default.getInstance().limitActModel.itemData[this._chooseItemIndex].sellItem()&&(cc.director.getScene().emit(u.default.UPDATE_TOPINFO),cc.director.getScene().emit(u.default.UPDATE_MERGEAREA,[this._chooseItemIndex])),this.updateItemInfo(this._chooseItemIndex)},e.prototype.onClickReback=function(){if(this._tempItemData){var t=m.default.getInstance().mstItem[this._tempItemData.id].sellCoins;if(h.default.getInstance().addCoins(-t)>=0){var e=this._tempItemData.id;if(h.default.getInstance().limitActModel.itemData[this._chooseItemIndex].id>0){h.default.getInstance().limitActModel.addReward([this._tempItemData]),this._tempItemData=null;var i={};i.id=e,i.startNode=this.mergeManager.itemIconPrefabList[this._chooseItemIndex].node,i.num=1,i.callback=function(){cc.director.getScene().emit(u.default.UPDATE_LIMIT_REWARD)},cc.director.getScene().emit(u.default.ITEM_FLY,i)}else h.default.getInstance().limitActModel.itemData[this._chooseItemIndex]=new v.default(this._tempItemData),this._tempItemData=null;h.default.getInstance().updateTaskAndItem(),cc.director.getScene().emit(u.default.UPDATE_TOPINFO),cc.director.getScene().emit(u.default.UPDATE_MERGEAREA,[this._chooseItemIndex]),this.updateItemInfo(this._chooseItemIndex),C.default.trackEvent("topInfo_reback_click",{itemId:e})}else I.default.getInstance().openUI(b.default,{data:{str:k.default.t("topInfoPrefab_13")}})}},e.prototype.onClickItemChain=function(){C.default.trackEvent("topInfo_detail_click");var t=h.default.getInstance().limitActModel.itemData[this._chooseItemIndex].id;t>=0&&I.default.getInstance().openUI(r.default,{data:t})},e.prototype.onClickShop=function(){I.default.getInstance().openUI(c.default,{data:{key:"foodStore",type:2}})},e.prototype.onClickTask=function(){I.default.getInstance().openUI(s.default)},e.prototype.onClickBack=function(){cc.director.getScene().emit(u.default.OPEN_SCENE)},e.prototype.onClickReward=function(){if(h.default.getInstance().limitActModel.rewards.length>0){var t=h.default.getInstance().receiveReward(1,1);if(t>=0)y.default.getInstance().playEffect("clickBtn"),this.updateReward(),this.updateItemInfo(-1),cc.director.getScene().emit(u.default.RECEIVE_AWARD,{cells:[t],originNode:this.btnAward,isAct:1});else{var e={str:k.default.t("bagItem_1")};I.default.getInstance().openUI(b.default,{data:e})}}},e.prototype.updateReward=function(){var t=h.default.getInstance().limitActModel.rewards;if(t.length>0){if(t[0].updateInfo(),this.awardCount.string=t.length+"",this._rewardId>=0&&this._rewardId!=t[0].id){this._rewardId=t[0].id,this.btnAward.active=!0;var e=N.default.getItemIconPathById(t[0].id+"");N.default.loadSpriteFrame(this.icon,e)}}else this.btnAward.active&&(this._rewardId=null,this.btnAward.active=!1)},e.prototype.loadActTopInfo=function(){var t=this,e=h.default.getInstance().limitActModel.getOpenActName();if(e)switch(e){case"foodFestival":return"FoodFestivalUI",cc.resources.load("entitys/FoodFestivalUI",cc.Prefab,function(e,i){e||(cc.instantiate(i).parent=t.actInfoNode)}),!0}},e.prototype.getExpNode=function(){var t=h.default.getInstance().limitActModel.getOpenActName();if(t)switch(t){case"foodFestival":return this.actInfoNode.children[0].getComponent(l.default).getPraiseNode()}return null},e.prototype.guideFreeDiamond=function(t){void 0===t&&(t=!1),this._isFree=t,this.updateItemInfo(this._chooseItemIndex)},e.prototype.guideFree=function(){this.speedUpIconNode.active=!0,this._isFree&&(this.speedUpIconNode.active=!1,this.lbSpeedUpText.node.height=80,this.lbSpeedUpText.string=k.default.t("topInfoPrefab_16"),this.lbSpeedUpPrice.string="")},o([T(cc.Node)],e.prototype,"bg1",void 0),o([T(cc.Node)],e.prototype,"bg2",void 0),o([T(cc.Node)],e.prototype,"actInfoNode",void 0),o([T(cc.Node)],e.prototype,"itemNameContent",void 0),o([T(cc.Node)],e.prototype,"itemInfoBtnContent",void 0),o([T(cc.Node)],e.prototype,"btnRebackNode",void 0),o([T(cc.Label)],e.prototype,"lbName",void 0),o([T(cc.Node)],e.prototype,"itemChainNode",void 0),o([T(cc.Label)],e.prototype,"lbTime",void 0),o([T(cc.Label)],e.prototype,"lbDes",void 0),o([T(cc.Node)],e.prototype,"speedUpBtnNode",void 0),o([T(cc.Node)],e.prototype,"clearVideoIcon",void 0),o([T(cc.Label)],e.prototype,"lbSpeedUpText",void 0),o([T(cc.Node)],e.prototype,"speedUpIconNode",void 0),o([T(cc.Label)],e.prototype,"lbSpeedUpPrice",void 0),o([T(cc.Label)],e.prototype,"lbVideoCount",void 0),o([T(cc.Node)],e.prototype,"sellBtnNode",void 0),o([T(cc.Label)],e.prototype,"lbsellText",void 0),o([T(cc.Label)],e.prototype,"lbsellPrice",void 0),o([T(cc.Button)],e.prototype,"videoBtnNode",void 0),o([T(cc.Label)],e.prototype,"lbVideoBtnText",void 0),o([T(cc.Node)],e.prototype,"btnAward",void 0),o([T(cc.Sprite)],e.prototype,"icon",void 0),o([T(cc.Label)],e.prototype,"awardCount",void 0),o([T(cc.Node)],e.prototype,"giftNode",void 0),o([T(p.default)],e.prototype,"mergeManager",void 0),o([w],e)}(cc.Component);i.default=P,cc._RF.pop()},{"../../scripts/data/MiscConfig":void 0,"../../scripts/data/MiscData":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/data/userModel/UserItemModel":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/AudioManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/Toast":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../../scripts/utils/StatisticsManager":void 0,"../prefabs/ItemChain":"ItemChain","../prefabs/LimitActivityGiftPopup":"LimitActivityGiftPopup","../prefabs/ShopPopup":"ShopPopup","../prefabs/UnlockShowPopup":"UnlockShowPopup","./FoodFestivalUI":"FoodFestivalUI","./LimitActMergeManager":"LimitActMergeManager"}],LimitActivityGiftPopup:[function(t,e,i){"use strict";cc._RF.push(e,"de1b31UOKFI1aHYyMp5DYFo","LimitActivityGiftPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/UserData"),c=t("../../scripts/manager/UIManager"),d=t("../../scripts/utils/EventName"),l=t("../../scripts/utils/GlobalFun"),p=t("../entitys/BuyItem"),u=t("../entitys/ItemEntity"),f=t("../extension/List"),h=t("./AwardPopup"),g=cc._decorator,m=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rewardBg=null,e.listElement=null,e._helpGiftConfig=null,e._helpGiftKey=null,e._model=null,e}return n(e,t),e.prototype.onLoad=function(){cc.director.getScene().on(d.default.LIMIT_ACT_CLOSE,this.closeLimitAct,this),this._model=r.default.getInstance().limitActModel;var t=this._model.getHelpGiftConfig(),e=l.default.sortObjectByValue(t);this._helpGiftConfig=e[0],this._helpGiftKey=e[1],this.listElement.numItems=this._helpGiftConfig.length},e.prototype.itemElementRender=function(t,e){var i=this,a=this._helpGiftConfig[e],n=this._model.getHelpGift(this._helpGiftKey[e]);t.getChildByName("name").getComponent(cc.Label).string=a.giftName,t.getChildByName("limitLab").getComponent(cc.Label).string=n.buyTimes+"/"+a.limitNum;var o=l.default.getAllReward(a.reward,a.rewardRes),s=t.getChildByName("ItemEntity1");if(s.active=o[0],o[0]){var r={};r.itemId=o[0].id,r.itemNum=o[0].num,r.isClickAble=!0,r.isShowInfo=!0,r.itemBg=this.rewardBg,s.getComponent(u.default).init(r)}var d=t.getChildByName("ItemEntity2");if(d.active=o[1],o[1]){var f={};f.itemId=o[1].id,f.itemNum=o[1].num,f.isClickAble=!0,f.isShowInfo=!0,f.itemBg=this.rewardBg,d.getComponent(u.default).init(f)}if(n.buyTimes>=a.limitNum)t.getChildByName("BuyItem").active=!1,t.getChildByName("overBtn").active=!0;else{t.getChildByName("BuyItem").active=!0,t.getChildByName("overBtn").active=!1;var g={};g.nowCostNum=n.costNum,g.successCb=function(o){if(i._model.buyHelpGift(i._helpGiftKey[e],o)){var s=l.default.getAllReward(a.reward,a.rewardRes);c.default.getInstance().openUI(h.default,{data:s}),t.getChildByName("BuyItem").getComponent(p.default).updateNowCostnum(0),t.getChildByName("limitLab").getComponent(cc.Label).string=n.buyTimes+"/"+a.limitNum,n.buyTimes>=a.limitNum&&(t.getChildByName("BuyItem").active=!1,t.getChildByName("overBtn").active=!0)}},g.failCb="",t.getChildByName("BuyItem").getComponent(p.default).init(a,g)}},e.prototype.closeLimitAct=function(){this.onClose()},e.uiName="LimitActivityGiftPopup",o([v(cc.SpriteFrame)],e.prototype,"rewardBg",void 0),o([v(f.default)],e.prototype,"listElement",void 0),o([m],e)}(s.default);i.default=_,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/UserData":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../entitys/BuyItem":"BuyItem","../entitys/ItemEntity":"ItemEntity","../extension/List":"List","./AwardPopup":"AwardPopup"}],ListItem:[function(t,e,i){"use strict";cc._RF.push(e,"a2e254eqIlE1oTO7hTGl9Qq","ListItem");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s,r=cc._decorator,c=r.ccclass,d=r.property,l=r.disallowMultiple,p=r.menu,u=r.executionOrder;(function(t){t[t.NONE=0]="NONE",t[t.TOGGLE=1]="TOGGLE",t[t.SWITCH=2]="SWITCH"})(s||(s={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.icon=null,e.title=null,e.selectedMode=s.NONE,e.selectedFlag=null,e.selectedSpriteFrame=null,e._unselectedSpriteFrame=null,e.adaptiveSize=!1,e._selected=!1,e._eventReg=!1,e}return n(e,t),Object.defineProperty(e.prototype,"selected",{get:function(){return this._selected},set:function(t){if(this._selected=t,this.selectedFlag)switch(this.selectedMode){case s.TOGGLE:this.selectedFlag.active=t;break;case s.SWITCH:var e=this.selectedFlag.getComponent(cc.Sprite);e&&(e.spriteFrame=t?this.selectedSpriteFrame:this._unselectedSpriteFrame)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"btnCom",{get:function(){return this._btnCom||(this._btnCom=this.node.getComponent(cc.Button)),this._btnCom},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){if(this.selectedMode==s.SWITCH){var t=this.selectedFlag.getComponent(cc.Sprite);this._unselectedSpriteFrame=t.spriteFrame}},e.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.SIZE_CHANGED,this._onSizeChange,this)},e.prototype._registerEvent=function(){this._eventReg||(this.btnCom&&this.list.selectedMode>0&&this.btnCom.clickEvents.unshift(this.createEvt(this,"onClickThis")),this.adaptiveSize&&this.node.on(cc.Node.EventType.SIZE_CHANGED,this._onSizeChange,this),this._eventReg=!0)},e.prototype._onSizeChange=function(){this.list._onItemAdaptive(this.node)},e.prototype.createEvt=function(t,e,i){if(void 0===i&&(i=null),t.isValid){t.comName=t.comName||t.name.match(/\<(.*?)\>/g).pop().replace(/\<|>/g,"");var a=new cc.Component.EventHandler;return a.target=i||t.node,a.component=t.comName,a.handler=e,a}},e.prototype.showAni=function(t,e,i){var a,n=this;switch(t){case 0:a=cc.tween(n.node).to(.2,{scale:.7}).by(.3,{y:2*n.node.height});break;case 1:a=cc.tween(n.node).to(.2,{scale:.7}).by(.3,{x:2*n.node.width});break;case 2:a=cc.tween(n.node).to(.2,{scale:.7}).by(.3,{y:-2*n.node.height});break;case 3:a=cc.tween(n.node).to(.2,{scale:.7}).by(.3,{x:-2*n.node.width});break;default:a=cc.tween(n.node).to(.3,{scale:.1})}(e||i)&&a.call(function(){if(i){n.list._delSingleItem(n.node);for(var t=n.list.displayData.length-1;t>=0;t--)if(n.list.displayData[t].id==n.listId){n.list.displayData.splice(t,1);break}}e()}),a.start()},e.prototype.onClickThis=function(){this.list.selectedId=this.listId},o([d({type:cc.Sprite,tooltip:!1})],e.prototype,"icon",void 0),o([d({type:cc.Node,tooltip:!1})],e.prototype,"title",void 0),o([d({type:cc.Enum(s),tooltip:!1})],e.prototype,"selectedMode",void 0),o([d({type:cc.Node,tooltip:!1,visible:function(){return this.selectedMode>s.NONE}})],e.prototype,"selectedFlag",void 0),o([d({type:cc.SpriteFrame,tooltip:!1,visible:function(){return this.selectedMode==s.SWITCH}})],e.prototype,"selectedSpriteFrame",void 0),o([d({tooltip:!1})],e.prototype,"adaptiveSize",void 0),o([c,l(),p("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/List Item"),u(-5001)],e)}(cc.Component);i.default=f,cc._RF.pop()},{}],List:[function(t,e,i){"use strict";cc._RF.push(e,"f3c80LEmDFG85V6PM9TX2S+","List");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s,r,c,d=cc._decorator,l=d.ccclass,p=d.property,u=d.disallowMultiple,f=d.menu,h=d.executionOrder,g=d.requireComponent,m=t("./ListItem");(function(t){t[t.NODE=1]="NODE",t[t.PREFAB=2]="PREFAB"})(s||(s={})),function(t){t[t.NORMAL=1]="NORMAL",t[t.ADHERING=2]="ADHERING",t[t.PAGE=3]="PAGE"}(r||(r={})),function(t){t[t.NONE=0]="NONE",t[t.SINGLE=1]="SINGLE",t[t.MULT=2]="MULT"}(c||(c={}));var v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateType=s.NODE,e.tmpNode=null,e.tmpPrefab=null,e._slideMode=r.NORMAL,e.pageDistance=.3,e.pageChangeEvent=new cc.Component.EventHandler,e._virtual=!0,e.cyclic=!1,e.lackCenter=!1,e.lackSlide=!1,e._updateRate=0,e.frameByFrameRenderNum=0,e.renderEvent=new cc.Component.EventHandler,e.selectedMode=c.NONE,e.repeatEventSingle=!1,e.selectedEvent=new cc.Component.EventHandler,e._selectedId=-1,e._forceUpdate=!1,e._updateDone=!0,e._numItems=0,e._inited=!1,e._needUpdateWidget=!1,e._aniDelRuning=!1,e._doneAfterUpdate=!1,e.adhering=!1,e._adheringBarrier=!1,e.curPageNum=0,e}return n(e,t),Object.defineProperty(e.prototype,"slideMode",{get:function(){return this._slideMode},set:function(t){this._slideMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"virtual",{get:function(){return this._virtual},set:function(t){null!=t&&(this._virtual=t),0!=this._numItems&&this._onScrolling()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"updateRate",{get:function(){return this._updateRate},set:function(t){t>=0&&t<=6&&(this._updateRate=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectedId",{get:function(){return this._selectedId},set:function(t){var e,i=this;switch(i.selectedMode){case c.SINGLE:if(!i.repeatEventSingle&&t==i._selectedId)return;e=i.getItemByListId(t);var a=void 0;if(i._selectedId>=0?i._lastSelectedId=i._selectedId:i._lastSelectedId=null,i._selectedId=t,e&&((a=e.getComponent(m.default)).selected=!0),i._lastSelectedId>=0&&i._lastSelectedId!=i._selectedId){var n=i.getItemByListId(i._lastSelectedId);n&&(n.getComponent(m.default).selected=!1)}i.selectedEvent&&cc.Component.EventHandler.emitEvents([i.selectedEvent],e,t%this._actualNumItems,null==i._lastSelectedId?null:i._lastSelectedId%this._actualNumItems);break;case c.MULT:if(!(e=i.getItemByListId(t)))return;a=e.getComponent(m.default),i._selectedId>=0&&(i._lastSelectedId=i._selectedId),i._selectedId=t;var o=!a.selected;a.selected=o;var s=i.multSelected.indexOf(t);o&&s<0?i.multSelected.push(t):!o&&s>=0&&i.multSelected.splice(s,1),i.selectedEvent&&cc.Component.EventHandler.emitEvents([i.selectedEvent],e,t%this._actualNumItems,null==i._lastSelectedId?null:i._lastSelectedId%this._actualNumItems,o)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numItems",{get:function(){return this._actualNumItems},set:function(t){var e=this;if(e.checkInited(!1))if(null==t||t<0)cc.error("numItems set the wrong::",t);else if(e._actualNumItems=e._numItems=t,e._forceUpdate=!0,e._virtual)e._resizeContent(),e.cyclic&&(e._numItems=e._cyclicNum*e._numItems),e._onScrolling(),e.frameByFrameRenderNum||e.slideMode!=r.PAGE||(e.curPageNum=e.nearestListId);else{e.cyclic&&(e._resizeContent(),e._numItems=e._cyclicNum*e._numItems);var i=e.content.getComponent(cc.Layout);if(i&&(i.enabled=!0),e._delRedundantItem(),e.firstListId=0,e.frameByFrameRenderNum>0){for(var a=e.frameByFrameRenderNum>e._numItems?e._numItems:e.frameByFrameRenderNum,n=0;n<a;n++)e._createOrUpdateItem2(n);e.frameByFrameRenderNum<e._numItems&&(e._updateCounter=e.frameByFrameRenderNum,e._updateDone=!1)}else{for(n=0;n<e._numItems;n++)e._createOrUpdateItem2(n);e.displayItemNum=e._numItems}}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scrollView",{get:function(){return this._scrollView},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this._init()},e.prototype.onDestroy=function(){var t=this;cc.isValid(t._itemTmp)&&t._itemTmp.destroy(),cc.isValid(t.tmpNode)&&t.tmpNode.destroy(),t._pool&&t._pool.clear()},e.prototype.onEnable=function(){this._registerEvent(),this._init(),this._aniDelRuning&&(this._aniDelRuning=!1,this._aniDelItem&&(this._aniDelBeforePos&&(this._aniDelItem.position=this._aniDelBeforePos,delete this._aniDelBeforePos),this._aniDelBeforeScale&&(this._aniDelItem.scale=this._aniDelBeforeScale,delete this._aniDelBeforeScale),delete this._aniDelItem),this._aniDelCB&&(this._aniDelCB(),delete this._aniDelCB))},e.prototype.onDisable=function(){this._unregisterEvent()},e.prototype._registerEvent=function(){var t=this;t.node.on(cc.Node.EventType.TOUCH_START,t._onTouchStart,t,!0),t.node.on("touch-up",t._onTouchUp,t),t.node.on(cc.Node.EventType.TOUCH_CANCEL,t._onTouchCancelled,t,!0),t.node.on("scroll-began",t._onScrollBegan,t,!0),t.node.on("scroll-ended",t._onScrollEnded,t,!0),t.node.on("scrolling",t._onScrolling,t,!0),t.node.on(cc.Node.EventType.SIZE_CHANGED,t._onSizeChanged,t)},e.prototype._unregisterEvent=function(){var t=this;t.node.off(cc.Node.EventType.TOUCH_START,t._onTouchStart,t,!0),t.node.off("touch-up",t._onTouchUp,t),t.node.off(cc.Node.EventType.TOUCH_CANCEL,t._onTouchCancelled,t,!0),t.node.off("scroll-began",t._onScrollBegan,t,!0),t.node.off("scroll-ended",t._onScrollEnded,t,!0),t.node.off("scrolling",t._onScrolling,t,!0),t.node.off(cc.Node.EventType.SIZE_CHANGED,t._onSizeChanged,t)},e.prototype._init=function(){var t=this;if(!t._inited)if(t._scrollView=t.node.getComponent(cc.ScrollView),t.content=t._scrollView.content,t.content){switch(t._layout=t.content.getComponent(cc.Layout),t._align=t._layout.type,t._resizeMode=t._layout.resizeMode,t._startAxis=t._layout.startAxis,t._topGap=t._layout.paddingTop,t._rightGap=t._layout.paddingRight,t._bottomGap=t._layout.paddingBottom,t._leftGap=t._layout.paddingLeft,t._columnGap=t._layout.spacingX,t._lineGap=t._layout.spacingY,t._colLineNum,t._verticalDir=t._layout.verticalDirection,t._horizontalDir=t._layout.horizontalDirection,t.setTemplateItem(cc.instantiate(t.templateType==s.PREFAB?t.tmpPrefab:t.tmpNode)),t._slideMode!=r.ADHERING&&t._slideMode!=r.PAGE||(t._scrollView.inertia=!1,t._scrollView._onMouseWheel=function(){}),t.virtual||(t.lackCenter=!1),t._lastDisplayData=[],t.displayData=[],t._pool=new cc.NodePool,t._forceUpdate=!1,t._updateCounter=0,t._updateDone=!0,t.curPageNum=0,t.cyclic&&(t._scrollView._processAutoScrolling=this._processAutoScrolling.bind(t),t._scrollView._startBounceBackIfNeeded=function(){return!1}),t._align){case cc.Layout.Type.HORIZONTAL:switch(t._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:t._alignCalcType=1;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:t._alignCalcType=2}break;case cc.Layout.Type.VERTICAL:switch(t._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:t._alignCalcType=3;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:t._alignCalcType=4}break;case cc.Layout.Type.GRID:switch(t._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:switch(t._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:t._alignCalcType=3;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:t._alignCalcType=4}break;case cc.Layout.AxisDirection.VERTICAL:switch(t._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:t._alignCalcType=1;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:t._alignCalcType=2}}}t.content.removeAllChildren(),t._inited=!0}else cc.error(t.node.name+"'s cc.ScrollView unset content!")},e.prototype._processAutoScrolling=function(t){this._scrollView._autoScrollAccumulatedTime+=1*t;var e=Math.min(1,this._scrollView._autoScrollAccumulatedTime/this._scrollView._autoScrollTotalTime);if(this._scrollView._autoScrollAttenuate){var i=e-1;e=i*i*i*i*i+1}var a=this._scrollView._autoScrollStartPosition.add(this._scrollView._autoScrollTargetDelta.mul(e)),n=this._scrollView.getScrollEndedEventTiming(),o=Math.abs(e-1)<=n;Math.abs(e-1)<=this._scrollView.getScrollEndedEventTiming()&&!this._scrollView._isScrollEndedWithThresholdEventFired&&(this._scrollView._dispatchEvent("scroll-ended-with-threshold"),this._scrollView._isScrollEndedWithThresholdEventFired=!0),o&&(this._scrollView._autoScrolling=!1);var s=a.sub(this._scrollView.getContentPosition());this._scrollView._moveContent(this._scrollView._clampDelta(s),o),this._scrollView._dispatchEvent("scrolling"),this._scrollView._autoScrolling||(this._scrollView._isBouncing=!1,this._scrollView._scrolling=!1,this._scrollView._dispatchEvent("scroll-ended"))},e.prototype.setTemplateItem=function(t){if(t){var e=this;e._itemTmp=t,e._resizeMode==cc.Layout.ResizeMode.CHILDREN?e._itemSize=e._layout.cellSize:e._itemSize=cc.size(t.width,t.height);var i=t.getComponent(m.default),a=!1;switch(i||(a=!0),a&&(e.selectedMode=c.NONE),(i=t.getComponent(cc.Widget))&&i.enabled&&(e._needUpdateWidget=!0),e.selectedMode==c.MULT&&(e.multSelected=[]),e._align){case cc.Layout.Type.HORIZONTAL:e._colLineNum=1,e._sizeType=!1;break;case cc.Layout.Type.VERTICAL:e._colLineNum=1,e._sizeType=!0;break;case cc.Layout.Type.GRID:switch(e._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:var n=e.content.width-e._leftGap-e._rightGap;e._colLineNum=Math.floor((n+e._columnGap)/(e._itemSize.width+e._columnGap)),e._sizeType=!0;break;case cc.Layout.AxisDirection.VERTICAL:var o=e.content.height-e._topGap-e._bottomGap;e._colLineNum=Math.floor((o+e._lineGap)/(e._itemSize.height+e._lineGap)),e._sizeType=!1}}}},e.prototype.checkInited=function(t){return void 0===t&&(t=!0),!!this._inited||(t&&cc.error("List initialization not completed!"),!1)},e.prototype._resizeContent=function(){var t,e=this;switch(e._align){case cc.Layout.Type.HORIZONTAL:if(e._customSize){var i=e._getFixedSize(null);t=e._leftGap+i.val+e._itemSize.width*(e._numItems-i.count)+e._columnGap*(e._numItems-1)+e._rightGap}else t=e._leftGap+e._itemSize.width*e._numItems+e._columnGap*(e._numItems-1)+e._rightGap;break;case cc.Layout.Type.VERTICAL:e._customSize?(i=e._getFixedSize(null),t=e._topGap+i.val+e._itemSize.height*(e._numItems-i.count)+e._lineGap*(e._numItems-1)+e._bottomGap):t=e._topGap+e._itemSize.height*e._numItems+e._lineGap*(e._numItems-1)+e._bottomGap;break;case cc.Layout.Type.GRID:switch(e.lackCenter&&(e.lackCenter=!1),e._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:var a=Math.ceil(e._numItems/e._colLineNum);t=e._topGap+e._itemSize.height*a+e._lineGap*(a-1)+e._bottomGap;break;case cc.Layout.AxisDirection.VERTICAL:var n=Math.ceil(e._numItems/e._colLineNum);t=e._leftGap+e._itemSize.width*n+e._columnGap*(n-1)+e._rightGap}}var o=e.content.getComponent(cc.Layout);if(o&&(o.enabled=!1),e._allItemSize=t,e._allItemSizeNoEdge=e._allItemSize-(e._sizeType?e._topGap+e._bottomGap:e._leftGap+e._rightGap),e.cyclic){var s=e._sizeType?e.node.height:e.node.width;e._cyclicPos1=0,s-=e._cyclicPos1,e._cyclicNum=Math.ceil(s/e._allItemSizeNoEdge)+1;var r=e._sizeType?e._lineGap:e._columnGap;e._cyclicPos2=e._cyclicPos1+e._allItemSizeNoEdge+r,e._cyclicAllItemSize=e._allItemSize+e._allItemSizeNoEdge*(e._cyclicNum-1)+r*(e._cyclicNum-1),e._cycilcAllItemSizeNoEdge=e._allItemSizeNoEdge*e._cyclicNum,e._cycilcAllItemSizeNoEdge+=r*(e._cyclicNum-1)}e._lack=!e.cyclic&&e._allItemSize<(e._sizeType?e.node.height:e.node.width);var c=e._lack&&e.lackCenter||!e.lackSlide?.1:0,d=e._lack?(e._sizeType?e.node.height:e.node.width)-c:e.cyclic?e._cyclicAllItemSize:e._allItemSize;d<0&&(d=0),e._sizeType?e.content.height=d:e.content.width=d},e.prototype._onScrolling=function(t){if(void 0===t&&(t=null),null==this.frameCount&&(this.frameCount=this._updateRate),!this._forceUpdate&&t&&"scroll-ended"!=t.type&&this.frameCount>0)this.frameCount--;else if(this.frameCount=this._updateRate,!this._aniDelRuning){if(this.cyclic){var e=this.content.getPosition();e=this._sizeType?e.y:e.x;var i=this._allItemSizeNoEdge+(this._sizeType?this._lineGap:this._columnGap),a=this._sizeType?cc.v2(0,i):cc.v2(i,0);switch(this._alignCalcType){case 1:e>-this._cyclicPos1?(this.content.x=-this._cyclicPos2,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.sub(a))):e<-this._cyclicPos2&&(this.content.x=-this._cyclicPos1,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(a)));break;case 2:e<this._cyclicPos1?(this.content.x=this._cyclicPos2,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(a))):e>this._cyclicPos2&&(this.content.x=this._cyclicPos1,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.sub(a)));break;case 3:e<this._cyclicPos1?(this.content.y=this._cyclicPos2,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(a))):e>this._cyclicPos2&&(this.content.y=this._cyclicPos1,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.sub(a)));break;case 4:e>-this._cyclicPos1?(this.content.y=-this._cyclicPos2,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.sub(a))):e<-this._cyclicPos2&&(this.content.y=-this._cyclicPos1,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(a)))}}var n,o,s,r;if(this._calcViewPos(),this._sizeType?(n=this.viewTop,s=this.viewBottom):(o=this.viewRight,r=this.viewLeft),this._virtual){this.displayData=[];var c=void 0,d=0,l=this._numItems-1;if(this._customSize)for(var p=!1;d<=l&&!p;d++)switch(c=this._calcItemPos(d),this._align){case cc.Layout.Type.HORIZONTAL:c.right>=r&&c.left<=o?this.displayData.push(c):0!=d&&this.displayData.length>0&&(p=!0);break;case cc.Layout.Type.VERTICAL:c.bottom<=n&&c.top>=s?this.displayData.push(c):0!=d&&this.displayData.length>0&&(p=!0);break;case cc.Layout.Type.GRID:switch(this._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:c.bottom<=n&&c.top>=s?this.displayData.push(c):0!=d&&this.displayData.length>0&&(p=!0);break;case cc.Layout.AxisDirection.VERTICAL:c.right>=r&&c.left<=o?this.displayData.push(c):0!=d&&this.displayData.length>0&&(p=!0)}}else{var u=this._itemSize.width+this._columnGap,f=this._itemSize.height+this._lineGap;switch(this._alignCalcType){case 1:d=(r-this._leftGap)/u,l=(o-this._leftGap)/u;break;case 2:d=(-o-this._rightGap)/u,l=(-r-this._rightGap)/u;break;case 3:d=(-n-this._topGap)/f,l=(-s-this._topGap)/f;break;case 4:d=(s-this._bottomGap)/f,l=(n-this._bottomGap)/f}for(d=Math.floor(d)*this._colLineNum,l=Math.ceil(l)*this._colLineNum,d<0&&(d=0),--l>=this._numItems&&(l=this._numItems-1);d<=l;d++)this.displayData.push(this._calcItemPos(d))}if(this._delRedundantItem(),this.displayData.length<=0||!this._numItems)return void(this._lastDisplayData=[]);this.firstListId=this.displayData[0].id,this.displayItemNum=this.displayData.length;var h=this._lastDisplayData.length,g=this.displayItemNum!=h;if(g&&(this.frameByFrameRenderNum>0&&this._lastDisplayData.sort(function(t,e){return t-e}),g=this.firstListId!=this._lastDisplayData[0]||this.displayData[this.displayItemNum-1].id!=this._lastDisplayData[h-1]),this._forceUpdate||g)if(this.frameByFrameRenderNum>0)this._numItems>0?(this._updateDone?this._updateCounter=0:this._doneAfterUpdate=!0,this._updateDone=!1):(this._updateCounter=0,this._updateDone=!0);else{this._lastDisplayData=[];for(var m=0;m<this.displayItemNum;m++)this._createOrUpdateItem(this.displayData[m]);this._forceUpdate=!1}this._calcNearestItem()}}},e.prototype._calcViewPos=function(){var t=this.content.getPosition();switch(this._alignCalcType){case 1:this.elasticLeft=t.x>0?t.x:0,this.viewLeft=(t.x<0?-t.x:0)-this.elasticLeft,this.viewRight=this.viewLeft+this.node.width,this.elasticRight=this.viewRight>this.content.width?Math.abs(this.viewRight-this.content.width):0,this.viewRight+=this.elasticRight;break;case 2:this.elasticRight=t.x<0?-t.x:0,this.viewRight=(t.x>0?-t.x:0)+this.elasticRight,this.viewLeft=this.viewRight-this.node.width,this.elasticLeft=this.viewLeft<-this.content.width?Math.abs(this.viewLeft+this.content.width):0,this.viewLeft-=this.elasticLeft;break;case 3:this.elasticTop=t.y<0?Math.abs(t.y):0,this.viewTop=(t.y>0?-t.y:0)+this.elasticTop,this.viewBottom=this.viewTop-this.node.height,this.elasticBottom=this.viewBottom<-this.content.height?Math.abs(this.viewBottom+this.content.height):0,this.viewBottom+=this.elasticBottom;break;case 4:this.elasticBottom=t.y>0?Math.abs(t.y):0,this.viewBottom=(t.y<0?-t.y:0)-this.elasticBottom,this.viewTop=this.viewBottom+this.node.height,this.elasticTop=this.viewTop>this.content.height?Math.abs(this.viewTop-this.content.height):0,this.viewTop-=this.elasticTop}},e.prototype._calcItemPos=function(t){var e,i,a,n,o,s,r,c;switch(this._align){case cc.Layout.Type.HORIZONTAL:switch(this._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:if(this._customSize){var d=this._getFixedSize(t);o=this._leftGap+(this._itemSize.width+this._columnGap)*(t-d.count)+(d.val+this._columnGap*d.count),e=(l=this._customSize[t])>0?l:this._itemSize.width}else o=this._leftGap+(this._itemSize.width+this._columnGap)*t,e=this._itemSize.width;return this.lackCenter&&(o-=this._leftGap,o+=this.content.width/2-this._allItemSizeNoEdge/2),{id:t,left:o,right:s=o+e,x:o+this._itemTmp.anchorX*e,y:this._itemTmp.y};case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:return this._customSize?(d=this._getFixedSize(t),s=-this._rightGap-(this._itemSize.width+this._columnGap)*(t-d.count)-(d.val+this._columnGap*d.count),e=(l=this._customSize[t])>0?l:this._itemSize.width):(s=-this._rightGap-(this._itemSize.width+this._columnGap)*t,e=this._itemSize.width),this.lackCenter&&(s+=this._rightGap,s-=this.content.width/2-this._allItemSizeNoEdge/2),{id:t,right:s,left:o=s-e,x:o+this._itemTmp.anchorX*e,y:this._itemTmp.y}}break;case cc.Layout.Type.VERTICAL:switch(this._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:return this._customSize?(d=this._getFixedSize(t),a=-this._topGap-(this._itemSize.height+this._lineGap)*(t-d.count)-(d.val+this._lineGap*d.count),i=(l=this._customSize[t])>0?l:this._itemSize.height):(a=-this._topGap-(this._itemSize.height+this._lineGap)*t,i=this._itemSize.height),this.lackCenter&&(a+=this._topGap,a-=this.content.height/2-this._allItemSizeNoEdge/2),{id:t,top:a,bottom:n=a-i,x:this._itemTmp.x,y:n+this._itemTmp.anchorY*i};case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:var l;if(this._customSize)d=this._getFixedSize(t),n=this._bottomGap+(this._itemSize.height+this._lineGap)*(t-d.count)+(d.val+this._lineGap*d.count),i=(l=this._customSize[t])>0?l:this._itemSize.height;else n=this._bottomGap+(this._itemSize.height+this._lineGap)*t,i=this._itemSize.height;return this.lackCenter&&(n-=this._bottomGap,n+=this.content.height/2-this._allItemSizeNoEdge/2),{id:t,top:a=n+i,bottom:n,x:this._itemTmp.x,y:n+this._itemTmp.anchorY*i}}case cc.Layout.Type.GRID:var p=Math.floor(t/this._colLineNum);switch(this._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:switch(this._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:c=(n=(a=-this._topGap-(this._itemSize.height+this._lineGap)*p)-this._itemSize.height)+this._itemTmp.anchorY*this._itemSize.height;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:a=(n=this._bottomGap+(this._itemSize.height+this._lineGap)*p)+this._itemSize.height,c=n+this._itemTmp.anchorY*this._itemSize.height}switch(r=this._leftGap+t%this._colLineNum*(this._itemSize.width+this._columnGap),this._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:r+=this._itemTmp.anchorX*this._itemSize.width,r-=this.content.anchorX*this.content.width;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:r+=(1-this._itemTmp.anchorX)*this._itemSize.width,r-=(1-this.content.anchorX)*this.content.width,r*=-1}return{id:t,top:a,bottom:n,x:r,y:c};case cc.Layout.AxisDirection.VERTICAL:switch(this._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:s=(o=this._leftGap+(this._itemSize.width+this._columnGap)*p)+this._itemSize.width,r=o+this._itemTmp.anchorX*this._itemSize.width,r-=this.content.anchorX*this.content.width;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:r=(o=(s=-this._rightGap-(this._itemSize.width+this._columnGap)*p)-this._itemSize.width)+this._itemTmp.anchorX*this._itemSize.width,r+=(1-this.content.anchorX)*this.content.width}switch(c=-this._topGap-t%this._colLineNum*(this._itemSize.height+this._lineGap),this._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:c-=(1-this._itemTmp.anchorY)*this._itemSize.height,c+=(1-this.content.anchorY)*this.content.height;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:c-=this._itemTmp.anchorY*this._itemSize.height,c+=this.content.anchorY*this.content.height,c*=-1}return{id:t,left:o,right:s,x:r,y:c}}}},e.prototype._calcExistItemPos=function(t){var e=this.getItemByListId(t);if(!e)return null;var i={id:t,x:e.x,y:e.y};return this._sizeType?(i.top=e.y+e.height*(1-e.anchorY),i.bottom=e.y-e.height*e.anchorY):(i.left=e.x-e.width*e.anchorX,i.right=e.x+e.width*(1-e.anchorX)),i},e.prototype.getItemPos=function(t){return this._virtual?this._calcItemPos(t):this.frameByFrameRenderNum?this._calcItemPos(t):this._calcExistItemPos(t)},e.prototype._getFixedSize=function(t){if(!this._customSize)return null;null==t&&(t=this._numItems);var e=0,i=0;for(var a in this._customSize)parseInt(a)<t&&(e+=this._customSize[a],i++);return{val:e,count:i}},e.prototype._onScrollBegan=function(){this._beganPos=this._sizeType?this.viewTop:this.viewLeft},e.prototype._onScrollEnded=function(){var t=this;if(t.curScrollIsTouch=!1,null!=t.scrollToListId){var e=t.getItemByListId(t.scrollToListId);t.scrollToListId=null,e&&cc.tween(e).to(.1,{scale:1.06}).to(.1,{scale:1}).start()}t._onScrolling(),t._slideMode!=r.ADHERING||t.adhering?t._slideMode==r.PAGE&&(null!=t._beganPos&&t.curScrollIsTouch?this._pageAdhere():t.adhere()):t.adhere()},e.prototype._onTouchStart=function(t,e){if(!this._scrollView.hasNestedViewGroup(t,e)&&(this.curScrollIsTouch=!0,t.eventPhase!==cc.Event.AT_TARGET||t.target!==this.node)){for(var i=t.target;null==i._listId&&i.parent;)i=i.parent;this._scrollItem=null!=i._listId?i:t.target}},e.prototype._onTouchUp=function(){var t=this;t._scrollPos=null,t._slideMode==r.ADHERING?(this.adhering&&(this._adheringBarrier=!0),t.adhere()):t._slideMode==r.PAGE&&(null!=t._beganPos?this._pageAdhere():t.adhere()),this._scrollItem=null},e.prototype._onTouchCancelled=function(t,e){var i=this;i._scrollView.hasNestedViewGroup(t,e)||t.simulate||(i._scrollPos=null,i._slideMode==r.ADHERING?(i.adhering&&(i._adheringBarrier=!0),i.adhere()):i._slideMode==r.PAGE&&(null!=i._beganPos?i._pageAdhere():i.adhere()),this._scrollItem=null)},e.prototype._onSizeChanged=function(){this.checkInited(!1)&&this._onScrolling()},e.prototype._onItemAdaptive=function(t){if(!this._sizeType&&t.width!=this._itemSize.width||this._sizeType&&t.height!=this._itemSize.height){this._customSize||(this._customSize={});var e=this._sizeType?t.height:t.width;this._customSize[t._listId]!=e&&(this._customSize[t._listId]=e,this._resizeContent(),this.updateAll(),null!=this._scrollToListId&&(this._scrollPos=null,this.unschedule(this._scrollToSo),this.scrollTo(this._scrollToListId,Math.max(0,this._scrollToEndTime-(new Date).getTime()/1e3))))}},e.prototype._pageAdhere=function(){var t=this;if(t.cyclic||!(t.elasticTop>0||t.elasticRight>0||t.elasticBottom>0||t.elasticLeft>0)){var e=t._sizeType?t.viewTop:t.viewLeft,i=(t._sizeType?t.node.height:t.node.width)*t.pageDistance;if(Math.abs(t._beganPos-e)>i)switch(t._alignCalcType){case 1:case 4:t._beganPos>e?t.prePage(.5):t.nextPage(.5);break;case 2:case 3:t._beganPos<e?t.prePage(.5):t.nextPage(.5)}else t.elasticTop<=0&&t.elasticRight<=0&&t.elasticBottom<=0&&t.elasticLeft<=0&&t.adhere();t._beganPos=null}},e.prototype.adhere=function(){var t=this;if(t.checkInited()&&!(t.elasticTop>0||t.elasticRight>0||t.elasticBottom>0||t.elasticLeft>0)){t.adhering=!0,t._calcNearestItem();var e=(t._sizeType?t._topGap:t._leftGap)/(t._sizeType?t.node.height:t.node.width);t.scrollTo(t.nearestListId,.7,e)}},e.prototype.update=function(){if(!(this.frameByFrameRenderNum<=0||this._updateDone))if(this._virtual){for(var t=this._updateCounter+this.frameByFrameRenderNum>this.displayItemNum?this.displayItemNum:this._updateCounter+this.frameByFrameRenderNum,e=this._updateCounter;e<t;e++){var i=this.displayData[e];i&&this._createOrUpdateItem(i)}this._updateCounter>=this.displayItemNum-1?this._doneAfterUpdate?(this._updateCounter=0,this._updateDone=!1,this._doneAfterUpdate=!1):(this._updateDone=!0,this._delRedundantItem(),this._forceUpdate=!1,this._calcNearestItem(),this.slideMode==r.PAGE&&(this.curPageNum=this.nearestListId)):this._updateCounter+=this.frameByFrameRenderNum}else if(this._updateCounter<this._numItems){for(t=this._updateCounter+this.frameByFrameRenderNum>this._numItems?this._numItems:this._updateCounter+this.frameByFrameRenderNum,e=this._updateCounter;e<t;e++)this._createOrUpdateItem2(e);this._updateCounter+=this.frameByFrameRenderNum}else this._updateDone=!0,this._calcNearestItem(),this.slideMode==r.PAGE&&(this.curPageNum=this.nearestListId)},e.prototype._createOrUpdateItem=function(t){var e=this.getItemByListId(t.id);if(e)this._forceUpdate&&this.renderEvent&&(e.setPosition(cc.v2(t.x,t.y)),this._resetItemSize(e),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],e,t.id%this._actualNumItems));else{var i=this._pool.size()>0;if(e=i?this._pool.get():cc.instantiate(this._itemTmp),i&&cc.isValid(e)||(e=cc.instantiate(this._itemTmp),i=!1),e._listId!=t.id&&(e._listId=t.id,e.setContentSize(this._itemSize)),e.setPosition(cc.v2(t.x,t.y)),this._resetItemSize(e),this.content.addChild(e),i&&this._needUpdateWidget){var a=e.getComponent(cc.Widget);a&&a.updateAlignment()}e.setSiblingIndex(this.content.childrenCount-1);var n=e.getComponent(m.default);e.listItem=n,n&&(n.listId=t.id,n.list=this,n._registerEvent()),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],e,t.id%this._actualNumItems)}this._resetItemSize(e),this._updateListItem(e.listItem),this._lastDisplayData.indexOf(t.id)<0&&this._lastDisplayData.push(t.id)},e.prototype._createOrUpdateItem2=function(t){var e,i=this.content.children[t];i?this._forceUpdate&&this.renderEvent&&(i._listId=t,e&&(e.listId=t),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],i,t%this._actualNumItems)):((i=cc.instantiate(this._itemTmp))._listId=t,this.content.addChild(i),e=i.getComponent(m.default),i.listItem=e,e&&(e.listId=t,e.list=this,e._registerEvent()),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],i,t%this._actualNumItems)),this._updateListItem(e),this._lastDisplayData.indexOf(t)<0&&this._lastDisplayData.push(t)},e.prototype._updateListItem=function(t){if(t&&this.selectedMode>c.NONE){var e=t.node;switch(this.selectedMode){case c.SINGLE:t.selected=this.selectedId==e._listId;break;case c.MULT:t.selected=this.multSelected.indexOf(e._listId)>=0}}},e.prototype._resetItemSize=function(){},e.prototype._updateItemPos=function(t){var e=isNaN(t)?t:this.getItemByListId(t),i=this.getItemPos(e._listId);e.setPosition(i.x,i.y)},e.prototype.setMultSelected=function(t,e){var i=this;if(i.checkInited()){if(Array.isArray(t)||(t=[t]),null==e)i.multSelected=t;else{var a=void 0,n=void 0;if(e)for(var o=t.length-1;o>=0;o--)a=t[o],(n=i.multSelected.indexOf(a))<0&&i.multSelected.push(a);else for(o=t.length-1;o>=0;o--)a=t[o],(n=i.multSelected.indexOf(a))>=0&&i.multSelected.splice(n,1)}i._forceUpdate=!0,i._onScrolling()}},e.prototype.getMultSelected=function(){return this.multSelected},e.prototype.hasMultSelected=function(t){return this.multSelected&&this.multSelected.indexOf(t)>=0},e.prototype.updateItem=function(t){if(this.checkInited()){Array.isArray(t)||(t=[t]);for(var e=0,i=t.length;e<i;e++){var a=t[e],n=this.getItemByListId(a);n&&cc.Component.EventHandler.emitEvents([this.renderEvent],n,a%this._actualNumItems)}}},e.prototype.updateAll=function(){this.checkInited()&&(this.numItems=this.numItems)},e.prototype.getItemByListId=function(t){if(this.content)for(var e=this.content.childrenCount-1;e>=0;e--){var i=this.content.children[e];if(i._listId==t)return i}},e.prototype._getOutsideItem=function(){for(var t,e=[],i=this.content.childrenCount-1;i>=0;i--)t=this.content.children[i],this.displayData.find(function(e){return e.id==t._listId})||e.push(t);return e},e.prototype._delRedundantItem=function(){if(this._virtual)for(var t=this._getOutsideItem(),e=t.length-1;e>=0;e--){var i=t[e];if(!this._scrollItem||i._listId!=this._scrollItem._listId){i.isCached=!0,this._pool.put(i);for(var a=this._lastDisplayData.length-1;a>=0;a--)if(this._lastDisplayData[a]==i._listId){this._lastDisplayData.splice(a,1);break}}}else for(;this.content.childrenCount>this._numItems;)this._delSingleItem(this.content.children[this.content.childrenCount-1])},e.prototype._delSingleItem=function(t){t.removeFromParent(),t.destroy&&t.destroy(),t=null},e.prototype.aniDelItem=function(t,e,i){var a=this;if(!a.checkInited()||a.cyclic||!a._virtual)return cc.error("This function is not allowed to be called!");if(!e)return cc.error("CallFunc are not allowed to be NULL, You need to delete the corresponding index in the data array in the CallFunc!");if(a._aniDelRuning)return cc.warn("Please wait for the current deletion to finish!");var n,o=a.getItemByListId(t);if(o){n=o.getComponent(m.default),a._aniDelRuning=!0,a._aniDelCB=e,a._aniDelItem=o,a._aniDelBeforePos=o.position,a._aniDelBeforeScale=o.scale;var s=a.displayData[a.displayData.length-1].id,r=n.selected;n.showAni(i,function(){var i,n,d;if(s<a._numItems-2&&(i=s+1),null!=i){var l=a._calcItemPos(i);a.displayData.push(l),a._virtual?a._createOrUpdateItem(l):a._createOrUpdateItem2(i)}else a._numItems--;if(a.selectedMode==c.SINGLE)r?a._selectedId=-1:a._selectedId-1>=0&&a._selectedId--;else if(a.selectedMode==c.MULT&&a.multSelected.length){var p=a.multSelected.indexOf(t);p>=0&&a.multSelected.splice(p,1);for(var u=a.multSelected.length-1;u>=0;u--)(g=a.multSelected[u])>=t&&a.multSelected[u]--}if(a._customSize){a._customSize[t]&&delete a._customSize[t];var f={},h=void 0;for(var g in a._customSize){h=a._customSize[g];var m=parseInt(g);f[m-(m>=t?1:0)]=h}a._customSize=f}for(u=null!=i?i:s;u>=t+1;u--)if(o=a.getItemByListId(u)){var v=a._calcItemPos(u-1);n=cc.tween(o).to(.2333,{position:cc.v2(v.x,v.y)}),u<=t+1&&(d=!0,n.call(function(){a._aniDelRuning=!1,e(t),delete a._aniDelCB})),n.start()}d||(a._aniDelRuning=!1,e(t),a._aniDelCB=null)},!0)}else e(t)},e.prototype.scrollTo=function(t,e,i,a){void 0===e&&(e=.5),void 0===i&&(i=null),void 0===a&&(a=!1);var n=this;if(n.checkInited(!1)){null==e?e=.5:e<0&&(e=0),t<0?t=0:t>=n._numItems&&(t=n._numItems-1),!n._virtual&&n._layout&&n._layout.enabled&&n._layout.updateLayout();var o,s,r=n.getItemPos(t);if(!r)return!1;switch(n._alignCalcType){case 1:o=r.left,o-=null!=i?n.node.width*i:n._leftGap,r=cc.v2(o,0);break;case 2:o=r.right-n.node.width,o+=null!=i?n.node.width*i:n._rightGap,r=cc.v2(o+n.content.width,0);break;case 3:s=r.top,s+=null!=i?n.node.height*i:n._topGap,r=cc.v2(0,-s);break;case 4:s=r.bottom+n.node.height,s-=null!=i?n.node.height*i:n._bottomGap,r=cc.v2(0,-s+n.content.height)}var c=n.content.getPosition();c=Math.abs(n._sizeType?c.y:c.x);var d=n._sizeType?r.y:r.x;Math.abs((null!=n._scrollPos?n._scrollPos:c)-d)>.5&&(n._scrollView.scrollToOffset(r,e),n._scrollToListId=t,n._scrollToEndTime=(new Date).getTime()/1e3+e,n._scrollToSo=n.scheduleOnce(function(){if(n._adheringBarrier||(n.adhering=n._adheringBarrier=!1),n._scrollPos=n._scrollToListId=n._scrollToEndTime=n._scrollToSo=null,a){var e=n.getItemByListId(t);e&&cc.tween(e).to(.1,{scale:1.05}).to(.1,{scale:1}).start()}},e+.1),e<=0&&n._onScrolling())}},e.prototype._calcNearestItem=function(){var t,e,i,a,n,o,s=this;s.nearestListId=null,s._virtual&&s._calcViewPos(),i=s.viewTop,a=s.viewRight,n=s.viewBottom,o=s.viewLeft;for(var r=!1,c=0;c<s.content.childrenCount&&!r;c+=s._colLineNum)if(t=s._virtual?s.displayData[c]:s._calcExistItemPos(c))switch(e=s._sizeType?(t.top+t.bottom)/2:e=(t.left+t.right)/2,s._alignCalcType){case 1:t.right>=o&&(s.nearestListId=t.id,o>e&&(s.nearestListId+=s._colLineNum),r=!0);break;case 2:t.left<=a&&(s.nearestListId=t.id,a<e&&(s.nearestListId+=s._colLineNum),r=!0);break;case 3:t.bottom<=i&&(s.nearestListId=t.id,i<e&&(s.nearestListId+=s._colLineNum),r=!0);break;case 4:t.top>=n&&(s.nearestListId=t.id,n>e&&(s.nearestListId+=s._colLineNum),r=!0)}if((t=s._virtual?s.displayData[s.displayItemNum-1]:s._calcExistItemPos(s._numItems-1))&&t.id==s._numItems-1)switch(e=s._sizeType?(t.top+t.bottom)/2:e=(t.left+t.right)/2,s._alignCalcType){case 1:a>e&&(s.nearestListId=t.id);break;case 2:o<e&&(s.nearestListId=t.id);break;case 3:n<e&&(s.nearestListId=t.id);break;case 4:i>e&&(s.nearestListId=t.id)}},e.prototype.prePage=function(t){void 0===t&&(t=.5),this.checkInited()&&this.skipPage(this.curPageNum-1,t)},e.prototype.nextPage=function(t){void 0===t&&(t=.5),this.checkInited()&&this.skipPage(this.curPageNum+1,t)},e.prototype.skipPage=function(t,e){var i=this;if(i.checkInited())return i._slideMode!=r.PAGE?cc.error("This function is not allowed to be called, Must SlideMode = PAGE!"):void(t<0||t>=i._numItems||i.curPageNum!=t&&(i.curPageNum=t,i.pageChangeEvent&&cc.Component.EventHandler.emitEvents([i.pageChangeEvent],t),i.scrollTo(t,e)))},e.prototype.calcCustomSize=function(t){var e=this;if(e.checkInited()){if(!e._itemTmp)return cc.error("Unset template item!");if(!e.renderEvent)return cc.error("Unset Render-Event!");e._customSize={};var i=cc.instantiate(e._itemTmp);e.content.addChild(i);for(var a=0;a<t;a++)cc.Component.EventHandler.emitEvents([e.renderEvent],i,a),i.height==e._itemSize.height&&i.width==e._itemSize.width||(e._customSize[a]=e._sizeType?i.height:i.width);return Object.keys(e._customSize).length||(e._customSize=null),i.removeFromParent(),i.destroy&&i.destroy(),e._customSize}},o([p({type:cc.Enum(s),tooltip:!1})],e.prototype,"templateType",void 0),o([p({type:cc.Node,tooltip:!1,visible:function(){return this.templateType==s.NODE}})],e.prototype,"tmpNode",void 0),o([p({type:cc.Prefab,tooltip:!1,visible:function(){return this.templateType==s.PREFAB}})],e.prototype,"tmpPrefab",void 0),o([p()],e.prototype,"_slideMode",void 0),o([p({type:cc.Enum(r),tooltip:!1})],e.prototype,"slideMode",null),o([p({type:cc.Float,range:[0,1,.1],tooltip:!1,slide:!0,visible:function(){return this._slideMode==r.PAGE}})],e.prototype,"pageDistance",void 0),o([p({type:cc.Component.EventHandler,tooltip:!1,visible:function(){return this._slideMode==r.PAGE}})],e.prototype,"pageChangeEvent",void 0),o([p()],e.prototype,"_virtual",void 0),o([p({type:cc.Boolean,tooltip:!1})],e.prototype,"virtual",null),o([p({tooltip:!1,visible:function(){var t=this.slideMode==r.NORMAL;return t||(this.cyclic=!1),t}})],e.prototype,"cyclic",void 0),o([p({tooltip:!1,visible:function(){return this.virtual}})],e.prototype,"lackCenter",void 0),o([p({tooltip:!1,visible:function(){var t=this.virtual&&!this.lackCenter;return t||(this.lackSlide=!1),t}})],e.prototype,"lackSlide",void 0),o([p({type:cc.Integer})],e.prototype,"_updateRate",void 0),o([p({type:cc.Integer,range:[0,6,1],tooltip:!1,slide:!0})],e.prototype,"updateRate",null),o([p({type:cc.Integer,range:[0,12,1],tooltip:!1,slide:!0})],e.prototype,"frameByFrameRenderNum",void 0),o([p({type:cc.Component.EventHandler,tooltip:!1})],e.prototype,"renderEvent",void 0),o([p({type:cc.Enum(c),tooltip:!1})],e.prototype,"selectedMode",void 0),o([p({tooltip:!1,visible:function(){return this.selectedMode==c.SINGLE}})],e.prototype,"repeatEventSingle",void 0),o([p({type:cc.Component.EventHandler,tooltip:!1,visible:function(){return this.selectedMode>c.NONE}})],e.prototype,"selectedEvent",void 0),o([p({serializable:!1})],e.prototype,"_numItems",void 0),o([l,u(),f("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/List"),g(cc.ScrollView),h(-5e3)],e)}(cc.Component);i.default=v,cc._RF.pop()},{"./ListItem":"ListItem"}],LockAreaItem:[function(t,e,i){"use strict";cc._RF.push(e,"bc620IYE7dPbJlIIqXNhCWr","LockAreaItem");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/MiscConfig"),r=t("../../scripts/data/MstData"),c=t("../../scripts/data/UserData"),d=t("../../scripts/manager/AudioManager"),l=t("../../scripts/manager/UIManager"),p=t("../../scripts/prefabs/Toast"),u=t("../../scripts/utils/EventName"),f=t("../../scripts/utils/GlobalFun"),h=t("../../scripts/utils/StatisticsManager"),g=t("../../scripts/extension/LanguageData"),m=cc._decorator,v=m.ccclass,_=m.property,y={1:"cloud7_3",2:"cloud3_2",3:"cloud4_2",4:"cloud7_2",5:"cloud3_2",6:"cloud3_2",7:"cloud1_2",8:"cloud4_4",9:"cloud4_2",10:"cloud4_3",11:"cloud3_3",12:"cloud3_3",13:"cloud3_3"},I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.animation=null,e.bg=null,e.limitNode=null,e.limitAreaNode=null,e.limitLv=null,e.limitAreaLv=null,e._areaId=0,e}return n(e,t),e.prototype.init=function(t,e){this._areaId=t,this.initUI(e)},e.prototype.onLoad=function(){cc.director.getScene().on(u.default.LEVELUP,this.updateUnLockArea,this)},e.prototype.initUI=function(t){var e=this;this.node.opacity=0;var i=r.default.getInstance().mstArea[this._areaId].unlockLevel||0;7==this._areaId?(this.limitLv.string="",this.limitAreaLv.string=g.default.t("bottomInfoPrefab_1",{lv:i})):(this.limitAreaLv.string="",this.limitLv.string=-1==i?g.default.t("lockAreaItem_1"):g.default.t("bottomInfoPrefab_1",{lv:i}));var a="textures/mapLock/"+y[this._areaId];f.default.loadSpriteFrame(this.bg,a,function(){e.node.setPosition(cc.v2(t.x-s.default.ITEM_SIZE_WIDTH/2,t.y+s.default.ITEM_SIZE_HEIGHT/2)),7==e._areaId?(e.limitNode.active=!1,e.limitAreaNode.active=!0,e.limitAreaNode.x=e.node.width/2,e.limitAreaNode.y=-e.node.height/2):(e.limitNode.active=!0,e.limitAreaNode.active=!1,e.limitNode.x=e.node.width/2,e.limitNode.y=-e.node.height/2+10),e.node.opacity=255}),this.updateUnLockArea()},e.prototype.onClickUnLockArea=function(){var t=this;h.default.trackEvent("merge_area_click",{areaId:this._areaId+""});var e=r.default.getInstance().mstArea[this._areaId];if(-1!=e.unlockLevel){var i=e.unlockLevel||0;if(c.default.getInstance().level>=i){h.default.trackEvent("merge_area_unlock",{areaId:String(this._areaId)});var a=c.default.getInstance().unLockArea(this._areaId+"");a&&(this.limitNode.active=!1,this.limitAreaNode.active=!1,d.default.getInstance().playEffect("unLockMergeArea"),cc.tween(this.node.children[0]).to(.2,{scale:0}).call(function(){t.node.destroy(),c.default.getInstance().updateTaskAndItem(),cc.director.getScene().emit(u.default.UPDATE_MERGEAREA,a),cc.director.getScene().emit(u.default.UNLOCKAREA,t._areaId)}).start())}else l.default.getInstance().openUI(p.default,{data:{str:g.default.t("bottomInfoPrefab_1",{lv:i})}})}else l.default.getInstance().openUI(p.default,{data:{str:g.default.t("lockAreaItem_1")}})},e.prototype.updateUnLockArea=function(){var t=r.default.getInstance().mstArea[this._areaId],e=-1==t.unlockLevel?1e4:t.unlockLevel;c.default.getInstance().level>=e?this.animation.play():this.animation.stop()},o([_(cc.Animation)],e.prototype,"animation",void 0),o([_(cc.Sprite)],e.prototype,"bg",void 0),o([_(cc.Node)],e.prototype,"limitNode",void 0),o([_(cc.Node)],e.prototype,"limitAreaNode",void 0),o([_(cc.Label)],e.prototype,"limitLv",void 0),o([_(cc.Label)],e.prototype,"limitAreaLv",void 0),o([v],e)}(cc.Component);i.default=I,cc._RF.pop()},{"../../scripts/data/MiscConfig":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AudioManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/Toast":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../../scripts/utils/StatisticsManager":void 0}],MailsAwardItem:[function(t,e,i){"use strict";cc._RF.push(e,"62082/kWXlCLZoU47rrHq5v","MailsAwardItem");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/MstData"),r=t("../../scripts/manager/UIManager"),c=t("../../scripts/utils/GlobalFun"),d=t("../prefabs/BuildInfoPopup"),l=t("../prefabs/CustomerInfoPopup"),p=t("../prefabs/ItemChain"),u=t("./BuildItem"),f=cc._decorator,h=f.ccclass,g=f.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.awardnum=null,e.awardCurIcon=null,e.gou=null,e._itemId=null,e._isCanTouch=!1,e._skinId=0,e}return n(e,t),e.prototype.initAwardInfo=function(t,e,i){var a=this;this._itemId=t,this.awardnum.string="x"+e,this.gou.active=!!i;var n=s.default.getInstance().mstItem[this._itemId];n.type.includes("Show")?(this._isCanTouch=!1,this.node.getComponent(cc.Button).interactable=!1):(this._isCanTouch=!0,this.node.getComponent(cc.Button).interactable=!0);var o=c.default.getItemIconPathById(t);if("activityShow"==n.type?(this.awardnum.string="x1",c.default.loadSpriteFrame(this.awardCurIcon,o+"_"+e)):c.default.loadSpriteFrame(this.awardCurIcon,o),this.awardCurIcon.node.destroyAllChildren(),"buildingSkinShow"==n.type){this._skinId=e,this._isCanTouch=!0,this.node.getComponent(cc.Button).interactable=!0,this.awardCurIcon.enabled=!1,this.awardnum.string="x1";var r=s.default.getInstance().mstBuildingSkin[e];r&&r.nodeName&&cc.resources.load("building/"+r.nodeName,cc.Prefab,function(t,e){if(!t&&cc.isValid(a.node)){var i=cc.instantiate(e);i.setPosition(cc.v2(0,0)),i.getComponent(u.default).initUnlockShow(150,150),a.awardCurIcon.node.addChild(i)}})}else if("roleSkinShow"==n.type){this._skinId=e,this._isCanTouch=!0,this.node.getComponent(cc.Button).interactable=!0,this.awardCurIcon.enabled=!1,this.awardnum.string="x1";var d=s.default.getInstance().mstRoleSkin[e];if(d&&d.icon){var l=new cc.Node;l.addComponent(cc.Sprite),l.scale=.7,this.awardCurIcon.node.addChild(l),c.default.loadSpriteFrame(l,"textures/role/icon/icon_"+d.icon)}}else this.awardCurIcon.enabled=!0},e.prototype.setReceive=function(){this.gou.active=!0},e.prototype.onItemClicked=function(){if(this._isCanTouch){var t=s.default.getInstance().mstItem[this._itemId];if("buildingSkinShow"==t.type)(e=s.default.getInstance().mstBuildingSkin[this._skinId])&&r.default.getInstance().openUI(d.default,{data:{buildId:e.buildingId}});else if("roleSkinShow"==t.type){var e;(e=s.default.getInstance().mstRoleSkin[this._skinId])&&r.default.getInstance().openUI(l.default,{data:{roleId:e.roleId}})}else r.default.getInstance().openUI(p.default,{data:this._itemId})}},o([g(cc.Label)],e.prototype,"awardnum",void 0),o([g(cc.Sprite)],e.prototype,"awardCurIcon",void 0),o([g(cc.Node)],e.prototype,"gou",void 0),o([h],e)}(cc.Component);i.default=m,cc._RF.pop()},{"../../scripts/data/MstData":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/utils/GlobalFun":void 0,"../prefabs/BuildInfoPopup":"BuildInfoPopup","../prefabs/CustomerInfoPopup":"CustomerInfoPopup","../prefabs/ItemChain":"ItemChain","./BuildItem":"BuildItem"}],MailsDetailsPopup:[function(t,e,i){"use strict";cc._RF.push(e,"e503dKUNbpKRrrFenAHj19o","MailsDetailsPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MstData"),c=t("../../scripts/data/UserData"),d=t("../../scripts/manager/AdManager"),l=t("../../scripts/manager/UIManager"),p=t("../../scripts/prefabs/Loading"),u=t("../../scripts/prefabs/Toast"),f=t("../../scripts/utils/Api"),h=t("../../scripts/utils/EventName"),g=t("../../scripts/utils/GlobalFun"),m=t("../entitys/MailsAwardItem"),v=t("./AwardPopup"),_=t("../../scripts/extension/LanguageData"),y=cc._decorator,I=y.ccclass,b=y.property,N=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mailName=null,e.timeLab=null,e.contentLab=null,e.awardNode=null,e.awardPrefab=null,e.btnGetAward=null,e.btnDeletMail=null,e.mailInfo=null,e.parent=null,e}return n(e,t),e.prototype.init=function(t){this.mailInfo=t.mailInfo,this.parent=t.parent,this.mailName.string=this.mailInfo.title,this.timeLab.string=this.mailInfo.date,this.contentLab.string=this.mailInfo.content;for(var e=JSON.parse(this.mailInfo.reward),i=0;i<this.awardNode.children.length;i++)this.awardNode.children[i].destroy();var a=!1;for(var n in e){var o=r.default.getInstance().mstItem[n];if(o){if("buildingSkinShow"==o.type){if(!r.default.getInstance().mstBuildingSkin[e[n]])continue}else if("activityShow"==o.type){var s=e[n];if(301!=s&&302!=s&&601!=s&&701!=s&&901!=s)continue}else if("roleSkinShow"==o.type&&!r.default.getInstance().mstRoleSkin[e[n]])continue;var c=cc.instantiate(this.awardPrefab);c.parent=this.awardNode,c.getComponent(m.default).initAwardInfo(n,e[n],this.mailInfo.isReceive),a=!0}}!a||this.mailInfo.isReceive?(a||(this.node.getChildByName("bg").getChildByName("fujian").active=!1),this.btnGetAward.active=!1,this.btnDeletMail.active=!0):(this.btnGetAward.active=!0,this.btnDeletMail.active=!1),g.default.isCanShowBanner()&&d.default.getInstance().showBanner()},e.prototype.resetAwardState=function(){this.btnGetAward.active=!1,this.btnDeletMail.active=!0;for(var t=0;t<this.awardNode.children.length;t++)this.awardNode.children[t].getComponent(m.default).setReceive()},e.prototype.onClickeGetAward=function(){var t=this;l.default.getInstance().openUI(p.default,{},function(){f.default.mail.send({type:"receive",para:JSON.stringify({mailId:t.mailInfo.mailId})},function(e){if(e.result){var i=[],a=JSON.parse(t.mailInfo.reward);for(var n in a)r.default.getInstance().mstItem[n]&&i.push({id:Number(n),num:Number(a[n])});l.default.getInstance().openUI(v.default,{data:i}),c.default.getInstance().addRewardByKV(a),t.resetAwardState(),t.parent.receiveMail(),c.default.getInstance().saveUserData(),cc.director.getScene().emit(h.default.UPDATE_ACTIVITY)}else l.default.getInstance().openUI(u.default,{data:{str:e.msg}});l.default.getInstance().closeUI(p.default)},function(){l.default.getInstance().closeUI(p.default)})})},e.prototype.onClickeDeleteMail=function(){var t=this;l.default.getInstance().openUI(p.default,{},function(){f.default.mail.send({type:"delete",para:JSON.stringify({mailId:t.mailInfo.mailId})},function(e){e.result?(cc.director.getScene().emit(h.default.UPDATE_ACTIVITY),t.parent.deleteMail(),t.onClose()):l.default.getInstance().openUI(u.default,{data:{str:e.msg}}),l.default.getInstance().closeUI(p.default)},function(){l.default.getInstance().closeUI(p.default),l.default.getInstance().openUI(u.default,{data:{str:_.default.t("mailsDetailsPopup_1")}})})})},e.prototype.onDestroy=function(){g.default.isCanShowBanner()&&d.default.getInstance().hideBanner()},e.uiName="MailsDetailsPopup",o([b(cc.Label)],e.prototype,"mailName",void 0),o([b(cc.Label)],e.prototype,"timeLab",void 0),o([b(cc.Label)],e.prototype,"contentLab",void 0),o([b(cc.Node)],e.prototype,"awardNode",void 0),o([b(cc.Prefab)],e.prototype,"awardPrefab",void 0),o([b(cc.Node)],e.prototype,"btnGetAward",void 0),o([b(cc.Node)],e.prototype,"btnDeletMail",void 0),o([I],e)}(s.default);i.default=N,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/Loading":void 0,"../../scripts/prefabs/Toast":void 0,"../../scripts/utils/Api":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../entitys/MailsAwardItem":"MailsAwardItem","./AwardPopup":"AwardPopup"}],MailsItem:[function(t,e,i){"use strict";cc._RF.push(e,"bebfaZjQbtMZabRfmGTycbi","MailsItem");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/MstData"),r=t("../../scripts/manager/UIManager"),c=t("../extension/ListItem"),d=t("../prefabs/MailsDetailsPopup"),l=t("./MailsAwardItem"),p=cc._decorator,u=p.ccclass,f=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mailName=null,e.timeLab=null,e.awardNode=null,e.openImg=null,e.closeImg=null,e.awardPrefab=null,e.mailInfo=null,e.parent=null,e}return n(e,t),e.prototype.init=function(t,e){this.mailInfo=t,this.parent=e,this.mailInfo.title.length>=7?this.mailName.string=this.mailInfo.title.substring(0,5)+"...":this.mailName.string=this.mailInfo.title,this.timeLab.string=this.mailInfo.date;for(var i=JSON.parse(this.mailInfo.reward),a=0;a<this.awardNode.children.length;a++)this.awardNode.children[a].destroy();for(var n in i){var o=s.default.getInstance().mstItem[n];if(o){if("buildingSkinShow"==o.type){if(!s.default.getInstance().mstBuildingSkin[i[n]])continue}else if("activityShow"==o.type){var r=i[n];if(301!=r&&302!=r&&601!=r&&701!=r&&901!=r)continue}var c=cc.instantiate(this.awardPrefab);c.parent=this.awardNode,c.getComponent(l.default).initAwardInfo(n,i[n],this.mailInfo.isReceive)}}this.mailInfo.isReceive?(this.openImg.active=!0,this.closeImg.active=!1):(this.openImg.active=!1,this.closeImg.active=!0)},e.prototype.onShowDial=function(){r.default.getInstance().openUI(d.default,{data:{mailInfo:this.mailInfo,parent:this}})},e.prototype.receiveMail=function(){this.parent.receiveMail(this.mailInfo.mailId)},e.prototype.deleteMail=function(){this.parent.deleteMail(this.mailInfo.mailId)},o([f(cc.Label)],e.prototype,"mailName",void 0),o([f(cc.Label)],e.prototype,"timeLab",void 0),o([f(cc.Node)],e.prototype,"awardNode",void 0),o([f(cc.Node)],e.prototype,"openImg",void 0),o([f(cc.Node)],e.prototype,"closeImg",void 0),o([f(cc.Prefab)],e.prototype,"awardPrefab",void 0),o([u],e)}(c.default);i.default=h,cc._RF.pop()},{"../../scripts/data/MstData":void 0,"../../scripts/manager/UIManager":void 0,"../extension/ListItem":"ListItem","../prefabs/MailsDetailsPopup":"MailsDetailsPopup","./MailsAwardItem":"MailsAwardItem"}],MailsPopup:[function(t,e,i){"use strict";cc._RF.push(e,"40cc89/23NBQ6IwcL7/fDQJ","MailsPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/UserData"),c=t("../../scripts/manager/AdManager"),d=t("../../scripts/utils/EventName"),l=t("../../scripts/utils/GlobalFun"),p=t("../entitys/MailsItem"),u=t("../extension/List"),f=cc._decorator,h=f.ccclass,g=f.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.listElement=null,e.noMailTip=null,e._atlasList=[],e}return n(e,t),e.prototype.init=function(){this._atlasList=[];var t=r.default.getInstance().mail;for(var e in t)t[e].mailId=e,this._atlasList.unshift(t[e]);l.default.isCanShowBanner()&&c.default.getInstance().showBanner()},e.prototype.itemElementRender=function(t,e){t.getComponent(p.default).init(this._atlasList[e],this)},e.prototype.receiveMail=function(t){for(var e=0;e<this._atlasList.length;e++)if(this._atlasList[e].mailId==t){this._atlasList[e].isReceive=!0;break}this.listElement.numItems=this._atlasList.length},e.prototype.deleteMail=function(t){for(var e=0;e<this._atlasList.length;e++)if(this._atlasList[e].mailId==t){this._atlasList.splice(e,1);break}this.listElement.numItems=this._atlasList.length},e.prototype.onLoad=function(){this._atlasList.length>0?(this.noMailTip.active=!1,this.listElement.numItems=this._atlasList.length):this.noMailTip.active=!0},e.prototype.onDisable=function(){cc.director.getScene().emit(d.default.OPEN_SCENE)},e.prototype.onDestroy=function(){l.default.isCanShowBanner()&&c.default.getInstance().hideBanner()},e.uiName="MailsPopup",o([g(u.default)],e.prototype,"listElement",void 0),o([g(cc.Node)],e.prototype,"noMailTip",void 0),o([h],e)}(s.default);i.default=m,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/UserData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../entitys/MailsItem":"MailsItem","../extension/List":"List"}],MainScene:[function(t,e,i){"use strict";cc._RF.push(e,"b8453qLhORGWojL9VIXnfNx","MainScene");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/MiscConfig"),r=t("../../scripts/data/MstData"),c=t("../../scripts/data/UserData"),d=t("../../scripts/manager/AdManager"),l=t("../../scripts/manager/AudioManager"),p=t("../../scripts/manager/SDKManager"),u=t("../../scripts/manager/UIManager"),f=t("../../scripts/prefabs/Loading"),h=t("../../scripts/prefabs/Toast"),g=t("../../scripts/utils/ActionFunc"),m=t("../../scripts/utils/ChannelHelper"),v=t("../../scripts/utils/EventName"),_=t("../../scripts/utils/GlobalFun"),y=t("../../scripts/utils/StatisticsManager"),I=t("../entitys/HemaPrefab"),b=t("../entitys/LimitActMergeUI"),N=t("../entitys/MergeUI"),C=t("../prefabs/DailyBenefitsPopup"),k=t("../prefabs/EnergyPopup"),S=t("../prefabs/LevelUpAwardPopup"),w=t("../prefabs/ShopPopup"),T=t("../../scripts/extension/LanguageData"),P=cc._decorator,D=P.ccclass,A=P.property,B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.experience=null,e.experienceValue=null,e.level=null,e.energy=null,e.infinite=null,e.physicalPowerValue=null,e.coins=null,e.goldValue=null,e.diamonds=null,e.diamondValue=null,e.recoverEnergy=null,e.hemaScenePre=null,e.mergeUINodeContent=null,e.limitActMergeUINodeContent=null,e.itemFlyContent=null,e.sceneUINodeContent=null,e._isExpAniFinished=!0,e._oldLevel=0,e._oldExp=0,e._oldEnergy=0,e._oldCoins=0,e._oldDiamonds=0,e._isSendMessage=!1,e.tipOnProduce=!1,e.tipHail=!1,e.tipCollect=!1,e.isMainScene=0,e}return n(e,t),e.prototype.onLoad=function(){if(y.default.trackEvent("common_mainScene"),cc.director.getScene().on(v.default.UPDATE_TOPINFO,this.updateTopInfo,this),cc.director.getScene().on(v.default.NO_ENERGY,this.noEnergy,this),cc.director.getScene().on(v.default.OPEN_SCENE,this.openScene,this),cc.director.getScene().on(v.default.LIMIT_ACT_CLOSE,this.closeLimitAct,this),cc.director.getScene().on(v.default.CLOSE_SCENE,this.onClickMerge,this),cc.director.getScene().on(v.default.OPEN_LIMIT_ACT_MERGE,this.onOpenLimitActScene,this),cc.director.getScene().on(v.default.UPDATE_BY_SECOND,this.updateBySecond,this),this.loadPrefab(),this.initAllUserInfo(),"wx"==m.default.getChannel()){var t=wx.getEnterOptionsSync();_.default.onClickShareLink(t)}p.default.getInstance().getUserInfo(function(t){""!=t.nickName&&""!=t.avatarUrl?_.default.saveUserInfo(t.nickName,t.avatarUrl,function(){c.default.getInstance().rankModel.saveAllScore()}):c.default.getInstance().rankModel.saveAllScore()})},e.prototype.loadPrefab=function(){var t=this;u.default.getInstance().openUI(f.default,{data:{showBlack:!0}},function(){var e=!1,i=!1,a=!1,n=(new Date).getTime()/1e3,o=function(){a&&e&&i&&(u.default.getInstance().closeUI(f.default),c.default.getInstance().guidance.isCanShowActicPopup()?_.default.onStartGamePopup():cc.director.getScene().emit(v.default.GUIDANCE_CONTINUE,c.default.getInstance().guidance.progress),y.default.trackEvent("common_mainScene_loadFinish",{time:Math.floor((new Date).getTime()/1e3-n)+""}))};cc.resources.load("entitys/ItemFly",cc.Prefab,function(e,i){if(!e){var n=cc.instantiate(i);t.itemFlyContent.addChild(n),a=!0,o()}});var s=cc.instantiate(t.hemaScenePre);s.getComponent(I.default).init(function(){e=!0,o()}),t.sceneUINodeContent.addChild(s),cc.resources.load("entitys/MergeUI",cc.Prefab,function(e,a){if(!e){var n=cc.instantiate(a);t.mergeUINodeContent.opacity=0,n.getComponent(N.default).init(function(){i=!0,o()}),t.mergeUINodeContent.addChild(n)}})})},e.prototype.initAllUserInfo=function(){var t=r.default.getInstance().mstLevelup;this._oldLevel=4*c.default.getInstance().level,this._oldExp=4*c.default.getInstance().exp,this.level.string=""+this._oldLevel/4,this._oldLevel/4>=s.default.MAX_LEVEL?(this.experience.progress=0,this.experienceValue.string=T.default.t("max")):(this.experience.progress=this._oldExp/4/t[this._oldLevel/4].exp,this.experienceValue.string=(this._oldExp/4).toString()+"/"+t[this._oldLevel/4].exp.toString()),this.infinite.node.active=!1,this._oldEnergy=4*c.default.getInstance().energy,this.physicalPowerValue.string=""+this._oldEnergy/4,this._oldCoins=4*c.default.getInstance().coins,this.goldValue.string=""+this._oldCoins/4,this._oldDiamonds=4*c.default.getInstance().diamonds,this.diamondValue.string=""+this._oldDiamonds/4},e.prototype.start=function(){l.default.getInstance().playBgm("bgm");var t=cc.sys.localStorage.getItem("cheatReason");t&&t.length>0&&c.default.getInstance().cheatApi(t)},e.prototype.updateBySecond=function(){if(c.default.getInstance().isUnlimitedEnergy){this._isSendMessage=!0,this.infinite.node.active=!0;var t=c.default.getInstance().unlimitedEnergyEndTime;if(t>0)if((o=t-window.serverTime)>0){var e=_.default.formatDateTimeHourEx(o);this.recoverEnergy.string=e}else this.recoverEnergy.string=""}else{var i=c.default.getInstance().energy,a=c.default.getInstance().maxEnergy;if(1==this._isSendMessage&&(this._isSendMessage=!1,cc.director.getScene().emit(v.default.UNLIMIT_ENERGY)),this.infinite.node.active=!1,i<a){var n=c.default.getInstance().nextEnergyRecoverTime;if(n>0){var o=_.default.formatDateTimeHourEx(n);this.recoverEnergy.string=o}else if(n<=0){this.recoverEnergy.string="",c.default.getInstance().changeEnergy(1,!0);var s=c.default.getInstance().energy;this._oldEnergy=4*s,this.physicalPowerValue.string=""+s,cc.director.getScene().emit(v.default.UPDATE_TOPINFO)}}else this.recoverEnergy.string=""}c.default.getInstance().isNewDay()},e.prototype.onClickExp=function(){u.default.getInstance().openUI(S.default)},e.prototype.onClickEnergy=function(){y.default.trackEvent("topInfo_energy_click"),u.default.getInstance().openUI(k.default)},e.prototype.onClickCoins=function(){},e.prototype.onClickDiamonds=function(){y.default.trackEvent("topInfo_diamonds_click");var t=r.default.getInstance().mstStore.dailyGift.openLevel;c.default.getInstance().level>=t?u.default.getInstance().openUI(w.default,{data:{key:"resource",type:1}}):u.default.getInstance().openUI(h.default,{data:{str:T.default.t("mainScene_1",{shopOpenLevel:t})}})},e.prototype.onOpenLimitActScene=function(){var t=this;255==this.sceneUINodeContent.opacity&&(this.sceneUINodeContent.getComponent(cc.Widget).enabled=!1,this.sceneUINodeContent.x=9999,this.sceneUINodeContent.opacity=0,this.mergeUINodeContent.x=9999,this.mergeUINodeContent.opacity=0,this.limitActMergeUINodeContent.x=0,this.limitActMergeUINodeContent.opacity=255,this.isMainScene=2,0==this.limitActMergeUINodeContent.childrenCount&&u.default.getInstance().openUI(f.default,{data:{showBlack:!1}},function(){cc.resources.load("entitys/LimitActMergeUI",cc.Prefab,function(e,i){if(!e){var a=cc.instantiate(i);a.getComponent(b.default).init(function(){cc.director.getScene().emit(v.default.LIMIT_ACT_GUIDE),u.default.getInstance().closeUI(f.default)}),t.limitActMergeUINodeContent.addChild(a)}})}))},e.prototype.onClickMerge=function(){var t=this;if(255==this.sceneUINodeContent.opacity){if(this.sceneUINodeContent.getComponent(cc.Widget).enabled=!1,this.sceneUINodeContent.x=9999,this.sceneUINodeContent.opacity=0,this.limitActMergeUINodeContent.x=9999,this.limitActMergeUINodeContent.opacity=0,this.mergeUINodeContent.opacity=255,this.mergeUINodeContent.x=0,this.isMainScene=1,cc.macro.ENABLE_MULTI_TOUCH=!1,c.default.getInstance().guidance.isCanShowActicPopup()){var e=r.default.getInstance().mstStore.dailyGift.openLevel;if(c.default.getInstance().level>=e){var i=c.default.getInstance().storeData.dailyGift[1].times;r.default.getInstance().mstStore.dailyGift.config[1].limitNum-i>0?u.default.getInstance().openUI(C.default,{},null,function(){t.onStartActivityGuide()}):this.onStartActivityGuide()}}d.default.getInstance().showInterstitial()}},e.prototype.onStartActivityGuide=function(){c.default.getInstance().activityData.isActivityGuideOpen()&&(cc.director.getScene().emit(v.default.RESET_ACTIVITY),cc.director.getScene().emit(v.default.LEVEL_UP_GUIDE))},e.prototype.openScene=function(){0==this.sceneUINodeContent.opacity&&(this.sceneUINodeContent.x=0,this.sceneUINodeContent.opacity=255,this.isMainScene=0,this.mergeUINodeContent.opacity=0,this.mergeUINodeContent.x=0,this.limitActMergeUINodeContent.opacity=0,this.limitActMergeUINodeContent.x=9999,cc.macro.ENABLE_MULTI_TOUCH=!0),d.default.getInstance().showInterstitial()},e.prototype.closeLimitAct=function(){2==this.isMainScene&&this.openScene(),this.limitActMergeUINodeContent.children[0]&&this.limitActMergeUINodeContent.children[0].destroy()},e.prototype.updateTopInfo=function(t){void 0===t&&(t="all"),"all"==t?(this.expAnimation(),this.onEnergyAnimation(),this.onCoinAnimation(),this.onDiamondsAnimation()):"exp"==t?this.expAnimation():"energy"==t?this.onEnergyAnimation():"coin"==t?this.onCoinAnimation():"diamond"==t&&this.onDiamondsAnimation()},e.prototype.expAnimation=function(t){var e=this;void 0===t&&(t=null);var i=c.default.getInstance().exp,a=c.default.getInstance().level;if(a!=this._oldLevel/4||i!=this._oldExp/4)if(this._isExpAniFinished)this._isExpAniFinished=!1,g.default.updateExpAnimation(this.experience.node,i,this._oldExp/4,a,this._oldLevel/4,function(){e._oldLevel=4*a,e._oldExp=4*i,e._isExpAniFinished=!0,a>=s.default.MAX_LEVEL&&(e.experience.progress=0,e.experienceValue.string=T.default.t("max")),"function"==typeof t&&t()});else{cc.tween(this.experience.node).stop(),this._oldLevel=4*parseInt(this.level.string);var n=this.experienceValue.string,o=n.indexOf("/");this._oldExp=4*parseInt(n.slice(0,o)),g.default.updateExpAnimation(this.experience.node,i,this._oldExp/4,a,this._oldLevel/4,function(){e._oldLevel=4*a,e._oldExp=4*i,e._isExpAniFinished=!0,a>=s.default.MAX_LEVEL&&(e.experience.progress=0,e.experienceValue.string=T.default.t("max")),"function"==typeof t&&t()})}},e.prototype.onEnergyAnimation=function(t){var e=this;if(void 0===t&&(t=null),c.default.getInstance().isUnlimitedEnergy)g.default.onceZoomAnimation(this.energy);else{var i=c.default.getInstance().energy;i!=this._oldEnergy/4&&g.default.updateNumberAnimation(this.energy,this.physicalPowerValue,i,this._oldEnergy/4,function(){e._oldEnergy=4*i,t&&t()})}},e.prototype.onCoinAnimation=function(t){var e=this;void 0===t&&(t=null);var i=c.default.getInstance().coins;i!=this._oldCoins/4&&g.default.updateNumberAnimation(this.coins,this.goldValue,i,this._oldCoins/4,function(){e._oldCoins=4*i,t&&t()})},e.prototype.onDiamondsAnimation=function(t){var e=this;void 0===t&&(t=null);var i=c.default.getInstance().diamonds;i!=this._oldDiamonds/4&&g.default.updateNumberAnimation(this.diamonds,this.diamondValue,i,this._oldDiamonds/4,function(){e._oldDiamonds=4*i,t&&t()})},e.prototype.noEnergy=function(){_.default.noEnergyCommonPopup()},o([A(cc.ProgressBar)],e.prototype,"experience",void 0),o([A(cc.Label)],e.prototype,"experienceValue",void 0),o([A(cc.Label)],e.prototype,"level",void 0),o([A(cc.Node)],e.prototype,"energy",void 0),o([A(cc.Sprite)],e.prototype,"infinite",void 0),o([A(cc.Label)],e.prototype,"physicalPowerValue",void 0),o([A(cc.Node)],e.prototype,"coins",void 0),o([A(cc.Label)],e.prototype,"goldValue",void 0),o([A(cc.Node)],e.prototype,"diamonds",void 0),o([A(cc.Label)],e.prototype,"diamondValue",void 0),o([A(cc.Label)],e.prototype,"recoverEnergy",void 0),o([A(cc.Prefab)],e.prototype,"hemaScenePre",void 0),o([A(cc.Node)],e.prototype,"mergeUINodeContent",void 0),o([A(cc.Node)],e.prototype,"limitActMergeUINodeContent",void 0),o([A(cc.Node)],e.prototype,"itemFlyContent",void 0),o([A(cc.Node)],e.prototype,"sceneUINodeContent",void 0),o([D],e)}(cc.Component);i.default=B,cc._RF.pop()},{"../../scripts/data/MiscConfig":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/AudioManager":void 0,"../../scripts/manager/SDKManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/Loading":void 0,"../../scripts/prefabs/Toast":void 0,"../../scripts/utils/ActionFunc":void 0,"../../scripts/utils/ChannelHelper":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../../scripts/utils/StatisticsManager":void 0,"../entitys/HemaPrefab":"HemaPrefab","../entitys/LimitActMergeUI":"LimitActMergeUI","../entitys/MergeUI":"MergeUI","../prefabs/DailyBenefitsPopup":"DailyBenefitsPopup","../prefabs/EnergyPopup":"EnergyPopup","../prefabs/LevelUpAwardPopup":"LevelUpAwardPopup","../prefabs/ShopPopup":"ShopPopup"}],MergeManager:[function(t,e,i){"use strict";cc._RF.push(e,"51beb6wLcpEt5gaf6FzsiHV","MergeManager");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("./ItemPrefab"),r=t("../prefabs/Levelup"),c=t("./CellItem"),d=t("../prefabs/LockAreaItem"),l=t("./ItemTempPrefab"),p=t("../prefabs/UnlockShowPopup"),u=t("./ItemBgPrefab"),f=t("./ItemImgPrefab"),h=t("../../scripts/utils/EventName"),g=t("../../scripts/data/MstData"),m=t("../../scripts/data/UserData"),v=t("../../scripts/data/MiscConfig"),_=t("../../scripts/prefabs/Loading"),y=t("../../scripts/manager/UIManager"),I=t("../../scripts/utils/GlobalFun"),b=t("../../scripts/manager/AudioManager"),N=t("../../scripts/prefabs/Toast"),C=t("../../scripts/prefabs/CommonPopup"),k=t("../../scripts/extension/LanguageData"),S=cc._decorator,w=S.ccclass,T=S.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tempContent=null,e.areaNode=[],e.touchNode=null,e.teleportOne=null,e.teleportTwo=null,e.tolerateDis=50,e.mapIndex=1,e.guideBagPutCallback=null,e.itemTempPrefab=null,e.isLoadAreaOneFinish=!1,e.isLoadAreaTwoFinish=!1,e.touchIndex=-1,e.tempItem=null,e.tipList=[],e._guideIndex1=null,e._guideIndex2=null,e._guideCallback=null,e._lastSeletIdx=-1,e._bottomInfoPrefab=null,e.itemIconPrefabList={},e.itemBgPrefabList={},e.itemPrefabList={},e._loadCompleteCallback=null,e}return n(e,t),e.prototype.onLoad=function(){var t=this;cc.director.getScene().on(h.default.UPDATE_MERGEAREA,this.updateMergeArea,this),cc.director.getScene().on(h.default.RECEIVE_AWARD,this.awardItem,this),cc.director.getScene().on(h.default.TASK_COMPLETE,this.taskComplete,this),cc.director.getScene().on(h.default.LEVELUP,function(){t.readyToTip(!1)},this),cc.director.getScene().on(h.default.UPDATE_TOPINFO,function(){t.readyToTip(!1)},this),cc.director.getScene().on(h.default.CLOSE_SCENE,this.updateMergeArea,this),cc.director.getScene().on(h.default.UNLOCKAREA,this.unlockMergeArea,this),cc.resources.load("entitys/ItemTempPrefab",cc.Prefab,function(e,i){e||(t.itemTempPrefab=i,t.tempItem=cc.instantiate(t.itemTempPrefab).getComponent(l.default),t.tempItem.node.parent=t.tempContent,t.tempItem.node.active=!1,t._lastSeletIdx=-1)})},e.prototype.setFinishCallBack=function(t){void 0===t&&(t=null),this._loadCompleteCallback=t},e.prototype.loadLockArea=function(t,e){var i=this;void 0===e&&(e=null),e&&e();var a=this.areaNode[t].getChildByName("lockAreaContent"),n=g.default.getInstance().mstArea,o=1,s=7;1==t&&(o=8,s=13);var r=function(c){if(c>s)i.loadItems(t,e);else{var l=n[c];if(m.default.getInstance().unlockMergeAreaIds.includes(c))i.unlockMergeArea(c),r(++o);else{var p=l.startPos,u=l.areaSize,f=p[0]-7*t+7*p[1],h=i.getPositionByIndex(f,0);cc.resources.load("entitys/LockAreaItem",cc.Prefab,function(t,e){if(!t){var i=cc.instantiate(e);i.parent=a,i.width=u[0]*v.default.ITEM_SIZE_WIDTH,i.height=u[1]*v.default.ITEM_SIZE_HEIGHT,i.getComponent(d.default).init(c,h),setTimeout(function(){r(++o)})}})}}};r(o)},e.prototype.loadItems=function(t,e){var i=this;void 0===e&&(e=null);var a=this.areaNode[t].getChildByName("cellsContent"),n=this.areaNode[t].getChildByName("itemsContent"),o=n.getChildByName("itemsImgContent"),r=n.getChildByName("itemsBgContent"),d=n.getChildByName("itemsStateContent"),l=v.default.GAME_WIDTH*v.default.GAME_HEIGHT,p=v.default.ITEM_SIZE_WIDTH,h=v.default.ITEM_SIZE_HEIGHT,g=0,m=function(e){if(e>=l)0==t?(i.readyToTip(),i.addTouchEvent(),i.isLoadAreaOneFinish=!0,"function"==typeof i._loadCompleteCallback&&i._loadCompleteCallback(),i.loadLockArea(1)):1==t&&(i.isLoadAreaTwoFinish=!0,y.default.getInstance().getUI(_.default)&&y.default.getInstance().closeUI(_.default));else{var n=!1,v=!1,I=!1,b=!1,N=function(){n&&v&&I&&b&&setTimeout(function(){m(++g)})},C=Math.floor(e/7),k=e%7*p+p/2,S=-C*h-h/2;cc.resources.load("entitys/CellItem",cc.Prefab,function(t,i){if(!t){var o=cc.instantiate(i);o.parent=a,o.setPosition(cc.v2(k,S)),o.width=p,o.height=h,o.getComponent(c.default).init(e),n=!0,N()}}),cc.resources.load("entitys/ItemBgPrefab",cc.Prefab,function(a,n){if(!a){var o=cc.instantiate(n);o.parent=r,o.setPosition(cc.v2(k,S)),o.width=p,o.height=h;var s=o.getComponent(u.default);s.init(e+63*t),i.itemBgPrefabList[e+63*t]=s,I=!0,N()}}),cc.resources.load("entitys/ItemImgPrefab",cc.Prefab,function(a,n){if(!a){var s=cc.instantiate(n);s.parent=o,s.setPosition(cc.v2(k,S)),s.width=p,s.height=h;var r=s.getComponent(f.default);r.init(e+63*t),i.itemIconPrefabList[e+63*t]=r,b=!0,N()}}),cc.resources.load("entitys/ItemPrefab",cc.Prefab,function(a,n){if(!a){var o=cc.instantiate(n);o.parent=d,o.setPosition(cc.v2(k,S)),o.width=p,o.height=h;var r=o.getComponent(s.default);r.init(e+63*t,i),i.itemPrefabList[e+63*t]=r,v=!0,N()}})}};m(g)},e.prototype.addTouchEvent=function(){var t=this;this.touchNode.on(cc.Node.EventType.TOUCH_START,function(e){t.stopToTip(),t.touchStart(e)},this),this.touchNode.on(cc.Node.EventType.TOUCH_MOVE,function(e){t.touchMove(e)},this),this.touchNode.on(cc.Node.EventType.TOUCH_CANCEL,function(){t.readyToTip(),t.touchCancel()},this),this.touchNode.on(cc.Node.EventType.TOUCH_END,function(e){t.readyToTip(),t.touchEnd(e)},this)},e.prototype.touchStart=function(t){var e=t.getLocation(),i=this.touchNode.convertToNodeSpaceAR(e),a=this.getIndexByLocation(i);if(this.touchIndex=a+63*m.default.getInstance().mergeArea,this.isCanMoveByIndex(this.touchIndex)){cc.director.getScene().emit(h.default.UPDATE_ITEM_INFO,this.touchIndex),this.tempItem.node.active=!0,this.tempItem.showCanMergeAnim(!1),this.itemPrefabList[this.touchIndex].node.active=!1,this.itemBgPrefabList[this.touchIndex].node.active=!1,this.itemIconPrefabList[this.touchIndex].node.active=!1,this.tempItem.init(this.touchIndex),this.tempItem.node.position=this.itemPrefabList[this.touchIndex].node.position;var n=m.default.getInstance().itemData[this.touchIndex].mstData.propAttribute;"spawnerBoost"==n[0]&&n[1]>0?cc.director.getScene().emit(h.default.USE_PROP,this.touchIndex):"timeSkip"==n[0]&&n[1]>0?cc.director.getScene().emit(h.default.USE_PROP,this.touchIndex):"duplicator"==n[0]&&n[1]>0?cc.director.getScene().emit(h.default.USE_PROP,this.touchIndex):"scissors"==n[0]&&n[1]>0&&cc.director.getScene().emit(h.default.USE_PROP,this.touchIndex)}},e.prototype.checkTolerateDis=function(t){var e=this.getPositionByIndex(this.touchIndex);I.default.getDisByPos(e,t)>=this.tolerateDis&&(this.tempItem&&this.tempItem.node&&!this.tempItem.node.active&&(this.tempItem.node.active=!0,this.itemPrefabList[this.touchIndex].node.active=!1,this.itemBgPrefabList[this.touchIndex].node.active=!1,this.itemIconPrefabList[this.touchIndex].node.active=!1),this.setIsChoose(this.touchIndex,!1))},e.prototype.touchMove=function(t){if(cc.isValid(this.tempItem)&&this.tempItem.node.active){this.tempItem.node.x+=t.getDelta().x,this.tempItem.node.y+=t.getDelta().y;var e=t.getLocation(),i=this.touchNode.convertToNodeSpaceAR(e),a=this.getIndexByLocation(i);a+=63*m.default.getInstance().mergeArea,this.checkTolerateDis(i),this.touchIndex!=a&&m.default.getInstance().isMergeable(this.touchIndex,a)?this.tempItem.showCanMergeAnim(!0):this.tempItem.showCanMergeAnim(!1),this.checkNearBag()}},e.prototype.touchEnd=function(t){var e=t.getLocation(),i=this.touchNode.convertToNodeSpaceAR(e),a=this.getIndexByLocation(i);if(a+=63*m.default.getInstance().mergeArea,cc.director.getScene().emit(h.default.USE_PROP,-1),!this._guideIndex1&&!this._guideIndex2||this.touchIndex==this._guideIndex1&&a==this._guideIndex2){if(a==this.touchIndex)return this.simulateClickItem(a),this.reBackPos();var n=m.default.getInstance().merge(this.touchIndex,a),o=m.default.getInstance().itemData[a];"change"==n.result&&o.state==v.default.ITEM_STATE_lOCK?(this.reBackPos(),this.itemClick(this.touchIndex)):("noCells"!=n.result&&o.state==v.default.ITEM_STATE_TELEPORT&&this.showTeleportAni(n.cells[1]),this.reBackPos(),this.dealMergeResult(n,a),this._guideCallback&&this._guideCallback(),this._guideIndex1=null,this._guideIndex2=null,this._guideCallback=null)}else this.reBackPos()},e.prototype.touchCancel=function(){return cc.director.getScene().emit(h.default.USE_PROP,-1),this.setIsChoose(this.touchIndex,!1),this.itemClick(this.touchIndex),this.checkPutBag(),this.reBackPos()},e.prototype.getPositionByIndex=function(t,e){void 0===e&&(e=m.default.getInstance().mergeArea);var i=v.default.ITEM_SIZE_WIDTH,a=v.default.ITEM_SIZE_HEIGHT,n=t-63*e,o=n%7*i+i/2,s=-Math.floor(n/7)*a-a/2;return cc.v3(o,s)},e.prototype.getDistanceByTwnPoint=function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},e.prototype.awardItem=function(t){if(t.cells&&!(t.cells.length<1)&&1!=t.isAct){var e=t.cells[0],i=cc.instantiate(this.itemTempPrefab);i.getComponent("ItemTempPrefab").init(e),i.parent=this.tempContent;var a=t.originNode,n=a.parent.convertToWorldSpaceAR(a.position),o=this.tempContent.convertToNodeSpaceAR(n);i.setPosition(o),i.active=!0;var s=this.getPositionByIndex(e),r=this.getDistanceByTwnPoint(o,s)/2e3;this.itemClick(-1),cc.tween(i).to(r,{position:s}).call(function(){m.default.getInstance().updateTaskAndItem(),cc.director.getScene().emit(h.default.UPDATE_MERGEAREA,t.cells),i.destroy()}).start()}},e.prototype.collectItem=function(t,e){var i=this.itemPrefabList[t].node,a=i,n=g.default.getInstance().mstItem[e].itemCount,o=g.default.getInstance().mstItem,s=0,r={};o&&"exp"==o[e].type?s=30091:o&&"energy"==o[e].type?s=30092:o&&"coin"==o[e].type?s=30093:o&&"diamond"==o[e].type?s=30094:o&&"unlimitedEnergy"==o[e].type?(s=e,r.endNode=cc.find("Canvas/mainUI/topInfo/energy/icon")):s=30092,r.id=s,r.startNode=a,r.num=n,r.callback=function(){o&&"unlimitedEnergy"==o[e].type&&cc.director.getScene().emit(h.default.UNLIMIT_ENERGY)},i.getComponent("ItemPrefab").init(t),cc.director.getScene().emit(h.default.ITEM_FLY,r)},e.prototype.unlockMergeArea=function(t){7==t?this.teleportOne.active=!0:8==t&&(this.teleportTwo.active=!0)},e.prototype.updateMergeArea=function(t){for(var e in void 0===t&&(t=[]),t){var i=t[e];this.itemPrefabList[i]&&this.itemPrefabList[i].init(i),this.itemBgPrefabList[i]&&this.itemBgPrefabList[i].init(i),this.itemIconPrefabList[i]&&this.itemIconPrefabList[i].init(i)}this.stopToTip(),this.readyToTip()},e.prototype.simulateSingleClick=function(t,e){void 0===e&&(e=-1),this.touchIndex=t,this.itemClick(t),this.simulateClickItem(t,e)},e.prototype.simulateClickItem=function(t,e){if(void 0===e&&(e=-1),!(this.touchIndex<=-1)){if(this.itemPrefabList[this.touchIndex].choose.active){var i=this.itemPrefabList[this.touchIndex],a=m.default.getInstance().itemData[this.touchIndex].id,n=g.default.getInstance().mstItem[a];if(n&&n.autoSpawner&&m.default.getInstance().itemData[this.touchIndex].state==v.default.ITEM_STATE_NORMAL&&!m.default.getInstance().itemData[this.touchIndex].isCool)return;if(i.itemData.mstData&&i.itemData.mstData.isSpawner&&m.default.getInstance().itemData[this.touchIndex].isCool)return void this.tipRefreshCD(this.touchIndex);if(m.default.getInstance().itemData[this.touchIndex].state==v.default.ITEM_STATE_BUBBLE)return void this.tipRefreshBubble(this.touchIndex);if(i.itemData.mstData&&i.itemData.mstData.isBox&&!m.default.getInstance().itemData[this.touchIndex].isOpened&&m.default.getInstance().itemData[this.touchIndex].coolingTime&&m.default.getInstance().itemData[this.touchIndex].lastCoolingTime)return void this.tipRefreshBox(this.touchIndex);var o=m.default.getInstance().level,s=m.default.getInstance().clickItem(this.touchIndex,e);m.default.getInstance().level>o&&y.default.getInstance().openUI(r.default,{data:{historyLevel:o}}),this.dealMergeResult(s,this.touchIndex)}this.itemClick(this.touchIndex)}},e.prototype.dealMergeResult=function(t,e){var i=this;if(t){if(m.default.getInstance().updateTaskAndItem(),cc.director.getScene().emit(h.default.UPDATE_MERGEAREA,t.cells),"spawn"==t.result)this.itemIconPrefabList[e].showOutPutAnim(!0),b.default.getInstance().playEffect("output"),cc.director.getScene().emit(h.default.UPDATE_TOPINFO);else if("merge"==t.result){var a=e,n=m.default.getInstance().itemData[a].id,o=g.default.getInstance().mstItem[n].level-1;o=(o=o<1?1:o)>7?7:o,b.default.getInstance().playEffect("merge"+o);var s=t.cells[1];this.itemBgPrefabList[s].showNewAnim(!0)}else"collect"==t.result?this.collectItem(t.cells[0],t.collectId):"noCells"==t.result?y.default.getInstance().openUI(N.default,{data:{str:k.default.t("bagItem_1")}}):"maxOpening"==t.result&&y.default.getInstance().openUI(N.default,{data:{str:k.default.t("mergeManager_1")}});if(t.move){var r=function(a){c.itemPrefabList[t.move[a]].node.active=!1,c.itemBgPrefabList[t.move[a]].node.active=!1,c.itemIconPrefabList[t.move[a]].node.active=!1,c.moveCreateItem(e,t.move[a],function(){i.itemPrefabList[t.move[a]].node.active=!0,i.itemBgPrefabList[t.move[a]].node.active=!0,i.itemIconPrefabList[t.move[a]].node.active=!0,i.updateMergeArea([t.move[a]])})},c=this;for(var d in t.move)r(d)}if(t.unlockItemIndex)for(var d in t.unlockItemIndex)this.lockAreaItemAnim(t.unlockItemIndex[d]);m.default.getInstance().itemData[e].state!=v.default.ITEM_STATE_TELEPORT&&this.itemClick(e),t.newCustomerId>0&&y.default.getInstance().openNotice(p.default,{data:{ntype:"customer",id:t.newCustomerId}}),t.newItemId>=0&&g.default.getInstance().mstItem[t.newItemId].isUnlockShow&&y.default.getInstance().openNotice(p.default,{data:{ntype:"item",id:t.newItemId}})}},e.prototype.dealAutoMergeResult=function(t,e){var i=this;if(t){if(t.cells.length>0&&(m.default.getInstance().updateTaskAndItem(),cc.director.getScene().emit(h.default.UPDATE_MERGEAREA,t.cells)),t.unlockItemIndex)for(var a in t.unlockItemIndex)this.lockAreaItemAnim(t.unlockItemIndex[a]);if(t.move){var n=function(a){b.default.getInstance().playEffect("output"),o.itemPrefabList[t.move[a]].node.active=!1,o.itemBgPrefabList[t.move[a]].node.active=!1,o.itemIconPrefabList[t.move[a]].node.active=!1,o.moveCreateItem(e,t.move[a],function(){i.itemPrefabList[t.move[a]].node.active=!0,i.itemBgPrefabList[t.move[a]].node.active=!0,i.itemIconPrefabList[t.move[a]].node.active=!0,i.updateMergeArea([t.move[a]])})},o=this;for(var a in t.move)n(a)}t.newCustomerId>0&&y.default.getInstance().openNotice(p.default,{data:{ntype:"customer",id:t.newCustomerId}}),t.newItemId>=0&&g.default.getInstance().mstItem[t.newItemId].isUnlockShow&&y.default.getInstance().openNotice(p.default,{data:{ntype:"item",id:t.newItemId}})}},e.prototype.itemClick=function(t){this._lastSeletIdx>=0&&this.itemPrefabList[this._lastSeletIdx].onClick(t),t>=0&&(this.itemPrefabList[t].onClick(t),this.itemIconPrefabList[t].onClick(t)),this._lastSeletIdx=t},e.prototype.setIsChoose=function(t,e){this.itemPrefabList[t]&&this.itemPrefabList[t].setSelect(e)},e.prototype.getIndexByLocation=function(t){var e=v.default.ITEM_SIZE_WIDTH,i=v.default.ITEM_SIZE_HEIGHT,a=Math.floor(Math.abs(t.x)/e),n=Math.floor(Math.abs(t.y)/i),o=7*n+a;return o>v.default.GAME_HEIGHT*v.default.GAME_WIDTH-1||o<0?-1:1==this.mapIndex?7*n+a:7*n+a+v.default.GAME_HEIGHT*v.default.GAME_WIDTH},e.prototype.moveCreateItem=function(t,e,i){var a=this;void 0===i&&(i=null);var n=cc.instantiate(this.itemTempPrefab);n.getComponent("ItemTempPrefab").init(e),n.parent=this.tempContent;var o=this.getPositionByIndex(t);n.setPosition(o),n.active=!0;var s=this.getPositionByIndex(e),r=this.getDistanceByTwnPoint(o,s)/2e3;cc.tween(n).to(r,{position:s}).call(function(){i&&i(),a.updateMergeArea([e]),n.destroy()}).start()},e.prototype.showTeleportAni=function(t){var e=cc.instantiate(this.itemTempPrefab);if(e.getComponent("ItemTempPrefab").init(t),e.parent=this.tempContent,e.position=this.tempItem.node.position,e.active=!0,cc.isValid(e)){var i=cc.v3(942.5,-138,0);1==m.default.getInstance().mergeArea&&(i=cc.v3(72.5,-138,0)),cc.tween(e).to(.1,{scale:1.5}).delay(.1).to(.3,{scale:0,position:i,angle:-360}).call(function(){e.destroy()}).start()}},e.prototype.reBackPos=function(){this.itemPrefabList[this.touchIndex]&&(this.itemPrefabList[this.touchIndex].node.active=!0),this.itemBgPrefabList[this.touchIndex]&&(this.itemBgPrefabList[this.touchIndex].node.active=!0),this.itemIconPrefabList[this.touchIndex]&&(this.itemIconPrefabList[this.touchIndex].node.active=!0),cc.isValid(this.tempItem)&&(this.tempItem.node.active=!1)},e.prototype.isCanMoveByIndex=function(t){var e=m.default.getInstance().itemData;return e[t].state==v.default.ITEM_STATE_NORMAL&&e[t].id>0||e[t].state==v.default.ITEM_STATE_BUBBLE&&e[t].id>0},e.prototype.readyToTip=function(t){var e=this;void 0===t&&(t=!0),cc.tween(this.node).delay(3).call(function(){if(t)for(var i in e.tipList=m.default.getInstance().getMergeTip(),e.tipList)e.itemIconPrefabList[e.tipList[i]]&&e.itemIconPrefabList[e.tipList[i]].showTipAnim();cc.director.getScene().emit(h.default.TIP_GUIDE_START)}).start()},e.prototype.stopToTip=function(){for(var t in this.node.stopAllActions(),this.tipList)this.itemIconPrefabList[this.tipList[t]]&&this.itemIconPrefabList[this.tipList[t]].stopTipAnim();this.tipList=[],cc.director.getScene().emit(h.default.TIP_GUIDE_STOP)},e.prototype.lockAreaItemAnim=function(t){this.itemPrefabList[t].showUnlockAnim(),this.itemIconPrefabList[t].showUnlockAnim()},e.prototype.taskComplete=function(t){if(cc.director.getScene().emit(h.default.UPDATE_ITEM_INFO,this.touchIndex),this.updateMergeArea(t.cells),0!=t.cells.length)for(var e=0,i=0;i<t.cells.length;i++){var a={};a.id=t.itemIds[i],a.startNode=this.itemIconPrefabList[t.cells[i]].node,a.endNode=t.node,a.moveSpeed=2e3,a.num=1,a.callback=function(){++e>=t.cells.length&&t.callback&&t.callback()},cc.director.getScene().emit(h.default.ITEM_FLY,a)}else t.callback&&t.callback()},e.prototype.tipRefreshCD=function(t){if(this.isCanVideoSpeedUp(t)){var e=cc.find("Canvas/MergeUIContent/MergeUI/topInfoContent/TopInfoPrefab").getComponent("TopInfoPrefab"),i={contentText:k.default.t("mergeManager_2"),model:v.default.COMMON_POPUP_MODEL_2,isVideo:!0,okCallback:function(){e.onClickVideoSpeedUp()}};y.default.getInstance().openUI(C.default,{data:i})}},e.prototype.tipRefreshBubble=function(t){if(this.isCanVideoSpeedUp(t)){var e=cc.find("Canvas/MergeUIContent/MergeUI/topInfoContent/TopInfoPrefab").getComponent("TopInfoPrefab"),i={contentText:"\u662f\u5426\u89c2\u770b\u89c6\u9891\u83b7\u5f97\u6c14\u6ce1\u7269\u54c1",model:v.default.COMMON_POPUP_MODEL_2,isVideo:!0,okCallback:function(){m.default.getInstance().itemData[t].state==v.default.ITEM_STATE_BUBBLE?e.onClickVideoSpeedUp():y.default.getInstance().openUI(N.default,{data:{str:k.default.t("mergeManager_4")}})}};y.default.getInstance().openUI(C.default,{data:i})}},e.prototype.isCanVideoSpeedUp=function(t){return!!m.default.getInstance().itemData[t].isShowVideo},e.prototype.tipRefreshBox=function(t){if(this.isCanVideoSpeedUp(t)){var e=cc.find("Canvas/MergeUIContent/MergeUI/topInfoContent/TopInfoPrefab").getComponent("TopInfoPrefab"),i={contentText:k.default.t("mergeManager_5"),model:v.default.COMMON_POPUP_MODEL_2,okCallback:function(){e.onClickVideoSpeedUp()}};y.default.getInstance().openUI(C.default,{data:i})}},e.prototype.getItemByIndex=function(t){return this.itemPrefabList[t].node},e.prototype.isNearBag=function(){var t=g.default.getInstance().mstMisc.bagConfig.config.openLevel;if(m.default.getInstance().level<t)return!1;var e=this.getBottomInfoPrefab().spBag.node.getBoundingBoxToWorld(),i=this.tempItem.node.parent.convertToWorldSpaceAR(this.tempItem.node.position);return!!e.contains(cc.v2(i.x,i.y))},e.prototype.checkNearBag=function(){var t=this.getBottomInfoPrefab();this.isNearBag()?t.putBag(!0):t.putBag(!1)},e.prototype.checkPutBag=function(){if(this.getBottomInfoPrefab().putBag(!1),this.isNearBag()){var t=m.default.getInstance().putIntoBag(this.touchIndex);1==t?(this.guideBagPutCallback&&this.guideBagPutCallback(),m.default.getInstance().updateTaskAndItem(),cc.director.getScene().emit(h.default.UPDATE_MERGEAREA,[this.touchIndex]),cc.director.getScene().emit(h.default.UPDATE_ITEM_INFO,this.touchIndex)):-1==t?y.default.getInstance().openUI(N.default,{data:{str:k.default.t("mergeManager_6")}}):-2==t?y.default.getInstance().openUI(N.default,{data:{str:k.default.t("mergeManager_7")}}):-3==t&&y.default.getInstance().openUI(N.default,{data:{str:k.default.t("mergeManager_8")}})}},e.prototype.guideToMerge=function(t,e,i){void 0===i&&(i=function(){}),this._guideIndex1=t,this._guideIndex2=e,this._guideCallback=i},e.prototype.getBottomInfoPrefab=function(){return this._bottomInfoPrefab||(this._bottomInfoPrefab=cc.find("Canvas/MergeUIContent/MergeUI/bottomInfoContent/BottomInfoPrefab").getComponent("BottomInfoPrefab")),this._bottomInfoPrefab},e.prototype.onGotoArea1=function(){var t=this;y.default.getInstance().openUI(_.default,{data:{showBlack:!1}},function(){cc.director.getScene().emit(h.default.UPDATE_ITEM_INFO,-1),t.itemClick(-1),t.stopToTip(),m.default.getInstance().checkAreaOne(),t.areaNode[0].opacity=255,cc.tween(t.areaNode[0]).to(.5,{position:cc.v3(0,0,0)}).start(),cc.tween(t.areaNode[1]).to(.5,{position:cc.v3(1080,0,0)}).call(function(){t.areaNode[1].opacity=0,t.readyToTip(),y.default.getInstance().closeUI(_.default)}).start()})},e.prototype.onGotoArea2=function(){var t=this;y.default.getInstance().openUI(_.default,{data:{showBlack:!1}},function(){cc.director.getScene().emit(h.default.UPDATE_ITEM_INFO,-1),t.itemClick(-1),t.stopToTip(),m.default.getInstance().checkAreaTwo(),t.areaNode[1].opacity=255,cc.tween(t.areaNode[0]).to(.5,{position:cc.v3(-1080,0,0)}).call(function(){t.areaNode[0].opacity=0,t.isLoadAreaTwoFinish&&(t.readyToTip(),y.default.getInstance().closeUI(_.default))}).start(),cc.tween(t.areaNode[1]).to(.5,{position:cc.v3(0,0,0)}).start()})},o([T(cc.Node)],e.prototype,"tempContent",void 0),o([T([cc.Node])],e.prototype,"areaNode",void 0),o([T(cc.Node)],e.prototype,"touchNode",void 0),o([T(cc.Node)],e.prototype,"teleportOne",void 0),o([T(cc.Node)],e.prototype,"teleportTwo",void 0),o([T(cc.Float)],e.prototype,"tolerateDis",void 0),o([T(cc.Integer)],e.prototype,"mapIndex",void 0),o([w],e)}(cc.Component);i.default=P,cc._RF.pop()},{"../../scripts/data/MiscConfig":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AudioManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/CommonPopup":void 0,"../../scripts/prefabs/Loading":void 0,"../../scripts/prefabs/Toast":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../prefabs/Levelup":"Levelup","../prefabs/LockAreaItem":"LockAreaItem","../prefabs/UnlockShowPopup":"UnlockShowPopup","./CellItem":"CellItem","./ItemBgPrefab":"ItemBgPrefab","./ItemImgPrefab":"ItemImgPrefab","./ItemPrefab":"ItemPrefab","./ItemTempPrefab":"ItemTempPrefab"}],MergeUI:[function(t,e,i){"use strict";cc._RF.push(e,"b6d1fZf97VOq6epiJ7uERE8","MergeUI");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("./MergeManager"),r=cc._decorator,c=r.ccclass,d=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bg1=null,e.bg2=null,e.topInfoContent=null,e.bottomInfoContent=null,e.mergeManager=null,e._loadCompleteCallback=null,e}return n(e,t),e.prototype.init=function(t){void 0===t&&(t=null),this._loadCompleteCallback=t},e.prototype.onLoad=function(){var t=this,e=this.mergeManager.getComponent(s.default);this.loadTopInfoDetail(),this.loadBottomInfo(),e.loadLockArea(0,function(){t.adapterScreen(),"function"==typeof t._loadCompleteCallback&&t._loadCompleteCallback()})},e.prototype.loadTopInfoDetail=function(){var t=this;cc.resources.load("entitys/TopInfoPrefab",cc.Prefab,function(e,i){e||(cc.instantiate(i).parent=t.topInfoContent)})},e.prototype.loadBottomInfo=function(){var t=this;cc.resources.load("entitys/BottomInfoPrefab",cc.Prefab,function(e,i){e||(cc.instantiate(i).parent=t.bottomInfoContent)})},e.prototype.adapterScreen=function(){var t=cc.view.getVisibleSize().width,e=cc.view.getVisibleSize().height;if(e/t>1920/1080){var i=1920/1080*t;this.bg1.height+=(e-i)/2,this.bg2.height+=(e-i)/2}},o([d(cc.Node)],e.prototype,"bg1",void 0),o([d(cc.Node)],e.prototype,"bg2",void 0),o([d(cc.Node)],e.prototype,"topInfoContent",void 0),o([d(cc.Node)],e.prototype,"bottomInfoContent",void 0),o([d(s.default)],e.prototype,"mergeManager",void 0),o([c],e)}(cc.Component);i.default=l,cc._RF.pop()},{"./MergeManager":"MergeManager"}],NewUserGiftPopup:[function(t,e,i){"use strict";cc._RF.push(e,"ee3f0jSUWRMfL/9BMcHO9hF","NewUserGiftPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MstData"),c=t("../../scripts/data/UserData"),d=t("../../scripts/manager/AdManager"),l=t("../../scripts/manager/UIManager"),p=t("../../scripts/utils/EventName"),u=t("../../scripts/utils/GlobalFun"),f=t("../../scripts/utils/StatisticsManager"),h=t("./AwardPopup"),g=t("../../scripts/extension/LanguageData"),m=cc._decorator,v=m.ccclass,_=m.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnGetAward=null,e.energy=null,e.diamonds=null,e._rewardRes=null,e}return n(e,t),e.prototype.init=function(){var t=r.default.getInstance().mstActivity.newUserGift.config;this._rewardRes=u.default.rewardResToObj(t.rewardRes),this.energy.string=this._rewardRes[30092],this.diamonds.string=this._rewardRes[30094],u.default.isCanShowBanner()&&d.default.getInstance().showBanner(),this.updateRewardCD()},e.prototype.onGetGiftAward=function(){var t=this;f.default.trackEvent("newUserGift_video_click"),f.default.trackEventOnXG("common","Ad_button_click"),f.default.trackEventOnXG("video","\u65b0\u624b\u793c\u5305",10,0),d.default.getInstance().showRewardAd(function(){f.default.trackEventOnXG("video","\u65b0\u624b\u793c\u5305",10,1),f.default.trackEvent("newUserGift_video_success"),t.getAward()},function(){f.default.trackEvent("newUserGift_video_fail")},function(){f.default.trackEvent("newUserGift_video_err")})},e.prototype.getAward=function(){var t=this;if(-1!=c.default.getInstance().getNewUserGift()){var e=[];for(var i in this._rewardRes)e.push({id:i,num:this._rewardRes[i]});l.default.getInstance().openUI(h.default,{data:e},null,function(){cc.director.getScene().emit(p.default.UPDATE_TOPINFO),cc.director.getScene().emit(p.default.UPDATE_ACTIVITY),l.default.getInstance().closeUI(t.tag)})}},e.prototype.updateRewardCD=function(){if(this.btnGetAward.node.active){var t=d.default.getInstance().rewardAdCd;t>0?(this.btnGetAward.interactable=!1,u.default.setBtnIsGrey(this.btnGetAward),this.energy.string=u.default.formatDateTimeHourEx(t)):(this.btnGetAward.interactable=!0,u.default.setBtnIsGrey(this.btnGetAward,new cc.Color(62,96,32)),this.energy.string=g.default.t("free"))}},e.prototype.onLoad=function(){f.default.trackEvent("newUserGift_open"),this.updateRewardCD(),cc.director.getScene().on(p.default.UPDATE_BY_SECOND,this.updateRewardCD,this)},e.prototype.onDestroy=function(){u.default.isCanShowBanner()&&d.default.getInstance().hideBanner()},e.uiName="NewUserGiftPopup",o([_(cc.Button)],e.prototype,"btnGetAward",void 0),o([_(cc.Label)],e.prototype,"energy",void 0),o([_(cc.Label)],e.prototype,"diamonds",void 0),o([v],e)}(s.default);i.default=y,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../../scripts/utils/StatisticsManager":void 0,"./AwardPopup":"AwardPopup"}],NewYearAniPopup:[function(t,e,i){"use strict";cc._RF.push(e,"1a5c14D+VdHa5fDbz6qKTtN","NewYearAniPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/manager/AudioManager"),c=t("../../scripts/utils/GlobalFun"),d=cc._decorator,l=d.ccclass,p=d.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.fireWorksNodes=[],e.wallNode=null,e.yearNode=null,e.lionNode=null,e.coupletsNode=null,e.coupletsTitleNode=null,e.coupletsLeftNode=null,e.coupletsRightNode=null,e._animations=[],e}return n(e,t),e.prototype.onLoad=function(){r.default.getInstance().setMusicVolume(.3),r.default.getInstance().playEffect("newYearLion"),this.runFireWorksAni(),this.runLionAni()},e.prototype.runFireWorksAni=function(){for(var t=this,e=function(e){i._animations[e]=i.fireWorksNodes[e].getComponent(cc.Animation);var a=c.default.radomBetween(1,5);setTimeout(function(){t._animations[e].play(),setTimeout(function(){cc.isValid(t)&&r.default.getInstance().playEffect("boom")},1e3),t._animations[e].on(cc.Animation.EventType.FINISHED,function(){t.fireWorksRandomPlay(e)},t)},100*a)},i=this,a=0;a<this.fireWorksNodes.length;a++)e(a)},e.prototype.fireWorksRandomPlay=function(t){var e=this,i=[-500,500],a=[-300,300],n=[1,5],o=c.default.radomBetween(i[0],i[1]),s=c.default.radomBetween(a[0],a[1]);this.fireWorksNodes[t].setPosition(o,s);var d=c.default.radomBetween(n[0],n[1]);setTimeout(function(){cc.isValid(e)&&(e._animations[t].play(),setTimeout(function(){cc.isValid(e)&&r.default.getInstance().playEffect("boom")},1e3))},100*d)},e.prototype.runLionAni=function(){var t=this;this.lionNode.scale=.2,this.lionNode.setPosition(12,-260);var e=cc.tween(this.lionNode).to(.8,{position:cc.v3(-240,-410),scale:.5}),i=cc.tween(this.lionNode).to(.8,{position:cc.v3(88,-490),scale:1}),a=cc.tween(this.lionNode).to(.3,{position:cc.v3(88,-360),scale:1}).to(.3,{position:cc.v3(88,-490),scale:1});cc.tween(this.lionNode).delay(1).sequence(e,i).then(a).delay(.8).then(a).delay(.8).then(a).call(function(){t.runCoupletsAni()}).start()},e.prototype.runCoupletsAni=function(){var t=this;this.wallNode.opacity=100,this.yearNode.active=!1,this.coupletsNode.active=!0,cc.tween(this.coupletsTitleNode).to(1,{width:845}).start(),cc.tween(this.coupletsNode.children[1]).to(.882,{position:cc.v3(-361,606,0)}).start(),cc.tween(this.coupletsNode.children[2]).to(.882,{position:cc.v3(361,606,0)}).start(),cc.tween(this.coupletsLeftNode).to(1,{height:900}).start(),cc.tween(this.coupletsLeftNode.children[0].children[0]).to(.977,{position:cc.v3(0,-364,0)}).call(function(){t.coupletsLeftNode.children[0].children[1].active=!0,t.coupletsLeftNode.children[0].children[1].scale=0,cc.tween(t.coupletsLeftNode.children[0].children[1]).to(.3,{scale:1}).start()}).start(),cc.tween(this.coupletsRightNode).to(1,{height:900}).start(),cc.tween(this.coupletsRightNode.children[0].children[0]).to(.977,{position:cc.v3(0,-364,0)}).call(function(){t.coupletsRightNode.children[0].children[1].active=!0,t.coupletsRightNode.children[0].children[1].scale=0,cc.tween(t.coupletsRightNode.children[0].children[1]).to(.3,{scale:1}).start(),t.node.getComponent(cc.Button).enabled=!0}).start()},e.prototype.onCilckClose=function(){r.default.getInstance().setMusicVolume(.7),this.onClose()},e.uiName="NewYearAniPopup",o([p([cc.Node])],e.prototype,"fireWorksNodes",void 0),o([p(cc.Node)],e.prototype,"wallNode",void 0),o([p(cc.Node)],e.prototype,"yearNode",void 0),o([p(cc.Node)],e.prototype,"lionNode",void 0),o([p(cc.Node)],e.prototype,"coupletsNode",void 0),o([p(cc.Node)],e.prototype,"coupletsTitleNode",void 0),o([p(cc.Node)],e.prototype,"coupletsLeftNode",void 0),o([p(cc.Node)],e.prototype,"coupletsRightNode",void 0),o([l],e)}(s.default);i.default=u,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/manager/AudioManager":void 0,"../../scripts/utils/GlobalFun":void 0}],NewYearBtn:[function(t,e,i){"use strict";cc._RF.push(e,"02f47uc9nVM2oQMmK4/M4O/","NewYearBtn");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/UserData"),r=t("../../scripts/manager/UIManager"),c=t("../../scripts/utils/ActionFunc"),d=t("../../scripts/utils/EventName"),l=t("../../scripts/utils/GlobalFun"),p=t("../prefabs/NewYearPopup"),u=cc._decorator,f=u.ccclass,h=u.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnBg=[],e.itemBg=[],e.itemNode=[],e.completeNode=null,e.bgSprite=null,e.endTimeLab=null,e.isStartAni=!1,e}return n(e,t),e.prototype.initNeedItems=function(){var t=s.default.getInstance().activityData.newYear.taskData[0];if(t){var e=t.requireItems,i=t.isReceived;if(e.length>0){var a=s.default.getInstance().getNormalItemIndexByIds(e);this.itemNode[0].active=!1,this.itemNode[1].active=!1;for(var n=0;n<e.length;n++){var o=i||a[n]>0,r=this.itemNode[n];r.active=!0;var d=l.default.getItemIconPathById(e[n]+"");if(d){var p=r.getChildByName("itemicon").getComponent(cc.Sprite);l.default.loadSpriteFrame(p,d)}o?(r.getChildByName("gou").active=!0,r.getComponent(cc.Sprite).spriteFrame=this.itemBg[1]):(r.getChildByName("gou").active=!1,r.getComponent(cc.Sprite).spriteFrame=this.itemBg[0])}}t.isComplete?(this.completeNode.active=!0,this.bgSprite.spriteFrame=this.btnBg[1],this.isStartAni||(this.isStartAni=!0,c.default.zoomAnim2(this.node))):(this.isStartAni&&(this.isStartAni=!1,cc.Tween.stopAllByTarget(this.node),this.node.scale=1),this.completeNode.active=!1,this.bgSprite.spriteFrame=this.btnBg[0])}},e.prototype.onClickActivity=function(){r.default.getInstance().openUI(p.default)},e.prototype.updateTime=function(){var t=s.default.getInstance().activityData.getActivityEndTime("newYear");if(t.length>0){var e=t[1]-window.serverTime;e>0?this.endTimeLab.string=l.default.formatDateTimeDaysPre(e):cc.director.getScene().emit(d.default.RESET_ACTIVITY)}else cc.director.getScene().emit(d.default.RESET_ACTIVITY)},e.prototype.onLoad=function(){cc.director.getScene().on(d.default.UPDATE_MERGEAREA,this.initNeedItems,this),cc.director.getScene().on(d.default.UPDATE_BY_SECOND,this.updateTime,this),this.updateTime(),this.initNeedItems(),s.default.getInstance().activityData.isFirstLoadActivitu("newYear")?(s.default.getInstance().activityData.setShowOneActivity("newYear"),s.default.getInstance().updateTaskAndItem(),cc.director.getScene().emit(d.default.UPDATE_MERGEAREA)):s.default.getInstance().activityData.setShowOneActivity("newYear")},o([h([cc.SpriteFrame])],e.prototype,"btnBg",void 0),o([h([cc.SpriteFrame])],e.prototype,"itemBg",void 0),o([h([cc.Node])],e.prototype,"itemNode",void 0),o([h(cc.Node)],e.prototype,"completeNode",void 0),o([h(cc.Sprite)],e.prototype,"bgSprite",void 0),o([h(cc.Label)],e.prototype,"endTimeLab",void 0),o([f],e)}(cc.Component);i.default=g,cc._RF.pop()},{"../../scripts/data/UserData":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/utils/ActionFunc":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../prefabs/NewYearPopup":"NewYearPopup"}],NewYearExchangeItem:[function(t,e,i){"use strict";cc._RF.push(e,"263c9FDLQ9DbLHJ4Sq/D4BA","NewYearExchangeItem");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/MstData"),r=t("../../scripts/data/UserData"),c=t("../../scripts/manager/UIManager"),d=t("../../scripts/prefabs/Toast"),l=t("../../scripts/utils/EventName"),p=t("../../scripts/utils/GlobalFun"),u=t("../../scripts/utils/StatisticsManager"),f=t("../extension/ListItem"),h=t("../prefabs/AwardPopup"),g=t("../prefabs/BuildInfoPopup"),m=t("../prefabs/ItemChain"),v=t("../prefabs/UnlockShowPopup"),_=t("./ActiveExchangeAwardItem"),y=t("../../scripts/extension/LanguageData"),I=cc._decorator,b=I.ccclass,N=I.property,C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.costnum=null,e.surplusCount=null,e.btnFinish=null,e.btnChain=null,e.recived=null,e.awardRoot=null,e.awardPrefab=null,e.shopInfo=null,e.awardList=[],e.awardSkinId=0,e._parent=null,e}return n(e,t),e.prototype.init=function(t,e){this.shopInfo=t,this._parent=e,this.awardList=[],this.awardSkinId=0,this.updateAward(),this.updateState()},e.prototype.updateAward=function(){this.btnChain.active=!1;for(var t=0;t<this.awardRoot.children.length;t++)this.awardRoot.children[t].destroy();var e=this.shopInfo.reward;for(t=0;t<e.length;t++)(o=cc.instantiate(this.awardPrefab)).getComponent(_.default).initAwardInfo(1,e[t]),this.awardRoot.addChild(o),this.awardList.push({id:e[t],num:1}),this.btnChain.active=!0,this.btnChain.itemId=e[t];var i=p.default.rewardResToObj(this.shopInfo.rewardRes);for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&((o=cc.instantiate(this.awardPrefab)).getComponent(_.default).initAwardInfo(2,Number(a),i[a]),this.awardRoot.addChild(o),this.awardList.push({id:Number(a),num:i[a]}));var n=this.shopInfo.rewardSkin;for(t=0;t<n.length;t++){var o;(o=cc.instantiate(this.awardPrefab)).getComponent(_.default).initAwardInfo(3,n[t]),this.awardRoot.addChild(o),this.awardSkinId=n[t],this.btnChain.active=!0,this.btnChain.skinId=n[t]}},e.prototype.updateState=function(){var t=r.default.getInstance().activityData.newYear.exchangeShop[this.shopInfo.shopId]?r.default.getInstance().activityData.newYear.exchangeShop[this.shopInfo.shopId]:0;if(t>=this.shopInfo.limitNum)this.btnFinish.active=!1,this.recived.active=!0,this.surplusCount.node.active=!1;else{this.btnFinish.active=!0,this.recived.active=!1,this.costnum.string="x"+this.shopInfo.costNum;var e=this.shopInfo.limitNum-t;e>0&&e<=10?(this.surplusCount.node.active=!0,this.surplusCount.string=y.default.t("shop_1",{num:e})):this.surplusCount.node.active=!1}},e.prototype.onClickExchange=function(){var t=this,e=r.default.getInstance().activityData.newYear.firecrackers;r.default.getInstance().activityData.newYear.exchangeReward(this.shopInfo.shopId)?(u.default.trackEvent("activity_newYear_exchange",{shopId:this.shopInfo.shopId+""}),r.default.getInstance().activityData.newYear.firecrackers!=e&&this._parent.addFirecrackersAni(e),this.updateState(),this.awardList.length>0?c.default.getInstance().openUI(h.default,{data:p.default.clone(this.awardList)},null,function(){t.awardSkinId>0&&c.default.getInstance().openNotice(v.default,{data:{ntype:"building",skinId:t.awardSkinId}})}):this.awardSkinId>0&&c.default.getInstance().openNotice(v.default,{data:{ntype:"building",skinId:this.awardSkinId}}),cc.director.getScene().emit(l.default.UPDATE_FIRECRACKERS),cc.director.getScene().emit(l.default.UPDATE_ACTIVITY)):c.default.getInstance().openUI(d.default,{data:{str:y.default.t("newYearExchangeItem_1")}})},e.prototype.onClick=function(t){if(t.target.itemId)c.default.getInstance().openUI(m.default,{data:t.target.itemId});else if(t.target.skinId){var e=s.default.getInstance().mstBuildingSkin[t.target.skinId];e&&c.default.getInstance().openUI(g.default,{data:{buildId:e.buildingId}})}},e.prototype.start=function(){},o([N(cc.Label)],e.prototype,"costnum",void 0),o([N(cc.Label)],e.prototype,"surplusCount",void 0),o([N(cc.Node)],e.prototype,"btnFinish",void 0),o([N(cc.Node)],e.prototype,"btnChain",void 0),o([N(cc.Node)],e.prototype,"recived",void 0),o([N(cc.Node)],e.prototype,"awardRoot",void 0),o([N(cc.Prefab)],e.prototype,"awardPrefab",void 0),o([b],e)}(f.default);i.default=C,cc._RF.pop()},{"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/Toast":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../../scripts/utils/StatisticsManager":void 0,"../extension/ListItem":"ListItem","../prefabs/AwardPopup":"AwardPopup","../prefabs/BuildInfoPopup":"BuildInfoPopup","../prefabs/ItemChain":"ItemChain","../prefabs/UnlockShowPopup":"UnlockShowPopup","./ActiveExchangeAwardItem":"ActiveExchangeAwardItem"}],NewYearExchangePopup:[function(t,e,i){"use strict";cc._RF.push(e,"8615cmYtDlF9rDduAkANT+q","NewYearExchangePopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MstData"),c=t("../../scripts/data/UserData"),d=t("../../scripts/manager/AdManager"),l=t("../../scripts/manager/UIManager"),p=t("../../scripts/utils/ActionFunc"),u=t("../../scripts/utils/EventName"),f=t("../../scripts/utils/GlobalFun"),h=t("../entitys/NewYearExchangeItem"),g=t("../extension/List"),m=t("./AssistShopPopup"),v=cc._decorator,_=v.ccclass,y=v.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.listElement=null,e.firecrackersLab=null,e.btnBianpao=null,e.exchangeList=[],e}return n(e,t),e.prototype.init=function(){this.updateTaskData(),this.updateFirecrackers(),f.default.isCanShowBanner()&&d.default.getInstance().showBanner()},e.prototype.updateFirecrackers=function(){this.firecrackersLab.string=c.default.getInstance().activityData.newYear.firecrackers+""},e.prototype.updateTaskData=function(){this.exchangeList=[];var t=r.default.getInstance().mstActivity.newYear.config.exchangeShop;for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)){var i=t[e];i.shopId=Number(e),this.exchangeList.push(i)}},e.prototype.itemElementRender=function(t,e){t.getComponent(h.default).init(this.exchangeList[e],this)},e.prototype.getExchangeNode=function(){return this.listElement.getItemByListId(0)},e.prototype.onClickAssist=function(){l.default.getInstance().openUI(m.default)},e.prototype.addFirecrackersAni=function(t){var e=this,i=c.default.getInstance().activityData.newYear.firecrackers;p.default.updateNumberAnimation(this.btnBianpao,this.firecrackersLab,i,t,function(){cc.isValid(e)&&e.updateFirecrackers()})},e.prototype.onLoad=function(){cc.director.getScene().on(u.default.UPDATE_FIRECRACKERS,this.updateFirecrackers,this),this.listElement.numItems=this.exchangeList.length},e.prototype.onDestroy=function(){f.default.isCanShowBanner()&&d.default.getInstance().hideBanner()},e.uiName="NewYearExchangePopup",o([y(g.default)],e.prototype,"listElement",void 0),o([y(cc.Label)],e.prototype,"firecrackersLab",void 0),o([y(cc.Node)],e.prototype,"btnBianpao",void 0),o([_],e)}(s.default);i.default=I,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/utils/ActionFunc":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../entitys/NewYearExchangeItem":"NewYearExchangeItem","../extension/List":"List","./AssistShopPopup":"AssistShopPopup"}],NewYearPopup:[function(t,e,i){"use strict";cc._RF.push(e,"3dcdeqS/lZNjZvTEWAEwXJY","NewYearPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MiscConfig"),c=t("../../scripts/data/MstData"),d=t("../../scripts/data/UserData"),l=t("../../scripts/manager/AudioManager"),p=t("../../scripts/manager/UIManager"),u=t("../../scripts/prefabs/CommonPopup"),f=t("../../scripts/prefabs/Loading"),h=t("../../scripts/utils/ActionFunc"),g=t("../../scripts/utils/EventName"),m=t("../../scripts/utils/GlobalFun"),v=t("./AssistShopPopup"),_=t("./ItemChain"),y=t("./ItemInfoPopup"),I=t("./NewYearExchangePopup"),b=t("../../scripts/extension/LanguageData"),N=cc._decorator,C=N.ccclass,k=N.property,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnBg=[],e.itemBg=[],e.itemNode=[],e.taskAwardNode=[],e.btnGetTaskAward=null,e.btnGoMerge=null,e.btnBianpao=null,e.bgSprite=null,e.endTimeLab=null,e.firecrackersLab=null,e.bannerNode=null,e.throwFireWorksNode=null,e._taskAwardList=[],e}return n(e,t),e.prototype.init=function(){this.updateFirecrackers(),this.updateTime(),this.initTaskData()},e.prototype.updateFirecrackers=function(){this.firecrackersLab.string=d.default.getInstance().activityData.newYear.firecrackers+""},e.prototype.initTaskData=function(){var t=d.default.getInstance().activityData.newYear.taskData[0];if(t){var e=t.requireItems,i=t.isReceived;if(e.length>0){var a=d.default.getInstance().getNormalItemIndexByIds(e);this.itemNode[0].active=!1,this.itemNode[1].active=!1;for(var n=0;n<e.length;n++){var o=i||a[n]>0,s=this.itemNode[n];s.active=!0;var r=m.default.getItemIconPathById(e[n]+"");if(r){var c=s.getChildByName("itemicon").getComponent(cc.Sprite);m.default.loadSpriteFrame(c,r)}o?(s.getChildByName("gou").active=!0,s.getComponent(cc.Sprite).spriteFrame=this.itemBg[1]):(s.getChildByName("gou").active=!1,s.getComponent(cc.Sprite).spriteFrame=this.itemBg[0]),s.getComponent(cc.Button).interactable=!0,s.getChildByName("chain").active=!0}}t.isComplete?(this.btnGetTaskAward.active=!0,this.btnGoMerge.active=!1,this.bgSprite.spriteFrame=this.btnBg[1]):(this.btnGetTaskAward.active=!1,this.btnGoMerge.active=!0,this.bgSprite.spriteFrame=this.btnBg[0]);var l=m.default.rewardResToObj(t.mstData.rewardRes),p=!1;for(var u in l){if("40002"==u)this.taskAwardNode[1].getChildByName("awardNum").getComponent(cc.Label).string="x"+l[u];else{this.taskAwardNode[0].active=!0;var f=m.default.getItemIconPathById(l[u]);m.default.loadSpriteFrame(this.taskAwardNode[0].getChildByName("icon").getComponent(cc.Sprite),f),this.taskAwardNode[0].getChildByName("bg").active=!0,this.taskAwardNode[0].getChildByName("awardNum").getComponent(cc.Label).string="x"+l[u],p=!0}this._taskAwardList.push({id:Number(u),num:l[u]})}!p&&(this.taskAwardNode[0].active=!1,t.mstData.reward.length>0)&&(f=m.default.getItemIconPathById(t.mstData.reward[0]),m.default.loadSpriteFrame(this.taskAwardNode[0].getChildByName("icon").getComponent(cc.Sprite),f),this.taskAwardNode[0].getChildByName("bg").active=!1,this.taskAwardNode[0].getChildByName("awardNum").getComponent(cc.Label).string="x1",this._taskAwardList.push({id:t.mstData.reward[0],num:1}))}},e.prototype.onClickItem1=function(){var t=d.default.getInstance().activityData.newYear.taskData[0];if(t){var e=t.requireItems;c.default.getInstance().mstItem[e[0]].type.includes("Show")?p.default.getInstance().openUI(y.default,{data:e[0]}):p.default.getInstance().openUI(_.default,{data:e[0]})}},e.prototype.onClickItem2=function(){var t=d.default.getInstance().activityData.newYear.taskData[0];if(t){var e=t.requireItems;c.default.getInstance().mstItem[e[0]].type.includes("Show")?p.default.getInstance().openUI(y.default,{data:e[1]}):p.default.getInstance().openUI(_.default,{data:e[1]})}},e.prototype.onClickGetAward=function(){var t=d.default.getInstance().activityData.newYear.firecrackers,e=d.default.getInstance().activityData.newYear.taskData[0].completeTask();if(e){d.default.getInstance().updateTaskAndItem(),this.initTaskData(),this.addFirecrackersAni(t);for(var i=0,a=0;a<this._taskAwardList.length;a++)if(40002==this._taskAwardList[a].id){i=this._taskAwardList[a].num;break}this.fireWorksAni(i/10),cc.director.getScene().emit(g.default.UPDATE_MERGEAREA,e.cells)}},e.prototype.onClickHelp=function(){var t=d.default.getInstance().activityData.getActivityEndTime("newYear");if(!(t.length<=0)){var e=m.default.getDateByYMD(t[0]),i=m.default.getDateByYMD(t[1]),a={titleText:b.default.t("happyBingoHelpPopup_2"),contentText:b.default.t("newYearPopup_1",{data1:e,data2:i}),model:r.default.COMMON_POPUP_MODEL_1,isLeft:!0,okText:b.default.t("sure"),okCallback:function(){}};p.default.getInstance().openUI(u.default,{data:a})}},e.prototype.onClickExchange=function(){p.default.getInstance().openUI(I.default)},e.prototype.onClickAssist=function(){p.default.getInstance().openUI(v.default)},e.prototype.updateTime=function(){var t=d.default.getInstance().activityData.getActivityEndTime("newYear");t.length>0?this.endTimeLab.string=m.default.formatDateTimeDaysPre(t[1]-window.serverTime):this.node.destroy()},e.prototype.getTaskNode=function(){return this.node.getChildByName("fram").getChildByName("itemBg")},e.prototype.getExchangeNode=function(){return this.node.getChildByName("fram").getChildByName("btnExchange")},e.prototype.onLoad=function(){cc.director.getScene().on(g.default.UPDATE_BY_SECOND,this.updateTime,this),cc.director.getScene().on(g.default.UPDATE_FIRECRACKERS,this.updateFirecrackers,this),cc.director.getScene().on(g.default.UPDATE_MERGEAREA,this.initTaskData,this)},e.prototype.addFirecrackersAni=function(t){var e=this,i=d.default.getInstance().activityData.newYear.firecrackers;h.default.updateNumberAnimation(this.btnBianpao,this.firecrackersLab,i,t,function(){cc.isValid(e)&&e.updateFirecrackers()})},e.prototype.fireWorksAni=function(t){var e=this;void 0===t&&(t=1),p.default.getInstance().openUI(f.default,{data:{showBlack:!1}},function(){t>10?t=10:t<1&&(t=1);for(var i=[-420,420],a=[60,-230],n=[-150,150],o=[80,-180],s=!1,r=function(r){var c=null;if(e.throwFireWorksNode.childrenCount-1<t?(c=cc.instantiate(e.throwFireWorksNode.children[0]),cc.isValid(e.node)&&e.throwFireWorksNode.addChild(c)):c=e.throwFireWorksNode.children[r+1],cc.isValid(e.node)){var d=m.default.radomBetween(0,i.length-1),u=i[d],h=m.default.radomBetween(a[0],a[1]),g=0,v=0,_=0;u<0?(g=u+140,v=h+100,_=-360):(g=u-140,v=h+100,_=360);var y=m.default.radomBetween(n[0],n[1]),I=m.default.radomBetween(o[0],o[1]),b=cc.tween(c).bezierTo(.5,cc.v2(u,h),cc.v2(g,v),cc.v2(y,I)),N=cc.tween(c).to(.5,{angle:_});e.bannerNode.children[1].active=!1,e.bannerNode.children[2].active=!0;var C=m.default.radomBetween(1,2);c.setPosition(u,h),c.angle=0,cc.tween(c).delay(r*C/10).call(function(){c.active=!0}).parallel(b,N).call(function(){cc.isValid(e.node)&&(c.children[0].active=!1,c.children[1].active=!0,c.children[1].scale=0,l.default.getInstance().playEffect("boom1"),s||(l.default.getInstance().playEffect("nianSound"),s=!0),cc.tween(c.children[0]).delay(2.3).call(function(){e.bannerNode.children[1].active=!0,e.bannerNode.children[2].active=!1,p.default.getInstance().closeUI(f.default)}).start(),cc.tween(c.children[1]).to(.2,{scale:2}).call(function(){cc.isValid(e.node)&&(c.active=!1,c.children[0].active=!0,c.children[1].active=!1)}).start())}).start()}},c=0;c<t;c++)r(c)})},e.prototype.onClickNian=function(){this.bannerNode.children[1].getComponent(cc.Animation).play(),l.default.getInstance().playEffect("nianSound")},e.uiName="NewYearPopup",o([k([cc.SpriteFrame])],e.prototype,"btnBg",void 0),o([k([cc.SpriteFrame])],e.prototype,"itemBg",void 0),o([k([cc.Node])],e.prototype,"itemNode",void 0),o([k([cc.Node])],e.prototype,"taskAwardNode",void 0),o([k(cc.Node)],e.prototype,"btnGetTaskAward",void 0),o([k(cc.Node)],e.prototype,"btnGoMerge",void 0),o([k(cc.Node)],e.prototype,"btnBianpao",void 0),o([k(cc.Sprite)],e.prototype,"bgSprite",void 0),o([k(cc.Label)],e.prototype,"endTimeLab",void 0),o([k(cc.Label)],e.prototype,"firecrackersLab",void 0),o([k(cc.Node)],e.prototype,"bannerNode",void 0),o([k(cc.Node)],e.prototype,"throwFireWorksNode",void 0),o([C],e)}(s.default);i.default=S,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MiscConfig":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AudioManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/CommonPopup":void 0,"../../scripts/prefabs/Loading":void 0,"../../scripts/utils/ActionFunc":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"./AssistShopPopup":"AssistShopPopup","./ItemChain":"ItemChain","./ItemInfoPopup":"ItemInfoPopup","./NewYearExchangePopup":"NewYearExchangePopup"}],OpeningPopup:[function(t,e,i){"use strict";cc._RF.push(e,"55165iTCERCPqyZJL5yd/QK","OpeningPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/manager/AudioManager"),c=cc._decorator,d=c.ccclass,l=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cuttingNode=null,e.closeBtn=null,e.tip=null,e.closeTip=null,e}return n(e,t),e.prototype.onClickCutting=function(){var t=this;r.default.getInstance().playEffect("clap"),this.tip.node.active=!1,this.cuttingNode.active=!1;var e=this.node.getComponent(cc.Animation);e.on(cc.Animation.EventType.FINISHED,function(){e.off(cc.Animation.EventType.FINISHED),t.closeBtn.enabled=!0,t.closeTip.active=!0}),e.play()},e.uiName="OpeningPopup",o([l(cc.Node)],e.prototype,"cuttingNode",void 0),o([l(cc.Button)],e.prototype,"closeBtn",void 0),o([l(cc.Label)],e.prototype,"tip",void 0),o([l(cc.Node)],e.prototype,"closeTip",void 0),o([d],e)}(s.default);i.default=p,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/manager/AudioManager":void 0}],OtherBlindBoxPopup:[function(t,e,i){"use strict";cc._RF.push(e,"246afSgtsJAf5hMtvUMUQaD","OtherBlindBoxPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/UserData"),c=t("../../scripts/manager/AdManager"),d=t("../../scripts/manager/UIManager"),l=t("../../scripts/prefabs/Loading"),p=t("../../scripts/prefabs/Toast"),u=t("../../scripts/utils/Api"),f=t("../../scripts/utils/EventName"),h=t("../../scripts/utils/GlobalFun"),g=t("../../scripts/utils/StatisticsManager"),m=t("../entitys/BlindBoxItem"),v=t("./AwardPopup"),_=t("./BlindBoxAwardPopup"),y=t("../../scripts/extension/LanguageData"),I=cc._decorator,b=I.ccclass,N=I.property,C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.boxPre=null,e.btnGetAward=null,e.boxNode=null,e.times=null,e.awardLab=null,e._boxNodeList=null,e._isreceived=!1,e._selectIdx=0,e._boxData=null,e._selectItemID=null,e._seleccItemNum=null,e}return n(e,t),e.prototype.init=function(t){this._boxNodeList=[],this._boxData=t;for(var e=0;e<this._boxData.list.length;e++){var i=cc.instantiate(this.boxPre);i.getComponent(m.default).initItemData(this._boxData.list[e],e,this._boxData.open,this),this.boxNode.addChild(i),this._boxNodeList.push(i)}this.showBlindAwardTime(),cc.director.getScene().on(f.default.NEW_DAY,this.refushNewDay,this),h.default.isCanShowBanner()&&c.default.getInstance().showBanner()},e.prototype.refushNewDay=function(){d.default.getInstance().openUI(p.default,{data:{str:y.default.t("otherBlindBoxPopup_6")}}),this.onClose()},e.prototype.selectBox=function(t,e,i,a){if(!this._isreceived){this._selectItemID=t,this._seleccItemNum=e,this._selectIdx=i;for(var n=0;n<this._boxNodeList.length;n++)this._boxNodeList[n].getComponent(m.default).selectItem(i);var o=r.default.getInstance().myOpenOtherBlindBox.length;this._isreceived||a?(this.btnGetAward.interactable=!1,this.btnGetAward.node.getChildByName("btnlab").getComponent(cc.LabelOutline).color=cc.color(116,116,116,255),this.awardLab.string=y.default.t("received")):(2==o?(this.btnGetAward.interactable=!1,this.btnGetAward.node.getChildByName("btnlab").getComponent(cc.LabelOutline).color=cc.color(116,116,116,255)):(this.btnGetAward.interactable=!0,this.btnGetAward.node.getChildByName("btnlab").getComponent(cc.LabelOutline).color=cc.color(64,98,35,255)),this.awardLab.string=y.default.t("receive"))}},e.prototype.showBlindAwardTime=function(){var t=r.default.getInstance().myOpenOtherBlindBox,e=t.length;this.times.string=y.default.t("otherBlindBoxPopup_1",{times:2-e});for(var i=0;i<e;i++)if(t[i]==this._boxData.userid){this._isreceived=!0;break}this._isreceived?(this.btnGetAward.interactable=!1,this.btnGetAward.node.getChildByName("btnlab").getComponent(cc.LabelOutline).color=cc.color(116,116,116,255),this.awardLab.string=y.default.t("received")):(2==e?(this.btnGetAward.interactable=!1,this.btnGetAward.node.getChildByName("btnlab").getComponent(cc.LabelOutline).color=cc.color(116,116,116,255)):(this.btnGetAward.interactable=!0,this.btnGetAward.node.getChildByName("btnlab").getComponent(cc.LabelOutline).color=cc.color(64,98,35,255)),this.awardLab.string=y.default.t("receive"))},e.prototype.onGetBlindBoxClicked=function(){var t=this;g.default.trackEvent("blindBox_receive_other");var e=h.default.getDateByYMD();this._boxData.shareTime==e?this._selectItemID?d.default.getInstance().openUI(l.default,{data:{showBlack:!1}},function(){var e={date:t._boxData.shareTime,shareUserId:t._boxData.userid,receivedId:t._selectIdx+1};u.default.activity.send({type:"blindBox",para:JSON.stringify(e)},function(e){if(e.result){if(r.default.getInstance().getOtherBlindBox(t._boxData.userid,t._selectItemID,t._seleccItemNum)){for(var i=0;i<t._boxNodeList.length;i++)t._boxNodeList[i].getComponent(m.default).showOpenUI(t._selectIdx);var a=[{id:t._selectItemID,num:t._seleccItemNum}];d.default.getInstance().openUI(v.default,{data:a}),t.showBlindAwardTime(),r.default.getInstance().saveUserData()}}else{var n=JSON.parse(e.data);for(i=0;i<t._boxNodeList.length;i++)t._boxNodeList[i].getComponent(m.default).setOpenList(n.receivedIds);n.receivedIds.length>=6?d.default.getInstance().openUI(p.default,{data:{str:y.default.t("otherBlindBoxPopup_4")}}):d.default.getInstance().openUI(p.default,{data:{str:y.default.t("otherBlindBoxPopup_5")}})}d.default.getInstance().closeUI(l.default)},function(){d.default.getInstance().closeUI(l.default)})}):d.default.getInstance().openUI(p.default,{data:{str:y.default.t("otherBlindBoxPopup_3")}}):d.default.getInstance().openUI(p.default,{data:{str:y.default.t("hemaPrefab_4")}})},e.prototype.onClickAwards=function(){d.default.getInstance().openUI(_.default,{data:this._boxData.list})},e.prototype.onDestroy=function(){h.default.isCanShowBanner()&&c.default.getInstance().hideBanner()},e.uiName="OtherBlindBoxPopup",o([N(cc.Prefab)],e.prototype,"boxPre",void 0),o([N(cc.Button)],e.prototype,"btnGetAward",void 0),o([N(cc.Node)],e.prototype,"boxNode",void 0),o([N(cc.Label)],e.prototype,"times",void 0),o([N(cc.Label)],e.prototype,"awardLab",void 0),o([b],e)}(s.default);i.default=C,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/Loading":void 0,"../../scripts/prefabs/Toast":void 0,"../../scripts/utils/Api":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../../scripts/utils/StatisticsManager":void 0,"../entitys/BlindBoxItem":"BlindBoxItem","./AwardPopup":"AwardPopup","./BlindBoxAwardPopup":"BlindBoxAwardPopup"}],PassAwardItem:[function(t,e,i){"use strict";cc._RF.push(e,"7f33cNDXMZGFKziI/Qv9G0t","PassAwardItem");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/UserData"),r=t("./ItemEntity"),c=cc._decorator,d=c.ccclass,l=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemNode=null,e.itemIcon=null,e.itemNum=null,e.needNum=null,e.videoSp=null,e.mergeSp=null,e.complete=null,e.lockIcon=null,e.bg=null,e.bgSp=[],e._itemID=0,e._itemNum=0,e}return n(e,t),e.prototype.initItem=function(t,e,i,a){void 0===a&&(a=!1);var n=this.itemNode.getComponent(r.default);this.node.insertChild(n.node,0);var o={};o.itemId=t,o.itemNum=e,o.itemBg=this.bgSp[i-1],o.isShowInfo=0!=i,o.isClickAble=0!=i,o.numOffset=0==i?cc.v2(5,-30):3==i?cc.v2(5,-10):cc.v2(20,10),n.init(o),this.lockIcon.active=a},e.prototype.initNeedItem=function(t,e,i,a){var n=this.itemNode.getComponent(r.default);this.node.insertChild(n.node,0);var o={};o.itemId=t,o.isShowInfo=!0,o.isClickAble=!0,this.lockIcon.active=!1;var c=0;"video"==i?(c=s.default.getInstance().videoTimes,o.itemId=-1,o.itemBg=this.videoSp,o.isShowInfo=!1,o.isClickAble=!1):"merge"==i?(c=s.default.getInstance().mergeTimes,o.itemId=-1,o.itemBg=this.mergeSp,o.isShowInfo=!1,o.isClickAble=!1):(o.itemId=t,o.isShowInfo=!0,o.isClickAble=!0,o.bgSize=cc.v2(170,170)),n.init(o),e?(c>=e?(c=e,this.complete.active=!0):this.complete.active=!1,this.needNum.node.active=!0,this.needNum.string=c+"/"+e):(this.needNum.node.active=!1,this.complete.active=!!a)},o([l(cc.Node)],e.prototype,"itemNode",void 0),o([l(cc.Sprite)],e.prototype,"itemIcon",void 0),o([l(cc.Label)],e.prototype,"itemNum",void 0),o([l(cc.Label)],e.prototype,"needNum",void 0),o([l(cc.SpriteFrame)],e.prototype,"videoSp",void 0),o([l(cc.SpriteFrame)],e.prototype,"mergeSp",void 0),o([l(cc.Node)],e.prototype,"complete",void 0),o([l(cc.Node)],e.prototype,"lockIcon",void 0),o([l(cc.Sprite)],e.prototype,"bg",void 0),o([l([cc.SpriteFrame])],e.prototype,"bgSp",void 0),o([d],e)}(cc.Component);i.default=p,cc._RF.pop()},{"../../scripts/data/UserData":void 0,"./ItemEntity":"ItemEntity"}],PassItem:[function(t,e,i){"use strict";cc._RF.push(e,"18743ZQe1tN2ar22HQMVmY6","PassItem");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/MstData"),r=t("../../scripts/data/UserData"),c=t("../../scripts/manager/AdManager"),d=t("../../scripts/manager/UIManager"),l=t("../../scripts/prefabs/Toast"),p=t("../../scripts/utils/EventName"),u=t("../../scripts/utils/GlobalFun"),f=t("../../scripts/utils/StatisticsManager"),h=t("../extension/ListItem"),g=t("../prefabs/AwardPopup"),m=t("../prefabs/ShopPopup"),v=t("./PassAwardItem"),_=t("../../scripts/extension/LanguageData"),y=cc._decorator,I=y.ccclass,b=y.property,N=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.levelLab=null,e.awardItem=null,e.levbgsp=null,e.levbgspfr=[],e.hightLay=null,e.lowerLay=null,e.specialReceivedTip=null,e.specialCanReceived=null,e.specialVideoNode=null,e.lbPrice=null,e.specialVideoTimes=null,e.normalReceivedTip=null,e.normalCanReceived=null,e.levelNode=null,e.upgress=null,e.downgress=null,e.taskNode=null,e.taskNeedNode=null,e.taskAwardNode=null,e.taskReceviedNode=null,e.btnGetTaskAward=null,e.btnGoComplete=null,e.titlenode=null,e.levelinfonode=null,e.btnTaskRefresh=null,e.lbRefush=null,e.refushVideo=null,e.refushDiamonds=null,e.refushDiaNum=null,e.taskdesc=null,e._level=0,e._parent=null,e._specialAward=[],e._normalAward=[],e._taskData=null,e._taskAward=[],e._passModel=null,e}return n(e,t),e.prototype.initLevelItemInfo=function(t,e){var i,a;if(!t)return this.titlenode.active=!0,this.levelinfonode.active=!1,this.levelNode.active=!0,void(this.taskNode.active=!1);this._passModel=r.default.getInstance().passModel,this.node.setContentSize(230,230),this.titlenode.active=!1,this.levelinfonode.active=!0,this._level=Number(t),this._parent=e,this.levelLab.string=t,this._passModel.lv>this._level?(this.upgress.active=!0,this.downgress.active=!0,this.levbgsp.spriteFrame=this.levbgspfr[1]):this._passModel.lv==this._level?(this.upgress.active=!0,this.downgress.active=!1,this.levbgsp.spriteFrame=this.levbgspfr[1]):(this.upgress.active=!1,this.downgress.active=!1,this.levbgsp.spriteFrame=this.levbgspfr[0]),this._specialAward=[],this._normalAward=[],this.levelNode.active=!0,this.taskNode.active=!1,this.initNormalAward(),this.initSpecialAward(),this.normalReceivedTip.active=!1,this.normalCanReceived.active=!1,this.specialCanReceived.active=!1,this.specialReceivedTip.active=!1,this.specialVideoNode.node.active=!1;var n=this._passModel.receiveData[this._level];if(this._passModel.lv>=this._level){var o=null!==(i=n.isSpecialReceive)&&void 0!==i&&i;this.specialVideoNode.node.active=!o,this.specialReceivedTip.active=o,o||this.initSpecialAwardCount();var s=null!==(a=n.isNormalReceive)&&void 0!==a&&a;this.normalReceivedTip.active=s,this.normalCanReceived.active=!s}},e.prototype.initNormalAward=function(){this.lowerLay.removeAllChildren();var t=s.default.getInstance().mstActivity.pass.config.lvData[this._level],e=t.normalRewardItems,i=!1;this._passModel.lv<this._level&&(i=!0);for(var a=0,n=0;n<e.length;n++)a<2&&(this.initItemUI(e[n],1,this.lowerLay,1,i),this._normalAward.push({id:e[n],num:1})),a++;if(a<2){var o=u.default.rewardResToObj(t.normalRewardRes);for(var r in o)a<2&&(this.initItemUI(Number(r),o[r],this.lowerLay,1,i),this._normalAward.push({id:Number(r),num:o[r]})),a++}},e.prototype.initSpecialAward=function(){this.hightLay.removeAllChildren();var t=s.default.getInstance().mstActivity.pass.config.lvData[this._level],e=t.specialRewardItems,i=!1;this._passModel.lv<this._level&&(i=!0);for(var a=0,n=0;n<e.length;n++)a<2&&(this.initItemUI(e[n],1,this.hightLay,2,i),this._specialAward.push({id:e[n],num:1})),a++;if(a<2){var o=u.default.rewardResToObj(t.specialRewardRes);for(var r in o)a<2&&(this.initItemUI(Number(r),o[r],this.hightLay,2,i),this._specialAward.push({id:Number(r),num:o[r]})),a++}},e.prototype.initSpecialAwardCount=function(){var t=this._passModel.receiveData[this._level]?this._passModel.receiveData[this._level].videoTimes:0,e=this._passModel.config.lvData[this._level].specialVideoTimes;this.specialVideoTimes.string="("+t+"/"+e+")"},e.prototype.initItemUI=function(t,e,i,a,n){var o=cc.instantiate(this.awardItem);o.getComponent(v.default).initItem(t,e,a,n),i.addChild(o)},e.prototype.onGetLowerAward=function(){f.default.trackEvent("pass_receive_normal_reward",{level:""+this._level}),r.default.getInstance().passModel.getReward(this._level)&&(d.default.getInstance().openUI(g.default,{data:this._normalAward}),this.normalCanReceived.active=!1,this.normalReceivedTip.active=!0,this._parent.refreshLevelRed(),cc.director.getScene().emit(p.default.UPDATE_ACTIVITY))},e.prototype.onGetHightAward=function(){var t=this;this._level>this._passModel.receiveSpecialLv+1?d.default.getInstance().openUI(l.default,{data:{str:_.default.t("childrenDayGiftPopup_5")}}):(f.default.trackEvent("pass_receive_special_reward",{level:""+this._level}),c.default.getInstance().showRewardAd(function(){r.default.getInstance().passModel.addVideoTimes(t._level)?(d.default.getInstance().openUI(g.default,{data:t._specialAward}),t.specialVideoNode.node.active=!1,t.specialReceivedTip.active=!0,t._parent.refreshLevelRed(),cc.director.getScene().emit(p.default.UPDATE_ACTIVITY)):t.initSpecialAwardCount()},function(){},function(){}))},e.prototype.initTaskItemInfo=function(t,e){this.levelNode.active=!1,this.taskNode.active=!0,this._taskData=t,this._parent=e,this._taskAward=[],this.node.setContentSize(200,200),this.initNeedItems(),this.initTaskAwardItems()},e.prototype.initNeedItems=function(){if(this._taskData){this.taskNeedNode.removeAllChildren();var t=this._taskData.requireItems,e=this._taskData.isReceived;if(this.btnTaskRefresh.node.active=this._taskData.mstData.isRefresh,this._taskData.mstData.refreshDiamonds>0?(this.refushVideo.active=!1,this.refushDiamonds.active=!0,this.refushDiaNum.string="x"+this._taskData.mstData.refreshDiamonds+" "+_.default.t("refresh")):(this.refushVideo.active=!0,this.refushDiamonds.active=!1),t.length>0){this.btnTaskRefresh.node.active=this._taskData.mstData.isRefresh,this.taskdesc.string=_.default.t("happyBingoSubmitPopup_2");for(var i=r.default.getInstance().getNormalItemIndexByIds(t),a=0;a<t.length;a++){var n=e||i[a]>0;(o=cc.instantiate(this.awardItem)).getComponent(v.default).initNeedItem(t[a],0,"",n),this.taskNeedNode.addChild(o)}}else{this.btnTaskRefresh.node.active=!1;var o,s=this._taskData.mstData;(o=cc.instantiate(this.awardItem)).getComponent(v.default).initNeedItem(-1,s.requireItems[0],s.key1,!1),this.taskNeedNode.addChild(o),"video"==s.key1?this.taskdesc.string=_.default.t("passItem_2",{times:s.requireItems[0]}):"merge"==s.key1&&(this.taskdesc.string=_.default.t("passItem_3",{times:s.requireItems[0]}))}e?(this.btnTaskRefresh.node.active=!1,this.taskReceviedNode.active=!0,this.btnGetTaskAward.active=!1,this.btnGoComplete.active=!1):(this.taskReceviedNode.active=!1,this._taskData.isComplete?(this.btnGetTaskAward.active=!0,this.btnGoComplete.active=!1):(this.btnGetTaskAward.active=!1,this.btnGoComplete.active=!0))}},e.prototype.initTaskAwardItems=function(){if(this._taskData){this.taskAwardNode.removeAllChildren();var t=this._taskData.mstData;this._taskData.requireItems.length>0&&(this.initItemUI(30093,this._taskData.coins,this.taskAwardNode,0,!1),this._taskAward.push({id:30093,num:this._taskData.coins}));var e=u.default.rewardResToObj(t.rewardRes);for(var i in e)this.initItemUI(Number(i),e[i],this.taskAwardNode,0,!1),this._taskAward.push({id:Number(i),num:e[i]})}},e.prototype.onGetTaskAward=function(){var t=this;f.default.trackEvent("pass_task_complete",{taskId:""+this._taskData.id});var e=r.default.getInstance().passModel,i=e.exp,a=e.lv,n=this._taskData.completeTask();if(n){for(var o=0;o<this._taskAward.length;o++){var s={};s.id=this._taskAward[o].id,s.startNode=this.node,s.num=this._taskAward[o].num,s.moveSpeed=1e3,30095==s.id&&(s.endNode=this._parent.levelIcon,s.callback=function(){cc.isValid(t)&&t._parent.showPassExpAni(i,a)}),cc.director.getScene().emit(p.default.ITEM_FLY,s)}r.default.getInstance().updateTaskAndItem(),this._parent.refreshTaskRed(),this._parent.refreshLevelRed(),this._parent.refreshTaskList(),cc.director.getScene().emit(p.default.UPDATE_ACTIVITY),cc.director.getScene().emit(p.default.UPDATE_MERGEAREA,n.cells)}},e.prototype.onGoComplete=function(){this._taskData&&("video"==this._taskData.mstData.key1?(d.default.getInstance().openUI(m.default,{data:{key:"resource",type:1}}),this._parent.goMerge()):(cc.director.getScene().emit(p.default.CLOSE_SCENE),this._parent.goMerge()))},e.prototype.onClickRefresh=function(){var t=this;if(this._taskData){var e=function(){var e=t._taskData.refreshRequireItems();if(1==e)r.default.getInstance().updateTaskAndItem(),cc.director.getScene().emit(p.default.UPDATE_MERGEAREA),cc.director.getScene().emit(p.default.UPDATE_TOPINFO),t._taskAward=[],t.initNeedItems(),t.initTaskAwardItems(),t._parent.updateRewardCD();else if(-2===e)u.default.noDiamondsCommonPopup();else{var i={str:_.default.t("taskCustomerItem_2")};d.default.getInstance().openUI(l.default,{data:i})}};this._taskData.mstData.refreshDiamonds>0?e():c.default.getInstance().showRewardAd(e,function(){},function(){})}},e.prototype.refushVideoCD=function(){var t;this.specialVideoNode.node.active&&((t=c.default.getInstance().rewardAdCd)>0?(this.specialVideoNode.interactable=!1,u.default.setBtnIsGrey(this.specialVideoNode),this.lbPrice.string=u.default.formatDateTimeHourEx(t)):(this.specialVideoNode.interactable=!0,u.default.setBtnIsGrey(this.specialVideoNode,new cc.Color(64,98,35)),this.lbPrice.string=_.default.t("receive"))),this.btnTaskRefresh.node.active&&this.refushVideo.active&&((t=c.default.getInstance().rewardAdCd)>0?(this.btnTaskRefresh.interactable=!1,u.default.setBtnIsGrey(this.btnTaskRefresh),this.lbRefush.string=u.default.formatDateTimeHourEx(t)):(this.btnTaskRefresh.interactable=!0,u.default.setBtnIsGrey(this.btnTaskRefresh,new cc.Color(64,98,35)),this.lbRefush.string=_.default.t("refresh")))},o([b(cc.Label)],e.prototype,"levelLab",void 0),o([b(cc.Prefab)],e.prototype,"awardItem",void 0),o([b(cc.Sprite)],e.prototype,"levbgsp",void 0),o([b([cc.SpriteFrame])],e.prototype,"levbgspfr",void 0),o([b(cc.Node)],e.prototype,"hightLay",void 0),o([b(cc.Node)],e.prototype,"lowerLay",void 0),o([b(cc.Node)],e.prototype,"specialReceivedTip",void 0),o([b(cc.Node)],e.prototype,"specialCanReceived",void 0),o([b(cc.Button)],e.prototype,"specialVideoNode",void 0),o([b(cc.Label)],e.prototype,"lbPrice",void 0),o([b(cc.Label)],e.prototype,"specialVideoTimes",void 0),o([b(cc.Node)],e.prototype,"normalReceivedTip",void 0),o([b(cc.Node)],e.prototype,"normalCanReceived",void 0),o([b(cc.Node)],e.prototype,"levelNode",void 0),o([b(cc.Node)],e.prototype,"upgress",void 0),o([b(cc.Node)],e.prototype,"downgress",void 0),o([b(cc.Node)],e.prototype,"taskNode",void 0),o([b(cc.Node)],e.prototype,"taskNeedNode",void 0),o([b(cc.Node)],e.prototype,"taskAwardNode",void 0),o([b(cc.Node)],e.prototype,"taskReceviedNode",void 0),o([b(cc.Node)],e.prototype,"btnGetTaskAward",void 0),o([b(cc.Node)],e.prototype,"btnGoComplete",void 0),o([b(cc.Node)],e.prototype,"titlenode",void 0),o([b(cc.Node)],e.prototype,"levelinfonode",void 0),o([b(cc.Button)],e.prototype,"btnTaskRefresh",void 0),o([b(cc.Label)],e.prototype,"lbRefush",void 0),o([b(cc.Node)],e.prototype,"refushVideo",void 0),o([b(cc.Node)],e.prototype,"refushDiamonds",void 0),o([b(cc.Label)],e.prototype,"refushDiaNum",void 0),o([b(cc.Label)],e.prototype,"taskdesc",void 0),o([I],e)}(h.default);i.default=N,cc._RF.pop()},{"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/Toast":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../../scripts/utils/StatisticsManager":void 0,"../extension/ListItem":"ListItem","../prefabs/AwardPopup":"AwardPopup","../prefabs/ShopPopup":"ShopPopup","./PassAwardItem":"PassAwardItem"}],PassPopup:[function(t,e,i){"use strict";cc._RF.push(e,"1a407n5Tl9B5bbW+djnVcEf","PassPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MstData"),c=t("../../scripts/data/UserData"),d=t("../../scripts/manager/UIManager"),l=t("../../scripts/utils/EventName"),p=t("../../scripts/utils/GlobalFun"),u=t("../../scripts/utils/StatisticsManager"),f=t("../entitys/PassItem"),h=t("../extension/List"),g=cc._decorator,m=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.listElement=null,e.levelRed=null,e.taskRed=null,e.timeBg=null,e.videoIcon=null,e.expGress=null,e.levelLab=null,e.expLab=null,e.timeLab=null,e.levelIcon=null,e.specialLab=null,e._passLv=null,e._taskList=null,e._atlasFlag=0,e._isExpAniFinished=!0,e._passModel=null,e}return n(e,t),e.prototype.init=function(t){void 0===t&&(t=0),this._passModel=c.default.getInstance().passModel,this.refreshPassData(),this._atlasFlag=t,this._passLv=Object.keys(r.default.getInstance().mstActivity.pass.config.lvData),this._passLv.unshift(null),this._taskList=c.default.getInstance().passModel.taskData},e.prototype.refreshPassData=function(){this.levelLab.string=this._passModel.lv+"";var t=this._passModel.config.lvData;this.expLab.string=this._passModel.exp+"/"+t[this._passModel.lv].exp,this.expGress.progress=this._passModel.exp/t[this._passModel.lv].exp},e.prototype.updateExpAnimation=function(t,e,i,a,n,o){var s=this,c=r.default.getInstance().mstActivity.pass.config.lvData,d=cc.tween(t).call(function(){var t=function(){if(a==n){var r=c[n].exp,d={a:i};cc.tween(d).to(.5,{a:e},{progress:function(t,e,i,a){var n=Math.round(t+(e-t)*a);return cc.isValid(s)&&(s.expLab.string=n+"/"+r,s.expGress.progress=n/r),t+(e-t)*a}}).call(o).start()}else if(a>n){var l=c[n].exp;d={a:i},cc.tween(d).to(.5,{a:l},{progress:function(t,e,i,a){var n=Math.round(t+(e-t)*a);return cc.isValid(s)&&(s.expLab.string=n+"/"+l,s.expGress.progress=n/l),t+(e-t)*a}}).call(function(){i=0,n++,cc.isValid(s)&&(s.levelLab.string=n+""),t()}).start()}};t()}),l=cc.tween(t).to(.5,{scale:1.2}).to(.5,{scale:1});return cc.tween(t).parallel(l,d).start()},e.prototype.showPassExpAni=function(t,e){var i=this,a=c.default.getInstance().passModel,n=a.exp,o=a.lv;if(o!=e||n!=t)if(this._isExpAniFinished)this._isExpAniFinished=!1,this.updateExpAnimation(this.expGress.node,n,t,o,e,function(){cc.isValid(i)&&(i._isExpAniFinished=!0,i.refreshPassData())});else{cc.tween(this.expGress.node).stop(),e=parseInt(this.levelLab.string);var s=this.expLab.string,r=s.indexOf("/");t=parseInt(s.slice(0,r)),this.updateExpAnimation(this.expGress.node,n,t,o,e,function(){e=o,t=n,cc.isValid(i)&&(i._isExpAniFinished=!0,i.refreshPassData())})}},e.prototype.itemElementRender=function(t,e){0==this._atlasFlag?t.getComponent(f.default).initLevelItemInfo(this._passLv[e],this):1==this._atlasFlag&&t.getComponent(f.default).initTaskItemInfo(this._taskList[e],this)},e.prototype.onLevelChecked=function(t){t.isChecked&&0!=this._atlasFlag&&(this._atlasFlag=0,this.onRefreshList())},e.prototype.onTaskChecked=function(t){t.isChecked&&1!=this._atlasFlag&&(this._atlasFlag=1,this.onRefreshList())},e.prototype.onRefreshList=function(){var t=this,e=0;if(0==this._atlasFlag){this.listElement.numItems=this._passLv.length,this.listElement.node.getComponent(cc.ScrollView).stopAutoScroll();for(var i=c.default.getInstance().passModel,a=1;a<this._passLv.length;a++){var n=i.receiveData[this._passLv[a]];if((!n||!n.special)&&this._passModel.isActive&&i.receiveSpecialLv<=this._passLv[a]){e=a;break}if((!n||!n.normal)&&i.receiveNormallLv<=this._passLv[a]){e=a;break}}1==e&&(e=0)}else if(1==this._atlasFlag)for(this.listElement.numItems=this._taskList.length,this.listElement.node.getComponent(cc.ScrollView).stopAutoScroll(),a=0;a<this._taskList.length;a++)if(!this._taskList[a].isReceived&&this._taskList[a].isComplete){e=a;break}setTimeout(function(){t.listElement.scrollTo(e)})},e.prototype.refreshTaskList=function(){this.listElement.numItems=this._taskList.length,this.listElement.node.getComponent(cc.ScrollView).stopAutoScroll()},e.prototype.onLookVideo=function(){},e.prototype.refreshLevelRed=function(){this.updateRewardCD();var t=c.default.getInstance().passModel.isHavePassAward();this.levelRed.active=!!t},e.prototype.refreshTaskRed=function(){var t=c.default.getInstance().passModel.isHavePassTaskAward();this.taskRed.active=!!t},e.prototype.goMerge=function(){d.default.getInstance().closeUI(this.tag)},e.prototype.updateBySecond=function(){var t=Math.ceil(this._passModel.endTime-window.serverTime);t<0&&(this._passModel.resetData(),this.refreshNextData()),t>=0&&(this.timeLab.string=p.default.timeFormat(t)),this.updateRewardCD()},e.prototype.updateRewardCD=function(){for(var t=this.listElement.content.children,e=0;e<t.length;e++)t[e].getComponent(f.default).refushVideoCD()},e.prototype.refreshNextData=function(){this.init(this._atlasFlag),this.onRefreshList(),this.refreshLevelRed(),this.refreshTaskRed()},e.prototype.onLoad=function(){u.default.trackEvent("pass_open"),this.refreshLevelRed(),this.refreshTaskRed(),this.onRefreshList(),this.updateBySecond(),cc.director.getScene().on(l.default.UPDATE_BY_SECOND,this.updateBySecond,this),cc.director.getScene().on(l.default.NEW_DAY,this.refreshNextData,this)},e.uiName="PassPopup",o([v(h.default)],e.prototype,"listElement",void 0),o([v(cc.Node)],e.prototype,"levelRed",void 0),o([v(cc.Node)],e.prototype,"taskRed",void 0),o([v(cc.Node)],e.prototype,"timeBg",void 0),o([v(cc.Node)],e.prototype,"videoIcon",void 0),o([v(cc.ProgressBar)],e.prototype,"expGress",void 0),o([v(cc.Label)],e.prototype,"levelLab",void 0),o([v(cc.Label)],e.prototype,"expLab",void 0),o([v(cc.Label)],e.prototype,"timeLab",void 0),o([v(cc.Node)],e.prototype,"levelIcon",void 0),o([v(cc.Label)],e.prototype,"specialLab",void 0),o([m],e)}(s.default);i.default=_,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../../scripts/utils/StatisticsManager":void 0,"../entitys/PassItem":"PassItem","../extension/List":"List"}],PlayerGroupPopup:[function(t,e,i){"use strict";cc._RF.push(e,"0b6afjIqWpL0rTv9Xa6uMxO","PlayerGroupPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/manager/AdManager"),c=t("../../scripts/manager/SDKManager"),d=t("../../scripts/manager/UIManager"),l=t("../../scripts/prefabs/Loading"),p=t("../../scripts/utils/AppConfig"),u=t("../../scripts/utils/StatisticsManager"),f=cc._decorator,h=f.ccclass,g=f.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemIcon=null,e}return n(e,t),e.prototype.init=function(){r.default.getInstance().showBanner()},e.prototype.onLoad=function(){var t=this;u.default.trackEvent("setting_open");var e=p.default.WX_GROUP_PATH+"groupImg.png?t="+(new Date).getTime();d.default.getInstance().openUI(l.default,{data:{showBlack:!0}},function(){cc.assetManager.loadRemote(e,function(e,i){var a=new cc.SpriteFrame(i);a&&(t.itemIcon.spriteFrame=a,d.default.getInstance().closeUI("Loading"))})})},e.prototype.onCopeClick=function(){c.default.getInstance().setClipboardData("638672350")},e.prototype.onDestroy=function(){r.default.getInstance().hideBanner()},e.uiName="PlayerGroupPopup",o([g(cc.Sprite)],e.prototype,"itemIcon",void 0),o([h],e)}(s.default);i.default=m,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/SDKManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/Loading":void 0,"../../scripts/utils/AppConfig":void 0,"../../scripts/utils/StatisticsManager":void 0}],RankItem:[function(t,e,i){"use strict";cc._RF.push(e,"f9213s585NCSL0UXuq6anhr","RankItem");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/UserData"),r=t("../../scripts/manager/SDKManager"),c=t("./ItemEntity"),d=t("../../scripts/extension/LanguageData"),l=cc._decorator,p=l.ccclass,u=l.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rankSpf=[],e.iconSpf=[],e.headBoxSpf=[],e.bgSpf=[],e.scorebgSpf=[],e.defaultHeadSpf=null,e.bgSp=null,e.rankLab=null,e.nameLab=null,e.numLab=null,e.headSp=null,e.boxSp=null,e.iconSp=null,e.rankSp=null,e.rewardNode=null,e.scoreNode=null,e.rwardNode=null,e.tipNode=null,e._realName="",e}return n(e,t),e.prototype.initUI=function(t,e,i,a){var n,o=this;if(n=e.name&&e.name.length>0?e.name.length>6?e.name.substr(0,5)+"...":e.name:e.displayId,this.bgSp.spriteFrame=i==a?this.bgSpf[1]:this.bgSpf[0],this.scoreNode.getComponent(cc.Sprite).spriteFrame=i==a?this.scorebgSpf[1]:this.scorebgSpf[0],this.nameLab.string=n,this.rankLab.string=i>100?"100+":+i+"",this.numLab.string=0==t?d.default.t("lv")+e.score:e.score,this.boxSp.spriteFrame=i>3?null:this.headBoxSpf[i-1],this.rankSp.spriteFrame=i>3?this.rankSpf[3]:this.rankSpf[i-1],this.iconSp.spriteFrame=this.iconSpf[t],this.tipNode.active=i>100,i>3?this.rankLab.node.setPosition(cc.v2(-368,6)):this.rankLab.node.setPosition(cc.v2(-368,18)),2==t){this.scoreNode.setPosition(cc.v2(67,0)),this.scoreNode.children[0].scale=.8,this.scoreNode.width=230,this.nameLab.fontSize=35,this.rewardNode.active=!0;var l=s.default.getInstance().rankModel.getRankRewardByIndex(i);if(0==l.length)this.rwardNode.active=!1;else{this.rwardNode.active=!0;var p={};p.itemId=l[0],p.isClickAble=!0,p.itemNum=l[1],p.numOffset=cc.v2(-10,0),this.rwardNode.getComponent(c.default).init(p)}}else this.scoreNode.setPosition(cc.v2(132,0)),this.scoreNode.children[0].scale=1,this.scoreNode.width=285,this.nameLab.fontSize=46,this.rewardNode.active=!1;this._realName=e.name,e.photo&&e.photo.length>0?r.default.getInstance().createImage(e.photo,function(t){if(o._realName==e.name&&cc.isValid(o.node)&&t){var i=new cc.Texture2D;i.initWithElement(t),i.handleLoadedTexture(),o.headSp.spriteFrame=new cc.SpriteFrame(i)}}):this.headSp.spriteFrame=this.defaultHeadSpf},o([u([cc.SpriteFrame])],e.prototype,"rankSpf",void 0),o([u([cc.SpriteFrame])],e.prototype,"iconSpf",void 0),o([u([cc.SpriteFrame])],e.prototype,"headBoxSpf",void 0),o([u([cc.SpriteFrame])],e.prototype,"bgSpf",void 0),o([u([cc.SpriteFrame])],e.prototype,"scorebgSpf",void 0),o([u(cc.SpriteFrame)],e.prototype,"defaultHeadSpf",void 0),o([u(cc.Sprite)],e.prototype,"bgSp",void 0),o([u(cc.Label)],e.prototype,"rankLab",void 0),o([u(cc.Label)],e.prototype,"nameLab",void 0),o([u(cc.Label)],e.prototype,"numLab",void 0),o([u(cc.Sprite)],e.prototype,"headSp",void 0),o([u(cc.Sprite)],e.prototype,"boxSp",void 0),o([u(cc.Sprite)],e.prototype,"iconSp",void 0),o([u(cc.Sprite)],e.prototype,"rankSp",void 0),o([u(cc.Node)],e.prototype,"rewardNode",void 0),o([u(cc.Node)],e.prototype,"scoreNode",void 0),o([u(cc.Node)],e.prototype,"rwardNode",void 0),o([u(cc.Node)],e.prototype,"tipNode",void 0),o([p],e)}(cc.Component);i.default=f,cc._RF.pop()},{"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/SDKManager":void 0,"./ItemEntity":"ItemEntity"}],RankPopup:[function(t,e,i){"use strict";cc._RF.push(e,"9d0cdq/JSpJd7PDpxX8N3c5","RankPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/UserData"),c=t("../../scripts/manager/SDKManager"),d=t("../../scripts/manager/UIManager"),l=t("../../scripts/prefabs/Loading"),p=t("../../scripts/utils/Api"),u=t("../../scripts/utils/AppConfig"),f=t("../../scripts/utils/ChannelHelper"),h=t("../../scripts/utils/EventName"),g=t("../../scripts/utils/GlobalFun"),m=t("../entitys/RankItem"),v=t("../extension/List"),_=t("./HelpCommonPopup"),y=t("../../scripts/extension/LanguageData"),I=cc._decorator,b=I.ccclass,N=I.property,C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.contentList=null,e.openDataNode=null,e.timeLab=null,e.bigToggleNode=null,e.smallToggleNode=null,e.timeNode=null,e.selfInfoNode=null,e.tipNode=null,e.updateTipNode=null,e._titleType=["lvWorld","skinWorld","saleWorld"],e._chooseSmallType=0,e._chooseBigType=0,e._rankModel=null,e._rankData={},e._lastTime=0,e._myRank=0,e._authSetting=!1,e._isLoading=!1,e}return n(e,t),e.prototype.init=function(){this._chooseBigType=0,this._chooseSmallType=0,this._lastTime=g.default.getTodayLastTime()},e.prototype.onClickBigRadioGrp=function(t){this._chooseBigType=+t.checkEvents[0].customEventData,this.checkTab(this._chooseBigType,0)},e.prototype.onClickSmallRadio=function(t){this._chooseSmallType=+t.checkEvents[0].customEventData,this.updateContent(),this.contentList.node.getComponent(cc.ScrollView).stopAutoScroll(),this.contentList.scrollTo(0)},e.prototype.checkTab=function(t,e){this._chooseBigType=t,this._chooseSmallType=e,this.bigToggleNode.children[t].getComponent(cc.Toggle).check(),this.smallToggleNode.children[e].getComponent(cc.Toggle).check(),this.updateContent(),this.contentList.node.getComponent(cc.ScrollView).stopAutoScroll(),this.contentList.scrollTo(0)},e.prototype.updateContent=function(){var t=this;if(1==this._chooseBigType){this.openDataNode.opacity=255,this.openDataNode.active=!0;var e=g.default.getDateByYMD();c.default.getInstance().postMessage({index:this._chooseSmallType,time:e}),this.selfInfoNode.active=!1,this.tipNode.active=!1}else{this.openDataNode.active=!1;var i=this._titleType[this._chooseSmallType];this.getRankByType(i,function(e){i==t._titleType[t._chooseSmallType]&&(t.initSelfUI(e),t.initContentUI(e))})}this.timeNode.active=2==this._chooseSmallType,this.updateTipNode.active=2!=this._chooseSmallType},e.prototype.initContentUI=function(t){var e=t.rankData,i=Object.keys(e).length;this.contentList.numItems=i,this.tipNode.active=0==i},e.prototype.initSelfUI=function(t){this._myRank=this.getMyRank(t),this.selfInfoNode.active=!0;var e=this._authSetting?r.default.getInstance().name:y.default.t("rankPopup_1"),i=this._authSetting?r.default.getInstance().photo:"",a={name:e,score:this._rankModel.getMyDataByType(this._chooseSmallType),photo:i};this.selfInfoNode.getComponent(m.default).initUI(this._chooseSmallType,a,t.myRank,t.myRank)},e.prototype.getMyRank=function(t){if(t.myRank)return t.myRank;for(var e in t.rankData)if(t.rankData[e].displayId==r.default.getInstance().id){var i=+e;return t.myRank=i,i}return t.myRank=999,999},e.prototype.contentItemElementRender=function(t,e){var i=e+1,a=this._titleType[this._chooseSmallType],n=this._rankData[a].rankData[i];t.getComponent(m.default).initUI(this._chooseSmallType,n,i,this._myRank)},e.prototype.getRankByType=function(t,e){var i=this;if(this._rankData[t])e&&e(this._rankData[t]);else{var a=function(){p.default.rank.send({type:"getRank",para:JSON.stringify({type:t})},function(a){a&&a.rankData&&(i._rankData[t]=a,e&&e(a)),d.default.getInstance().closeUI(l.default),i._isLoading=!1},function(){d.default.getInstance().closeUI(l.default),i._isLoading=!1})};this._isLoading?a():d.default.getInstance().openUI(l.default,{data:{showBlack:!0}},function(){a()})}},Object.defineProperty(e.prototype,"chooseIndex",{get:function(){return this._chooseSmallType},enumerable:!1,configurable:!0}),e.prototype.updateBySecond=function(){var t=Math.ceil(this._lastTime-window.serverTime);if(t>=0){var e=g.default.timeFormat(t);this.timeLab.string=e}},e.prototype.refushNewDay=function(){1==this._chooseSmallType&&this.updateContent(),this._lastTime=g.default.getTodayLastTime()},e.prototype.onClickHelp=function(){var t={contentText:[y.default.t("rankPopup_2"),y.default.t("rankPopup_3"),y.default.t("rankPopup_4"),y.default.t("rankPopup_5")]};d.default.getInstance().openUI(_.default,{data:t})},e.prototype.onClickShare=function(){var t=y.default.t("rankPopup_6"),e=u.default.WX_SHARE_PATH+"share2.jpg";c.default.getInstance().shareAppMessage(t,e,null,null,null)},e.prototype.onLoad=function(){var t=this;this.timeNode.active=2==this._chooseSmallType,this.selfInfoNode.active=!1,this.tipNode.active=!1,this.updateBySecond(),this._rankModel=r.default.getInstance().rankModel,cc.director.getScene().on(h.default.NEW_DAY,this.refushNewDay,this),cc.director.getScene().on(h.default.UPDATE_BY_SECOND,this.updateBySecond,this),d.default.getInstance().openUI(l.default,{data:{showBlack:!0}},function(){t._isLoading=!0,t._rankModel.saveAllScore(function(){t.checkTab(0,0)})}),c.default.getInstance().getUserInfoOnRank(function(e){void 0===e&&(e=null),t.node&&cc.isValid(t.node)&&(e&&e.nickName?(t._authSetting=!0,t.saveUserInfo(e.nickName,e.avatarUrl)):t.saveUserInfo("",""))},function(){t.node&&cc.isValid(t.node)&&t.saveUserInfo("","")}),"wx"!=f.default.getChannel()&&this.saveUserInfo("","")},e.prototype.saveUserInfo=function(t,e){var i=this;this._rankModel.saveUserInfo(t,e,function(){if(i.node&&cc.isValid(i.node)){var t=i._rankData[i._titleType[i._chooseSmallType]];t&&i.initSelfUI(t)}})},e.uiName="RankPopup",o([N(v.default)],e.prototype,"contentList",void 0),o([N(cc.Node)],e.prototype,"openDataNode",void 0),o([N(cc.Label)],e.prototype,"timeLab",void 0),o([N(cc.Node)],e.prototype,"bigToggleNode",void 0),o([N(cc.Node)],e.prototype,"smallToggleNode",void 0),o([N(cc.Node)],e.prototype,"timeNode",void 0),o([N(cc.Node)],e.prototype,"selfInfoNode",void 0),o([N(cc.Node)],e.prototype,"tipNode",void 0),o([N(cc.Node)],e.prototype,"updateTipNode",void 0),o([b],e)}(s.default);i.default=C,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/SDKManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/Loading":void 0,"../../scripts/utils/Api":void 0,"../../scripts/utils/AppConfig":void 0,"../../scripts/utils/ChannelHelper":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../entitys/RankItem":"RankItem","../extension/List":"List","./HelpCommonPopup":"HelpCommonPopup"}],RoleSkinItem:[function(t,e,i){"use strict";cc._RF.push(e,"f8428vecMRE/LcE0OsKDfLm","RoleSkinItem");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/MstData"),r=t("../../scripts/data/UserData"),c=t("../../scripts/utils/GlobalFun"),d=t("../extension/ListItem"),l=t("../../scripts/extension/LanguageData"),p=cc._decorator,u=p.ccclass,f=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.roleNode=null,e.descLab=null,e.usedNode=null,e.hasedNode=null,e.xianding=null,e.itemBg=[],e.itemBgNode=null,e}return n(e,t),e.prototype.initItemInfo=function(t,e){var i=this,a=s.default.getInstance().mstRoleSkin[t],n=r.default.getInstance().roleData[e],o=a.name;n.isSkinUnlock(this.listId)?n.skinIdIndex==this.listId?(this.usedNode.active=!0,this.hasedNode.active=!1,this.descLab.node.active=!1,this.itemBgNode.spriteFrame=this.itemBg[2]):(this.usedNode.active=!1,this.hasedNode.active=!0,this.descLab.node.active=!1,this.itemBgNode.spriteFrame=this.itemBg[1]):(this.itemBgNode.spriteFrame=this.itemBg[0],this.usedNode.active=!1,this.hasedNode.active=!1,this.descLab.node.active=!0,"activity"==a.costType?this.descLab.string=a.skinDesc:"item"==a.costType?this.descLab.string=a.skinDesc:this.descLab.string=l.default.t("buildingSkinItem_1")),"activity"==a.costType?this.xianding.active=!0:this.xianding.active=!1,o&&c.default.loadSpriteFrame(this.roleNode,"textures/role/icon/icon_"+a.icon,function(){var t=i.roleNode.width>i.roleNode.height?i.roleNode.width:i.roleNode.height;i.roleNode.scale=150/t})},o([f(cc.Node)],e.prototype,"roleNode",void 0),o([f(cc.Label)],e.prototype,"descLab",void 0),o([f(cc.Node)],e.prototype,"usedNode",void 0),o([f(cc.Node)],e.prototype,"hasedNode",void 0),o([f(cc.Node)],e.prototype,"xianding",void 0),o([f([cc.SpriteFrame])],e.prototype,"itemBg",void 0),o([f(cc.Sprite)],e.prototype,"itemBgNode",void 0),o([u],e)}(d.default);i.default=h,cc._RF.pop()},{"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/utils/GlobalFun":void 0,"../extension/ListItem":"ListItem"}],SelfBlindBoxPopup:[function(t,e,i){"use strict";cc._RF.push(e,"e29ee6RV3ZDbYUhLyNJYwB/","SelfBlindBoxPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MstData"),c=t("../../scripts/data/UserData"),d=t("../../scripts/manager/AdManager"),l=t("../../scripts/manager/SDKManager"),p=t("../../scripts/manager/UIManager"),u=t("../../scripts/utils/AppConfig"),f=t("../../scripts/utils/EventName"),h=t("../../scripts/utils/GlobalFun"),g=t("../../scripts/utils/StatisticsManager"),m=t("../entitys/BlindBoxItem"),v=t("./AwardPopup"),_=t("./BlindBoxAwardPopup"),y=t("./PlayerGroupPopup"),I=t("../../scripts/extension/LanguageData"),b=cc._decorator,N=b.ccclass,C=b.property,k=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.boxPre=null,e.btnGetAward=null,e.btnShare=null,e.boxNode=null,e.press=null,e.refreshTime=null,e.openLab=null,e.diaAward=[],e.invitation=[],e.btnDiamonds=[],e.yilingqu=[],e._boxNodeList=null,e._openLen=0,e._selectIdx=0,e._selectItemID=null,e._seleccItemNum=null,e}return n(e,t),e.prototype.init=function(t){this.updateUI(t),this.updateBySecond(),h.default.isCanShowBanner()&&d.default.getInstance().showBanner()},e.prototype.refushNewDay=function(){this.updateUI([])},e.prototype.updateUI=function(t){var e=t;this._openLen=e.length,this._boxNodeList=[];for(var i=c.default.getInstance().blindBox.boxData,a=0;a<i.length;a++){var n;this.boxNode.children[a]?((n=this.boxNode.children[a]).getComponent(m.default).initItemData(i[a],a,e,this),this._boxNodeList.push(n)):((n=cc.instantiate(this.boxPre)).getComponent(m.default).initItemData(i[a],a,e,this),this.boxNode.addChild(n),this._boxNodeList.push(n))}c.default.getInstance().myOpenSelfBlindBox?(this.btnGetAward.active=!1,this.btnShare.active=!1):(this.btnGetAward.active=!0,this.btnGetAward.getChildByName("btnlab").getComponent(cc.LabelOutline).color=cc.color(116,116,116,255),this.btnGetAward.getComponent(cc.Button).interactable=!1,this.btnShare.active=!1),this.press.progress=this._openLen/i.length,this.openLab.string=this._openLen+"/"+i.length;var o=r.default.getInstance().mstActivity.blindBox.config;for(a=0;a<o.openCount.length;a++)this.diaAward[a].string=o.openCountRewardDiamonds[a],this.invitation[a].string=o.openCount[a],this._openLen>=o.openCount[a]&&!c.default.getInstance().blindBox.receiveOpenBox[a]?(this.btnDiamonds[a].active=!0,this.yilingqu[a].active=!1):(this.btnDiamonds[a].active=!1,c.default.getInstance().blindBox.receiveOpenBox[a]?this.yilingqu[a].active=!0:this.yilingqu[a].active=!1)},e.prototype.selectBox=function(t,e,i){if(!this.btnShare.active){this._selectItemID=t,this._selectIdx=i,this._seleccItemNum=e;for(var a=0;a<this._boxNodeList.length;a++)this._boxNodeList[a].getComponent(m.default).selectItem(i);this.btnGetAward.getChildByName("btnlab").getComponent(cc.LabelOutline).color=cc.color(64,98,35,255),this.btnGetAward.getComponent(cc.Button).interactable=!0}},e.prototype.getDiamondsAward=function(t){var e=r.default.getInstance().mstActivity.blindBox.config;if(c.default.getInstance().getBlindBoxDiamondsAward(t,e.openCountRewardDiamonds[t])){this.btnDiamonds[t].active=!1,this.yilingqu[t].active=!0;var i=[{id:30094,num:e.openCountRewardDiamonds[t]}];p.default.getInstance().openUI(v.default,{data:i}),cc.director.getScene().emit(f.default.UPDATE_TOPINFO)}},e.prototype.onGetDiamondsOne=function(){g.default.trackEvent("blindBox_receive_diamonds",{index:"1"}),this.getDiamondsAward(0)},e.prototype.onGetDiamondsTwo=function(){g.default.trackEvent("blindBox_receive_diamonds",{index:"2"}),this.getDiamondsAward(1)},e.prototype.onGetDiamondsThree=function(){g.default.trackEvent("blindBox_receive_diamonds",{index:"3"}),this.getDiamondsAward(2)},e.prototype.onGetBlindBoxClicked=function(){if(g.default.trackEvent("blindBox_receive_self"),c.default.getInstance().getSelfBlindBox(this._selectItemID,this._seleccItemNum,this._selectIdx+1)){for(var t=0;t<this._boxNodeList.length;t++)this._boxNodeList[t].getComponent(m.default).showOpenUI(this._selectIdx);var e=[{id:this._selectItemID,num:this._seleccItemNum}];p.default.getInstance().openUI(v.default,{data:e}),cc.director.getScene().emit(f.default.UPDATE_TOPINFO),this.btnGetAward.active=!1,this.btnShare.active=!0,this._openLen++,this.press.progress=this._openLen/c.default.getInstance().blindBox.boxData.length,this.openLab.string=this._openLen+"/"+c.default.getInstance().blindBox.boxData.length}},e.prototype.onShareClicked=function(){g.default.trackEvent("blindBox_share_click");var t=I.default.t("share_4"),e=u.default.WX_SHARE_PATH+"share4.jpg",i={type:"blindBox",uid:c.default.getInstance().id,boxData:JSON.stringify(c.default.getInstance().blindBox.boxData),shareTime:window.serverTime,receivedID:c.default.getInstance().myOpenSelfBlindBox},a=h.default.objToKeyValue(i);l.default.getInstance().shareAppMessage(t,e,a,function(){},null)},e.prototype.onClickAwards=function(){p.default.getInstance().openUI(_.default,{data:c.default.getInstance().blindBox.boxData})},e.prototype.updateBySecond=function(){var t=h.default.getDateByYMD(),e=(new Date(t).getTime()+864e5)/1e3-window.serverTime,i=h.default.formatDateTimeHourEx(e);this.refreshTime.string=I.default.t("selfBlindBoxPopup_1",{time:i})},e.prototype.onClickeShowPlayer=function(){p.default.getInstance().openUI(y.default)},e.prototype.onLoad=function(){g.default.trackEvent("blindBox_open"),cc.director.getScene().on(f.default.UPDATE_BY_SECOND,this.updateBySecond,this),cc.director.getScene().on(f.default.NEW_DAY,this.refushNewDay,this)},e.prototype.onDestroy=function(){h.default.isCanShowBanner()&&d.default.getInstance().hideBanner()},e.uiName="SelfBlindBoxPopup",o([C(cc.Prefab)],e.prototype,"boxPre",void 0),o([C(cc.Node)],e.prototype,"btnGetAward",void 0),o([C(cc.Node)],e.prototype,"btnShare",void 0),o([C(cc.Node)],e.prototype,"boxNode",void 0),o([C(cc.ProgressBar)],e.prototype,"press",void 0),o([C(cc.Label)],e.prototype,"refreshTime",void 0),o([C(cc.Label)],e.prototype,"openLab",void 0),o([C([cc.Label])],e.prototype,"diaAward",void 0),o([C([cc.Label])],e.prototype,"invitation",void 0),o([C([cc.Node])],e.prototype,"btnDiamonds",void 0),o([C([cc.Node])],e.prototype,"yilingqu",void 0),o([N],e)}(s.default);i.default=k,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/SDKManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/utils/AppConfig":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../../scripts/utils/StatisticsManager":void 0,"../entitys/BlindBoxItem":"BlindBoxItem","./AwardPopup":"AwardPopup","./BlindBoxAwardPopup":"BlindBoxAwardPopup","./PlayerGroupPopup":"PlayerGroupPopup"}],Setting:[function(t,e,i){"use strict";cc._RF.push(e,"e1b95OeGfxNUKpPDeNJxU7c","Setting");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/UserData"),c=t("../../scripts/manager/AdManager"),d=t("../../scripts/manager/AudioManager"),l=t("../../scripts/manager/SDKManager"),p=t("../../scripts/manager/UIManager"),u=t("../../scripts/prefabs/Toast"),f=t("../../scripts/utils/AppConfig"),h=t("../../scripts/utils/StatisticsManager"),g=t("./ExchangeCodePopup"),m=t("./HelpQuestionPopup"),v=t("./PlayerGroupPopup"),_=t("../../scripts/extension/LanguageData"),y=cc._decorator,I=y.ccclass,b=y.property,N=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.musicBtn=null,e.soundBtn=null,e.id=null,e.ver=null,e._musicSwitch=!1,e._soundSwitch=!1,e._closePos=-70,e._openPos=70,e._textClosePos=31,e._textOpenPos=-31,e}return n(e,t),e.prototype.init=function(){this._musicSwitch=d.default.getInstance().bgmSwitch,this._soundSwitch=d.default.getInstance().soundEffectSwitch,this.setMusicSwitch(),this.setSoundSwitch(),this.ver.string="ver:"+f.default.APP_VERSION;var t=r.default.getInstance().id;this.id.string="ID:"+t,c.default.getInstance().showBanner()},e.prototype.onLoad=function(){h.default.trackEvent("setting_open")},e.prototype.onMusicClick=function(){this._musicSwitch=!this._musicSwitch,d.default.getInstance().setBgmSwitch(this._musicSwitch),this._musicSwitch?d.default.getInstance().playBgm("bgm"):(d.default.getInstance().stopBgm(),h.default.trackEvent("setting_close_music")),this.setMusicSwitch()},e.prototype.onSoundClick=function(){this._soundSwitch=!this._soundSwitch,d.default.getInstance().setSoundEffectSwitch(this._soundSwitch),this.setSoundSwitch(),this._soundSwitch||h.default.trackEvent("setting_close_effect")},e.prototype.setMusicSwitch=function(){var t=this.musicBtn.node.getChildByName("sprite"),e=this.musicBtn.node.getChildByName("select"),i=this.musicBtn.node.getChildByName("text").getComponent(cc.Label);this._musicSwitch?(t.active=!0,e.x=this._openPos,i.string="ON",i.node.x=this._textOpenPos):(t.active=!1,e.x=this._closePos,i.string="OFF",i.node.x=this._textClosePos)},e.prototype.setSoundSwitch=function(){var t=this.soundBtn.node.getChildByName("sprite"),e=this.soundBtn.node.getChildByName("select"),i=this.soundBtn.node.getChildByName("text").getComponent(cc.Label);this._soundSwitch?(t.active=!0,e.x=this._openPos,i.string="ON",i.node.x=this._textOpenPos):(t.active=!1,e.x=this._closePos,i.string="OFF",i.node.x=this._textClosePos)},e.prototype.onClickeShowPlayer=function(){p.default.getInstance().openUI(v.default)},e.prototype.onClickeExchangeCode=function(){p.default.getInstance().openUI(g.default)},e.prototype.onClickeKefu=function(){l.default.getInstance().openKefu(1)},e.prototype.onClickHelp=function(){p.default.getInstance().openUI(m.default)},e.prototype.onClickSave=function(){r.default.getInstance().saveUserData(function(){var t=_.default.t("setting_1");p.default.getInstance().openUI(u.default,{data:{str:t}})},function(){var t=_.default.t("setting_2");p.default.getInstance().openUI(u.default,{data:{str:t}})})},e.prototype.onDestroy=function(){c.default.getInstance().hideBanner()},e.uiName="Setting",o([b(cc.Button)],e.prototype,"musicBtn",void 0),o([b(cc.Button)],e.prototype,"soundBtn",void 0),o([b(cc.Label)],e.prototype,"id",void 0),o([b(cc.Label)],e.prototype,"ver",void 0),o([I],e)}(s.default);i.default=N,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/AudioManager":void 0,"../../scripts/manager/SDKManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/Toast":void 0,"../../scripts/utils/AppConfig":void 0,"../../scripts/utils/StatisticsManager":void 0,"./ExchangeCodePopup":"ExchangeCodePopup","./HelpQuestionPopup":"HelpQuestionPopup","./PlayerGroupPopup":"PlayerGroupPopup"}],ShopItem:[function(t,e,i){"use strict";cc._RF.push(e,"16295vxO7hHY6TTXbJmvZ7H","ShopItem");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/MstData"),r=t("../../scripts/data/UserData"),c=t("../../scripts/manager/AdManager"),d=t("../../scripts/manager/UIManager"),l=t("../../scripts/prefabs/Toast"),p=t("../../scripts/utils/EventName"),u=t("../../scripts/utils/GlobalFun"),f=t("../../scripts/utils/StatisticsManager"),h=t("../prefabs/AwardPopup"),g=t("../prefabs/BuyTipPopup"),m=t("../prefabs/ItemChain"),v=t("../prefabs/ShopPopup"),_=t("./BottomInfoPrefab"),y=t("./BuildItem"),I=t("./ItemEntity"),b=t("../../scripts/extension/LanguageData"),N=cc._decorator,C=N.ccclass,k=N.property,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lbName=null,e.btnItemChain=null,e.lbLimit=null,e.btnPurchaseType=null,e.lbPrice=null,e.redPointNode=null,e.itemIcon=null,e.purchaseIcon=null,e.videoSPF=null,e.shareSPF=null,e.coinSPF=null,e.diamondsSPF=null,e.itemBg=null,e.goodsId=null,e.shopType="",e.shopConfig=null,e}return n(e,t),Object.defineProperty(e.prototype,"itemId",{get:function(){var t=-1;return"dailyGift"==this.shopType?t=this.shopConfig[this.goodsId].itemId:"goods"==this.shopType?t=this.goodsId:"prop"==this.shopType?t=this.shopConfig[this.goodsId].itemId:"box"==this.shopType?t=this.shopConfig[this.goodsId].itemId:"resource"==this.shopType?t=this.shopConfig[this.goodsId].itemId:"foodStore"==this.shopType?t=this.shopConfig[this.goodsId].itemId:"foodBuildingSkin"==this.shopType&&(t=this.shopConfig[this.goodsId].itemId),t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"purchaseType",{get:function(){var t="";return"dailyGift"==this.shopType?t=this.shopConfig[this.goodsId].costType:"goods"==this.shopType?t=this.shopConfig.costType:"prop"==this.shopType?t=this.shopConfig[this.goodsId].costType:"box"==this.shopType?t=this.shopConfig[this.goodsId].costType:"resource"==this.shopType?t=this.shopConfig[this.goodsId].costType:"foodStore"==this.shopType?t=this.shopConfig[this.goodsId].costType:"foodBuildingSkin"==this.shopType&&(t=this.shopConfig[this.goodsId].costType),t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"price",{get:function(){var t=100;if("dailyGift"==this.shopType)t=(i=this.shopConfig[this.goodsId]).costNum;else if("goods"==this.shopType)t=s.default.getInstance().mstItem[this.goodsId].diamondsPrice;else if("prop"==this.shopType)t=(i=this.shopConfig[this.goodsId]).costNum;else if("box"==this.shopType)t=(i=this.shopConfig[this.goodsId]).costNum;else if("resource"==this.shopType)if((i=this.shopConfig[this.goodsId]).addPrice>0){var e=r.default.getInstance().storeData[this.shopType][this.goodsId].times;t=e>0?i.costNum*Math.pow(i.addPrice,e):i.costNum}else t=i.costNum;else if("foodStore"==this.shopType)t=(i=this.shopConfig[this.goodsId]).costNum;else if("foodBuildingSkin"==this.shopType){var i;t=(i=this.shopConfig[this.goodsId]).costNum}return t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isFree",{get:function(){return 0==this.price},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"awardNum",{get:function(){var t=1;return"resource"==this.shopType?t=this.shopConfig[this.goodsId].itemNum:"foodBuildingSkin"==this.shopType&&(t=this.shopConfig[this.goodsId].itemNum),t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"residueTimes",{get:function(){var t=r.default.getInstance().storeData[this.shopType][this.goodsId].times;return("goods"==this.shopType?this.shopConfig.limitNum:this.shopConfig[this.goodsId].limitNum)-t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"buyCD",{get:function(){return c.default.getInstance().rewardAdCd},enumerable:!1,configurable:!0}),e.prototype.init=function(t,e){this.shopType=t,this.goodsId=e,this.shopConfig=s.default.getInstance().mstStore[this.shopType].config,this.updateUI()},e.prototype.updateUI=function(){var t=this,e=this.itemId,i=s.default.getInstance().mstItem[e];this.lbName.string=i.name;var a=u.default.getItemIconPathById(e);"goods"!=this.shopType&&this.shopConfig[this.goodsId].icon&&""!=this.shopConfig[this.goodsId].icon&&(a="textures/itemIcon/"+this.shopConfig[this.goodsId].icon);var n={};if(30098==e){var o=this.shopConfig[this.goodsId].itemNum,r=s.default.getInstance().mstBuildingSkin[o].nodeName;r&&(cc.resources.load("building/"+r,cc.Prefab,function(i,a){if(!i&&cc.isValid(t.btnItemChain)){var s=cc.instantiate(a);s.getComponent(y.default).initUnlockShow(130,130),n.iconNode=s,n.itemId=e,n.itemNum=o,n.itemBg=t.itemBg,n.isClickAble=!0,n.isShowInfo=!0,t.btnItemChain.getComponent(I.default).init(n)}}),this.lbName.string=s.default.getInstance().mstBuildingSkin[o].name)}else n.itemId=e,n.iconPath=a,n.itemBg=this.itemBg,n.isShowInfo=!0,n.isClickAble=!0,this.btnItemChain.getComponent(I.default).init(n);if(i.type.includes("Show")&&30098!=e&&(this.lbName.string+="x"+this.awardNum),this.residueTimes>0&&this.residueTimes<=10?(this.lbLimit.node.active=!0,this.lbLimit.string=b.default.t("shopItem_1",{times:this.residueTimes})):(this.lbLimit.node.active=!1,this.lbLimit.string=b.default.t("shopItem_1",{times:this.residueTimes})),this.btnPurchaseType.interactable=!(this.residueTimes<=0),this.redPointNode.active=!1,this.lbPrice.node.x=36.5,u.default.setBtnIsGrey(this.btnPurchaseType,new cc.Color(64,98,35)),this.residueTimes<=0)this.purchaseIcon.node.active=!1,this.lbPrice.string=b.default.t("shopItem_2"),this.lbPrice.node.x=0,u.default.setBtnIsGrey(this.btnPurchaseType);else if(this.isFree)this.purchaseIcon.node.active=!1,this.lbPrice.string=b.default.t("free"),this.lbPrice.node.x=0,this.residueTimes>0&&(this.redPointNode.active=!0);else if(this.purchaseIcon.enabled=!0,this.itemIcon.active=!1,"coins"==this.purchaseType)this.purchaseIcon.spriteFrame=this.coinSPF,this.lbPrice.string=""+this.price,this.purchaseIcon.node.active=!0;else if("diamonds"==this.purchaseType)this.purchaseIcon.spriteFrame=this.diamondsSPF,this.lbPrice.string=""+this.price,this.purchaseIcon.node.active=!0;else if("video"==this.purchaseType){this.purchaseIcon.spriteFrame=this.videoSPF,this.purchaseIcon.node.active=!0;var c=this.buyCD;c>0?(this.btnPurchaseType.interactable=!1,u.default.setBtnIsGrey(this.btnPurchaseType),this.lbPrice.string=u.default.formatDateTimeHourEx(c)):this.lbPrice.string=b.default.t("free")}else if("share"==this.purchaseType)this.purchaseIcon.spriteFrame=this.shareSPF,this.lbPrice.string=b.default.t("free"),this.purchaseIcon.node.active=!0;else if("pay"==this.purchaseType)this.purchaseIcon.node.active=!1,this.lbPrice.string="\uffe5"+this.price,this.lbPrice.node.x=0;else if("item"==this.purchaseType){this.purchaseIcon.enabled=!1,this.purchaseIcon.node.active=!0,this.itemIcon.active=!0;var d={};d.itemId=this.price,this.itemIcon.getComponent(I.default).init(d),this.itemIcon.scale=.5,this.lbPrice.string="1"}},e.prototype.onClickItem=function(){30092!=this.itemId&&30093!=this.itemId&&30094!=this.itemId&&d.default.getInstance().openUI(m.default,{data:this.itemId})},e.prototype.onClickPurchase=function(){var t=this,e=r.default.getInstance().storeData,i=!1,a={id:this.itemId,num:this.awardNum};30098==this.itemId&&(a={id:30098,num:this.awardNum});var n=function(){if(i="goods"==t.shopType?e.buyGoods(t.goodsId):e.buyItem(t.shopType,t.goodsId)){i&&f.default.trackEvent("shop_"+t.shopType+"_buy",{goodsId:t.goodsId+""}),"foodBuildingSkin"==t.shopType&&(r.default.getInstance().updateTaskAndItem(),cc.director.getScene().emit(p.default.UPDATE_MERGEAREA,[i]));var n="all";"video"!=t.purchaseType&&(n=t.purchaseType,cc.director.getScene().emit(p.default.UPDATE_TOPINFO,n)),d.default.getInstance().openUI(h.default,{data:[a]}),t.updateUI(),d.default.getInstance().getUI(v.default).updateRedPoint(),cc.find("Canvas/MergeUIContent/MergeUI/bottomInfoContent/BottomInfoPrefab").getComponent(_.default).updateUI()}else"item"==t.purchaseType?(s.default.getInstance().mstItem[t.price].name,d.default.getInstance().openUI(l.default,{data:{str:b.default.t("shop_3")}})):u.default.noDiamondsCommonPopup()};if("video"==this.purchaseType)f.default.trackEventOnXG("common","Ad_button_click"),this.trackEvent(0),f.default.trackEvent("shop_"+this.shopType+"_video_click",{goodsId:this.goodsId+""}),c.default.getInstance().showRewardAd(function(){f.default.trackEvent("shop_"+t.shopType+"_video_success",{goodsId:t.goodsId+""}),t.trackEvent(1),n()},function(){f.default.trackEvent("shop_"+t.shopType+"_video_fail",{goodsId:t.goodsId+""})},function(){f.default.trackEvent("shop_"+t.shopType+"_video_err",{goodsId:t.goodsId+""})});else if("item"==this.purchaseType){var o={okCallback:function(){n()},id:this.price,num:1};d.default.getInstance().openUI(g.default,{data:o})}else n()},e.prototype.trackEvent=function(t){"dailyGift"==this.shopType&&2==this.goodsId?f.default.trackEventOnXG("video","\u6bcf\u65e5\u798f\u5229-\u4f53\u529b\u5b9d\u7bb1",6,t):"dailyGift"==this.shopType&&3==this.goodsId?f.default.trackEventOnXG("video","\u6bcf\u65e5\u798f\u5229-\u52a0\u901f\u9053\u5177",6,t):"resource"==this.shopType&&1==this.goodsId?f.default.trackEventOnXG("video","\u8865\u5145\u4f53\u529b",4,t):"resource"==this.shopType&&2==this.goodsId&&f.default.trackEventOnXG("video","\u6bcf\u65e5\u8d44\u6e90-\u514d\u8d39\u94bb\u77f3",6,t)},o([k(cc.Label)],e.prototype,"lbName",void 0),o([k(cc.Node)],e.prototype,"btnItemChain",void 0),o([k(cc.Label)],e.prototype,"lbLimit",void 0),o([k(cc.Button)],e.prototype,"btnPurchaseType",void 0),o([k(cc.Label)],e.prototype,"lbPrice",void 0),o([k(cc.Node)],e.prototype,"redPointNode",void 0),o([k(cc.Node)],e.prototype,"itemIcon",void 0),o([k(cc.Sprite)],e.prototype,"purchaseIcon",void 0),o([k(cc.SpriteFrame)],e.prototype,"videoSPF",void 0),o([k(cc.SpriteFrame)],e.prototype,"shareSPF",void 0),o([k(cc.SpriteFrame)],e.prototype,"coinSPF",void 0),o([k(cc.SpriteFrame)],e.prototype,"diamondsSPF",void 0),o([k(cc.SpriteFrame)],e.prototype,"itemBg",void 0),o([C],e)}(cc.Component);i.default=S,cc._RF.pop()},{"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/Toast":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../../scripts/utils/StatisticsManager":void 0,"../prefabs/AwardPopup":"AwardPopup","../prefabs/BuyTipPopup":"BuyTipPopup","../prefabs/ItemChain":"ItemChain","../prefabs/ShopPopup":"ShopPopup","./BottomInfoPrefab":"BottomInfoPrefab","./BuildItem":"BuildItem","./ItemEntity":"ItemEntity"}],ShopPopup:[function(t,e,i){"use strict";cc._RF.push(e,"086edoyKiRMrqfSgQiNUtPw","ShopPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},s=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var a=Array(t),n=0;for(e=0;e<i;e++)for(var o=arguments[e],s=0,r=o.length;s<r;s++,n++)a[n]=o[s];return a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../scripts/base/BaseUI"),c=t("../../scripts/data/MiscData"),d=t("../../scripts/data/MstData"),l=t("../../scripts/data/UserData"),p=t("../../scripts/manager/AdManager"),u=t("../../scripts/utils/EventName"),f=t("../../scripts/utils/GlobalFun"),h=t("../../scripts/utils/StatisticsManager"),g=t("../entitys/ShopItem"),m=t("../entitys/WeeklyGiftItem"),v=t("../../scripts/extension/LanguageData"),_=cc._decorator,y=_.ccclass,I=_.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tagScrollView=null,e.nodeContentGird=null,e.nodeContentWeek=null,e.pfbGoodsItem=null,e.weeklyGiftItem=null,e.lbTime=null,e.nodeRefresh=null,e.btnRefresh=null,e.spBtn=null,e.shopSrollItem=null,e.weekSrollItem=null,e.lbVideoCD=null,e.toggleList=[],e._storeData=[],e._tabName=[],e._chooseIndex=0,e._shopItemJS=[],e._lastTime=0,e._shopType=0,e}return n(e,t),e.prototype.init=function(t){this._shopType=t.type;var e=this.getAllShopKeyByType(t.type),i=f.default.sortObjectByValue(e);this._tabName=i[1],this._storeData=i[0];var a=-1==this._tabName.indexOf(t.key)?0:this._tabName.indexOf(t.key);this._chooseIndex=a;for(var n=0;n<this.toggleList.length;n++){var o=this._storeData[n]?this._storeData[n].name:null;o?(this.toggleList[n].node.active=!0,this.toggleList[n].node.getChildByName("select").getChildByName("label").getComponent(cc.Label).string=o,this.toggleList[n].node.getChildByName("unselect").getChildByName("label").getComponent(cc.Label).string=o):this.toggleList[n].node.active=!1}this.initLastTime(),f.default.isCanShowBanner()&&p.default.getInstance().showBanner()},e.prototype.onLoad=function(){if(cc.director.getScene().on(u.default.UPDATE_BY_SECOND,this.updateBySecond,this),cc.director.getScene().on(u.default.NEW_DAY,this.updateUI,this),1!=this._shopType&&cc.director.getScene().on(u.default.LIMIT_ACT_CLOSE,this.closeLimitAct,this),h.default.trackEvent("shop_open"),this._chooseIndex>0){this.toggleList[this._chooseIndex].check();var t=cc.v2(this.toggleList[this._chooseIndex].node.x-this.toggleList[this._chooseIndex].node.width/2,this.toggleList[this._chooseIndex].node.y);this.tagScrollView.scrollToOffset(t,0)}this.updateUI(),this.updateBySecond()},e.prototype.updateUI=function(){var t=this._storeData[this._chooseIndex].key;if("weeklyGift"==t){this.shopSrollItem.active=!1,this.weekSrollItem.active=!0,this.nodeRefresh.active=!0,this.btnRefresh.node.active=!1;var e,i=l.default.getInstance().weeklyGiftModel,a=i.config,n=[],o=[];for(var r in a)if(Object.prototype.hasOwnProperty.call(a,r)){var c=a[r];i.isReceived(r)?n.push({index:c.index,name:r}):o.push({index:c.index,name:r})}if(o.sort(function(t,e){return t.index-e.index}),n.sort(function(t,e){return t.index-e.index}),e=s(o,n),this.nodeContentWeek.children.length<e.length)for(var u=e.length-this.nodeContentWeek.children.length,h=0;h<u;h++){var _=cc.instantiate(this.weeklyGiftItem);this.nodeContentWeek.addChild(_)}for(h=0;h<this.nodeContentWeek.children.length;h++)_=this.nodeContentWeek.children[h],h<e.length?(_.active=!0,_.getComponent(m.default).initLevelItemInfo(e[h].name,this,890)):_.active=!1}else{this.shopSrollItem.active=!0,this.weekSrollItem.active=!1;var y=l.default.getInstance().storeData[t],I=Object.keys(y);if("goods"!=t&&I.sort(function(e,i){return d.default.getInstance().mstStore[t].config[e].index-d.default.getInstance().mstStore[t].config[i].index}),this._shopItemJS.length<=I.length)for(u=I.length-this._shopItemJS.length,h=0;h<u;h++){var b=(_=cc.instantiate(this.pfbGoodsItem)).getComponent(g.default);this.nodeContentGird.addChild(_),this._shopItemJS.push(b)}for(h=0;h<this._shopItemJS.length;h++)h<I.length?(this._shopItemJS[h].node.active=!0,this._shopItemJS[h].init(t,I[h])):this._shopItemJS[h].node.active=!1;this.btnRefresh.node.active=!0,this.nodeRefresh.active="goods"==t}if(this.nodeRefresh.active&&this.btnRefresh.node.active){var N=p.default.getInstance().rewardAdCd;N>0?(this.btnRefresh.interactable&&(this.btnRefresh.interactable=!1,f.default.setBtnIsGrey(this.btnRefresh)),this.lbVideoCD.string=f.default.formatDateTimeHourEx(N)):(this.btnRefresh.interactable||(this.btnRefresh.interactable=!0,f.default.setBtnIsGrey(this.btnRefresh,new cc.Color(157,104,72))),this.lbVideoCD.string=v.default.t("refresh"))}this.updateRedPoint()},e.prototype.updateCompleteGiftName=function(){this.updateUI()},e.prototype.checkTab=function(t){var e=-1==this._tabName.indexOf(t)?0:this._tabName.indexOf(t);this._chooseIndex=e,this.toggleList[this._chooseIndex].check();var i=cc.v2(this.toggleList[this._chooseIndex].node.x-this.toggleList[this._chooseIndex].node.width/2,this.toggleList[this._chooseIndex].node.y);this.tagScrollView.scrollToOffset(i,0);var a=this._storeData[this._chooseIndex].key;"dailyGift"==a?h.default.trackEvent("shop_dailyGift_click"):"goods"==a?h.default.trackEvent("shop_goods_click"):"prop"==a?h.default.trackEvent("shop_prop_click"):"box"==a?h.default.trackEvent("shop_box_click"):"resource"==a&&h.default.trackEvent("shop_resource_click"),this.updateUI()},e.prototype.onClickRadioGrp=function(t){var e=this.toggleList.indexOf(t);if(e!==this._chooseIndex){this._chooseIndex=e;var i=this._storeData[this._chooseIndex].key;"dailyGift"==i?h.default.trackEvent("shop_dailyGift_click"):"goods"==i?h.default.trackEvent("shop_goods_click"):"prop"==i?h.default.trackEvent("shop_prop_click"):"box"==i?h.default.trackEvent("shop_box_click"):"resource"==i&&h.default.trackEvent("shop_resource_click"),this.updateUI()}},e.prototype.onClickRefresh=function(){var t=this;h.default.trackEventOnXG("common","Ad_button_click"),h.default.trackEventOnXG("video","\u5546\u5e97-\u5feb\u901f\u8d2d\u4e70-\u5237\u65b0\u7269\u54c1",5,0),p.default.getInstance().showRewardAd(function(){h.default.trackEventOnXG("video","\u5546\u5e97-\u5feb\u901f\u8d2d\u4e70-\u5237\u65b0\u7269\u54c1",5,1),l.default.getInstance().storeData.refreshGoods(),t.updateUI()},null,null,"shop_goods_video")},e.prototype.updateRedPoint=function(){var t=this._tabName.indexOf("dailyGift");-1!=t&&(this.toggleList[t].node.getChildByName("spRedPoint").active=l.default.getInstance().storeData.isShowRedPoint())},e.prototype.updateBySecond=function(){var t=this._storeData[this._chooseIndex].key;if("goods"==t){var e=d.default.getInstance().mstStore.goods.config.refreshTime,i=l.default.getInstance().storeData.goodsResfreshTime;i+e<=window.serverTime?l.default.getInstance().storeData.refreshGoods():this.lbTime.string=f.default.formatDateTimeHourEx(Math.floor(e-(window.serverTime-i))).toString()}else if("weeklyGift"==t){var a=Math.ceil(this._lastTime-window.serverTime);if(a<0&&(l.default.getInstance().weeklyGiftModel.loadData(),this.initLastTime()),a>=0){var n=f.default.timeFormat(a);this.lbTime.string=n}}this.updateUI()},e.prototype.initLastTime=function(){var t=new Date(1e3*window.serverTime),e=t.getDay();0===e&&(e=7);var i=t.getTime()-864e5*(e-1),a=new Date(i),n=a.getFullYear(),o=a.getMonth()+1,s=a.getDate(),r=new Date(n+"/"+o+"/"+s).getTime()+6048e5;this._lastTime=r/1e3},e.prototype.getAllShopKeyByType=function(t){var e=d.default.getInstance().mstStore,i={};for(var a in e)if(c.default.getInstance().isIOSPayOpen||"diamonds"!=a&&"skipAd"!=a&&"skinTicket"!=a&&"weeklyGift"!=a){var n=e[a];l.default.getInstance().level>=n.openLevel&&n.storeId.includes(t)&&(i[a]=n)}return i},e.prototype.closeLimitAct=function(){this.onClose()},e.prototype.onDestroy=function(){f.default.isCanShowBanner()&&p.default.getInstance().hideBanner()},e.uiName="ShopPopup",o([I(cc.ScrollView)],e.prototype,"tagScrollView",void 0),o([I(cc.Node)],e.prototype,"nodeContentGird",void 0),o([I(cc.Node)],e.prototype,"nodeContentWeek",void 0),o([I(cc.Prefab)],e.prototype,"pfbGoodsItem",void 0),o([I(cc.Prefab)],e.prototype,"weeklyGiftItem",void 0),o([I(cc.Label)],e.prototype,"lbTime",void 0),o([I(cc.Node)],e.prototype,"nodeRefresh",void 0),o([I(cc.Button)],e.prototype,"btnRefresh",void 0),o([I(cc.Sprite)],e.prototype,"spBtn",void 0),o([I(cc.Node)],e.prototype,"shopSrollItem",void 0),o([I(cc.Node)],e.prototype,"weekSrollItem",void 0),o([I(cc.Label)],e.prototype,"lbVideoCD",void 0),o([I([cc.Toggle])],e.prototype,"toggleList",void 0),o([y],e)}(r.default);i.default=b,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MiscData":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../../scripts/utils/StatisticsManager":void 0,"../entitys/ShopItem":"ShopItem","../entitys/WeeklyGiftItem":"WeeklyGiftItem"}],SkinGiftPopup:[function(t,e,i){"use strict";cc._RF.push(e,"021bb7gXT1Ew4xP/fU+xHlt","SkinGiftPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/UserData"),c=t("../../scripts/manager/AdManager"),d=t("../../scripts/manager/SDKManager"),l=t("../../scripts/manager/UIManager"),p=t("../../scripts/utils/EventName"),u=t("../../scripts/utils/GlobalFun"),f=t("../../scripts/utils/StatisticsManager"),h=t("../entitys/ItemEntity"),g=t("./AwardPopup"),m=t("../../scripts/extension/LanguageData"),v=cc._decorator,_=v.ccclass,y=v.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemNode=null,e.itemBg=null,e.layout=null,e.money=null,e.oldMoney=null,e.rewardNode2=null,e.skin=null,e.discount=null,e.skinName=null,e.videoNode=null,e.lbVideo=null,e.videoCountLab=null,e.buyNode=null,e.timelab=null,e._config=null,e._skinGiftModel=null,e}return n(e,t),e.prototype.init=function(t){void 0===t&&(t=0),u.default.isCanShowBanner()&&c.default.getInstance().showBanner()},e.prototype.initUI=function(){var t=this;if(this._config=this._skinGiftModel.skinGiftData,this._config){var e=this._config,i=e.rewardRes.length>2||e.reward.length>0;this.rewardNode2.active=i,this.skin.removeAllChildren();var a,n="30098"==e.rewardRes[0]||"40000"==e.rewardRes[0]?0:2;if(u.default.getSkinNode(+e.rewardRes[n],+e.rewardRes[n+1],300,300,function(i,a){if(4e4==+e.rewardRes[n])i.scale=1,t.skin.addChild(i),i.setPosition(cc.v2(0,20)),t.skinName.string=a.name;else if(30098==+e.rewardRes[n]&&(t.skin.addChild(i),t.skin.scale=.8,i.setPosition(cc.v2(0,0)),t.skinName.string=a.name,i.getChildByName("buildnode"))){i.height=i.getChildByName("buildnode").height;var o=i.addComponent(cc.Widget);o.isAlignBottom=!0,o.bottom=20}}),this.layout.removeAllChildren(),e.rewardRes.length>2){var o=cc.instantiate(this.itemNode);this.layout.addChild(o);var s="30098"==e.rewardRes[0]||"40000"==e.rewardRes[0]?2:0;(a={}).itemId=e.rewardRes[s],a.itemNum=e.rewardRes[s+1],a.itemBg=this.itemBg,a.isShowInfo=!0,a.isClickAble=!0,a.numOffset=cc.v2(30,15),o.getComponent(h.default).init(a)}if(e.reward.length>0)o=cc.instantiate(this.itemNode),this.layout.addChild(o),(a={}).itemId=e.reward[0],a.itemNum=1,a.itemBg=this.itemBg,a.isShowInfo=!0,a.isClickAble=!0,a.numOffset=cc.v2(30,15),o.getComponent(h.default).init(a);"pay"==this._config.costType?(this.buyNode.active=!0,this.videoNode.node.active=!1,this.money.string="\uffe5"+e.costNum,this.oldMoney.string="\uffe5"+parseFloat((e.costNum/e.saleTag*10).toFixed(1)),this.discount.string=m.default.t("saleTag",{count:e.saleTag})):"video"==this._config.costType&&(this.buyNode.active=!1,this.videoNode.node.active=!0,this.videoCountLab.string=this._skinGiftModel.videoCount+"/"+e.costNum)}else this.onClose()},e.prototype.onLoad=function(){this._skinGiftModel=r.default.getInstance().skinGiftModel,this.initUI(),this.updateBySecond(),cc.director.getScene().on(p.default.UPDATE_BY_SECOND,this.updateBySecond,this),cc.director.getScene().on(p.default.NEW_DAY,this.initUI,this)},e.prototype.onClickBuyGift=function(){var t=this;f.default.trackEvent("skinGift_pay_click");var e=this._config;"pay"==e.costType?(e.payType=14,d.default.getInstance().pay(e,function(){t.getReward(),f.default.trackEvent("skinGift_pay_success")},function(){f.default.trackEvent("skinGift_pay_fail")})):"video"==e.costType&&c.default.getInstance().showRewardAd(function(){t.getReward(),t.updateRewardCD(),f.default.trackEvent("skinGift_pay_success")},function(){f.default.trackEvent("skinGift_pay_fail")},function(){})},e.prototype.getReward=function(){var t;this._skinGiftModel.getReward(this._config)?(t=u.default.getAllReward(this._config.reward,this._config.rewardRes),l.default.getInstance().openUI(g.default,{data:t}),this._skinGiftModel.resetSkinGiftId(),cc.director.getScene().emit(p.default.UPDATE_ACTIVITY),this.onClose()):this.videoCountLab.string=this._skinGiftModel.videoCount+"/"+this._config.costNum},e.prototype.updateBySecond=function(){var t=u.default.getDateByYMD(),e=(new Date(t).getTime()+864e5)/1e3-window.serverTime,i=u.default.formatDateTimeHourEx(e);this.timelab.string=m.default.t("levelAwardPopup_2",{time:i}),this.updateRewardCD()},e.prototype.updateRewardCD=function(){if(this.videoNode.node.active){var t=c.default.getInstance().rewardAdCd;t>0?(this.videoNode.interactable=!1,u.default.setBtnIsGrey(this.videoNode),this.lbVideo.string=u.default.formatDateTimeHourEx(t)):(this.videoNode.interactable=!0,u.default.setBtnIsGrey(this.videoNode,new cc.Color(62,96,32)),this.lbVideo.string=m.default.t("receive"))}},e.prototype.onDestroy=function(){u.default.isCanShowBanner()&&c.default.getInstance().hideBanner()},e.uiName="SkinGiftPopup",o([y(cc.Prefab)],e.prototype,"itemNode",void 0),o([y(cc.SpriteFrame)],e.prototype,"itemBg",void 0),o([y(cc.Node)],e.prototype,"layout",void 0),o([y(cc.Label)],e.prototype,"money",void 0),o([y(cc.Label)],e.prototype,"oldMoney",void 0),o([y(cc.Node)],e.prototype,"rewardNode2",void 0),o([y(cc.Node)],e.prototype,"skin",void 0),o([y(cc.Label)],e.prototype,"discount",void 0),o([y(cc.Label)],e.prototype,"skinName",void 0),o([y(cc.Button)],e.prototype,"videoNode",void 0),o([y(cc.Label)],e.prototype,"lbVideo",void 0),o([y(cc.Label)],e.prototype,"videoCountLab",void 0),o([y(cc.Node)],e.prototype,"buyNode",void 0),o([y(cc.Label)],e.prototype,"timelab",void 0),o([_],e)}(s.default);i.default=I,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/SDKManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../../scripts/utils/StatisticsManager":void 0,"../entitys/ItemEntity":"ItemEntity","./AwardPopup":"AwardPopup"}],SuperBenefitsPopup:[function(t,e,i){"use strict";cc._RF.push(e,"d878ejtfFhJaopmy4L/yn6x","SuperBenefitsPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MstData"),c=t("../../scripts/data/UserData"),d=t("../../scripts/manager/AdManager"),l=t("../../scripts/manager/SDKManager"),p=t("../../scripts/manager/UIManager"),u=t("../../scripts/utils/ActionFunc"),f=t("../../scripts/utils/AppConfig"),h=t("../../scripts/utils/EventName"),g=t("../../scripts/utils/GlobalFun"),m=t("../../scripts/utils/StatisticsManager"),v=t("./AwardPopup"),_=t("./HelpCommonPopup"),y=t("../../scripts/extension/LanguageData"),I=cc._decorator,b=I.ccclass,N=I.property,C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bangkanlab=[],e.usernode=[],e.usrid=[],e.videoNums=null,e.btnGetReward=null,e.btnVideoNode=null,e.awardNode=null,e._kanyidaoconf=null,e._receviveList=null,e}return n(e,t),e.prototype.init=function(t){this._receviveList=t,this._kanyidaoconf=r.default.getInstance().mstActivity.kanyidao.config;for(var e=0;e<3;e++)this.bangkanlab[e].string=y.default.t("superBenefitsPopup_1",{times:this._kanyidaoconf.cutNum[e]}),this._receviveList[e]?(this.usernode[e].active=!0,this.usrid[e].string=this._receviveList[e]):this.usernode[e].active=!1;this.initAwardItems(),this.updateBenefitsState(),g.default.isCanShowBanner()&&d.default.getInstance().showBanner()},e.prototype.onLoad=function(){m.default.trackEvent("pindaodao_open"),u.default.zoomAnim2(this.btnVideoNode.children[1])},e.prototype.initAwardItems=function(){var t=function(t,e,i){t.active=!0;var a=g.default.getItemIconPathById(e),n=t.getChildByName("item").getComponent(cc.Sprite);g.default.loadSpriteFrame(n,a),t.getChildByName("itemnum").getComponent(cc.Label).string="x"+i},e=this.awardNode.children,i=g.default.rewardResToObj(this._kanyidaoconf.rewardRes);t(e[0],30092,i[30092]),t(e[1],30094,i[30094]);for(var a=0;a<this._kanyidaoconf.reward.length;a++)t(e[a+2],this._kanyidaoconf.reward[a],1)},e.prototype.updateBenefitsState=function(){for(var t=c.default.getInstance().superBenefitsTimes,e=r.default.getInstance().mstActivity.kanyidao.config.costNum,i=this._receviveList.length,a=r.default.getInstance().mstActivity.kanyidao.config.cutNum,n=0;n<i;n++)e-=a[n];t<e?(this.btnVideoNode.active=!0,this.btnGetReward.active=!1,this.videoNums.string=t+"/"+e):0==c.default.getInstance().superBenefitsRewardTimes&&(this.btnVideoNode.active=!1,this.btnGetReward.active=!0)},e.prototype.onVideoClicked=function(){var t=this;m.default.trackEvent("pindaodao_video_click"),m.default.trackEventOnXG("common","Ad_button_click"),m.default.trackEventOnXG("video","\u62fc\u5200\u5200",9,0),d.default.getInstance().showRewardAd(function(){m.default.trackEventOnXG("video","\u62fc\u5200\u5200",9,1),c.default.getInstance().addSuperBenefitsTime(),t.updateBenefitsState(),m.default.trackEvent("pindaodao_video_times",{times:""+c.default.getInstance().superBenefitsTimes}),m.default.trackEvent("pindaodao_video_success")},function(){m.default.trackEvent("pindaodao_video_fail")},function(){m.default.trackEvent("pindaodao_video_err")})},e.prototype.onShareClicked=function(){m.default.trackEvent("pindaodao_share_click");var t=y.default.t("share_3"),e=f.default.WX_SHARE_PATH+"share3.jpg",i={type:"friendsHelp",uid:c.default.getInstance().id},a=g.default.objToKeyValue(i);l.default.getInstance().shareAppMessage(t,e,a,function(){},null)},e.prototype.onGetBenefitsAward=function(){if(m.default.trackEvent("pindaodao_receive_reward"),c.default.getInstance().getSuperBenefitsReward(this._receviveList)){var t=[],e=g.default.rewardResToObj(this._kanyidaoconf.rewardRes);for(var i in e)t.push({id:Number(i),num:e[i]});for(var a=0;a<this._kanyidaoconf.reward.length;a++){var n={};n.id=this._kanyidaoconf.reward[a],n.num=1,t.push(n)}p.default.getInstance().openUI(v.default,{data:t}),cc.director.getScene().emit(h.default.UPDATE_TOPINFO),cc.director.getScene().emit(h.default.UPDATE_ACTIVITY),p.default.getInstance().closeUI(this.tag)}},e.prototype.onGetBenefitsHelp=function(){var t={contentText:[y.default.t("superBenefitsPopup_3"),y.default.t("superBenefitsPopup_4"),y.default.t("superBenefitsPopup_5"),y.default.t("superBenefitsPopup_6")]};p.default.getInstance().openUI(_.default,{data:t})},e.prototype.onDestroy=function(){g.default.isCanShowBanner()&&d.default.getInstance().hideBanner()},e.uiName="SuperBenefitsPopup",o([N([cc.Label])],e.prototype,"bangkanlab",void 0),o([N([cc.Node])],e.prototype,"usernode",void 0),o([N([cc.Label])],e.prototype,"usrid",void 0),o([N(cc.Label)],e.prototype,"videoNums",void 0),o([N(cc.Node)],e.prototype,"btnGetReward",void 0),o([N(cc.Node)],e.prototype,"btnVideoNode",void 0),o([N(cc.Node)],e.prototype,"awardNode",void 0),o([b],e)}(s.default);i.default=C,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/SDKManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/utils/ActionFunc":void 0,"../../scripts/utils/AppConfig":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../../scripts/utils/StatisticsManager":void 0,"./AwardPopup":"AwardPopup","./HelpCommonPopup":"HelpCommonPopup"}],SuperVipPopup:[function(t,e,i){"use strict";cc._RF.push(e,"aaad54eypND4I3X5wBd4eQZ","SuperVipPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MstData"),c=t("../../scripts/data/UserData"),d=t("../../scripts/manager/AdManager"),l=t("../../scripts/manager/UIManager"),p=t("../../scripts/utils/EventName"),u=t("../../scripts/utils/GlobalFun"),f=t("../../scripts/utils/StatisticsManager"),h=t("./AwardPopup"),g=t("../../scripts/extension/LanguageData"),m=cc._decorator,v=m.ccclass,_=m.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.vipNowEnergy=null,e.vipNowDiamond=null,e.vipDailyEnergy=null,e.vipDailyDiamond=null,e.vipVideoTimes=null,e.vipDesc=null,e.vipSurplusTimes=null,e.superVipNowEnergy=null,e.superVipNowDiamond=null,e.superVipDailyEnergy=null,e.superVipDailyDiamond=null,e.superVipVideoTimes=null,e.superVipDesc=null,e.superVipSurplusTimes=null,e.btnVipAwardLab=null,e.btnSuperVipAwardLab=null,e.btnVipVideo=null,e.lbVipVideo=null,e.btnVipAward=null,e.btnSuperVipVideo=null,e.lbSuperVipVideo=null,e.btnSuperVipAward=null,e._vipCardConfig=null,e._superVipConfig=null,e._curVipIsOpen=!1,e._curSuperVipIsOpen=!1,e}return n(e,t),e.prototype.init=function(){this._curVipIsOpen=!1,this._curSuperVipIsOpen=!1,this._vipCardConfig=r.default.getInstance().mstActivity.vipCrad.config,this._superVipConfig=r.default.getInstance().mstActivity.superVipCard.config,this.refushNewDay(),this.updateBySecond(),cc.director.getScene().on(p.default.UPDATE_BY_SECOND,this.updateBySecond,this),cc.director.getScene().on(p.default.NEW_DAY,this.refushNewDay,this),u.default.isCanShowBanner()&&d.default.getInstance().showBanner()},e.prototype.refushNewDay=function(){this.initVipInfo(),this.initSuperVipInfo()},e.prototype.initVipInfo=function(){if(this._curVipIsOpen=c.default.getInstance().isVipCard,c.default.getInstance().isVipCard)this.btnVipAward.active=!0,this.btnVipVideo.node.active=!1,c.default.getInstance().vipCardDailyRewardTimes>0?(this.btnVipAward.getComponent(cc.Button).interactable=!1,this.btnVipAwardLab.getComponent(cc.LabelOutline).color=cc.color(116,116,116,255),this.btnVipAwardLab.string=g.default.t("received")):(this.btnVipAward.getComponent(cc.Button).interactable=!0,this.btnVipAwardLab.getComponent(cc.LabelOutline).color=cc.color(64,98,35,255),this.btnVipAwardLab.string=g.default.t("receive"));else{this.btnVipAward.active=!1,this.btnVipVideo.node.active=!0;var t=c.default.getInstance().vipCardTimes;this.vipVideoTimes.string=t+"/"+this._vipCardConfig.costNum}var e=u.default.rewardResToObj(this._vipCardConfig.rewardRes),i=u.default.rewardResToObj(this._vipCardConfig.dailyRewardRes);this.vipNowEnergy.string="x"+e[30092],this.vipNowDiamond.string="x"+e[30094],this.vipDailyEnergy.string="x"+7*i[30092],this.vipDailyDiamond.string="x"+7*i[30094],this.vipDesc.string=g.default.t("superVipPopup_1",{energy:i[30092],diamonds:i[30094]})},e.prototype.initSuperVipInfo=function(){if(this._curSuperVipIsOpen=c.default.getInstance().isSuperVipCard,c.default.getInstance().isSuperVipCard)this.btnSuperVipAward.active=!0,this.btnSuperVipVideo.node.active=!1,c.default.getInstance().superVipCardDailyRewardTimes>0?(this.btnSuperVipAward.getComponent(cc.Button).interactable=!1,this.btnSuperVipAwardLab.getComponent(cc.LabelOutline).color=cc.color(116,116,116,255),this.btnSuperVipAwardLab.string=g.default.t("received")):(this.btnSuperVipAward.getComponent(cc.Button).interactable=!0,this.btnSuperVipAwardLab.getComponent(cc.LabelOutline).color=cc.color(64,98,35,255),this.btnSuperVipAwardLab.string=g.default.t("receive"));else{this.btnSuperVipAward.active=!1,this.btnSuperVipVideo.node.active=!0;var t=c.default.getInstance().superVipCardTimes;this.superVipVideoTimes.string=t+"/"+this._superVipConfig.costNum}var e=u.default.rewardResToObj(this._superVipConfig.rewardRes),i=u.default.rewardResToObj(this._superVipConfig.dailyRewardRes);this.superVipNowEnergy.string="x"+e[30092],this.superVipNowDiamond.string="x"+e[30094],this.superVipDailyEnergy.string="x"+30*i[30092],this.superVipDailyDiamond.string="x"+30*i[30094],this.superVipDesc.string=g.default.t("superVipPopup_1",{energy:i[30092],diamonds:i[30094]})},e.prototype.onVipVideoClicked=function(){var t=this;f.default.trackEvent("vip_video_click"),f.default.trackEventOnXG("common","Ad_button_click"),f.default.trackEventOnXG("video","\u5468\u5361",12,0),d.default.getInstance().showRewardAd(function(){f.default.trackEventOnXG("video","\u5468\u5361",12,1),t.getVipCardReward(),t.updateRewardCD(),f.default.trackEvent("vip_video_times",{times:""+c.default.getInstance().vipCardTimes}),f.default.trackEvent("vip_video_success")},function(){f.default.trackEvent("vip_video_fail")},function(){f.default.trackEvent("vip_video_err")})},e.prototype.getVipCardReward=function(){var t=c.default.getInstance().addVipCardTime();if(t==this._vipCardConfig.costNum){this.vipVideoTimes.string=t+"/"+this._vipCardConfig.costNum;var e=[],i=u.default.rewardResToObj(this._vipCardConfig.rewardRes);for(var a in i)e.push({id:Number(a),num:i[a]});l.default.getInstance().openUI(h.default,{data:e}),cc.director.getScene().emit(p.default.UPDATE_TOPINFO),this.initVipInfo(),cc.director.getScene().emit(p.default.UPDATE_ACTIVITY)}else-1!=t&&(this.vipVideoTimes.string=t+"/"+this._vipCardConfig.costNum)},e.prototype.onGetVipAwardClicked=function(){if(f.default.trackEvent("vip_dialy_reward_click"),c.default.getInstance().getVipCardDailyReward()){this.btnVipAward.getComponent(cc.Button).interactable=!1,this.btnVipAwardLab.getComponent(cc.LabelOutline).color=cc.color(116,116,116,255),this.btnVipAwardLab.string=g.default.t("received");var t=[],e=u.default.rewardResToObj(this._vipCardConfig.dailyRewardRes);for(var i in e)t.push({id:Number(i),num:e[i]});l.default.getInstance().openUI(h.default,{data:t}),cc.director.getScene().emit(p.default.UPDATE_TOPINFO),cc.director.getScene().emit(p.default.UPDATE_ACTIVITY)}},e.prototype.onSuperVipVideoClicked=function(){var t=this;f.default.trackEvent("vip_super_video_click"),f.default.trackEventOnXG("common","Ad_button_click"),f.default.trackEventOnXG("video","\u6708\u5361",11,0),d.default.getInstance().showRewardAd(function(){f.default.trackEventOnXG("video","\u6708\u5361",11,1),t.getSuperVipCardReward(),t.updateRewardCD(),f.default.trackEvent("vip_super_video_times",{times:""+c.default.getInstance().superVipCardTimes}),f.default.trackEvent("vip_super_video_success")},function(){f.default.trackEvent("vip_super_video_fail")},function(){f.default.trackEvent("vip_super_video_err")})},e.prototype.getSuperVipCardReward=function(){var t=c.default.getInstance().addSuperVipCardTime();if(t==this._superVipConfig.costNum){this.superVipVideoTimes.string=t+"/"+this._superVipConfig.costNum;var e=[],i=u.default.rewardResToObj(this._superVipConfig.rewardRes);for(var a in i)e.push({id:Number(a),num:i[a]});l.default.getInstance().openUI(h.default,{data:e}),cc.director.getScene().emit(p.default.UPDATE_TOPINFO),this.initSuperVipInfo(),cc.director.getScene().emit(p.default.UPDATE_ACTIVITY)}else-1!=t&&(this.superVipVideoTimes.string=t+"/"+this._superVipConfig.costNum)},e.prototype.onGetSuperVipAwardClicked=function(){if(f.default.trackEvent("vip_super_dialy_reward_click"),c.default.getInstance().getSuperVipCardDailyReward()){this.btnSuperVipAward.getComponent(cc.Button).interactable=!1,this.btnSuperVipAwardLab.getComponent(cc.LabelOutline).color=cc.color(116,116,116,255),this.btnSuperVipAwardLab.string=g.default.t("received");var t=[],e=u.default.rewardResToObj(this._superVipConfig.dailyRewardRes);for(var i in e)t.push({id:Number(i),num:e[i]});l.default.getInstance().openUI(h.default,{data:t}),cc.director.getScene().emit(p.default.UPDATE_TOPINFO),cc.director.getScene().emit(p.default.UPDATE_ACTIVITY)}},e.prototype.updateBySecond=function(){var t,e;c.default.getInstance().isVipCard?(this.vipSurplusTimes.node.active=!0,this._curVipIsOpen||this.initVipInfo(),(t=c.default.getInstance().vipCardEndTime)>0&&((e=t-window.serverTime)>=0?(this.vipSurplusTimes.node.color=e<86400?cc.color(255,0,0,255):cc.color(255,255,255,255),this.vipSurplusTimes.string=u.default.timeFormat(e)):this.vipSurplusTimes.string="")):(this.vipSurplusTimes.node.active=!1,this._curVipIsOpen&&this.initVipInfo()),c.default.getInstance().isSuperVipCard?(this.superVipSurplusTimes.node.active=!0,this._curSuperVipIsOpen||this.initSuperVipInfo(),(t=c.default.getInstance().superVipCardEndTime)>0&&((e=t-window.serverTime)>=0?(this.superVipSurplusTimes.node.color=e<86400?cc.color(255,0,0,255):cc.color(255,255,255,255),this.superVipSurplusTimes.string=u.default.timeFormat(e)):this.superVipSurplusTimes.string="")):(this.superVipSurplusTimes.node.active=!1,this._curSuperVipIsOpen&&this.initSuperVipInfo()),this.updateRewardCD()},e.prototype.updateRewardCD=function(){var t;this.btnVipVideo.node.active&&((t=d.default.getInstance().rewardAdCd)>0?(this.btnVipVideo.interactable=!1,u.default.setBtnIsGrey(this.btnVipVideo),this.lbVipVideo.string=u.default.formatDateTimeHourEx(t)):(this.btnVipVideo.interactable=!0,u.default.setBtnIsGrey(this.btnVipVideo,new cc.Color(62,96,32)),this.lbVipVideo.string=g.default.t("free"))),this.btnSuperVipVideo.node.active&&((t=d.default.getInstance().rewardAdCd)>0?(this.btnSuperVipVideo.interactable=!1,u.default.setBtnIsGrey(this.btnSuperVipVideo),this.lbSuperVipVideo.string=u.default.formatDateTimeHourEx(t)):(this.btnSuperVipVideo.interactable=!0,u.default.setBtnIsGrey(this.btnSuperVipVideo,new cc.Color(62,96,32)),this.lbSuperVipVideo.string=g.default.t("free")))},e.prototype.onLoad=function(){f.default.trackEvent("vip_open"),this.updateRewardCD()},e.prototype.onDestroy=function(){u.default.isCanShowBanner()&&d.default.getInstance().hideBanner()},e.uiName="SuperVipPopup",o([_(cc.Label)],e.prototype,"vipNowEnergy",void 0),o([_(cc.Label)],e.prototype,"vipNowDiamond",void 0),o([_(cc.Label)],e.prototype,"vipDailyEnergy",void 0),o([_(cc.Label)],e.prototype,"vipDailyDiamond",void 0),o([_(cc.Label)],e.prototype,"vipVideoTimes",void 0),o([_(cc.Label)],e.prototype,"vipDesc",void 0),o([_(cc.Label)],e.prototype,"vipSurplusTimes",void 0),o([_(cc.Label)],e.prototype,"superVipNowEnergy",void 0),o([_(cc.Label)],e.prototype,"superVipNowDiamond",void 0),o([_(cc.Label)],e.prototype,"superVipDailyEnergy",void 0),o([_(cc.Label)],e.prototype,"superVipDailyDiamond",void 0),o([_(cc.Label)],e.prototype,"superVipVideoTimes",void 0),o([_(cc.Label)],e.prototype,"superVipDesc",void 0),o([_(cc.Label)],e.prototype,"superVipSurplusTimes",void 0),o([_(cc.Label)],e.prototype,"btnVipAwardLab",void 0),o([_(cc.Label)],e.prototype,"btnSuperVipAwardLab",void 0),o([_(cc.Button)],e.prototype,"btnVipVideo",void 0),o([_(cc.Label)],e.prototype,"lbVipVideo",void 0),o([_(cc.Node)],e.prototype,"btnVipAward",void 0),o([_(cc.Button)],e.prototype,"btnSuperVipVideo",void 0),o([_(cc.Label)],e.prototype,"lbSuperVipVideo",void 0),o([_(cc.Node)],e.prototype,"btnSuperVipAward",void 0),o([v],e)}(s.default);i.default=y,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../../scripts/utils/StatisticsManager":void 0,"./AwardPopup":"AwardPopup"}],TaskCustomerItem:[function(t,e,i){"use strict";cc._RF.push(e,"daa72Kg+rpBNqDMVK1ZxN/H","TaskCustomerItem");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/UserData"),r=t("../../scripts/manager/AdManager"),c=t("../../scripts/manager/AudioManager"),d=t("../../scripts/manager/UIManager"),l=t("../../scripts/prefabs/Loading"),p=t("../../scripts/prefabs/Toast"),u=t("../../scripts/utils/EventName"),f=t("../../scripts/utils/GlobalFun"),h=t("../../scripts/utils/StatisticsManager"),g=t("../extension/ListItem"),m=t("../prefabs/TaskPopup"),v=t("./ItemList"),_=t("../../scripts/extension/LanguageData"),y=cc._decorator,I=y.ccclass,b=y.property,N=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lbName=null,e.itemListContent=null,e.itemListPrefab=null,e.itemSpriteFrame=null,e.itemCompleteSpriteFrame=null,e.refreshNode=null,e.lbRefush=null,e.lbCoins=null,e.rewardItemIcon=null,e.lbItemNum=null,e.finishNode=null,e.gotoMergeNode=null,e.unLockNode=null,e.refushVideo=null,e.refushDiamonds=null,e.refushDiaNum=null,e.lbTip=null,e._taskModel=null,e._parent=null,e}return n(e,t),e.prototype.init=function(t,e){void 0===e&&(e=null),e&&(this._parent=e),cc.Tween.stopAllByTarget(this.node),this._taskModel=s.default.getInstance().getTaskDataByOrderId(t),this.updateUI()},e.prototype.updateUI=function(){if(this._taskModel){if(this.unLockNode.active=!1,this.lbName.string=this._taskModel.taskName,this._taskModel.mstData.isRefresh?(this.refreshNode.node.active=!0,this._taskModel.mstData.refreshDiamonds>0?(this.refushVideo.active=!1,this.refushDiamonds.active=!0,this.refushDiaNum.string="x"+this._taskModel.mstData.refreshDiamonds+" "+_.default.t("refresh")):(this.refushVideo.active=!0,this.refushDiamonds.active=!1)):this.refreshNode.node.active=!1,0==this.itemListContent.childrenCount){var t=cc.instantiate(this.itemListPrefab);this.itemListContent.addChild(t)}var e=this.getItemData();this.itemListContent.children[0].getComponent(v.default).init({itemsData:e,spacingX:10}),this.lbCoins.string="x"+this._taskModel.coins,this._taskModel.mstData.reward.length>0?(this.lbItemNum.node.parent.active=!0,f.default.loadSpriteFrame(this.rewardItemIcon,f.default.getItemIconPathById(this._taskModel.mstData.reward[0])),this.lbItemNum.string="x1"):this.lbItemNum.node.parent.active=!1,this._taskModel.isComplete?(this.refreshNode.node.active=!1,this.finishNode.active=!0,this.gotoMergeNode.active=!1):(this._taskModel.mstData.isRefresh?(this.refreshNode.node.active=!0,this._taskModel.mstData.refreshDiamonds>0?(this.refushVideo.active=!1,this.refushDiamonds.active=!0,this.refushDiaNum.string="x"+this._taskModel.mstData.refreshDiamonds+" "+_.default.t("refresh")):(this.refushVideo.active=!0,this.refushDiamonds.active=!1)):this.refreshNode.node.active=!1,this.finishNode.active=!1,this.gotoMergeNode.active=!0)}else{this.refreshNode.node.active=!1,this.finishNode.active=!1,this.gotoMergeNode.active=!1,this.unLockNode.active=!0;var i=s.default.getInstance().getUnlockTaskNextLevel();this.lbTip.string=_.default.t("taskCustomerItem_1",{lv:i})}},e.prototype.getItemData=function(){var t=[],e=this._taskModel.requireItems.length,i=s.default.getInstance().getNormalItemIndexByIds(this._taskModel.requireItems);if(this._taskModel.isComplete)for(var a=0;a<e;a++)(n={uiName:"TaskPopup"}).itemId=this._taskModel.requireItems[a],n.itemBg=this.itemCompleteSpriteFrame,n.isComplete=!0,t.push(n);else for(a=0;a<e;a++){var n;(n={uiName:"TaskPopup"}).itemId=this._taskModel.requireItems[a],n.isClickAble=!0,i[a]>=0?(n.isComplete=!0,n.itemBg=this.itemCompleteSpriteFrame):(n.isComplete=!1,n.itemBg=this.itemSpriteFrame),t.push(n)}return t},e.prototype.refushVideoCD=function(){if(this.refreshNode.node.active&&this.refushVideo.active){var t=r.default.getInstance().rewardAdCd;t>0?(this.refreshNode.interactable=!1,f.default.setBtnIsGrey(this.refreshNode),this.lbRefush.string=f.default.formatDateTimeHourEx(t)):(this.refreshNode.interactable=!0,f.default.setBtnIsGrey(this.refreshNode,new cc.Color(157,104,72)),this.lbRefush.string=_.default.t("refresh"))}},e.prototype.onClickFinishedTask=function(){this.finishTask(null)},e.prototype.onClickGotoMerge=function(){d.default.getInstance().closeUI(m.default)},e.prototype.onClickRefreshTask=function(){var t=this;h.default.trackEventOnXG("common","Ad_button_click");var e=function(){var e=t._taskModel.refreshRequireItems();if(1===e)s.default.getInstance().updateTaskAndItem(),cc.director.getScene().emit(u.default.UPDATE_TOPINFO),cc.director.getScene().emit(u.default.UPDATE_MERGEAREA),t.updateUI();else if(-2===e)f.default.noDiamondsCommonPopup();else{var i={str:_.default.t("taskCustomerItem_2")};d.default.getInstance().openUI(p.default,{data:i})}};this._taskModel.mstData.refreshDiamonds>0?e():(h.default.trackEventOnXG("video","\u8ba2\u5355-\u987e\u5ba2\u4efb\u52a1-\u5237\u65b0",3,0),r.default.getInstance().showRewardAd(function(){h.default.trackEventOnXG("video","\u8ba2\u5355-\u987e\u5ba2\u4efb\u52a1-\u5237\u65b0",3,1),e()},function(){},function(){},"order_customer_video"))},e.prototype.finishTask=function(t){var e=this;void 0===t&&(t=null);var i=this._taskModel.completeTask();if(i){c.default.getInstance().playEffect("taskComplete");var a=function(){var t={id:30093};if(t.startNode=e.lbCoins.node,t.num=e._taskModel.coins,t.callback=function(){n()},cc.director.getScene().emit(u.default.ITEM_FLY,t),e._taskModel.mstData.reward.length>0){var i={};i.id=e._taskModel.mstData.reward[0],i.startNode=e.lbItemNum.node,i.num=1,cc.director.getScene().emit(u.default.ITEM_FLY,i)}},n=function(){c.default.getInstance().playEffect("orderShow"),cc.tween(e.node).call(function(){}).to(.6,{x:-950},{easing:"sineOut"}).call(function(){o()}).start()},o=function(){i.newTasks.length>0?(e.init(i.newTasks[0].orderId),c.default.getInstance().playEffect("orderShow"),cc.tween(e.node).to(1.2,{x:-2},{easing:"backOut"}).call(function(){d.default.getInstance().closeUI(l.default),s.default.getInstance().updateTaskAndItem(),cc.director.getScene().emit(u.default.UPDATE_MERGEAREA,i.cells),e._parent.updateUI(),t&&t()}).start()):(d.default.getInstance().closeUI(l.default),s.default.getInstance().updateTaskAndItem(),cc.director.getScene().emit(u.default.UPDATE_MERGEAREA,i.cells),e._parent.updateUI(),t&&t())};d.default.getInstance().openUI(l.default,{data:{showBlack:!1}},function(){a()})}else d.default.getInstance().openUI(p.default,{data:{str:_.default.t("taskCustomerItem_3")}})},o([b(cc.Label)],e.prototype,"lbName",void 0),o([b(cc.Node)],e.prototype,"itemListContent",void 0),o([b(cc.Prefab)],e.prototype,"itemListPrefab",void 0),o([b(cc.SpriteFrame)],e.prototype,"itemSpriteFrame",void 0),o([b(cc.SpriteFrame)],e.prototype,"itemCompleteSpriteFrame",void 0),o([b(cc.Button)],e.prototype,"refreshNode",void 0),o([b(cc.Label)],e.prototype,"lbRefush",void 0),o([b(cc.Label)],e.prototype,"lbCoins",void 0),o([b(cc.Node)],e.prototype,"rewardItemIcon",void 0),o([b(cc.Label)],e.prototype,"lbItemNum",void 0),o([b(cc.Node)],e.prototype,"finishNode",void 0),o([b(cc.Node)],e.prototype,"gotoMergeNode",void 0),o([b(cc.Node)],e.prototype,"unLockNode",void 0),o([b(cc.Node)],e.prototype,"refushVideo",void 0),o([b(cc.Node)],e.prototype,"refushDiamonds",void 0),o([b(cc.Label)],e.prototype,"refushDiaNum",void 0),o([b(cc.Label)],e.prototype,"lbTip",void 0),o([I],e)}(g.default);i.default=N,cc._RF.pop()},{"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/AudioManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/Loading":void 0,"../../scripts/prefabs/Toast":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../../scripts/utils/StatisticsManager":void 0,"../extension/ListItem":"ListItem","../prefabs/TaskPopup":"TaskPopup","./ItemList":"ItemList"}],TaskGiftPopup:[function(t,e,i){"use strict";cc._RF.push(e,"5a498xJ+sJH+KGQYcPTC3+c","TaskGiftPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MstData"),c=t("../../scripts/data/UserData"),d=t("../../scripts/manager/UIManager"),l=t("../../scripts/utils/EventName"),p=t("../../scripts/utils/GlobalFun"),u=t("../entitys/BuyItem"),f=t("../entitys/ItemEntity"),h=t("./AwardPopup"),g=cc._decorator,m=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemSp=null,e.item=null,e.timeLab=null,e.rewardNode=null,e.buyNode=null,e._endTime=0,e._model=null,e}return n(e,t),e.prototype.onLoad=function(){this._model=c.default.getInstance().activityData.taskGift,this._endTime=this._model.endTime,this.initUI(),this.updateBySecond(),cc.director.getScene().on(l.default.UPDATE_BY_SECOND,this.updateBySecond,this)},e.prototype.initUI=function(){var t=this,e=[this._model.rewardId];this._model.rewardData.reward&&e.push.apply(e,this._model.rewardData.reward);for(var i=0;i<e.length;i++)(n=cc.instantiate(this.item)).active=!0,(o={}).itemId=e[i],o.itemNum=1,o.isClickAble=!0,o.isShowInfo=!0,o.itemBg=this.itemSp,n.getChildByName("ItemEntity").getComponent(f.default).init(o),n.getChildByName("name").getComponent(cc.Label).string=r.default.getInstance().mstItem[e[i]].name,this.rewardNode.addChild(n);var a=this._model.rewardData.rewardRes;if(a)for(i=0;i<a.length;i++){var n,o;(n=cc.instantiate(this.item)).active=!0,(o={}).itemId=a[i],o.itemNum=a[i+1],o.isClickAble=!0,o.isShowInfo=!0,o.itemBg=this.itemSp,n.getChildByName("name").getComponent(cc.Label).string=r.default.getInstance().mstItem[a[i]].name,n.getChildByName("ItemEntity").getComponent(f.default).init(o),this.rewardNode.addChild(n),i++}var s={};s.nowCostNum=this._model.payNum,s.successCb=function(i){if(t._model.buyGift(i)){var n=p.default.getAllReward(e,a);d.default.getInstance().openUI(h.default,{data:n}),t.onClose()}},this.buyNode.getComponent(u.default).init(this._model.rewardData,s)},e.prototype.updateBySecond=function(){var t=Math.ceil(this._endTime-window.serverTime);t<0&&this.onClose(),t>=0&&(this.timeLab.string=p.default.timeFormat(t))},e.uiName="TaskGiftPopup",o([v(cc.SpriteFrame)],e.prototype,"itemSp",void 0),o([v(cc.Node)],e.prototype,"item",void 0),o([v(cc.Label)],e.prototype,"timeLab",void 0),o([v(cc.Node)],e.prototype,"rewardNode",void 0),o([v(cc.Node)],e.prototype,"buyNode",void 0),o([m],e)}(s.default);i.default=_,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../entitys/BuyItem":"BuyItem","../entitys/ItemEntity":"ItemEntity","./AwardPopup":"AwardPopup"}],TaskPopup:[function(t,e,i){"use strict";cc._RF.push(e,"0e6a9LdEXZFD4/OupbJUy25","TaskPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s,r=t("../../scripts/base/BaseUI"),c=t("../../scripts/data/MstData"),d=t("../../scripts/data/UserData"),l=t("../../scripts/manager/AdManager"),p=t("../../scripts/manager/UIManager"),u=t("../../scripts/prefabs/Toast"),f=t("../../scripts/utils/EventName"),h=t("../../scripts/utils/GlobalFun"),g=t("../../scripts/utils/StatisticsManager"),m=t("../entitys/TaskCustomerItem"),v=t("../entitys/TaskTradeItem"),_=t("../extension/List"),y=t("../../scripts/extension/LanguageData"),I=cc._decorator,b=I.ccclass,N=I.property;(function(t){t.CUSTOMER="customer",t.TRADING="trading"})(s||(s={}));var C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scrollViews=[],e.radioButton=null,e.spRedPoints=[],e.toggleList=[],e.tradeLockNode=null,e.customerTask=[],e.tradingTask=[],e._chooseIndex=0,e}return n(e,t),e.prototype.init=function(t){void 0===t&&(t=0),this._chooseIndex=Number(t),h.default.isCanShowBanner()&&l.default.getInstance().showBanner()},e.prototype.onLoad=function(){cc.director.getScene().on(f.default.LEVELUP,this.updateUI,this),cc.director.getScene().on(f.default.UPDATE_BY_SECOND,this.updateRewardCD,this),g.default.trackEvent("order_open"),this._chooseIndex>0&&this.toggleList[this._chooseIndex].check(),this.updateUI(),this.updateRewardCD()},e.prototype.updateRewardCD=function(){for(var t=this.scrollViews[this._chooseIndex].content.children,e=0;e<t.length;e++)0==this._chooseIndex?t[e].getComponent(m.default).refushVideoCD():1==this._chooseIndex&&t[e].getComponent(v.default).refushVideoCD()},e.prototype.updateUI=function(){this.updateTaskData();for(var t=0;t<this.scrollViews.length;t++)this.scrollViews[t].node.active=t===this._chooseIndex;switch(this._chooseIndex){case 0:this.scrollViews[0].numItems=this.customerTask.length;break;case 1:this.scrollViews[1].numItems=this.tradingTask.length}var e=d.default.getInstance().level,i=c.default.getInstance().mstMisc.tradingConfig.config[0];this.tradeLockNode.active=i>e},e.prototype.onClickToggle=function(t){var e=this.toggleList.indexOf(t);if(e!==this._chooseIndex){if(1==e){var i=c.default.getInstance().mstMisc.tradingConfig.config[0];if(d.default.getInstance().level<i)return this.toggleList[this._chooseIndex].check(),void p.default.getInstance().openUI(u.default,{data:{str:y.default.t("bottomInfoPrefab_1",{lv:i})}})}this._chooseIndex=e,this.updateUI()}},e.prototype.itemCustomerRender=function(t,e){t.getComponent(m.default).init(this.customerTask[e],this)},e.prototype.itemTradingRender=function(t,e){t.getComponent(v.default).init(this.tradingTask[e],this)},e.prototype.updateTaskData=function(){var t=this;this.customerTask=[],this.tradingTask=[],d.default.getInstance().taskData.forEach(function(e){e.mstData.type===s.CUSTOMER?t.customerTask.push(e.orderId):t.tradingTask.push(e.orderId)}),d.default.getInstance().getUnlockTaskNextLevel()>0&&this.customerTask.push("-1"),this.tradingTask.length=c.default.getInstance().mstMisc.tradingConfig.config.length,this.tradingTask.sort(function(t,e){var i=d.default.getInstance().getTaskDataByOrderId(t),a=d.default.getInstance().getTaskDataByOrderId(e);return i.id-a.id})},e.prototype.onDestroy=function(){h.default.isCanShowBanner()&&l.default.getInstance().hideBanner()},e.uiName="TaskPopup",o([N([_.default])],e.prototype,"scrollViews",void 0),o([N(cc.ToggleContainer)],e.prototype,"radioButton",void 0),o([N([cc.Sprite])],e.prototype,"spRedPoints",void 0),o([N([cc.Toggle])],e.prototype,"toggleList",void 0),o([N(cc.Node)],e.prototype,"tradeLockNode",void 0),o([b],e)}(r.default);i.default=C,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/Toast":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../../scripts/utils/StatisticsManager":void 0,"../entitys/TaskCustomerItem":"TaskCustomerItem","../entitys/TaskTradeItem":"TaskTradeItem","../extension/List":"List"}],TaskTradeItem:[function(t,e,i){"use strict";cc._RF.push(e,"31e99YxwQdJRagjgYzDbsHy","TaskTradeItem");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/MiscConfig"),r=t("../../scripts/data/MstData"),c=t("../../scripts/data/UserData"),d=t("../../scripts/manager/AdManager"),l=t("../../scripts/manager/AudioManager"),p=t("../../scripts/manager/UIManager"),u=t("../../scripts/prefabs/CommonPopup"),f=t("../../scripts/prefabs/Loading"),h=t("../../scripts/prefabs/Toast"),g=t("../../scripts/utils/EventName"),m=t("../../scripts/utils/GlobalFun"),v=t("../../scripts/utils/StatisticsManager"),_=t("../extension/ListItem"),y=t("../prefabs/AwardPopup"),I=t("../prefabs/Levelup"),b=t("./ItemList"),N=t("../../scripts/extension/LanguageData"),C=cc._decorator,k=C.ccclass,S=C.property,w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.shareSpf=null,e.videoSpf=null,e.videoIcon=null,e.lbName=null,e.lbTime=null,e.lbDiamondsCost=null,e.lbCoins=null,e.rewardIconNode=null,e.itemListContent=null,e.itemListPrefab=null,e.itemSpriteFrame=null,e.itemCompleteSpriteFrame=null,e.readyNode=null,e.refreshNode=null,e.lbRefush=null,e.speedUpNode=null,e.finishNode=null,e.lbLeftTime=null,e.car=null,e.nodeDes=null,e.nodeRedPoint=null,e.nodeInfo=null,e.limitedLvLabel=null,e.siji=null,e.sijicom=null,e.sijikaiche=null,e.weiqi=null,e.refushVideo=null,e.refushDiamonds=null,e.refushDiaNum=null,e._taskModel=null,e._mudidi=[N.default.t("taskTradeItem_1"),N.default.t("taskTradeItem_2"),N.default.t("taskTradeItem_3")],e._parent=null,e}return n(e,t),e.prototype.init=function(t,e){void 0===e&&(e=null),e&&(this._parent=e),this._taskModel=c.default.getInstance().getTaskDataByOrderId(t),this.updateUI()},e.prototype.onLoad=function(){cc.director.getScene().on(g.default.UPDATE_BY_SECOND,this.updateBySecond,this)},e.prototype.updateUI=function(){var t=r.default.getInstance().mstMisc.tradingConfig.config[this.listId];if(c.default.getInstance().level<t)this.nodeDes.active=!0,this.nodeInfo.active=!1,this.car.active=!1,this.limitedLvLabel.string=N.default.t("taskTradeItem_8",{unlockLevel:t});else{this.nodeDes.active=!1,this.nodeInfo.active=!0,this.car.active=!0,this.lbCoins.string="x"+this._taskModel.coins;for(var e=this._taskModel.mstData.reward,i=function(t){var i=a.rewardIconNode.children[t+1];if(e[t]){i.active=!0;var n=m.default.getItemIconPathById(e[t]),o=i.getChildByName("iconbg").getChildByName("icon");m.default.loadSpriteFrame(o.getComponent(cc.Sprite),n,function(){var t=60/o.width,e=60/o.height;o.scale=t<e?t:e}),i.getChildByName("lbReward").getComponent(cc.Label).string="x1"}else i.active=!1},a=this,n=0;n<2;n++)i(n);if(0==this.itemListContent.childrenCount){var o=cc.instantiate(this.itemListPrefab);this.itemListContent.addChild(o)}var s=this.getItemData();if(this.itemListContent.children[0].getComponent(b.default).init({itemsData:s,spacingX:10}),this._taskModel.startTime)if(this._taskModel.tradingLeftTime>0){this.car.x=this.node.width,this.car.scaleX=-1,this.readyNode.active=!1,this.refreshNode.node.active=!1,this.speedUpNode.active=!0,this.finishNode.active=!1,this.lbLeftTime.string=N.default.t("hemaPrefab_2",{time:m.default.formatDateTimeHourEx(this._taskModel.tradingLeftTime)});var d=this._taskModel.tradingLeftTime>3600?3600:this._taskModel.tradingLeftTime;this.lbDiamondsCost.string=m.default.getNeedDiamondByTime(d)+""}else this.car.scaleX=-1,this.itemListContent.scaleX=-1,this.car.x=0,this.readyNode.active=!1,this.refreshNode.node.active=!1,this.speedUpNode.active=!1,this.finishNode.active=!0,this.lbLeftTime.string=N.default.t("taskTradeItem_4");else this.readyNode.active=!0,this.refreshNode.node.active=!0,this.speedUpNode.active=!1,this.finishNode.active=!1,this._taskModel.mstData.refreshDiamonds>0?(this.refushVideo.active=!1,this.refushDiamonds.active=!0,this.refushDiaNum.string="x"+this._taskModel.mstData.refreshDiamonds):(this.refushVideo.active=!0,this.refushDiamonds.active=!1);this.lbName.string=this._mudidi[this._taskModel.id%10-1];var l=this._taskModel.mstData.times;this.lbTime.string=m.default.formatDateTimeHourEx(l)}},e.prototype.refushVideoCD=function(){if(this.refreshNode.node.active&&this.refushVideo.active){var t=d.default.getInstance().rewardAdCd;t>0?(this.refreshNode.interactable=!1,m.default.setBtnIsGrey(this.refreshNode),this.lbRefush.string=m.default.formatDateTimeHourEx(t)):(this.refreshNode.interactable=!0,m.default.setBtnIsGrey(this.refreshNode,new cc.Color(64,98,35)),this.lbRefush.string=N.default.t("refresh"))}},e.prototype.getItemData=function(){var t=[];if(this._taskModel.startTime&&this._taskModel.tradingLeftTime<=0)for(var e=this._taskModel.mstData.reward.length,i=0;i<e;i++)(n={uiName:"TaskPopup"}).itemId=this._taskModel.mstData.reward[i],n.isClickAble=!0,n.isComplete=!1,n.itemBg=this.itemSpriteFrame,t.push(n);else{e=this._taskModel.requireItems.length;var a=c.default.getInstance().getNormalItemIndexByIds(this._taskModel.requireItems);if(this._taskModel.isComplete)for(i=0;i<e;i++)(n={uiName:"TaskPopup"}).itemId=this._taskModel.requireItems[i],n.itemBg=this.itemCompleteSpriteFrame,n.isComplete=!0,t.push(n);else for(i=0;i<e;i++){var n;(n={uiName:"TaskPopup"}).itemId=this._taskModel.requireItems[i],n.isClickAble=!0,a[i]>=0?(n.isComplete=!0,n.itemBg=this.itemCompleteSpriteFrame):(n.isComplete=!1,n.itemBg=this.itemSpriteFrame),t.push(n)}}return t},e.prototype.updateBySecond=function(){null!=this._taskModel&&cc.isValid(this.node)&&this._taskModel.startTime&&this.updateLeftTime()},e.prototype.updateLeftTime=function(){if(this._taskModel.tradingLeftTime>=0){this.lbLeftTime.string=N.default.t("hemaPrefab_2",{time:m.default.formatDateTimeHourEx(this._taskModel.tradingLeftTime)});var t=this._taskModel.tradingLeftTime>3600?3600:this._taskModel.tradingLeftTime;this.lbDiamondsCost.string=m.default.getNeedDiamondByTime(t)+""}else this.speedUpNode.active&&(this.lbLeftTime.string="",this.updateUI(),this.carBackAnimaation())},e.prototype.onStartClick=function(){var t=this;1===this._taskModel.progress?p.default.getInstance().openUI(f.default,{data:{showBlack:!1}},function(){var e=t._taskModel.startTask();e&&(c.default.getInstance().updateTaskAndItem(),cc.director.getScene().emit(g.default.UPDATE_MERGEAREA,e.cells),t.nodeRedPoint.active=!1);var i={},a=t.lbCoins.node;i.id=30093,i.startNode=a,i.num=t._taskModel.coins,cc.director.getScene().emit(g.default.ITEM_FLY,i);var n=t.car.getComponent(cc.Animation);n.on(cc.Animation.EventType.FINISHED,function(){n.play("ani_carmove"),t.siji.spriteFrame=t.sijikaiche,cc.tween(t.car).to(1,{x:-t.node.width}).call(function(){t.car.scaleX=-1,t.updateUI(),p.default.getInstance().closeUI(f.default)}).start(),l.default.getInstance().playEffect("carGo"),n.off(cc.Animation.EventType.FINISHED)}),n.play("ani_carstart")}):p.default.getInstance().openUI(h.default,{data:{str:N.default.t("taskTradeItem_5")}})},e.prototype.onRefreshClick=function(){var t=this,e=function(){var e=t._taskModel.refreshRequireItems();if(1==e)c.default.getInstance().updateTaskAndItem(),cc.director.getScene().emit(g.default.UPDATE_MERGEAREA),cc.director.getScene().emit(g.default.UPDATE_TOPINFO),t.updateUI();else if(-2===e)m.default.noDiamondsCommonPopup();else{var i={str:N.default.t("taskCustomerItem_2")};p.default.getInstance().openUI(h.default,{data:i})}};this._taskModel.mstData.refreshDiamonds>0?e():d.default.getInstance().showRewardAd(e,function(){},function(){})},e.prototype.onSpeedupVideoClick=function(){var t=this;v.default.trackEventOnXG("common","Ad_button_click"),v.default.trackEventOnXG("video","\u8ba2\u5355-\u8d38\u6613",2,0);var e,i,a=this._taskModel.tradingLeftTime>3600?3600:this._taskModel.tradingLeftTime;e=a,i={contentText:N.default.t("taskTradeItem_9",{count:m.default.getNeedDiamondByTime(e)}),model:s.default.COMMON_POPUP_MODEL_2,okCallback:function(){v.default.trackEventOnXG("video","\u8ba2\u5355-\u8d38\u6613",2,1),t._taskModel.speedUpTask(e)?(t.updateLeftTime(),t.updateUI(),t.carBackAnimaation(),cc.director.getScene().emit(g.default.UPDATE_TOPINFO)):m.default.noDiamondsCommonPopup()}},p.default.getInstance().openUI(u.default,{data:i})},e.prototype.carBackAnimaation=function(){var t=this;this._taskModel.tradingLeftTime>0||(this.nodeRedPoint.active=!1,this.car.x=this.node.width,p.default.getInstance().openUI(f.default,{data:{showBlack:!1}},function(){var e=t.car.getComponent(cc.Animation);e.play("ani_carmove"),t.siji.spriteFrame=t.sijikaiche,t.weiqi.active=!0,cc.tween(t.car).call(function(){t.car.scaleX=-1,t.car.x=-t.node.width}).to(.5,{x:0}).call(function(){e.stop("ani_carmove"),t.updateLeftTime(),t.updateUI(),p.default.getInstance().closeUI(f.default),t.siji.spriteFrame=t.sijicom,t.weiqi.active=!1}).start(),l.default.getInstance().playEffect("carEnd")}))},e.prototype.onReceiveClick=function(){var t=this,e=this._taskModel.mstData.reward,i=[];e.length>0&&e.forEach(function(t){var e={};-1!==i.indexOf(t)?i[i.indexOf(t)].num++:(e.id=t,e.num=1,i.push(e))});var a=c.default.getInstance().level,n=this._taskModel.completeTask();n?(this.nodeRedPoint.active=!1,p.default.getInstance().openUI(f.default,{data:{showBlack:!1}},function(){t.beginCoinFly(n,i,a)})):this.SetToastData(N.default.t("taskTradeItem_7"))},e.prototype.beginCoinFly=function(t,e,i){var a=this;cc.tween(this.car).to(.7,{x:this.node.width}).call(function(){a.car.scaleX=1,a.itemListContent.scaleX=1,a.init(t.newTasks[0].orderId),a.updateLeftTime(),a.showRewardsWin(e,i)}).start()},e.prototype.showRewardsWin=function(t,e){var i=this;cc.tween(this.car).to(.7,{x:0}).call(function(){p.default.getInstance().closeUI(f.default),c.default.getInstance().updateTaskAndItem(),cc.director.getScene().emit(g.default.UPDATE_MERGEAREA),i._parent.updateUI()}).start(),p.default.getInstance().openUI(y.default,{data:t},void 0,function(){c.default.getInstance().level>e&&p.default.getInstance().openUI(I.default,{data:{historyLevel:e}})})},e.prototype.SetToastData=function(t){var e={str:t};p.default.getInstance().openUI(h.default,{data:e})},o([S(cc.SpriteFrame)],e.prototype,"shareSpf",void 0),o([S(cc.SpriteFrame)],e.prototype,"videoSpf",void 0),o([S(cc.Sprite)],e.prototype,"videoIcon",void 0),o([S(cc.Label)],e.prototype,"lbName",void 0),o([S(cc.Label)],e.prototype,"lbTime",void 0),o([S(cc.Label)],e.prototype,"lbDiamondsCost",void 0),o([S(cc.Label)],e.prototype,"lbCoins",void 0),o([S(cc.Node)],e.prototype,"rewardIconNode",void 0),o([S(cc.Node)],e.prototype,"itemListContent",void 0),o([S(cc.Prefab)],e.prototype,"itemListPrefab",void 0),o([S(cc.SpriteFrame)],e.prototype,"itemSpriteFrame",void 0),o([S(cc.SpriteFrame)],e.prototype,"itemCompleteSpriteFrame",void 0),o([S(cc.Node)],e.prototype,"readyNode",void 0),o([S(cc.Button)],e.prototype,"refreshNode",void 0),o([S(cc.Label)],e.prototype,"lbRefush",void 0),o([S(cc.Node)],e.prototype,"speedUpNode",void 0),o([S(cc.Node)],e.prototype,"finishNode",void 0),o([S(cc.Label)],e.prototype,"lbLeftTime",void 0),o([S(cc.Node)],e.prototype,"car",void 0),o([S(cc.Node)],e.prototype,"nodeDes",void 0),o([S(cc.Node)],e.prototype,"nodeRedPoint",void 0),o([S(cc.Node)],e.prototype,"nodeInfo",void 0),o([S(cc.Label)],e.prototype,"limitedLvLabel",void 0),o([S(cc.Sprite)],e.prototype,"siji",void 0),o([S(cc.SpriteFrame)],e.prototype,"sijicom",void 0),o([S(cc.SpriteFrame)],e.prototype,"sijikaiche",void 0),o([S(cc.Node)],e.prototype,"weiqi",void 0),o([S(cc.Node)],e.prototype,"refushVideo",void 0),o([S(cc.Node)],e.prototype,"refushDiamonds",void 0),o([S(cc.Label)],e.prototype,"refushDiaNum",void 0),o([k],e)}(_.default);i.default=w,cc._RF.pop()},{"../../scripts/data/MiscConfig":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/AudioManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/CommonPopup":void 0,"../../scripts/prefabs/Loading":void 0,"../../scripts/prefabs/Toast":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../../scripts/utils/StatisticsManager":void 0,"../extension/ListItem":"ListItem","../prefabs/AwardPopup":"AwardPopup","../prefabs/Levelup":"Levelup","./ItemList":"ItemList"}],TipGuide:[function(t,e,i){"use strict";cc._RF.push(e,"478e7KcoYRATY088FL8Li00","TipGuide");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/UserData"),r=t("../../scripts/manager/UIManager"),c=t("../../scripts/utils/ActionFunc"),d=t("../../scripts/utils/EventName"),l=t("../../scripts/utils/GlobalFun"),p=cc._decorator,u=p.ccclass,f=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.handNode=null,e._clickIndex=-1,e._mergeIndex=[],e}return n(e,t),e.prototype.onLoad=function(){cc.director.getScene().on(d.default.TIP_GUIDE_START,this.startTip,this),cc.director.getScene().on(d.default.TIP_GUIDE_STOP,this.stopTip,this)},e.prototype.startTip=function(){this.handNode.active=!0,this.isTipBuilding()?this.tipBuilding():this.isTipTaskComplete()?this.tipTaskComplete():this.isTipClick()?this.tipClick():this.isTipMerge()?this.tipMerge():this.stopTip()},e.prototype.stopTip=function(){this.handNode.active=!1,this.handNode.getComponent(cc.Animation).stop(),this.handNode.stopAllActions(),this.handNode.children[0].scale=1,this.handNode.children[0].x=0,this.handNode.children[0].y=0},e.prototype.isTipBuilding=function(){return s.default.getInstance().level<5&&!r.default.getInstance().getUI("Guide")&&s.default.getInstance().getCompleteBuildingTaskId().length>0},e.prototype.tipBuilding=function(){var t=this.getBtnTopTask(),e=t.parent.convertToWorldSpaceAR(t.position),i=this.node.convertToNodeSpaceAR(e);this.handNode.setPosition(i),this.handNode.getComponent(cc.Animation).play()},e.prototype.isTipTaskComplete=function(){if(s.default.getInstance().level<5&&!r.default.getInstance().getUI("Guide")){var t=s.default.getInstance().taskData;if(t[0]&&t[0].isComplete)return!0}return!1},e.prototype.tipTaskComplete=function(){var t=this.getTopFirstTask(),e=t.parent.convertToWorldSpaceAR(t.position),i=this.node.convertToNodeSpaceAR(e);this.handNode.setPosition(i),this.handNode.getComponent(cc.Animation).play()},e.prototype.isTipClick=function(){if(s.default.getInstance().level<5&&!r.default.getInstance().getUI("Guide")){var t=s.default.getInstance().getMergeTip(),e=s.default.getInstance().getAvailableSpawnerOrBoxIndex();if(0==t.length&&e>=0)return this._clickIndex=e,!0}return!1},e.prototype.tipClick=function(){var t=this.getMergeManagerClass().itemPrefabList[this._clickIndex].node,e=t.parent.convertToWorldSpaceAR(t.position),i=this.node.convertToNodeSpaceAR(e);this.handNode.setPosition(i),this.handNode.getComponent(cc.Animation).play()},e.prototype.isTipMerge=function(){if(s.default.getInstance().level<5&&!r.default.getInstance().getUI("Guide")){var t=s.default.getInstance().getMergeTip();if(t.length>=2)return this._mergeIndex=t,!0}return!1},e.prototype.tipMerge=function(){var t=this.getMergeManagerClass(),e=t.itemPrefabList[this._mergeIndex[0]].node,i=t.itemPrefabList[this._mergeIndex[1]].node,a=e.parent.convertToWorldSpaceAR(e.position),n=i.parent.convertToWorldSpaceAR(i.position),o=this.node.convertToNodeSpaceAR(a),s=this.node.convertToNodeSpaceAR(n),r=l.default.getTimeByPosAndSpeed(o,s,200),d=c.default.toAndFroAnimation(this.handNode,o,s,r);c.default.playAction(this.handNode,d,!1,null,!0)},e.prototype.getBtnTopTask=function(){return cc.find("Canvas/MergeUIContent/MergeUI/topInfoContent/TopInfoPrefab/tasks/btnTask")},e.prototype.getTopFirstTask=function(){return cc.find("Canvas/MergeUIContent/MergeUI/topInfoContent/TopInfoPrefab/tasks/tasksScrollView/view/content").children[0]},e.prototype.getMergeManagerClass=function(){return cc.find("Canvas/MergeUIContent/MergeUI/MergeManager").getComponent("MergeManager")},o([f(cc.Node)],e.prototype,"handNode",void 0),o([u],e)}(cc.Component);i.default=h,cc._RF.pop()},{"../../scripts/data/UserData":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/utils/ActionFunc":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0}],TopInfoPrefab:[function(t,e,i){"use strict";cc._RF.push(e,"55e0dY+aNREq43oXCBl8Y2Z","TopInfoPrefab");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/MiscConfig"),r=t("../../scripts/data/MstData"),c=t("../../scripts/data/UserData"),d=t("../../scripts/data/userModel/UserItemModel"),l=t("../../scripts/manager/AdManager"),p=t("../../scripts/manager/AudioManager"),u=t("../../scripts/manager/UIManager"),f=t("../../scripts/prefabs/Toast"),h=t("../../scripts/utils/ActionFunc"),g=t("../../scripts/utils/EventName"),m=t("../../scripts/utils/GlobalFun"),v=t("../../scripts/utils/StatisticsManager"),_=t("../extension/List"),y=t("../prefabs/BuildTaskPopup"),I=t("../prefabs/ItemChain"),b=t("../prefabs/UnlockShowPopup"),N=t("./MergeManager"),C=t("./TopInfoTaskItem"),k=t("../../scripts/extension/LanguageData"),S=cc._decorator,w=S.ccclass,T=S.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnBuildingTaskNode=null,e.buildingTaskRedPointNode=null,e.taskList=null,e.itemNameContent=null,e.itemInfoBtnContent=null,e.btnRebackNode=null,e.lbName=null,e.itemChainNode=null,e.lbTime=null,e.lbDes=null,e.speedUpBtnNode=null,e.clearVideoIcon=null,e.lbSpeedUpText=null,e.speedUpIconNode=null,e.lbSpeedUpPrice=null,e.lbVideoCount=null,e.sellBtnNode=null,e.lbsellText=null,e.lbsellPrice=null,e.videoBtnNode=null,e.lbVideoBtnText=null,e.activityRoot=null,e._chooseItemIndex=-1,e._tempItemData=null,e._isFree=!1,e._taskItemList=[],e._isAddActiveBtn=!1,e}return n(e,t),e.prototype.onLoad=function(){cc.director.getScene().on(g.default.UPDATE_ITEM_INFO,this.updateItemInfo,this),cc.director.getScene().on(g.default.UPDATE_MERGEAREA,this.updateTask,this),cc.director.getScene().on(g.default.LEVELUP,this.leveUpOpt,this),cc.director.getScene().on(g.default.UPDATE_TOPINFO,this.updateBuildingTask,this),cc.director.getScene().on(g.default.UPDATE_BY_SECOND,this.updateBySecond,this),cc.director.getScene().on(g.default.RESET_ACTIVITY,this.initActivityBtn,this),this.initActivityBtn(),this.updateBuildingTask(),this.updateTask(),this.updateItemInfo()},e.prototype.leveUpOpt=function(){this.updateTask(),this.updateBuildingTask(),this.initActivityBtn()},e.prototype.itemElementRender=function(t,e){t.getComponent(C.default).init(this._taskItemList[e])},e.prototype.updateTask=function(){this._taskItemList=this.getShowTaskOrderIds(),this.taskList.numItems=this._taskItemList.length;var t=c.default.getInstance().getTaskDataByOrderId(this._taskItemList[0]);t&&t.isComplete&&this.node.getChildByName("tasks").getChildByName("tasksScrollView").getComponent(cc.ScrollView).scrollToLeft(.5)},e.prototype.getShowTaskOrderIds=function(){for(var t=c.default.getInstance().taskData,e=[],i=[],a=0;a<t.length;a++)"customer"==t[a].mstData.type?e.push(t[a].orderId):"trading"==t[a].mstData.type&&(t[a].startTime&&t[a].tradingLeftTime>0?i.push(t[a].orderId):e.push(t[a].orderId));return e=e.concat(i),c.default.getInstance().getUnlockTaskNextLevel()>0&&e.push("-1"),e},e.prototype.updateBuildingTask=function(){c.default.getInstance().getCompleteBuildingTaskId().length>0?this.buildingTaskRedPointNode.active||(this.buildingTaskRedPointNode.active=!0,h.default.zoomAnim2(this.btnBuildingTaskNode)):this.buildingTaskRedPointNode.active&&(this.buildingTaskRedPointNode.active=!1,cc.Tween.stopAllByTarget(this.btnBuildingTaskNode),this.btnBuildingTaskNode.scale=1)},e.prototype.updateItemInfo=function(t){if(void 0===t&&(t=-1),this._chooseItemIndex!=t&&(this._tempItemData=null,this._chooseItemIndex=t),-1==this._chooseItemIndex||this._tempItemData||c.default.getInstance().itemData[this._chooseItemIndex].id<0)if(this.itemNameContent.active=!1,this.itemInfoBtnContent.active=!1,this._tempItemData){this.btnRebackNode.active=!0;var e=r.default.getInstance().mstItem[this._tempItemData.id].name,i=r.default.getInstance().mstItem[this._tempItemData.id].level;this.lbDes.string=k.default.t("topInfoPrefab_1",{itemName:e,itemLevel:i})}else this.btnRebackNode.active=!1,this.lbDes.string=k.default.t("topInfoPrefab_2");else{this.itemNameContent.active=!0,this.itemInfoBtnContent.active=!0,this.btnRebackNode.active=!1;var a=c.default.getInstance().itemData[this._chooseItemIndex];if(this.lbName.string=k.default.t("topInfoPrefab_3",{itemName:a.mstData.name,lv:a.mstData.level}),this.lbTime.node.parent.active=!0,this.videoBtnNode.node.active=!1,this.lbVideoBtnText.string=k.default.t("topInfoPrefab_14"),this.speedUpBtnNode.active=!1,this.speedUpIconNode.active=!0,this.lbSpeedUpText.node.height=40,this.lbSpeedUpText.node.y=41,a.mstData.isBox&&a.state==s.default.ITEM_STATE_NORMAL)if(a.isOpened)this.lbTime.node.parent.active=!1,this.lbTime.string="";else if(a.coolingTime>=0){var n=a.coolingTime;if(this.lbTime.string=m.default.formatDateTimeHourEx(n),a.isShowVideo){this.videoBtnNode.node.active=!0;var o=r.default.getInstance().mstMisc.clearMaxTimeByVideoTimes.config-c.default.getInstance().clearVideoTimes;this.lbVideoCount.string=o<=10?k.default.t("topInfoPrefab_15",{count:o}):""}this.speedUpBtnNode.active=!0,this.lbSpeedUpText.node.height=40,this.lbSpeedUpText.string=k.default.t("topInfoPrefab_4"),this.lbSpeedUpPrice.string=""+a.clearCoolDiamonds,this.guideFree()}else this.speedUpBtnNode.active=!0,this.speedUpIconNode.active=!1,this.lbSpeedUpText.node.height=40,this.lbSpeedUpText.string=k.default.t("topInfoPrefab_5"),this.lbSpeedUpPrice.string="",this.lbSpeedUpText.node.y=20,this.lbTime.string=m.default.formatDateTimeHourEx(a.mstData.openingTime);else if(a.mstData.isSpawner&&a.state==s.default.ITEM_STATE_NORMAL)(n=a.coolingTime)>0?(this.lbTime.string=m.default.formatDateTimeHourEx(n),a.isShowVideo&&(this.videoBtnNode.node.active=!0,o=r.default.getInstance().mstMisc.clearMaxTimeByVideoTimes.config-c.default.getInstance().clearVideoTimes,this.lbVideoCount.string=o<=10?k.default.t("topInfoPrefab_15",{count:o}):""),this.speedUpBtnNode.active=!0,this.lbSpeedUpText.node.height=40,this.lbSpeedUpText.string=k.default.t("topInfoPrefab_4"),this.lbSpeedUpPrice.string=""+a.clearCoolDiamonds,this.guideFree()):this.lbTime.node.parent.active=!1;else if(a.decayAttribute&&a.decayAttribute.length>0)if(this.lbTime.string=m.default.formatDateTimeHourEx(a.decayTime),a.state==s.default.ITEM_STATE_BUBBLE){var d=a.mstData.diamondsPrice;a.isShowVideo&&(this.lbVideoBtnText.string=k.default.t("topInfoPrefab_16"),this.videoBtnNode.node.active=!0,o=r.default.getInstance().mstMisc.getBubbleByVideoTimes.config-c.default.getInstance().bubbleVideoTimes,this.lbVideoCount.string=o<=10?k.default.t("topInfoPrefab_15",{count:o}):""),this.speedUpBtnNode.active=!0,this.lbSpeedUpText.node.height=40,this.lbSpeedUpText.string=k.default.t("buildInfoPopup_3"),this.lbSpeedUpPrice.string=d,this.guideFree()}else a.isShowVideo&&(this.videoBtnNode.node.active=!0,o=r.default.getInstance().mstMisc.clearMaxTimeByVideoTimes.config-c.default.getInstance().clearVideoTimes,this.lbVideoCount.string=o<=10?k.default.t("topInfoPrefab_15",{count:o}):""),this.speedUpBtnNode.active=!0,this.lbSpeedUpText.node.height=40,this.lbSpeedUpText.string=k.default.t("topInfoPrefab_4"),this.lbSpeedUpPrice.string=""+a.clearDecayDiamonds,this.guideFree();else this.lbTime.node.parent.active=!1;this.itemChainNode.active=!0,a.state==s.default.ITEM_STATE_NORMAL?this.lbDes.string=a.mstData.desc:a.state==s.default.ITEM_STATE_BUBBLE?this.lbDes.string=k.default.t("topInfoPrefab_7"):a.state==s.default.ITEM_STATE_COBWEB?this.lbDes.string=k.default.t("topInfoPrefab_8"):a.state==s.default.ITEM_STATE_UNKNOWN?(this.lbName.string=k.default.t("topInfoPrefab_9"),this.lbDes.string=k.default.t("topInfoPrefab_10"),this.itemChainNode.active=!1):(a.state,s.default.ITEM_STATE_lOCK),this.sellBtnNode.active=!1,this.lbsellText.string=k.default.t("topInfoPrefab_11"),this.lbsellText.node.y=14.3,this.sellBtnNode.children[1].active=!0,this.sellBtnNode.children[2].active=!0,a.mstData.deleteAble&&a.state==s.default.ITEM_STATE_NORMAL&&(this.sellBtnNode.active=!0,this.lbsellPrice.string=a.mstData.sellCoins)}this.updateRewardCD()},e.prototype.updatelbTime=function(){if(!(-1==this._chooseItemIndex||this._tempItemData||c.default.getInstance().itemData[this._chooseItemIndex].id<0)){var t=c.default.getInstance().itemData[this._chooseItemIndex];if(t.mstData.isBox&&t.state==s.default.ITEM_STATE_NORMAL){if(!t.isOpened&&t.coolingTime>=0){var e=t.coolingTime;this.lbTime.string=m.default.formatDateTimeHourEx(e),this.lbSpeedUpPrice.string=""+t.clearCoolDiamonds,this.guideFree()}}else t.mstData.isSpawner&&t.state==s.default.ITEM_STATE_NORMAL?(e=t.coolingTime)>0&&(this.lbTime.string=m.default.formatDateTimeHourEx(e),this.lbSpeedUpPrice.string=""+t.clearCoolDiamonds,this.guideFree()):t.decayAttribute&&t.decayAttribute.length>0&&(this.lbTime.string=m.default.formatDateTimeHourEx(t.decayTime),this.guideFree())}},e.prototype.updateRewardCD=function(){if(this.videoBtnNode.node.active){var t=l.default.getInstance().rewardAdCd;if(t>0)this.videoBtnNode.interactable=!1,m.default.setBtnIsGrey(this.videoBtnNode),this.clearVideoIcon.active=!1,this.lbVideoBtnText.node.x=0,this.lbVideoBtnText.node.y=0,this.lbVideoBtnText.string=m.default.formatDateTimeHourEx(t);else if(this.videoBtnNode.interactable=!0,m.default.setBtnIsGrey(this.videoBtnNode,new cc.Color(64,98,35)),this.clearVideoIcon.active=!0,this.lbVideoBtnText.node.x=15,this.lbVideoBtnText.node.y=3.5,this.lbVideoBtnText.string=k.default.t("topInfoPrefab_14"),this._chooseItemIndex>0){var e=c.default.getInstance().itemData[this._chooseItemIndex];e.decayAttribute&&e.decayAttribute.length>0&&e.state==s.default.ITEM_STATE_BUBBLE&&e.isShowVideo&&(this.lbVideoBtnText.string=k.default.t("topInfoPrefab_16"))}}},e.prototype.updateBySecond=function(){this.updatelbTime(),this.updateRewardCD()},e.prototype.onClickVideoSpeedUp=function(){var t=this;v.default.trackEventOnXG("common","Ad_button_click");var e=c.default.getInstance().itemData[this._chooseItemIndex],i=r.default.getInstance().mstItem[e.id],a=null;if(i.isSpawner&&e.state==s.default.ITEM_STATE_NORMAL)e.isCool&&(v.default.trackEventOnXG("video","\u4ea7\u51fa\u7269\u54c1CD",15,0),e.clearCoolDiamonds<=r.default.getInstance().mstMisc.clearMaxTimeByVideo.config&&(a=function(){e.clearCoolTime(!0),c.default.getInstance().addClearVideoTimes(),v.default.trackEventOnXG("video","\u4ea7\u51fa\u7269\u54c1CD",15,1)}));else if(i.isBox&&e.state==s.default.ITEM_STATE_NORMAL)!e.isOpened&&e.coolingTime&&e.lastCoolingTime&&(v.default.trackEventOnXG("video","\u5f00\u5b9d\u7bb1",16,0),e.clearCoolDiamonds<=r.default.getInstance().mstMisc.clearMaxTimeByVideo.config&&(a=function(){e.clearCoolTime(!0),c.default.getInstance().addClearVideoTimes(),v.default.trackEventOnXG("video","\u5f00\u5b9d\u7bb1",16,1)}));else if(e.decayAttribute&&e.decayAttribute.length>0)if(e.state==s.default.ITEM_STATE_BUBBLE){var n=e.id;v.default.trackEventOnXG("video","\u6c14\u6ce1\u8d2d\u4e70",17,0),a=function(){var t=e.buyItem(!0,n);c.default.getInstance().addBulleVideoTimes(),p.default.getInstance().playEffect("bubbleBreak"),t&&t.newCustomerId>0&&u.default.getInstance().openNotice(b.default,{data:{ntype:"customer",id:t.newCustomerId}}),t&&t.newItemId>=0&&r.default.getInstance().mstItem[t.newItemId].isUnlockShow&&u.default.getInstance().openNotice(b.default,{data:{ntype:"item",id:t.newItemId}}),v.default.trackEventOnXG("video","\u6c14\u6ce1\u8d2d\u4e70",17,1)}}else e.clearDecayDiamonds<=r.default.getInstance().mstMisc.clearMaxTimeByVideo.config&&(v.default.trackEventOnXG("video","\u7269\u54c1\u52a0\u901f",18,0),a=function(){e.speedupDecay(!0),c.default.getInstance().addClearVideoTimes(),v.default.trackEventOnXG("video","\u7269\u54c1\u52a0\u901f",18,1)});l.default.getInstance().showRewardAd(function(){a&&a(),c.default.getInstance().updateTaskAndItem(),cc.director.getScene().emit(g.default.UPDATE_MERGEAREA,[t._chooseItemIndex]),t.updateItemInfo(t._chooseItemIndex),cc.director.getScene().emit(g.default.UPDATE_TOPINFO)},function(){},function(){},"topInfo_speedup_video")},e.prototype.onClickSpeedUp=function(){var t=c.default.getInstance().itemData[this._chooseItemIndex],e=r.default.getInstance().mstItem[t.id],i=0,a=null;e.isSpawner&&t.state==s.default.ITEM_STATE_NORMAL?t.isCool&&(i=t.clearCoolDiamonds,a=function(){t.clearCoolTime(),v.default.trackEvent("topInfo_clearCoolTime_click",{itemId:t.id})}):e.isBox&&t.state==s.default.ITEM_STATE_NORMAL?!t.isOpened&&t.coolingTime<0?"maxOpening"==c.default.getInstance().clickItem(this._chooseItemIndex).result&&u.default.getInstance().openUI(f.default,{data:{str:k.default.t("topInfoPrefab_12")}}):!t.isOpened&&t.coolingTime&&t.lastCoolingTime&&(i=t.clearCoolDiamonds,a=function(){t.clearCoolTime(),v.default.trackEvent("topInfo_clearCoolTime_click",{itemId:t.id})}):t.decayAttribute&&t.decayAttribute.length>0&&(t.state==s.default.ITEM_STATE_BUBBLE?(i=e.diamondsPrice,a=function(){var e=t.buyItem();p.default.getInstance().playEffect("bubbleBreak"),v.default.trackEvent("topInfo_buyBubble_click",{itemId:t.id}),e&&e.newCustomerId>0&&u.default.getInstance().openNotice(b.default,{data:{ntype:"customer",id:e.newCustomerId}}),e&&e.newItemId>=0&&r.default.getInstance().mstItem[e.newItemId].isUnlockShow&&u.default.getInstance().openNotice(b.default,{data:{ntype:"item",id:e.newItemId}})}):(i=t.clearDecayDiamonds,a=function(){t.speedupDecay(),v.default.trackEvent("topInfo_speedupDecay_click",{itemId:t.id})})),c.default.getInstance().diamonds>=i?(a&&a(),c.default.getInstance().updateTaskAndItem(),cc.director.getScene().emit(g.default.UPDATE_MERGEAREA,[this._chooseItemIndex]),this.updateItemInfo(this._chooseItemIndex),cc.director.getScene().emit(g.default.UPDATE_TOPINFO)):m.default.noDiamondsCommonPopup()},e.prototype.onClickSell=function(){var t=c.default.getInstance().itemData[this._chooseItemIndex];this._tempItemData=c.default.getInstance().itemData[this._chooseItemIndex].zipData();var e=c.default.getInstance().itemData[this._chooseItemIndex].sellItem();v.default.trackEvent("topInfo_sell_click",{itemId:t.id}),e&&(c.default.getInstance().updateTaskAndItem(),cc.director.getScene().emit(g.default.UPDATE_TOPINFO),cc.director.getScene().emit(g.default.UPDATE_MERGEAREA,[this._chooseItemIndex])),this.updateItemInfo(this._chooseItemIndex)},e.prototype.onClickReback=function(){if(this._tempItemData){var t=r.default.getInstance().mstItem[this._tempItemData.id].sellCoins;if(c.default.getInstance().addCoins(-t)>=0){var e=this._tempItemData.id;if(c.default.getInstance().itemData[this._chooseItemIndex].id>0){c.default.getInstance().addReward([this._tempItemData]),this._tempItemData=null;var i={},a=cc.find("Canvas/MergeUIContent/MergeUI/MergeManager").getComponent(N.default);i.id=e,i.startNode=a.itemIconPrefabList[this._chooseItemIndex].node,i.num=1,i.callback=function(){cc.director.getScene().emit(g.default.UPDATE_REWARD)},cc.director.getScene().emit(g.default.ITEM_FLY,i)}else c.default.getInstance().itemData[this._chooseItemIndex]=new d.default(this._tempItemData),this._tempItemData=null;c.default.getInstance().updateTaskAndItem(),cc.director.getScene().emit(g.default.UPDATE_TOPINFO),cc.director.getScene().emit(g.default.UPDATE_MERGEAREA,[this._chooseItemIndex]),this.updateItemInfo(this._chooseItemIndex),v.default.trackEvent("topInfo_reback_click",{itemId:e})}else u.default.getInstance().openUI(f.default,{data:{str:k.default.t("topInfoPrefab_13")}})}},e.prototype.onClickBuildingTask=function(){v.default.trackEvent("topInfo_buildingTask_click"),u.default.getInstance().openUI(y.default)},e.prototype.onClickItemChain=function(){v.default.trackEvent("topInfo_detail_click");var t=c.default.getInstance().itemData[this._chooseItemIndex].id;t>=0&&u.default.getInstance().openUI(I.default,{data:t})},e.prototype.guideFreeDiamond=function(t){void 0===t&&(t=!1),this._isFree=t,this.updateItemInfo(this._chooseItemIndex)},e.prototype.guideFree=function(){this.speedUpIconNode.active=!0,this._isFree&&(this.speedUpIconNode.active=!1,this.lbSpeedUpText.node.height=80,this.lbSpeedUpText.string=k.default.t("topInfoPrefab_16"),this.lbSpeedUpPrice.string="")},e.prototype.initActivityBtn=function(){var t=this;if(!this._isAddActiveBtn){var e="";if(c.default.getInstance().activityData.isActivityOpen("christmas"))this._isAddActiveBtn=!0,e="christmasBtn",cc.resources.load("activity/"+e,cc.Prefab,function(e,i){if(!e){for(var a=0;a<t.activityRoot.children.length;a++)t.activityRoot.children[a].destroy();var n=cc.instantiate(i);t.activityRoot.addChild(n),t._isAddActiveBtn=!1}}),this.taskList.node.setPosition(cc.v2(-83,0)),this.taskList.node.setContentSize(cc.size(610,225)),this.taskList.node.children[0].getComponent(cc.Widget).updateAlignment(),this.taskList.node.children[0].children[0].getComponent(cc.Widget).updateAlignment();else if(c.default.getInstance().activityData.isActivityOpen("newYear"))this._isAddActiveBtn=!0,e="newYearBtn",cc.resources.load("activity/"+e,cc.Prefab,function(e,i){if(!e){for(var a=0;a<t.activityRoot.children.length;a++)t.activityRoot.children[a].destroy();var n=cc.instantiate(i);t.activityRoot.addChild(n),t._isAddActiveBtn=!1}}),this.taskList.node.setPosition(cc.v2(-83,0)),this.taskList.node.setContentSize(cc.size(610,225)),this.taskList.node.children[0].getComponent(cc.Widget).updateAlignment(),this.taskList.node.children[0].children[0].getComponent(cc.Widget).updateAlignment();else if(c.default.getInstance().activityData.isActivityOpen("happyBingo"))this._isAddActiveBtn=!0,e="happyBingoBtn",cc.resources.load("activity/"+e,cc.Prefab,function(e,i){if(!e){for(var a=0;a<t.activityRoot.children.length;a++)t.activityRoot.children[a].destroy();var n=cc.instantiate(i);t.activityRoot.addChild(n),t._isAddActiveBtn=!1}}),this.taskList.node.setPosition(cc.v2(-83,0)),this.taskList.node.setContentSize(cc.size(610,225)),this.taskList.node.children[0].getComponent(cc.Widget).updateAlignment(),this.taskList.node.children[0].children[0].getComponent(cc.Widget).updateAlignment();else if(c.default.getInstance().activityData.isActivityOpen("waterPark"))this._isAddActiveBtn=!0,e="waterParkBtn",cc.resources.load("activity/"+e,cc.Prefab,function(e,i){if(!e){for(var a=0;a<t.activityRoot.children.length;a++)t.activityRoot.children[a].destroy();var n=cc.instantiate(i);t.activityRoot.addChild(n),t._isAddActiveBtn=!1}}),this.taskList.node.setPosition(cc.v2(-83,0)),this.taskList.node.setContentSize(cc.size(610,225)),this.taskList.node.children[0].getComponent(cc.Widget).updateAlignment(),this.taskList.node.children[0].children[0].getComponent(cc.Widget).updateAlignment();else if(c.default.getInstance().activityData.isActivityOpen("childrenDay"))this._isAddActiveBtn=!0,e="childrenDayBtn",cc.resources.load("activity/"+e,cc.Prefab,function(e,i){if(!e){for(var a=0;a<t.activityRoot.children.length;a++)t.activityRoot.children[a].destroy();var n=cc.instantiate(i);t.activityRoot.addChild(n),t._isAddActiveBtn=!1}}),this.taskList.node.setPosition(cc.v2(-83,0)),this.taskList.node.setContentSize(cc.size(610,225)),this.taskList.node.children[0].getComponent(cc.Widget).updateAlignment(),this.taskList.node.children[0].children[0].getComponent(cc.Widget).updateAlignment();else{for(var i=0;i<this.activityRoot.children.length;i++)this.activityRoot.children[i].destroy();this.taskList.node.setPosition(cc.v2(-355,0)),this.taskList.node.setContentSize(cc.size(870,225)),this.taskList.node.children[0].getComponent(cc.Widget).updateAlignment(),this.taskList.node.children[0].children[0].getComponent(cc.Widget).updateAlignment()}}},o([T(cc.Node)],e.prototype,"btnBuildingTaskNode",void 0),o([T(cc.Node)],e.prototype,"buildingTaskRedPointNode",void 0),o([T(_.default)],e.prototype,"taskList",void 0),o([T(cc.Node)],e.prototype,"itemNameContent",void 0),o([T(cc.Node)],e.prototype,"itemInfoBtnContent",void 0),o([T(cc.Node)],e.prototype,"btnRebackNode",void 0),o([T(cc.Label)],e.prototype,"lbName",void 0),o([T(cc.Node)],e.prototype,"itemChainNode",void 0),o([T(cc.Label)],e.prototype,"lbTime",void 0),o([T(cc.Label)],e.prototype,"lbDes",void 0),o([T(cc.Node)],e.prototype,"speedUpBtnNode",void 0),o([T(cc.Node)],e.prototype,"clearVideoIcon",void 0),o([T(cc.Label)],e.prototype,"lbSpeedUpText",void 0),o([T(cc.Node)],e.prototype,"speedUpIconNode",void 0),o([T(cc.Label)],e.prototype,"lbSpeedUpPrice",void 0),o([T(cc.Label)],e.prototype,"lbVideoCount",void 0),o([T(cc.Node)],e.prototype,"sellBtnNode",void 0),o([T(cc.Label)],e.prototype,"lbsellText",void 0),o([T(cc.Label)],e.prototype,"lbsellPrice",void 0),o([T(cc.Button)],e.prototype,"videoBtnNode",void 0),o([T(cc.Label)],e.prototype,"lbVideoBtnText",void 0),o([T(cc.Node)],e.prototype,"activityRoot",void 0),o([w],e)}(cc.Component);i.default=P,cc._RF.pop()},{"../../scripts/data/MiscConfig":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/data/userModel/UserItemModel":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/AudioManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/Toast":void 0,"../../scripts/utils/ActionFunc":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../../scripts/utils/StatisticsManager":void 0,"../extension/List":"List","../prefabs/BuildTaskPopup":"BuildTaskPopup","../prefabs/ItemChain":"ItemChain","../prefabs/UnlockShowPopup":"UnlockShowPopup","./MergeManager":"MergeManager","./TopInfoTaskItem":"TopInfoTaskItem"}],TopInfoTaskItem:[function(t,e,i){"use strict";cc._RF.push(e,"f9406YlfClCJKh1jsu3sos9","TopInfoTaskItem");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/MiscConfig"),r=t("../../scripts/data/UserData"),c=t("../../scripts/manager/AudioManager"),d=t("../../scripts/manager/UIManager"),l=t("../../scripts/prefabs/CommonPopup"),p=t("../../scripts/prefabs/Toast"),u=t("../../scripts/utils/ActionFunc"),f=t("../../scripts/utils/EventName"),h=t("../../scripts/utils/GlobalFun"),g=t("../../scripts/utils/StatisticsManager"),m=t("../extension/ListItem"),v=t("../prefabs/AwardPopup"),_=t("../prefabs/TaskPopup"),y=t("./ItemList"),I=t("../../scripts/extension/LanguageData"),b=t("../../scripts/manager/AdManager"),N=cc._decorator,C=N.ccclass,k=N.property,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.customerTaskNode=null,e.tradingTaskNode=null,e.unlockTipNode=null,e.customerTaskCoins=null,e.tradingTaskCoins=null,e.tradingLeftTime=null,e.lbDiamondsCost=null,e.normalBgSF=null,e.completeBgSF=null,e.itemSpriteFrame=null,e.itemCompleteSpriteFrame=null,e.carNormalBgSF=null,e.carCompleteBgSF=null,e.taskCompleteBtnNode=null,e.tradingBtnNode=null,e.unLockLv=null,e.lbTip=null,e.itemList=null,e._orderId=null,e._taskData=null,e._isCompleteAni=!1,e}return n(e,t),e.prototype.init=function(t){this.node.active=!0,this._orderId=t,this._taskData=r.default.getInstance().getTaskDataByOrderId(t),this.updateUI()},e.prototype.onLoad=function(){var t=this;cc.director.getScene().on(f.default.UPDATE_BY_SECOND,this.updateBySecond,this),cc.director.getScene().on(f.default.UPDATE_TASK,function(){t.updateUI(!1)},this)},e.prototype.updateUI=function(t){if(void 0===t&&(t=!0),this._orderId&&-1!=this._orderId){if(!this._taskData)return;if(this.unlockTipNode.active=!1,"customer"==this._taskData.mstData.type)this.customerTaskNode.active=!0,this.tradingTaskNode.active=!1,this.customerTaskCoins.string=this._taskData.coins+"",this._taskData.isComplete?(this.customerTaskNode.getComponent(cc.Sprite).spriteFrame=this.completeBgSF,this.showTaskItems(this.customerTaskNode.children[0]),this.taskCompleteBtnNode.active=!0,t&&!this._isCompleteAni&&(this._isCompleteAni=!0,u.default.zoomAnim2(this.node))):(this.customerTaskNode.getComponent(cc.Sprite).spriteFrame=this.normalBgSF,this.showTaskItems(this.customerTaskNode.children[0]),this.taskCompleteBtnNode.active=!1,t&&this._isCompleteAni&&(this._isCompleteAni=!1,cc.Tween.stopAllByTarget(this.node),this.node.scale=1));else if("trading"==this._taskData.mstData.type)if(this.customerTaskNode.active=!1,this.tradingTaskNode.active=!0,this.tradingTaskNode.children[2].active=!0,this.tradingTaskCoins.string=this._taskData.coins+"",this.tradingTaskNode.getComponent(cc.Animation).setCurrentTime(0),this.tradingTaskNode.getComponent(cc.Animation).stop(),this._taskData.startTime)if(this._taskData.tradingLeftTime<=0)this.tradingTaskNode.getComponent(cc.Sprite).spriteFrame=this.carCompleteBgSF,this.tradingBtnNode.active=!0,this.tradingBtnNode.children[0].active=!0,this.tradingBtnNode.children[1].active=!1,this.showTaskItems(this.tradingTaskNode.children[2]),this.tradingBtnNode.getChildByName("text").active=!0,this.tradingBtnNode.getChildByName("text").getComponent(cc.Label).string=I.default.t("receive"),t&&!this._isCompleteAni&&(this._isCompleteAni=!0,u.default.zoomAnim2(this.node));else{this.tradingTaskNode.getComponent(cc.Sprite).spriteFrame=this.carCompleteBgSF,this.tradingBtnNode.active=!0,this.tradingBtnNode.children[0].active=!1,this.tradingBtnNode.children[1].active=!0,this.tradingBtnNode.getChildByName("text").active=!1,this.tradingTaskNode.children[2].active=!1,this.tradingLeftTime.string=h.default.formatDateTimeHourEx(this._taskData.tradingLeftTime);var e=this._taskData.tradingLeftTime>3600?3600:this._taskData.tradingLeftTime;this.lbDiamondsCost.string=h.default.getNeedDiamondByTime(e)+"",this.tradingTaskNode.getComponent(cc.Animation).play(),t&&this._isCompleteAni&&(this._isCompleteAni=!1,cc.Tween.stopAllByTarget(this.node),this.node.scale=1)}else this._taskData.isComplete?(this.tradingTaskNode.getComponent(cc.Sprite).spriteFrame=this.carCompleteBgSF,this.tradingBtnNode.active=!0,this.tradingBtnNode.children[0].active=!0,this.tradingBtnNode.children[1].active=!1,this.showTaskItems(this.tradingTaskNode.children[2]),this.tradingBtnNode.getChildByName("text").active=!0,this.tradingBtnNode.getChildByName("text").getComponent(cc.Label).string=I.default.t("topInfoTaskItem_1"),t&&!this._isCompleteAni&&(this._isCompleteAni=!0,u.default.zoomAnim2(this.node))):(this.tradingTaskNode.getComponent(cc.Sprite).spriteFrame=this.carNormalBgSF,this.tradingBtnNode.active=!1,this.tradingBtnNode.getChildByName("text").active=!1,this.showTaskItems(this.tradingTaskNode.children[2]),t&&this._isCompleteAni&&(this._isCompleteAni=!1,cc.Tween.stopAllByTarget(this.node),this.node.scale=1))}else{this.customerTaskNode.active=!1,this.tradingTaskNode.active=!1,this.unlockTipNode.active=!0;var i=r.default.getInstance().getUnlockTaskNextLevel();this.unLockLv.string=i+"",this.lbTip.string=I.default.t("taskCustomerItem_1",{lv:i}),t&&this._isCompleteAni&&(this._isCompleteAni=!1,cc.Tween.stopAllByTarget(this.node),this.node.scale=1)}},e.prototype.updateBySecond=function(){if(this._taskData&&this._orderId>0&&"trading"==this._taskData.mstData.type)if(this._taskData.tradingLeftTime>0){this.tradingLeftTime.string=h.default.formatDateTimeHourEx(this._taskData.tradingLeftTime);var t=this._taskData.tradingLeftTime>3600?3600:this._taskData.tradingLeftTime;this.lbDiamondsCost.string=h.default.getNeedDiamondByTime(t)+""}else this._taskData.startTime&&this._taskData.isComplete&&this.tradingBtnNode.children[1].active&&(c.default.getInstance().playEffect("carEnd"),r.default.getInstance().updateTaskAndItem(),cc.director.getScene().emit(f.default.UPDATE_MERGEAREA))},e.prototype.showTaskItems=function(t){if(this._taskData){if(0==t.childrenCount){var e=cc.instantiate(this.itemList);t.addChild(e)}var i=this.getItemData(),a=t.children[0].getComponent(y.default);"customer"==this._taskData.mstData.type?a.init({itemsData:i,spacingX:25}):"trading"==this._taskData.mstData.type&&a.init({itemsData:i,spacingX:10})}},e.prototype.getItemData=function(){var t=[];if("customer"==this._taskData.mstData.type){var e=this._taskData.requireItems.length,i=r.default.getInstance().getNormalItemIndexByIds(this._taskData.requireItems);if(this._taskData.isComplete)for(var a=0;a<e;a++)(n={uiName:"TopInfoPrefab"}).itemId=this._taskData.requireItems[a],n.itemBg=this.itemCompleteSpriteFrame,n.isComplete=!0,t.push(n);else for(a=0;a<e;a++)(n={uiName:"TopInfoPrefab"}).itemId=this._taskData.requireItems[a],n.isClickAble=!0,i[a]>=0?(n.isComplete=!0,n.itemBg=this.itemCompleteSpriteFrame):(n.isComplete=!1,n.itemBg=this.itemSpriteFrame),t.push(n)}else if(this._taskData.startTime){if(this._taskData.tradingLeftTime<=0)for(a=0;a<this._taskData.mstData.reward.length;a++)(n={uiName:"TopInfoPrefab"}).itemId=this._taskData.mstData.reward[a],n.itemBg=this.itemSpriteFrame,t.push(n)}else if(e=this._taskData.requireItems.length,i=r.default.getInstance().getNormalItemIndexByIds(this._taskData.requireItems),this._taskData.isComplete)for(a=0;a<e;a++)(n={uiName:"TopInfoPrefab"}).itemId=this._taskData.requireItems[a],n.itemBg=this.itemCompleteSpriteFrame,n.isComplete=!0,t.push(n);else for(a=0;a<e;a++){var n;(n={uiName:"TopInfoPrefab"}).itemId=this._taskData.requireItems[a],n.isClickAble=!0,i[a]>=0?(n.isComplete=!0,n.itemBg=this.itemCompleteSpriteFrame):(n.isComplete=!1,n.itemBg=this.itemSpriteFrame),t.push(n)}return t},e.prototype.onTaskClick=function(){var t,e,i=this;if(this._orderId>0)if(g.default.trackEvent("topInfo_task_click"),"customer"==this._taskData.mstData.type)this._taskData.isComplete?this.taskCompleteAnim():d.default.getInstance().openUI(_.default);else if("trading"==this._taskData.mstData.type)if(this._taskData.startTime)if(this._taskData.tradingLeftTime<=0)this.taskCompleteAnim();else{var a=this._taskData.tradingLeftTime>3600?3600:this._taskData.tradingLeftTime;t=a,e={contentText:I.default.t("taskTradeItem_9",{count:h.default.getNeedDiamondByTime(t)}),model:s.default.COMMON_POPUP_MODEL_2,okCallback:function(){i._taskData.speedUpTask(t)?(i.updateBySecond(),cc.director.getScene().emit(f.default.UPDATE_TOPINFO)):h.default.noDiamondsCommonPopup()}},d.default.getInstance().openUI(l.default,{data:e})}else this._taskData.isComplete?this.taskCompleteAnim():d.default.getInstance().openUI(_.default,{data:1})},e.prototype.taskCompleteAnim=function(){var t=this;if(this._taskData){var e=null,i=!0;this.customerTaskNode.getComponent(cc.Button).interactable=!1,this.tradingTaskNode.getComponent(cc.Button).interactable=!1,"customer"==this._taskData.mstData.type?(e=this._taskData.completeTask(),c.default.getInstance().playEffect("taskComplete")):"trading"==this._taskData.mstData.type&&(this._taskData.startTime?(i=!1,e=this._taskData.completeTask()):(e=this._taskData.startTask(),d.default.getInstance().openUI(p.default,{data:{str:I.default.t("topInfoTaskItem_2")}}),c.default.getInstance().playEffect("carGo"))),this.taskCompleteBtnNode.active=!1,this.tradingBtnNode.active=!1,this._isCompleteAni=!1,cc.Tween.stopAllByTarget(this.node),this.node.scale=1,e&&cc.director.getScene().emit(f.default.TASK_COMPLETE,{node:this.node,itemIds:this._taskData.requireItems,cells:e.cells,callback:function(){if(i){var a={id:30093};a.startNode=t.customerTaskCoins.node.parent.children[0],a.num=t._taskData.coins,a.moveSpeed=1e3,a.callback=function(){"customer"==t._taskData.mstData.type&&b.default.getInstance().showInterstitial()},cc.director.getScene().emit(f.default.ITEM_FLY,a)}else if("trading"==t._taskData.mstData.type){for(var n=[],o=0;o<t._taskData.mstData.reward.length;o++){var s={};s.id=t._taskData.mstData.reward[o],s.num=1,n.push(s)}d.default.getInstance().openUI(v.default,{data:n}),b.default.getInstance().showInterstitial()}t._isCompleteAni=!0,u.default.taskCompleteHideAnim(t.node,function(){e.newTasks.length>0?(t.resetTaskInfo(e.newTasks[0].orderId),u.default.taskCompleteShowAnim(t.node,function(){t._isCompleteAni=!1,t.taskCompleteBtnNode.active=!0,t.tradingBtnNode.active=!0,t.customerTaskNode.getComponent(cc.Button).interactable=!0,t.tradingTaskNode.getComponent(cc.Button).interactable=!0,r.default.getInstance().updateTaskAndItem(),cc.director.getScene().emit(f.default.UPDATE_MERGEAREA,e.cells)})):(t._isCompleteAni=!1,t.node.scale=1,t.node.active=!1,r.default.getInstance().updateTaskAndItem(),cc.director.getScene().emit(f.default.UPDATE_MERGEAREA,e.cells))})}})}},e.prototype.resetTaskInfo=function(t){this.node.active=!0,this._orderId=t,this._taskData=r.default.getInstance().getTaskDataByOrderId(t),this.updateUI(!1)},o([k(cc.Node)],e.prototype,"customerTaskNode",void 0),o([k(cc.Node)],e.prototype,"tradingTaskNode",void 0),o([k(cc.Node)],e.prototype,"unlockTipNode",void 0),o([k(cc.Label)],e.prototype,"customerTaskCoins",void 0),o([k(cc.Label)],e.prototype,"tradingTaskCoins",void 0),o([k(cc.Label)],e.prototype,"tradingLeftTime",void 0),o([k(cc.Label)],e.prototype,"lbDiamondsCost",void 0),o([k(cc.SpriteFrame)],e.prototype,"normalBgSF",void 0),o([k(cc.SpriteFrame)],e.prototype,"completeBgSF",void 0),o([k(cc.SpriteFrame)],e.prototype,"itemSpriteFrame",void 0),o([k(cc.SpriteFrame)],e.prototype,"itemCompleteSpriteFrame",void 0),o([k(cc.SpriteFrame)],e.prototype,"carNormalBgSF",void 0),o([k(cc.SpriteFrame)],e.prototype,"carCompleteBgSF",void 0),o([k(cc.Node)],e.prototype,"taskCompleteBtnNode",void 0),o([k(cc.Node)],e.prototype,"tradingBtnNode",void 0),o([k(cc.Label)],e.prototype,"unLockLv",void 0),o([k(cc.Label)],e.prototype,"lbTip",void 0),o([k(cc.Prefab)],e.prototype,"itemList",void 0),o([C],e)}(m.default);i.default=S,cc._RF.pop()},{"../../scripts/data/MiscConfig":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/AudioManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/CommonPopup":void 0,"../../scripts/prefabs/Toast":void 0,"../../scripts/utils/ActionFunc":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../../scripts/utils/StatisticsManager":void 0,"../extension/ListItem":"ListItem","../prefabs/AwardPopup":"AwardPopup","../prefabs/TaskPopup":"TaskPopup","./ItemList":"ItemList"}],UndirectedGraph:[function(t,e,i){"use strict";cc._RF.push(e,"8cf4celT4lCHJ8TbXK9ijKq","UndirectedGraph"),Object.defineProperty(i,"__esModule",{value:!0});var a=t("../../scripts/data/UserData"),n=function(t,e){this.cost=0,this.targetList=[],this.passingLong=0,this.surplusLong=0,this.name=t,this.point=e},o=function(){function t(){this.nodeMap=new Map,this.pointPos={}}return t.prototype.initNodeMap=function(t){var e=this;cc.resources.load("routeConfig/route_pos",cc.JsonAsset,function(i,a){for(var n in e.pointPos=a.json,e.pointPos)e.addVertex(n,e.pointPos[n]);t()})},t.prototype.addVertex=function(t,e){var i=new n(t,e);this.nodeMap.set(t,i)},t.prototype.nodeToPath=function(t){for(var e=[],i=t;i;){var a=cc.v3(i.point.pos.x,i.point.pos.y,i.point.pos.z);e.unshift(a),i=i.parent}return e},t.prototype.getPintPosByID=function(t){return this.pointPos[t]},t.prototype.findPath=function(t,e){if(t==e)return null;var i=this.nodeMap.get(t),a=this.nodeMap.get(e),n=[],o=[i];for(i.parent=null,a.parent=null,a.targetList=[],i.passingLong=0,i.surplusLong=0;o.length>0;){var s=o.pop();n.push(s);for(var r=0;r<s.point.dest.length;r++){var c=s.point.dest[r],d=this.nodeMap.get(c+"");if(d==a){d.targetList.push(s),a.parent=s,o.length=0;break}if(-1==n.indexOf(d))if(this.areaIsOpen(d.point.areaid)){d.parent=s;var l=d.parent&&d.parent.passingLong?d.parent.passingLong:0,p=d.parent?cc.Vec3.distance(d.parent.point.pos,d.point.pos):0;if(-1!=o.indexOf(d)&&d.passingLong>l+p||-1==o.indexOf(d)){d.surplusLong=cc.Vec3.distance(d.point.pos,a.point.pos),d.passingLong=l+p;for(var u=d.surplusLong+d.passingLong,f=o.length-1;f>=0;f--){if(u<o[f].surplusLong+o[f].passingLong){o.splice(f+1,0,d);break}0==f&&o.splice(0,0,d)}0==o.length&&o.push(d)}}else n.push(d)}}return this.nodeToPath(a)},t.prototype.areaIsOpen=function(t){var e=a.default.getInstance().unlockSceneAreaIds;return-1!==e.indexOf(t+"")||-1!==e.indexOf(t)},t.prototype.pointIsOpen=function(t){var e=this.pointPos[t],i=a.default.getInstance().unlockSceneAreaIds;if(-1!==i.indexOf(e.areaid+"")||-1!==i.indexOf(e.areaid)){var n=a.default.getInstance().buildingData[e.buildkey];return!!n&&n.isUnlock}return!1},t}();i.default=o,cc._RF.pop()},{"../../scripts/data/UserData":void 0}],UnlockBuildingAni:[function(t,e,i){"use strict";cc._RF.push(e,"240985CpiJL/IyZRQiCW9t9","UnlockBuildingAni");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/manager/AudioManager"),r=t("../../scripts/manager/UIManager"),c=t("../../scripts/prefabs/Loading"),d=t("../../scripts/utils/GlobalFun"),l=cc._decorator,p=l.ccclass,u=l.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.particle=null,e.particle2=null,e.buildingAni=null,e._callback=null,e}return n(e,t),e.prototype.init=function(t){void 0===t&&(t=null),this._callback=t},e.prototype.onLoad=function(){this.showAni()},e.prototype.showAni=function(){var t=this;r.default.getInstance().openUI(c.default,{data:{showBlack:!1}},function(){var e=t.node.parent.getChildByName("buildnode"),i=e.width/2,a=e.height/2;t.particle.duration=2,t.particle.node.active=!0,t.particle.posVar=cc.v2(i,a),t.particle.resetSystem();var n=0;t.buildingAni.on(cc.Animation.EventType.FINISHED,function(){if(++n<2){var e=d.default.radomBetween(-.8*i,.8*i),o=d.default.radomBetween(-.8*a,.8*a);t.buildingAni.node.setPosition(e,o),t.buildingAni.play()}else t.buildingAni.node.active=!1,t.buildingAni.off(cc.Animation.EventType.FINISHED)}),t.buildingAni.play(),s.default.getInstance().playEffect("chuizi");var o=e.scaleX;e.scale=0,t.scheduleOnce(function(){cc.tween(e).to(.5,{scaleX:o,scaleY:1,opacity:255}).call(function(){t.particle2.duration=1,t.particle2.node.active=!0,t.particle2.posVar=cc.v2(i,a),t.particle2.resetSystem(),s.default.getInstance().playEffect("unlockBuilding")}).delay(1).delay(1.2).call(function(){r.default.getInstance().closeUI(c.default),"function"==typeof t._callback&&t._callback(),t.node.destroy()}).start()},2)})},o([u(cc.ParticleSystem)],e.prototype,"particle",void 0),o([u(cc.ParticleSystem)],e.prototype,"particle2",void 0),o([u(cc.Animation)],e.prototype,"buildingAni",void 0),o([p],e)}(cc.Component);i.default=f,cc._RF.pop()},{"../../scripts/manager/AudioManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/Loading":void 0,"../../scripts/utils/GlobalFun":void 0}],UnlockShowPopup:[function(t,e,i){"use strict";cc._RF.push(e,"2661axx9aFD34Iu/a6Vl3+/","UnlockShowPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MstData"),c=t("../../scripts/data/UserData"),d=t("../../scripts/manager/AdManager"),l=t("../../scripts/manager/AudioManager"),p=t("../../scripts/manager/SDKManager"),u=t("../../scripts/manager/UIManager"),f=t("../../scripts/utils/AppConfig"),h=t("../../scripts/utils/ChannelHelper"),g=t("../../scripts/utils/EventName"),m=t("../../scripts/utils/GlobalFun"),v=t("../entitys/BuildItem"),_=t("../entitys/Customer"),y=t("../entitys/ItemEntity"),I=t("../scenes/MainScene"),b=t("./BuildInfoPopup"),N=t("./CustomerInfoPopup"),C=t("../../scripts/extension/LanguageData"),k=cc._decorator,S=k.ccclass,w=k.property,T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.root=null,e.cusIcon=null,e.buildIcon=null,e.lbDes=null,e.cusName=null,e.buildName=null,e.btnShare=null,e.customeNode=null,e.buildNode=null,e.itemNode=null,e.itemIcon=null,e.itemName=null,e.itemDesc=null,e.transitionNode=null,e.skinNode=null,e.skinName=null,e.resultReward=null,e.rewardItemBg=null,e.roleSkinSp=null,e._data=null,e._skinTicket=0,e}return n(e,t),e.prototype.init=function(t){this._data=t,this.updateUI(),this.showAnim(),m.default.isCanShowBanner()&&d.default.getInstance().showBanner()},e.prototype.showAnim=function(){var t=this;l.default.getInstance().playEffect("awardShow"),cc.tween(this.root).call(function(){t.root.scale=0}).to(.24,{scale:1}).call(function(){t._data.callback&&t._data.callback()}).start()},e.prototype.updateUI=function(){h.default.getChannel(),h.HMCHANNEL.WY?this.btnShare.active=!1:this.btnShare.active=!0,"building"==this._data.ntype?this.updateBuildingUI():"customer"==this._data.ntype?this.updateCustomerUI():"item"==this._data.ntype&&this.updateItemUI()},e.prototype.updateBuildingUI=function(){var t=this;this.customeNode.active=!1,this.buildNode.active=!0,this.itemNode.active=!1;var e=null;this._data.id?e=c.default.getInstance().buildingData[this._data.id].mstSkinData:this._data.skinId&&(e=r.default.getInstance().mstBuildingSkin[this._data.skinId]),this.buildName.string=e.name,e.nodeName&&cc.resources.load("building/"+e.nodeName,cc.Prefab,function(e,i){if(!e&&cc.isValid(t.node)){var a=cc.instantiate(i);a.setPosition(cc.v2(0,0)),a.getComponent(v.default).initUnlockShow(400,400),t.buildIcon.addChild(a)}})},e.prototype.updateCustomerUI=function(){var t=this;this.customeNode.active=!0,this.buildNode.active=!1,this.itemNode.active=!1;var e=null;this._data.id?e=c.default.getInstance().roleData[this._data.id].mstSkinData:this._data.skinId&&(e=r.default.getInstance().mstRoleSkin[this._data.skinId]),cc.resources.load("entitys/Customer",cc.Prefab,function(i,a){if(!i&&cc.isValid(t.node)){var n=cc.instantiate(a);n.setPosition(cc.v2(0,0)),n.getComponent(_.default).initUnlockShow(e.icon),t.cusIcon.addChild(n)}}),this.lbDes.string=e.desc,this.cusName.string=e.name},e.prototype.updateItemUI=function(){this.customeNode.active=!1,this.buildNode.active=!1,this.itemNode.active=!0;var t=r.default.getInstance().mstItem[this._data.id],e=m.default.getItemIconPathById(this._data.id);m.default.loadSpriteFrame(this.itemIcon,e),this.itemName.string=t.name,this.itemDesc.string=t.desc},e.prototype.onShareClicked=function(){var t=C.default.t("unlockShowPopup_1"),e=f.default.WX_SHARE_PATH+"share1.jpg";"building"==this._data.ntype?(t=C.default.t("share_6"),e=f.default.WX_SHARE_PATH+"share6.jpg"):"customer"==this._data.ntype?(t=C.default.t("share_5"),e=f.default.WX_SHARE_PATH+"share5.jpg"):"item"==this._data.ntype&&(t=C.default.t("share_1"),e=f.default.WX_SHARE_PATH+"share1.jpg"),p.default.getInstance().shareAppMessage(t,e,null,null,null)},e.prototype.onCloseClicked=function(){var t=this;if("building"==this._data.ntype){var e=null;this._data.id?e=c.default.getInstance().buildingData[this._data.id].mstSkinData:this._data.skinId&&(e=r.default.getInstance().mstBuildingSkin[this._data.skinId]);var i=e.buildingId;(a=c.default.getInstance().buildingData[i].getTransitionSkinTicket(this._data.skinId))?(this._skinTicket=a,this.root.active=!1,this.transitionNode.active=!0,cc.resources.load("building/"+e.nodeName,cc.Prefab,function(e,i){if(!e&&cc.isValid(t.skinNode)){var a=cc.instantiate(i);t.skinNode.addChild(a),a.setPosition(cc.v2(0,0)),a.getComponent(v.default).initUnlockShow(130,130)}}),(n={itemId:"30097"}).itemNum=a,n.isShowInfo=!0,n.isClickAble=!0,n.itemBg=this.rewardItemBg,this.resultReward.getComponent(y.default).init(n),this.skinName.string=e.name):(cc.director.getScene().emit(g.default.UPDATE_ACTIVITY),u.default.getInstance().closeNotice(this.tag),c.default.getInstance().buildingData[i].isUnlock&&c.default.getInstance().buildingData[i].isHaveTips&&((o=cc.sys.localStorage.getItem("checkSkin"))&&""!=o||(2==cc.find("Canvas").getComponent(I.default).isMainScene&&cc.director.getScene().emit(g.default.OPEN_SCENE),u.default.getInstance().closeAllUI(),cc.director.getScene().emit(g.default.GUIDANCE_CONTINUE,"40"))))}else if("customer"==this._data.ntype){e=null,this._data.id?e=c.default.getInstance().roleData[this._data.id].mstSkinData:this._data.skinId&&(e=r.default.getInstance().mstRoleSkin[this._data.skinId]);var a,n,o,s=e.roleId;(a=c.default.getInstance().roleData[s].getTransitionSkinTicket(this._data.skinId))?(this._skinTicket=a,this.root.active=!1,this.transitionNode.active=!0,m.default.loadSpriteFrame(this.roleSkinSp,"textures/role/icon/icon_"+e.icon,function(){var e=t.roleSkinSp.node.width>t.roleSkinSp.node.height?t.roleSkinSp.node.width:t.roleSkinSp.node.height;t.roleSkinSp.node.scale=120/e}),(n={itemId:"30097"}).itemNum=a,n.isShowInfo=!0,n.isClickAble=!0,n.itemBg=this.rewardItemBg,this.resultReward.getComponent(y.default).init(n),this.skinName.string=e.name):(cc.director.getScene().emit(g.default.UPDATE_ACTIVITY),u.default.getInstance().closeNotice(this.tag),c.default.getInstance().roleData[s].isUnlock&&c.default.getInstance().roleData[s].isHaveTips&&((o=cc.sys.localStorage.getItem("checkSkin"))&&""!=o||(2==cc.find("Canvas").getComponent(I.default).isMainScene&&cc.director.getScene().emit(g.default.OPEN_SCENE),u.default.getInstance().closeAllUI(),cc.director.getScene().emit(g.default.GUIDANCE_CONTINUE,"200"))))}else cc.director.getScene().emit(g.default.UPDATE_ACTIVITY),u.default.getInstance().closeNotice(this.tag)},e.prototype.onClickTransion=function(){var t={id:30097};t.startNode=this.resultReward,t.num=this._skinTicket,cc.director.getScene().emit(g.default.ITEM_FLY,t),cc.director.getScene().emit(g.default.UPDATE_ACTIVITY),u.default.getInstance().closeNotice(this.tag)},e.prototype.onClickBuild=function(){if("building"==this._data.ntype){var t=r.default.getInstance().mstBuildingSkin[this._data.skinId].buildingId;u.default.getInstance().openUI(b.default,{data:{buildId:t,parent:this}})}else if("customer"==this._data.ntype){var e=r.default.getInstance().mstRoleSkin[this._data.skinId].roleId;u.default.getInstance().openUI(N.default,{data:{roleId:e,parent:this}})}},e.prototype.onDestroy=function(){m.default.isCanShowBanner()&&d.default.getInstance().hideBanner()},e.uiName="UnlockShowPopup",o([w(cc.Node)],e.prototype,"root",void 0),o([w(cc.Node)],e.prototype,"cusIcon",void 0),o([w(cc.Node)],e.prototype,"buildIcon",void 0),o([w(cc.Label)],e.prototype,"lbDes",void 0),o([w(cc.Label)],e.prototype,"cusName",void 0),o([w(cc.Label)],e.prototype,"buildName",void 0),o([w(cc.Node)],e.prototype,"btnShare",void 0),o([w(cc.Node)],e.prototype,"customeNode",void 0),o([w(cc.Node)],e.prototype,"buildNode",void 0),o([w(cc.Node)],e.prototype,"itemNode",void 0),o([w(cc.Sprite)],e.prototype,"itemIcon",void 0),o([w(cc.Label)],e.prototype,"itemName",void 0),o([w(cc.Label)],e.prototype,"itemDesc",void 0),o([w(cc.Node)],e.prototype,"transitionNode",void 0),o([w(cc.Node)],e.prototype,"skinNode",void 0),o([w(cc.Label)],e.prototype,"skinName",void 0),o([w(cc.Node)],e.prototype,"resultReward",void 0),o([w(cc.SpriteFrame)],e.prototype,"rewardItemBg",void 0),o([w(cc.Sprite)],e.prototype,"roleSkinSp",void 0),o([S],e)}(s.default);i.default=T,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/AudioManager":void 0,"../../scripts/manager/SDKManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/utils/AppConfig":void 0,"../../scripts/utils/ChannelHelper":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../entitys/BuildItem":"BuildItem","../entitys/Customer":"Customer","../entitys/ItemEntity":"ItemEntity","../scenes/MainScene":"MainScene","./BuildInfoPopup":"BuildInfoPopup","./CustomerInfoPopup":"CustomerInfoPopup"}],WaterParkBtn:[function(t,e,i){"use strict";cc._RF.push(e,"1450fzkKJZJH5nT7u7DX88x","WaterParkBtn");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/UserData"),r=t("../../scripts/manager/UIManager"),c=t("../../scripts/utils/ActionFunc"),d=t("../../scripts/utils/EventName"),l=t("../../scripts/utils/GlobalFun"),p=t("../prefabs/WaterParkPopup"),u=cc._decorator,f=u.ccclass,h=u.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnBg=[],e.itemBg=[],e.itemNode=[],e.completeNode=null,e.bgSprite=null,e.endTimeLab=null,e.isStartAni=!1,e}return n(e,t),e.prototype.initNeedItems=function(){var t=s.default.getInstance().activityData.waterPark,e=t.taskData[t.chooseTaskIndex];if(e){var i=e.requireItems,a=e.isReceived;if(i.length>0){var n=s.default.getInstance().getNormalItemIndexByIds(i);this.itemNode[0].active=!1,this.itemNode[1].active=!1;for(var o=0;o<i.length;o++){var r=a||n[o]>0,d=this.itemNode[o];d.active=!0;var p=l.default.getItemIconPathById(i[o]+"");if(p){var u=d.getChildByName("itemicon").getComponent(cc.Sprite);l.default.loadSpriteFrame(u,p)}r?(d.getChildByName("gou").active=!0,d.getComponent(cc.Sprite).spriteFrame=this.itemBg[1]):(d.getChildByName("gou").active=!1,d.getComponent(cc.Sprite).spriteFrame=this.itemBg[0])}}e.isComplete?(this.completeNode.active=!0,this.bgSprite.spriteFrame=this.btnBg[1],this.isStartAni||(this.isStartAni=!0,c.default.zoomAnim2(this.node))):(this.isStartAni&&(this.isStartAni=!1,cc.Tween.stopAllByTarget(this.node),this.node.scale=1),this.completeNode.active=!1,this.bgSprite.spriteFrame=this.btnBg[0])}},e.prototype.onClickActivity=function(){r.default.getInstance().openUI(p.default)},e.prototype.updateTime=function(){var t=s.default.getInstance().activityData.getActivityEndTime("waterPark");if(t.length>0){var e=t[1]-window.serverTime;e>0?this.endTimeLab.string=l.default.formatDateTimeDaysPre(e):cc.director.getScene().emit(d.default.RESET_ACTIVITY)}else cc.director.getScene().emit(d.default.RESET_ACTIVITY)},e.prototype.onLoad=function(){cc.director.getScene().on(d.default.UPDATE_MERGEAREA,this.initNeedItems,this),cc.director.getScene().on(d.default.UPDATE_BY_SECOND,this.updateTime,this),this.updateTime(),this.initNeedItems(),s.default.getInstance().activityData.isFirstLoadActivitu("waterPark")?(s.default.getInstance().activityData.setShowOneActivity("waterPark"),s.default.getInstance().updateTaskAndItem(),cc.director.getScene().emit(d.default.UPDATE_MERGEAREA)):s.default.getInstance().activityData.setShowOneActivity("waterPark")},o([h([cc.SpriteFrame])],e.prototype,"btnBg",void 0),o([h([cc.SpriteFrame])],e.prototype,"itemBg",void 0),o([h([cc.Node])],e.prototype,"itemNode",void 0),o([h(cc.Node)],e.prototype,"completeNode",void 0),o([h(cc.Sprite)],e.prototype,"bgSprite",void 0),o([h(cc.Label)],e.prototype,"endTimeLab",void 0),o([f],e)}(cc.Component);i.default=g,cc._RF.pop()},{"../../scripts/data/UserData":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/utils/ActionFunc":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../prefabs/WaterParkPopup":"WaterParkPopup"}],WaterParkGiftItem:[function(t,e,i){"use strict";cc._RF.push(e,"09b3c5btf5OXauvgoy29UEp","WaterParkGiftItem");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/MiscConfig"),r=t("../../scripts/data/UserData"),c=t("../../scripts/manager/AdManager"),d=t("../../scripts/manager/UIManager"),l=t("../../scripts/prefabs/CommonPopup"),p=t("../../scripts/prefabs/Toast"),u=t("../../scripts/utils/GlobalFun"),f=t("../extension/ListItem"),h=t("../prefabs/AwardPopup"),g=t("./ItemList"),m=cc._decorator,v=m.ccclass,_=m.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lvLab=null,e.lvSpNode=null,e.normalList=null,e.specialList=null,e.normalNode=null,e.specialNode=null,e._model=null,e._rewardLv=0,e._data=null,e._waterParkGift=null,e}return n(e,t),e.prototype.initUI=function(t,e,i){var a;this._waterParkGift=i,this._rewardLv=t,this._data=e,this._model=null!==(a=this._model)&&void 0!==a?a:r.default.getInstance().activityData.waterPark;for(var n=u.default.getAllReward(e.reward,e.rewardRes),o=[],s=0;s<n.length;s++){var c={};c.itemId=n[s].id,c.isClickAble=!0,c.isShowInfo=!0,o.push(c)}this.normalList.init({itemsData:o,spacingX:25});var d=u.default.getAllReward(e.vipReward,e.vipRewardRes),l=[];for(s=0;s<d.length;s++){var p={};p.itemId=d[s].id,p.itemNum=d[s].num,p.itemBg="",p.isClickAble=!0,p.isShowInfo=!0,l.push(p)}this.specialList.init({itemsData:l,spacingX:25});var f=this._model;this.lvLab.string=t+"",this.lvSpNode.active=f.lv>=t;var h=this._model.firstNormalRewardIndex,g=this._model.firstSpecialRewardIndex;this.normalNode.active=h==t&&this._model.receiveData[t]&&!this._model.receiveData[t].isNormalReceive,this.specialNode.active=g==t&&this._model.receiveData[t]&&!this._model.receiveData[t].isSpecialReceive},e.prototype.onClockLock=function(t,e){var i=null;"1"==e?i={str:"\u4e0d\u53ef\u5237\u65b0"}:"2"==e&&(i={str:"\u4e0d\u53ef\u5237\u65b0"}),d.default.getInstance().openUI(p.default,{data:i})},e.prototype.onClickGetNormalReward=function(){if(this._model.buyNormalReward(this._rewardLv)){var t=this._model.config.lvData[this._rewardLv],e=u.default.getAllReward(t.reward,t.rewardRes);d.default.getInstance().openUI(h.default,{data:e}),this._waterParkGift.updateRewardList()}},e.prototype.onClickGetSpecialReward=function(){var t=this;c.default.getInstance().showRewardAd(function(){if(t._model.buySpecialReward(t._rewardLv)){var e=t._model.config.lvData[t._rewardLv],i=u.default.getAllReward(e.vipReward,e.vipRewardRes);d.default.getInstance().openUI(h.default,{data:i})}t._waterParkGift.updateRewardList()},function(){},function(){})},e.prototype.onClickBuyExp=function(){var t=this,e=this._model.lv,i=this._rewardLv;if(e<i){var a={titleText:" \u63d0\u793a ",contentText:cc.js.formatStr("\u662f\u5426\u82b1\u8d39\u94bb\u77f3\u5230\u8fbe\u4e0b\u4e00\u7ea7"),model:s.default.COMMON_POPUP_MODEL_2,isLeft:!0,okText:"\u786e\u5b9a",okCallback:function(){var e=t._model.exp,a=t._model.lv;t._model.buyExp(i)?(t._waterParkGift.showPassExpAni(e,a),t.initUI(t._rewardLv,t._data,t._waterParkGift)):d.default.getInstance().openUI(p.default,{data:{str:"\u94bb\u77f3\u4e0d\u8db3"}})}};d.default.getInstance().openUI(l.default,{data:a})}},o([_(cc.Label)],e.prototype,"lvLab",void 0),o([_(cc.Node)],e.prototype,"lvSpNode",void 0),o([_(g.default)],e.prototype,"normalList",void 0),o([_(g.default)],e.prototype,"specialList",void 0),o([_(cc.Node)],e.prototype,"normalNode",void 0),o([_(cc.Node)],e.prototype,"specialNode",void 0),o([v],e)}(f.default);i.default=y,cc._RF.pop()},{"../../scripts/data/MiscConfig":void 0,"../../scripts/data/UserData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/prefabs/CommonPopup":void 0,"../../scripts/prefabs/Toast":void 0,"../../scripts/utils/GlobalFun":void 0,"../extension/ListItem":"ListItem","../prefabs/AwardPopup":"AwardPopup","./ItemList":"ItemList"}],WaterParkGiftPopup:[function(t,e,i){"use strict";cc._RF.push(e,"4c1b10VN6BKi6uZhZ2fOxAa","WaterParkGiftPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MstData"),c=t("../../scripts/data/UserData"),d=t("../../scripts/utils/EventName"),l=t("../entitys/WaterParkGiftItem"),p=t("../extension/List"),u=cc._decorator,f=u.ccclass,h=u.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.expProg=null,e.barNode=null,e.lvLab=null,e.expLab=null,e.vipbtn=null,e.rewardList=null,e._model=null,e._lvData=null,e._isExpAniFinished=!0,e}return n(e,t),e.prototype.onLoad=function(){this._model=c.default.getInstance().activityData.waterPark,this._lvData=r.default.getInstance().mstActivity.waterPark.config.lvData,this.vipbtn.active=!1,this.updateRewardList(),this.initProgress(),this.rewardList.scrollTo(this._model.firstRewardIndex-2)},e.prototype.initProgress=function(){var t=this._model.config.lvData[this._model.lv],e=this._model.lv,i=this._model.exp,a=this._model.maxLv;this.lvLab.string=e+"",e>=a?(this.expProg.progress=1,this.expLab.string="\u6ee1\u7ea7"):(this.expProg.progress=i/t.exp,this.expLab.string=i+"/"+t.exp)},e.prototype.updateRewardList=function(){this.rewardList.numItems=Object.keys(this._lvData).length},e.prototype.itemElementRender=function(t,e){var i=e+1;t.getComponent(l.default).initUI(i,this._lvData[i],this)},e.prototype.showPassExpAni=function(t,e){var i=this;cc.director.getScene().emit(d.default.UPDATE_WATERPARK_LV);var a=this._model.exp,n=this._model.lv;if(n!=e||a!=t)if(this._isExpAniFinished)this._isExpAniFinished=!1,this.updateExpAnimation(this.expProg.node,a,t,n,e,function(){cc.isValid(i)&&(i._isExpAniFinished=!0,i.initProgress())});else{cc.tween(this.expProg.node).stop(),e=parseInt(this.lvLab.string);var o=this.expLab.string,s=o.indexOf("/");t=parseInt(o.slice(0,s)),this.updateExpAnimation(this.expProg.node,a,t,n,e,function(){e=n,t=a,cc.isValid(i)&&(i._isExpAniFinished=!0,i.initProgress())})}},e.prototype.updateExpAnimation=function(t,e,i,a,n,o){var s=this,c=r.default.getInstance().mstActivity.waterPark.config.lvData,d=cc.tween(t).call(function(){var t=function(){if(a==n){var r=c[n].exp,d={a:i};cc.tween(d).to(.5,{a:e},{progress:function(t,e,i,a){var n=Math.round(t+(e-t)*a);return cc.isValid(s)&&(s.expLab.string=n+"/"+r,s.expProg.progress=n/r),t+(e-t)*a}}).call(o).start()}else if(a>n){var l=c[n].exp;d={a:i},cc.tween(d).to(.5,{a:l},{progress:function(t,e,i,a){var n=Math.round(t+(e-t)*a);return cc.isValid(s)&&(s.expLab.string=n+"/"+l,s.expProg.progress=n/l),t+(e-t)*a}}).call(function(){i=0,n++,cc.isValid(s)&&(s.lvLab.string=n+""),t()}).start()}};t()}),l=cc.tween(t).to(.5,{scale:1.2}).to(.5,{scale:1});return cc.tween(t).parallel(l,d).start()},e.uiName="WaterParkGiftPopup",o([h(cc.ProgressBar)],e.prototype,"expProg",void 0),o([h(cc.Node)],e.prototype,"barNode",void 0),o([h(cc.Label)],e.prototype,"lvLab",void 0),o([h(cc.Label)],e.prototype,"expLab",void 0),o([h(cc.Node)],e.prototype,"vipbtn",void 0),o([h(p.default)],e.prototype,"rewardList",void 0),o([f],e)}(s.default);i.default=g,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/utils/EventName":void 0,"../entitys/WaterParkGiftItem":"WaterParkGiftItem","../extension/List":"List"}],WaterParkPopup:[function(t,e,i){"use strict";cc._RF.push(e,"3df878Gz3lLHqu5WhuwLSpf","WaterParkPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/UserData"),c=t("../../scripts/utils/EventName"),d=t("../entitys/ItemList"),l=t("../../scripts/utils/GlobalFun"),p=t("../../scripts/manager/UIManager"),u=t("../../scripts/data/MstData"),f=t("./WaterParkGiftPopup"),h=cc._decorator,g=h.ccclass,m=h.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemNode=null,e.expProg=null,e.barNode=null,e.lvLab=null,e.expLab=null,e.taskNode=null,e.expIconNode=null,e._model=null,e._itemNodeList=[],e._isExpAniFinished=!0,e._lastChooseNode=null,e}return n(e,t),e.prototype.onLoad=function(){cc.director.getScene().on(c.default.UPDATE_WATERPARK_LV,this.initProgress,this),this._model=r.default.getInstance().activityData.waterPark,this.initProgress(),this.initTask();var t=this._model.chooseTaskIndex;this.onClickChooseTask({target:this._itemNodeList[t].getChildByName("chooseBtn")},t+"")},e.prototype.initProgress=function(){var t=this._model.config.lvData[this._model.lv],e=this._model.lv,i=this._model.exp,a=this._model.maxLv;this.lvLab.string=e+"",e>=a?(this.expProg.progress=1,this.expLab.string="\u6ee1\u7ea7"):(this.expProg.progress=i/t.exp,this.expLab.string=i+"/"+t.exp)},e.prototype.initTask=function(){for(var t=this._model.taskData,e=t.length,i=0;i<t.length;i++){var a=this._itemNodeList[i];a||(a=cc.instantiate(this.itemNode),this.taskNode.addChild(a),this._itemNodeList[i]=a,a.active=!0),this._itemNodeList[i].active=!0,this.initTaskItem(a,i,t[i])}for(i=e;i<this._itemNodeList.length;i++)this._itemNodeList[i].active=!1},e.prototype.initTaskItem=function(t,e,i){for(var a=i.requireItems,n=[],o=0;o<a.length;o++){(u={}).itemId=a[o];var s=r.default.getInstance().getNormalItemIndexByIds([a[o]]);u.isComplete=!s.includes(-1),u.isClickAble=!0,u.isShowInfo=!0,n.push(u)}t.getChildByName("requireList").getComponent(d.default).init({itemsData:n,spacingX:25});var c=l.default.getAllReward(i.mstData.reward,i.mstData.rewardRes),p=[];for(o=0;o<c.length;o++){var u;(u={}).itemId=c[o].id,u.itemNum=c[o].num,u.itemBg="",u.isClickAble=!0,u.isShowInfo=!0,p.push(u)}t.getChildByName("rewardList").getComponent(d.default).init({itemsData:p,spacingX:25});var f=t.getChildByName("btn");f.getChildByName("txt").getComponent(cc.Label).string="",f.getComponent(cc.Button).clickEvents[0].customEventData=e+"";var h=!r.default.getInstance().getNormalItemIndexByIds(a).includes(-1),g=h?"onClickSubmitTask":"onClickGoMerge",m=h?"\u63d0\u4ea4":"\u53bb\u5b8c\u6210";f.getComponent(cc.Button).clickEvents[0].handler=g,f.getComponent(cc.Sprite).spriteFrame=null,f.getChildByName("txt").getComponent(cc.Label).string=m,t.getChildByName("chooseBtn").getComponent(cc.Button).clickEvents[0].customEventData=e+""},e.prototype.onClickChooseTask=function(t,e){this._lastChooseNode&&(this._lastChooseNode.getChildByName("Background").active=!1),this._lastChooseNode=t.target,this._lastChooseNode.getChildByName("Background").active=!0,r.default.getInstance().activityData.waterPark.chooseTask(+e),cc.director.getScene().emit(c.default.UPDATE_MERGEAREA)},e.prototype.onClickSubmitTask=function(t,e){var i=this,a=this._model.exp,n=this._model.lv,o=+e,s=r.default.getInstance().activityData.waterPark.submit(o);if(!s.ids.includes(-1)){cc.director.getScene().emit(c.default.UPDATE_MERGEAREA,s),this.initTask();for(var d=0;d<s.reward.length;d++){var l={};l.id=s.reward[d].id,l.startNode=this.node,l.num=s.reward[d].num,40002==l.id&&(l.endNode=this.expIconNode,l.callback=function(){cc.isValid(i.node)&&n!=i._model.maxLv&&i.showPassExpAni(a,n)}),cc.director.getScene().emit(c.default.ITEM_FLY,l)}}},e.prototype.onClickGoMerge=function(){cc.director.getScene().emit(c.default.CLOSE_SCENE),this.onClose()},e.prototype.onClickLookGift=function(){p.default.getInstance().openUI(f.default)},e.prototype.showPassExpAni=function(t,e){var i=this,a=this._model.exp,n=this._model.lv;if(n!=e||a!=t)if(this._isExpAniFinished)this._isExpAniFinished=!1,this.updateExpAnimation(this.expProg.node,a,t,n,e,function(){cc.isValid(i)&&(i._isExpAniFinished=!0,i.initProgress())});else{cc.tween(this.expProg.node).stop(),e=parseInt(this.lvLab.string);var o=this.expLab.string,s=o.indexOf("/");t=parseInt(o.slice(0,s)),this.updateExpAnimation(this.expProg.node,a,t,n,e,function(){e=n,t=a,cc.isValid(i)&&(i._isExpAniFinished=!0,i.initProgress())})}},e.prototype.updateExpAnimation=function(t,e,i,a,n,o){var s=this,r=u.default.getInstance().mstActivity.waterPark.config.lvData,c=cc.tween(t).call(function(){var t=function(){if(a==n){var c=r[n].exp,d={a:i};cc.tween(d).to(.5,{a:e},{progress:function(t,e,i,a){var n=Math.round(t+(e-t)*a);return cc.isValid(s)&&(s.expLab.string=n+"/"+c,s.expProg.progress=n/c),t+(e-t)*a}}).call(o).start()}else if(a>n){var l=r[n].exp;d={a:i},cc.tween(d).to(.5,{a:l},{progress:function(t,e,i,a){var n=Math.round(t+(e-t)*a);return cc.isValid(s)&&(s.expLab.string=n+"/"+l,s.expProg.progress=n/l),t+(e-t)*a}}).call(function(){i=0,n++,cc.isValid(s)&&(s.lvLab.string=n+""),t()}).start()}};t()}),d=cc.tween(t).to(.5,{scale:1.2}).to(.5,{scale:1});return cc.tween(t).parallel(d,c).start()},e.uiName="WaterParkPopup",o([m(cc.Node)],e.prototype,"itemNode",void 0),o([m(cc.ProgressBar)],e.prototype,"expProg",void 0),o([m(cc.Node)],e.prototype,"barNode",void 0),o([m(cc.Label)],e.prototype,"lvLab",void 0),o([m(cc.Label)],e.prototype,"expLab",void 0),o([m(cc.Node)],e.prototype,"taskNode",void 0),o([m(cc.Node)],e.prototype,"expIconNode",void 0),o([g],e)}(s.default);i.default=v,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../entitys/ItemList":"ItemList","./WaterParkGiftPopup":"WaterParkGiftPopup"}],WeeklyGiftItem:[function(t,e,i){"use strict";cc._RF.push(e,"2ffa4F3HrRLIJN9XKhY0wkB","WeeklyGiftItem");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/UserData"),r=t("../../scripts/manager/AdManager"),c=t("../../scripts/manager/UIManager"),d=t("../extension/ListItem"),l=t("../prefabs/AwardPopup"),p=t("./ItemEntity"),u=t("../../scripts/extension/LanguageData"),f=t("../../scripts/utils/GlobalFun"),h=cc._decorator,g=h.ccclass,m=h.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bg=[],e.itemBg=null,e.bgSp=null,e.itemNode=null,e.giftStageLab=null,e.rewardNode=null,e.adNum=null,e.adNode=null,e.adLab=null,e.payNode=null,e.receviedTask=null,e.uiNode=null,e._weeklyGiftModel=null,e._giftName=null,e._allAward=[],e._configData=null,e._parentNode=null,e._giftBg=["energy","skinTicket","diamonds","skipAd"],e.nodeWidth=952,e.nodeHeight=394,e}return n(e,t),e.prototype.initLevelItemInfo=function(t,e,i){var a,n;if(void 0===i&&(i=-1),-1!=i){var o=i/this.nodeWidth;this.node.width=i,this.node.height=o*this.nodeHeight,this.uiNode.scale=o}var r=this._giftBg.indexOf(t);this.bgSp.spriteFrame=this.bg[r],this._giftName=t,this._weeklyGiftModel=s.default.getInstance().weeklyGiftModel;var c=this._weeklyGiftModel.config[t];this._parentNode=e,this._configData=c;var d=Object.keys(c.config),l=this._weeklyGiftModel.receiveData[t].stageIndex,f=l>d.length;this.payNode.active=!f,this.adNode.node.active=!f,this.receviedTask.active=f,this.receviedTask.getComponent(cc.Label).string=u.default.t("received"),f?l--:"pay"==c.config[l].costType?this.initByPay():this.initByAd(),this.giftStageLab.string=l+"/"+d.length;var h=c.config[l].reward,g=c.config[l].rewardRes;this._allAward=[];for(var m=0,v=0;v<h.length;v++)(_=null!==(a=this.rewardNode.children[m])&&void 0!==a?a:cc.instantiate(this.itemNode)).parent=this.rewardNode,(y={}).itemId=h[v],y.itemBg=this.itemBg,y.bgSize=cc.v2(138,138),y.isShowInfo=!0,y.isClickAble=!0,_.getComponent(p.default).init(y),m++,this._allAward.push({id:h[v],num:1});for(v=0;v<g.length;v++){var _,y;(_=null!==(n=this.rewardNode.children[m])&&void 0!==n?n:cc.instantiate(this.itemNode)).parent=this.rewardNode,(y={}).itemId=g[v],y.itemBg=this.itemBg,y.bgSize=cc.v2(138,138),y.itemNum=g[v+1],y.isShowInfo=!0,y.isClickAble=!0,_.getComponent(p.default).init(y),this._allAward.push({id:g[v],num:g[v+1]}),v++,m++}var I=this.rewardNode.childrenCount;for(v=0;v<I;v++)v>=m&&(this.rewardNode.children[v].active=!1)},e.prototype.initByAd=function(){var t=this._configData,e=this._weeklyGiftModel.receiveData[this._giftName],i=this._weeklyGiftModel.receiveData[this._giftName].stageIndex,a=e?e.videoCount:0;this.adNum.string=a+"/"+t.config[i].costNum,this.adNode.node.active=!0,this.payNode.active=!1;var n=r.default.getInstance().rewardAdCd;n>0?(this.adNode.interactable=!1,f.default.setBtnIsGrey(this.adNode),this.adLab.string=f.default.formatDateTimeHourEx(n)):(this.adNode.interactable=!0,f.default.setBtnIsGrey(this.adNode,new cc.Color(64,98,35)),this.adLab.string=u.default.t("receive"))},e.prototype.refushVideoCD=function(){var t=this._weeklyGiftModel.receiveData[this._giftName].stageIndex;"video"==this._configData.config[t].costType&&this.initByAd()},e.prototype.initByPay=function(){this.adNode.node.active=!1,this.payNode.active=!0},e.prototype.onClickAd=function(){var t=this;r.default.getInstance().showRewardAd(function(){t._weeklyGiftModel.watchAd(t._giftName)?(c.default.getInstance().openUI(l.default,{data:t._allAward}),t._weeklyGiftModel.isReceived(t._giftName)?t._parentNode&&t._parentNode.updateCompleteGiftName(t._giftName):t.initLevelItemInfo(t._giftName,t._parentNode)):t.initByAd()},function(){},function(){})},o([m(cc.SpriteFrame)],e.prototype,"bg",void 0),o([m(cc.SpriteFrame)],e.prototype,"itemBg",void 0),o([m(cc.Sprite)],e.prototype,"bgSp",void 0),o([m(cc.Prefab)],e.prototype,"itemNode",void 0),o([m(cc.Label)],e.prototype,"giftStageLab",void 0),o([m(cc.Node)],e.prototype,"rewardNode",void 0),o([m(cc.Label)],e.prototype,"adNum",void 0),o([m(cc.Button)],e.prototype,"adNode",void 0),o([m(cc.Label)],e.prototype,"adLab",void 0),o([m(cc.Node)],e.prototype,"payNode",void 0),o([m(cc.Node)],e.prototype,"receviedTask",void 0),o([m(cc.Node)],e.prototype,"uiNode",void 0),o([g],e)}(d.default);i.default=v,cc._RF.pop()},{"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/AdManager":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/utils/GlobalFun":void 0,"../extension/ListItem":"ListItem","../prefabs/AwardPopup":"AwardPopup","./ItemEntity":"ItemEntity"}],WeeklyGiftPopup:[function(t,e,i){"use strict";cc._RF.push(e,"1754c3x6axNs7Px0vaqCkR1","WeeklyGiftPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},s=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var a=Array(t),n=0;for(e=0;e<i;e++)for(var o=arguments[e],s=0,r=o.length;s<r;s++,n++)a[n]=o[s];return a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../scripts/base/BaseUI"),c=t("../../scripts/data/UserData"),d=t("../../scripts/utils/EventName"),l=t("../../scripts/utils/GlobalFun"),p=t("../entitys/WeeklyGiftItem"),u=t("../extension/List"),f=cc._decorator,h=f.ccclass,g=f.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.listElement=null,e.timeLab=null,e._weeklyGiftModel=null,e._sortName=[],e._sortName1=[],e._sortName2=[],e._lastTime=0,e}return n(e,t),e.prototype.init=function(){this._weeklyGiftModel=c.default.getInstance().weeklyGiftModel,this.initLastTime(),this.initListData()},e.prototype.initListData=function(){var t=this._weeklyGiftModel.config;for(var e in this._sortName2=[],this._sortName1=[],t)if(Object.prototype.hasOwnProperty.call(t,e)){var i=t[e];this._weeklyGiftModel.isReceived(e)?this._sortName2.push({index:i.index,name:e}):this._sortName1.push({index:i.index,name:e})}this._sortName1.sort(function(t,e){return t.index-e.index}),this._sortName2.sort(function(t,e){return t.index-e.index}),this._sortName=s(this._sortName1,this._sortName2)},e.prototype.initLastTime=function(){this._lastTime=c.default.getInstance().weeklyGiftModel.lastTime},e.prototype.itemElementRender=function(t,e){t.getComponent(p.default).initLevelItemInfo(this._sortName[e].name,this)},e.prototype.updateList=function(){this.listElement.numItems=this._sortName.length},e.prototype.updateCompleteGiftName=function(t){this.updateRewardCD();for(var e=-1,i=0;i<this._sortName1.length;i++)if(this._sortName1[i].name==t){e=i;break}if(this._weeklyGiftModel.isReceived(t)&&-1!=e){var a=this._sortName1.splice(e,1);this._sortName2.push(a[0]),this._sortName2.sort(function(t,e){return t.index-e.index}),this._sortName=s(this._sortName1,this._sortName2),this.updateList()}},e.prototype.updateBySecond=function(){var t=Math.ceil(this._lastTime-window.serverTime);if(t<0&&(this._weeklyGiftModel.loadData(),this.initLastTime(),this.initListData(),this.updateList()),t>=0){var e=l.default.timeFormat(t);this.timeLab.string=e}this.updateRewardCD()},e.prototype.updateRewardCD=function(){for(var t=this.listElement.content.children,e=0;e<t.length;e++)t[e].getComponent(p.default).refushVideoCD()},e.prototype.onLoad=function(){this.updateList(),this.updateBySecond(),cc.director.getScene().on(d.default.UPDATE_BY_SECOND,this.updateBySecond,this)},e.prototype.onDestroy=function(){},e.uiName="WeeklyGiftPopup",o([g(u.default)],e.prototype,"listElement",void 0),o([g(cc.Label)],e.prototype,"timeLab",void 0),o([h],e)}(r.default);i.default=m,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/UserData":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../entitys/WeeklyGiftItem":"WeeklyGiftItem","../extension/List":"List"}],WelfareCenterPopup:[function(t,e,i){"use strict";cc._RF.push(e,"1612at3Le5NVpksa1TIiVfv","WelfareCenterPopup");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/base/BaseUI"),r=t("../../scripts/data/MiscData"),c=t("../../scripts/data/MstData"),d=t("../../scripts/data/UserData"),l=t("../../scripts/manager/UIManager"),p=t("../../scripts/utils/EventName"),u=t("../../scripts/utils/GlobalFun"),f=t("../../scripts/utils/StatisticsManager"),h=t("./EnergyCardPopup"),g=t("./GreatValueGiftPopup"),m=t("./GrowthFundPopup"),v=t("./SuperVipPopup"),_=t("./WeeklyGiftPopup"),y=t("../../scripts/extension/LanguageData"),I=cc._decorator,b=I.ccclass,N=I.property,C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.weeklyGiftNode=null,e.vipNode=null,e.growthFundNode=null,e.greatValueGiftNode=null,e.weeklyGiftNodeRed=null,e.vipNodeRed=null,e.growthFundNodRede=null,e.greatValueGiftNodeRed=null,e.vipTime=null,e.weeklyGiftTime=null,e.energyCardTime=null,e.energyCardNodeRed=null,e.energyCard=null,e}return n(e,t),e.prototype.onClickVip=function(){f.default.trackEvent("vip_click"),l.default.getInstance().openUI(v.default),cc.sys.localStorage.setItem("superViptRedTime",u.default.getDateByYMD()),cc.director.getScene().emit(p.default.UPDATE_ACTIVITY)},e.prototype.onClickGrowthFund=function(){l.default.getInstance().openUI(m.default),d.default.getInstance().growthFundData.updateRed(!1),cc.director.getScene().emit(p.default.UPDATE_ACTIVITY)},e.prototype.onClickGreatValueGift=function(){f.default.trackEvent("greatValueGift_click"),l.default.getInstance().openUI(g.default)},e.prototype.onClickWeeklyGift=function(){l.default.getInstance().openUI(_.default),d.default.getInstance().weeklyGiftModel.updateRed(!1),cc.director.getScene().emit(p.default.UPDATE_ACTIVITY)},e.prototype.onClickEnergyCard=function(){l.default.getInstance().openUI(h.default),this.energyCardNodeRed.active=!1,d.default.getInstance().energyCardModel.updateRed(!1),cc.director.getScene().emit(p.default.UPDATE_ACTIVITY)},e.prototype.updateEnergyCardTime=function(){var t=Math.ceil(d.default.getInstance().energyCardModel.endTime-window.serverTime);this.energyCardTime.string=t<0?y.default.t("hemaPrefab_3"):u.default.timeFormat(t)},e.prototype.updateEnergyCard=function(){if(d.default.getInstance().level>=c.default.getInstance().mstActivity.energyCard.openLevel&&r.default.getInstance().isIOSPayOpen){this.energyCard.active=!0;var t=Math.ceil(d.default.getInstance().energyCardModel.endTime-window.serverTime);this.energyCardNodeRed.active=d.default.getInstance().energyCardModel.isRed&&t<=0}else this.energyCard.active=!1},e.prototype.updateVipCardTime=function(){var t=d.default.getInstance().vipCardEndTime,e=d.default.getInstance().superVipCardEndTime;if(d.default.getInstance().isVipCard||d.default.getInstance().isSuperVipCard){var i=t-window.serverTime,a=e-window.serverTime,n=0;i>0&&(a<=0||i<a)?n=i:a>0&&(i<=0||a<i)&&(n=a),this.vipTime.string=u.default.timeFormat(n)}else this.vipTime.string=y.default.t("hemaPrefab_3")},e.prototype.updateWeeklyGiftTime=function(){var t=Math.ceil(d.default.getInstance().weeklyGiftModel.lastTime-window.serverTime);t=t<0?0:t,this.weeklyGiftTime.string=u.default.timeFormat(t),d.default.getInstance().weeklyGiftModel.getFirstDayOnWeek()&&d.default.getInstance().weeklyGiftModel.loadData()},e.prototype.updateVipCard=function(){if(d.default.getInstance().level>=c.default.getInstance().mstActivity.vipCrad.openLevel&&r.default.getInstance().isIOSPayOpen){this.vipNode.active=!0;var t=d.default.getInstance().vipCardDailyRewardTimes,e=d.default.getInstance().superVipCardDailyRewardTimes;d.default.getInstance().isVipCard&&t<=0||d.default.getInstance().isSuperVipCard&&e<=0?this.vipNodeRed.active=!0:this.vipNodeRed.active=!1,d.default.getInstance().isSuperVipRed&&(t<=0||e<=0)&&(this.vipNodeRed.active=!0)}else this.vipNode.active=!1},e.prototype.updateWeeklyGift=function(){d.default.getInstance().level>=c.default.getInstance().mstActivity.weeklyGift.openLevel&&r.default.getInstance().isIOSPayOpen?(this.weeklyGiftNode.active=!0,this.weeklyGiftNodeRed.active=d.default.getInstance().weeklyGiftModel.isRed&&!d.default.getInstance().weeklyGiftModel.isAllReceived()):this.weeklyGiftNode.active=!1},e.prototype.updateGrowthFund=function(){d.default.getInstance().level>=c.default.getInstance().mstActivity.growthFund.openLevel&&r.default.getInstance().isIOSPayOpen?this.growthFundNode.active=!0:this.growthFundNode.active=!1;var t=c.default.getInstance().mstLevelup,e=1;for(this.growthFundNodRede.active=!1;t[e];){if((t[e].growthFundReward.length>0||t[e].growthFundRewardRes.length>0)&&d.default.getInstance().level>=e&&(!d.default.getInstance().growthFundData.receiveData[e]||!d.default.getInstance().growthFundData.receiveData[e].isReceive))return void(this.growthFundNodRede.active=!0);e++}},e.prototype.unpdateGreatValueGift=function(){this.greatValueGiftNodeRed.active=!1,d.default.getInstance().level>=c.default.getInstance().mstActivity.greatValueGift.openLevel&&r.default.getInstance().isIOSPayOpen?this.greatValueGiftNode.active=!0:this.greatValueGiftNode.active=!1},e.prototype.updateBySecond=function(){this.updateVipCardTime(),this.updateWeeklyGiftTime(),this.updateEnergyCardTime()},e.prototype.updateActive=function(){this.updateVipCard(),this.updateWeeklyGift(),this.updateGrowthFund(),this.unpdateGreatValueGift(),this.updateEnergyCard()},e.prototype.onLoad=function(){this.updateBySecond(),this.updateActive(),cc.director.getScene().on(p.default.UPDATE_BY_SECOND,this.updateBySecond,this),cc.director.getScene().on(p.default.UPDATE_ACTIVITY,this.updateActive,this),cc.director.getScene().on(p.default.NEW_DAY,this.updateVipCard,this)},e.uiName="WelfareCenterPopup",o([N(cc.Node)],e.prototype,"weeklyGiftNode",void 0),o([N(cc.Node)],e.prototype,"vipNode",void 0),o([N(cc.Node)],e.prototype,"growthFundNode",void 0),o([N(cc.Node)],e.prototype,"greatValueGiftNode",void 0),o([N(cc.Node)],e.prototype,"weeklyGiftNodeRed",void 0),o([N(cc.Node)],e.prototype,"vipNodeRed",void 0),o([N(cc.Node)],e.prototype,"growthFundNodRede",void 0),o([N(cc.Node)],e.prototype,"greatValueGiftNodeRed",void 0),o([N(cc.Label)],e.prototype,"vipTime",void 0),o([N(cc.Label)],e.prototype,"weeklyGiftTime",void 0),o([N(cc.Label)],e.prototype,"energyCardTime",void 0),o([N(cc.Node)],e.prototype,"energyCardNodeRed",void 0),o([N(cc.Node)],e.prototype,"energyCard",void 0),o([b],e)}(s.default);i.default=C,cc._RF.pop()},{"../../scripts/base/BaseUI":void 0,"../../scripts/data/MiscData":void 0,"../../scripts/data/MstData":void 0,"../../scripts/data/UserData":void 0,"../../scripts/extension/LanguageData":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/utils/EventName":void 0,"../../scripts/utils/GlobalFun":void 0,"../../scripts/utils/StatisticsManager":void 0,"./EnergyCardPopup":"EnergyCardPopup","./GreatValueGiftPopup":"GreatValueGiftPopup","./GrowthFundPopup":"GrowthFundPopup","./SuperVipPopup":"SuperVipPopup","./WeeklyGiftPopup":"WeeklyGiftPopup"}],levelUpAwardItem:[function(t,e,i){"use strict";cc._RF.push(e,"0996fzN9ilNPYQNcpz75OF+","levelUpAwardItem");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var n,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../scripts/data/MstData"),r=t("../../scripts/manager/UIManager"),c=t("../../scripts/utils/GlobalFun"),d=t("../prefabs/ItemChain"),l=cc._decorator,p=l.ccclass,u=l.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.icon=null,e.infoNode=null,e.itemName=null,e._itemData=null,e}return n(e,t),e.prototype.init=function(t){t.itemId?(this._itemData=s.default.getInstance().mstItem[t.itemId],cc.isValid(this.node)&&(this.loadIcon(),this.itemName.string=this._itemData.name,30091==t.itemId||30092==t.itemId||30093==t.itemId||30094==t.itemId?(this.node.getComponent(cc.Button).interactable=!1,this.infoNode.active=!1):(this.node.getComponent(cc.Button).interactable=!0,this.infoNode.active=!0))):console.error("levelUpAwardItem \u7269\u54c1Id\u9519\u8bef,\u4e0d\u80fd\u4e3a\u7a7a")},e.prototype.loadIcon=function(t){void 0===t&&(t=!1);var e="textures/itemIcon/"+this._itemData.icon;c.default.loadSpriteFrame(this.icon,e)},e.prototype.onClick=function(){r.default.getInstance().openUI(d.default,{data:this._itemData.id})},o([u(cc.Sprite)],e.prototype,"icon",void 0),o([u(cc.Node)],e.prototype,"infoNode",void 0),o([u(cc.Label)],e.prototype,"itemName",void 0),o([p],e)}(cc.Component);i.default=f,cc._RF.pop()},{"../../scripts/data/MstData":void 0,"../../scripts/manager/UIManager":void 0,"../../scripts/utils/GlobalFun":void 0,"../prefabs/ItemChain":"ItemChain"}]},{},["ActivityBtn","ChildrenDayBtn","HappyBingoBtn","NewYearBtn","WaterParkBtn","ActiveExchangeAwardItem","AltasTypeItem","AssistShopAwardItem","AssistShopItem","AtlasElementItem","BagItem","BlindBoxAwardItem","BlindBoxItem","BottomInfoPrefab","BuildCompleteItem","BuildItem","BuildTaskBubble","BuildTaskItem","BuildingSkinItem","BuyItem","CellItem","ChildrenDayGiftItem","ChristmasLvItem","Customer","FoodFestivalUI","GashaponAwardItem","GreatValueGiftItem","GrowthFundItem","HappyBingoItem","HemaPrefab","ItemBgPrefab","ItemChainItem","ItemEntity","ItemFly","ItemImgPrefab","ItemList","ItemPrefab","ItemTempPrefab","LimitActMergeManager","LimitActMergeUI","MailsAwardItem","MailsItem","MergeManager","MergeUI","NewYearExchangeItem","PassAwardItem","PassItem","RankItem","RoleSkinItem","ShopItem","TaskCustomerItem","TaskTradeItem","TipGuide","TopInfoPrefab","TopInfoTaskItem","UnlockBuildingAni","WaterParkGiftItem","WeeklyGiftItem","levelUpAwardItem","List","ListItem","AssistShopPopup","AtlasPopup","AwardPopup","BagPopup","BlindBoxAwardPopup","BuildCompletePopup","BuildInfoPopup","BuildTaskPopup","BuyTipPopup","ChildrenDayGiftPopup","ChildrenDayPopup","ChristmasAniPopup","ChristmasPopup","ContractPopup","CustomerInfoPopup","DailyBenefitsPopup","EnergyBottlePopup","EnergyCardPopup","EnergyPopup","ExchangeCodePopup","FoodFestivalHelpPopup","FoodFestivalResultPopup","FreeBenefitsPopup","GameClubPopup","GashaponPopup","GreatValueGiftPopup","GrowthFundPopup","GuidanceManager","Guide","HappyBingoHelpPopup","HappyBingoPopup","HappyBingoSubmitPopup","HelpCommonPopup","HelpPopup","HelpQuestionPopup","ItemChain","ItemInfoPopup","LevelAwardPopup","LevelUpAwardPopup","Levelup","LimitActListPopup","LimitActivityGiftPopup","LockAreaItem","MailsDetailsPopup","MailsPopup","NewUserGiftPopup","NewYearAniPopup","NewYearExchangePopup","NewYearPopup","OpeningPopup","OtherBlindBoxPopup","PassPopup","PlayerGroupPopup","RankPopup","SelfBlindBoxPopup","Setting","ShopPopup","SkinGiftPopup","SuperBenefitsPopup","SuperVipPopup","TaskGiftPopup","TaskPopup","UnlockShowPopup","WaterParkGiftPopup","WaterParkPopup","WeeklyGiftPopup","WelfareCenterPopup","MainScene","AdapterTop","UndirectedGraph"]);